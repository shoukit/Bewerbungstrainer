import{j as e,O as Y,L as W,z as ye,v as It,Q as _e,g as Ie,Y as Dt,_ as Ze,m as M,V as Re,M as we,$ as ut,F as Et,a0 as Ne,a1 as Ge,y as Ee,C as Ct,A as _t,e as et,a2 as At,a3 as zt,a4 as Oe,a5 as Lt,a6 as es,a7 as ts,w as Ot,a8 as pt,a9 as ss,b as as,X as ns,aa as is,h as xe,l as We,d as Fe,ab as gt,ac as ft,c as Te,ad as rs,s as ls,ae as cs,a as tt,H as bt,p as jt,t as yt,af as os}from"./ui-vendor-BPmrRjpn.js";import{a as o}from"./react-vendor-uDOJF2jQ.js";import{B as X,C as q,S as Ue,a as ds}from"./select-native-DRUSZasO.js";import{g as De,a as de,m as J,l as ve,C as B,n as me,I as U,u as xs,w as P}from"./FeatureInfoButton-C-pllNNf.js";import{D as ms,a as hs,b as us,c as ps,d as gs,e as fs}from"./dialog-ClMCq6FL.js";import{b as bs,p as js,d as ys,e as Ns,h as vs,i as ws,j as ks,g as Ss}from"./index.js";import{u as Ae}from"./useMobile-YxjH166V.js";import{R as Is}from"./RoleplaySessionReport-BFhIoZv4.js";import{g as Ds,B as Es}from"./BriefingWorkbook-Di2RZfgT.js";import{D as Cs,a as _s}from"./DecisionBoardResult-DsI6upfT.js";import{I as As,a as zs}from"./IkigaiResults-CjgtfHlE.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";import"./input-Dg8SXIdV.js";import"./textarea-D_5UFHp6.js";import"./AudioRecorder-B_-X6R96.js";import"./button-BoRGn9H8.js";import"./card-CnaoFFkT.js";import"./DeviceSettingsDialog-oL48EOzx.js";import"./DeviceSetupPage-CC-lJTFm.js";import"./MicrophoneTestDialog-BMYyyjuu.js";const he=({isOpen:t,onClose:a,onConfirm:n,title:u="L√∂schen best√§tigen",description:m="Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:i=!1,confirmLabel:p="L√∂schen",cancelLabel:x="Abbrechen"})=>e.jsx(ms,{open:t,onOpenChange:a,children:e.jsxs(hs,{className:"max-w-[400px]",children:[e.jsxs(us,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-[10px] bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center",children:e.jsx(Y,{className:"w-5 h-5 text-white"})}),e.jsx(ps,{children:u})]}),e.jsx(gs,{children:m})]}),e.jsxs(fs,{className:"mt-4",children:[e.jsx("button",{onClick:a,disabled:i,style:{minWidth:"100px",height:"40px",padding:"8px 20px",borderRadius:"8px",border:"1px solid #E2E8F0",backgroundColor:"#FFFFFF",color:"#1E293B",fontSize:"14px",fontWeight:"500",cursor:i?"not-allowed":"pointer",opacity:i?.5:1,transition:"all 0.15s ease"},onMouseEnter:j=>{i||(j.target.style.backgroundColor="#F8FAFC")},onMouseLeave:j=>{j.target.style.backgroundColor="#FFFFFF"},children:x}),e.jsx("button",{onClick:n,disabled:i,style:{minWidth:"100px",height:"40px",padding:"8px 20px",borderRadius:"8px",border:"none",background:"linear-gradient(to bottom right, #EF4444, #DC2626)",color:"#FFFFFF",fontSize:"14px",fontWeight:"500",cursor:i?"not-allowed":"pointer",opacity:i?.5:1,transition:"all 0.15s ease",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:i?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-4 h-4 animate-spin"}),p,"..."]}):p})]})]})}),Ls={auftreten:ss,selbstbewusstsein:pt,koerpersprache:Ot,kommunikation:we,professionalitaet:pt,inhalt:Ee},Os=t=>t>=90?"Ausgezeichnet!":t>=80?"Sehr gut!":t>=70?"Gut!":t>=60?"Solide Leistung":t>=50?"Ausbauf√§hig":"Weiter √ºben!",Fs=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",Ts=t=>t==="video"?"Wirkungs-Analyse":t==="roleplay"?"Live-Simulation":"Szenario-Training",Rs=({score:t,size:a=120,isHeader:n=!1})=>{const u=Math.min(100,Math.max(0,t||0)),m=(a-12)/2,i=m*2*Math.PI,p=i-u/100*i,x=J(t);return e.jsxs("div",{className:"relative",style:{width:a,height:a},children:[e.jsxs("svg",{width:a,height:a,style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:a/2,cy:a/2,r:m,fill:"none",stroke:n?"rgba(255,255,255,0.3)":B.slate[200],strokeWidth:10}),e.jsx(M.circle,{cx:a/2,cy:a/2,r:m,fill:"none",stroke:x,strokeWidth:10,strokeLinecap:"round",strokeDasharray:i,initial:{strokeDashoffset:i},animate:{strokeDashoffset:p},transition:{duration:1,ease:"easeOut"}})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{style:{fontSize:a/3.5,fontWeight:700,color:x},children:Math.round(t)}),e.jsx("span",{className:`${n?"text-white":"text-slate-500"}`,style:{fontSize:a/10},children:"von 100"})]})]})},Ms=({audioUrl:t,durationHint:a})=>{const n=o.useRef(null),[u,m]=o.useState(!1),[i,p]=o.useState(0),[x,j]=o.useState(a||0),[N,r]=o.useState(!0),[S,E]=o.useState(null);o.useEffect(()=>{if(!t)return;r(!0),E(null),j(a||0);const d=new Audio;n.current=d;const C=()=>{const f=d.duration;f&&isFinite(f)&&f>0&&j(f),r(!1)},F=()=>{const f=d.duration;f&&isFinite(f)&&f>0&&j(f)},O=()=>{r(!1);const f=d.duration;f&&isFinite(f)&&f>0&&j(f)};return d.addEventListener("loadedmetadata",C),d.addEventListener("durationchange",F),d.addEventListener("canplaythrough",O),d.addEventListener("timeupdate",()=>p(d.currentTime)),d.addEventListener("play",()=>m(!0)),d.addEventListener("pause",()=>m(!1)),d.addEventListener("ended",()=>m(!1)),d.addEventListener("error",()=>{E("Audio nicht verf√ºgbar"),r(!1)}),d.src=t,d.load(),()=>{d.pause(),d.removeEventListener("loadedmetadata",C),d.removeEventListener("durationchange",F),d.removeEventListener("canplaythrough",O),d.src=""}},[t,a]);const v=()=>{n.current&&(u?n.current.pause():n.current.play())},I=d=>{const C=d.currentTarget.getBoundingClientRect(),F=(d.clientX-C.left)/C.width;n.current&&(n.current.currentTime=F*x)},L=d=>{n.current&&(n.current.currentTime=Math.max(0,Math.min(n.current.currentTime+d,x)))};if(S)return e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg text-slate-500 text-[13px] flex items-center gap-2",children:[e.jsx(ye,{size:16})," ",S]});if(!t)return null;const A=x>0?i/x*100:0;return e.jsxs(q,{className:"p-5",children:[e.jsx("div",{onClick:I,className:"h-2 bg-slate-200 rounded cursor-pointer mb-4",children:e.jsx("div",{className:"h-full bg-primary rounded transition-all duration-100",style:{width:`${A}%`}})}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:()=>L(-10),className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600",children:e.jsx(At,{size:20})}),e.jsx("button",{onClick:v,disabled:N,className:`w-12 h-12 rounded-full bg-primary border-none flex items-center justify-center text-white ${N?"cursor-wait opacity-70":"cursor-pointer"}`,children:N?e.jsx(W,{size:22,className:"animate-spin"}):u?e.jsx(zt,{size:22,fill:"white"}):e.jsx(Oe,{size:22,fill:"white",className:"ml-0.5"})}),e.jsx("button",{onClick:()=>L(10),className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600",children:e.jsx(Lt,{size:20})})]}),e.jsxs("div",{className:"text-center mt-2 text-[13px] text-slate-500",children:[ve(i)," / ",ve(x)]})]})},$s=({sessionId:t,conversationId:a})=>{const n=o.useRef(null),[u,m]=o.useState(!1),[i,p]=o.useState(!1),[x,j]=o.useState(0),[N,r]=o.useState(0),[S,E]=o.useState(null),[v,I]=o.useState(!0);o.useEffect(()=>{if(!a){I(!1),E("Keine Audio-Aufnahme verf√ºgbar");return}const F=ws(t);return I(!0),E(null),fetch(F,{headers:{"X-WP-Nonce":de()},credentials:"same-origin"}).then(O=>{if(!O.ok)throw new Error(`HTTP ${O.status}`);return O.blob()}).then(O=>{const f=URL.createObjectURL(O),w=new Audio(f);n.current=w,w._objectUrl=f,w.addEventListener("loadedmetadata",()=>{r(w.duration),I(!1)}),w.addEventListener("timeupdate",()=>j(w.currentTime)),w.addEventListener("play",()=>m(!0)),w.addEventListener("pause",()=>m(!1)),w.addEventListener("ended",()=>m(!1)),w.addEventListener("error",()=>{E("Audio konnte nicht abgespielt werden."),I(!1)})}).catch(()=>{E("Audio nicht verf√ºgbar."),I(!1)}),()=>{n.current&&(n.current.pause(),n.current._objectUrl&&URL.revokeObjectURL(n.current._objectUrl),n.current=null)}},[t,a]);const L=()=>{n.current&&(u?n.current.pause():n.current.play())},A=()=>{n.current&&(n.current.muted=!i,p(!i))},d=F=>{n.current&&(n.current.currentTime=Math.max(0,Math.min(n.current.currentTime+F,N)))},C=F=>{const O=F.currentTarget.getBoundingClientRect(),f=(F.clientX-O.left)/O.width;n.current&&(n.current.currentTime=f*N)};return v?e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6 text-center",children:[e.jsx(W,{size:24,className:"text-primary animate-spin mx-auto"}),e.jsx("p",{className:"text-[13px] text-slate-500 mt-2",children:"Audio wird geladen..."})]}):S?e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6 text-center",children:[e.jsx(ye,{size:24,className:"text-slate-400 mx-auto"}),e.jsx("p",{className:"text-[13px] text-slate-500 mt-2",children:S})]}):e.jsxs(q,{className:"p-5",children:[e.jsxs("h3",{className:"text-[15px] font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(et,{size:18,className:"text-primary"})," Gespr√§chsaufnahme"]}),e.jsx("div",{onClick:C,className:"h-2 bg-slate-200 rounded cursor-pointer mb-4",children:e.jsx("div",{className:"h-full bg-primary rounded transition-all duration-100",style:{width:`${x/N*100||0}%`}})}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:()=>d(-10),className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600",children:e.jsx(At,{size:20})}),e.jsx("button",{onClick:L,className:"w-12 h-12 rounded-full bg-primary border-none cursor-pointer flex items-center justify-center text-white",children:u?e.jsx(zt,{size:22,fill:"white"}):e.jsx(Oe,{size:22,fill:"white",className:"ml-0.5"})}),e.jsx("button",{onClick:()=>d(10),className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600",children:e.jsx(Lt,{size:20})}),e.jsx("button",{onClick:A,className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600 ml-auto",children:i?e.jsx(es,{size:20}):e.jsx(ts,{size:20})})]}),e.jsxs("div",{className:"text-center mt-2 text-[13px] text-slate-500",children:[ve(x)," / ",ve(N)]})]})},Bs=({entry:t})=>{const a=t.role==="user";return e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex-shrink-0 flex items-center justify-center ${a?"bg-primary":"bg-slate-200"}`,children:e.jsx(Ot,{size:16,className:a?"text-white":"text-slate-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-xs font-semibold mb-1 ${a?"text-primary":"text-slate-400"}`,children:a?"Du":"Interviewer"}),e.jsx("p",{className:"text-sm text-slate-900 leading-relaxed m-0",children:t.text||t.message})]})]})},Ps=({answer:t,index:a})=>{const[n,u]=o.useState(!1),m=t.feedback?typeof t.feedback=="string"?JSON.parse(t.feedback):t.feedback:null,i=t.audio_analysis?typeof t.audio_analysis=="string"?JSON.parse(t.audio_analysis):t.audio_analysis:null,p=t.transcript==="[Keine Sprache erkannt]"||i?.speech_rate==="keine_sprache";return e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.05},children:e.jsxs(q,{className:"mb-4 overflow-hidden p-0",children:[e.jsxs("button",{onClick:()=>u(!n),className:"w-full p-4 bg-transparent border-none cursor-pointer flex items-center gap-3 text-left",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-primary/10 flex items-center justify-center text-primary font-bold text-sm flex-shrink-0",children:a+1}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h4",{className:"text-sm font-semibold text-slate-900 m-0 truncate",children:t.question_text||`Frage ${a+1}`})}),t.overall_score!=null&&e.jsx("span",{className:"text-base font-bold",style:{color:p?B.slate[400]:J(t.overall_score*10)},children:p?"‚Äì":`${Math.round(t.overall_score*10)}%`}),e.jsx(Ct,{size:18,className:`text-slate-400 transition-transform ${n?"rotate-180":""}`})]}),e.jsx(_t,{children:n&&e.jsx(M.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"px-5 pb-5 pt-4 border-t border-slate-100",children:[t.question_text&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-[13px] font-semibold text-slate-900 mb-2 flex items-center gap-1.5",children:[e.jsx(we,{size:14,className:"text-primary"})," Frage / Situation"]}),e.jsx("p",{className:"text-sm text-slate-900 leading-relaxed bg-primary/5 p-3 rounded-lg m-0 border border-primary/10",children:t.question_text})]}),t.audio_url&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-[13px] font-semibold text-slate-900 mb-2 flex items-center gap-1.5",children:[e.jsx(et,{size:14,className:"text-primary"})," Deine Aufnahme"]}),e.jsx(Ms,{audioUrl:t.audio_url,durationHint:t.audio_duration_seconds})]}),t.transcript&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-[13px] font-semibold text-slate-900 mb-2 flex items-center gap-1.5",children:[e.jsx(Et,{size:14,className:"text-primary"})," Transkript"]}),e.jsxs("p",{className:`text-[13px] leading-relaxed bg-slate-50 p-3 rounded-lg m-0 italic break-words ${p?"text-slate-400":"text-slate-600"}`,children:['"',t.transcript,'"']})]}),m?.scores&&!p&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"text-[13px] font-semibold text-slate-900 mb-2.5 flex items-center gap-1.5",children:[e.jsx(Ne,{size:14,className:"text-primary"})," Bewertung"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[{key:"content",label:"Inhalt"},{key:"structure",label:"Struktur"},{key:"relevance",label:"Relevanz"},{key:"delivery",label:"Pr√§sentation"}].map(({key:x,label:j})=>{const N=m.scores[x],r=N!=null?N*10:null;return e.jsxs("div",{className:"p-2.5 bg-slate-50 rounded-lg text-center",children:[e.jsx("div",{className:"text-base font-bold",style:{color:r!=null?J(r):B.slate[400]},children:r!=null?Math.round(r):"-"}),e.jsx("div",{className:"text-[10px] text-slate-500 mt-0.5",children:j})]},x)})}),(()=>{const x=m.scores.overall,j=x!=null?x*10:null;return e.jsxs("div",{className:"p-3 bg-primary/10 rounded-lg text-center border border-primary/20 flex items-center justify-center gap-3",children:[e.jsx("div",{className:"text-[10px] text-slate-500",children:"Gesamt"}),e.jsx("div",{className:"text-xl font-bold",style:{color:j!=null?J(j):B.slate[400]},children:j!=null?Math.round(j):"-"})]})})()]}),m?.summary&&e.jsx("p",{className:"text-[13px] text-slate-600 leading-snug mb-3",children:m.summary}),m?.strengths?.length>0&&!p&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{className:"text-xs font-semibold text-green-600 mb-1.5 flex items-center gap-1",children:[e.jsx(Ge,{size:12})," St√§rken"]}),e.jsx("ul",{className:"m-0 pl-4 text-slate-600 text-xs",children:m.strengths.map((x,j)=>e.jsx("li",{className:"mb-1",children:x},j))})]}),m?.improvements?.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{className:"text-xs font-semibold text-amber-600 mb-1.5 flex items-center gap-1",children:[e.jsx(ye,{size:12})," Verbesserungspotenzial"]}),e.jsx("ul",{className:"m-0 pl-4 text-slate-600 text-xs",children:m.improvements.map((x,j)=>e.jsx("li",{className:"mb-1",children:x},j))})]}),m?.tips?.length>0&&!p&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h6",{className:"text-xs font-semibold text-primary mb-1.5 flex items-center gap-1",children:[e.jsx(Ee,{size:12})," Tipps"]}),e.jsx("ul",{className:"m-0 pl-4 text-slate-600 text-xs",children:m.tips.map((x,j)=>e.jsx("li",{className:"mb-1",children:x},j))})]}),i&&!p&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100",children:[e.jsxs("h5",{className:"text-[13px] font-semibold text-slate-900 mb-3 flex items-center gap-1.5",children:[e.jsx(et,{size:14,className:"text-primary"})," Sprechanalyse"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[i.speech_rate&&e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"Sprechtempo"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 capitalize",children:i.speech_rate==="optimal"?"‚úì Optimal":i.speech_rate==="zu_schnell"?"‚ö° Zu schnell":i.speech_rate==="zu_langsam"?"üê¢ Zu langsam":i.speech_rate})]}),i.filler_words&&e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"F√ºllw√∂rter"}),e.jsxs("div",{className:`text-sm font-semibold ${i.filler_words.count<=2?"text-green-600":i.filler_words.count<=5?"text-amber-600":"text-red-600"}`,children:[i.filler_words.count||0," erkannt"]}),i.filler_words.words?.length>0&&e.jsx("div",{className:"text-[11px] text-slate-500 mt-1",children:i.filler_words.words.slice(0,5).join(", ")})]}),i.confidence_score!=null&&e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"Selbstsicherheit"}),e.jsxs("div",{className:"text-sm font-semibold",style:{color:J(i.confidence_score)},children:[i.confidence_score,"%"]})]}),i.clarity_score!=null&&e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"text-[11px] text-slate-500 mb-1",children:"Klarheit"}),e.jsxs("div",{className:"text-sm font-semibold",style:{color:J(i.clarity_score)},children:[i.clarity_score,"%"]})]})]}),i.notes&&e.jsx("p",{className:"text-xs text-slate-500 mt-2.5 italic",children:i.notes})]})]})})})]})})},Us=({isOpen:t,onClose:a,onConfirm:n,isDeleting:u})=>t?e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",onClick:a,children:e.jsxs(M.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl p-6 max-w-[400px] w-[90%] shadow-2xl",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-100 flex items-center justify-center",children:e.jsx(Y,{size:24,className:"text-red-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 m-0",children:"Session l√∂schen?"})]}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed mb-6",children:"M√∂chtest du diese Session wirklich l√∂schen? Alle Antworten und Feedback werden unwiderruflich entfernt."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(X,{variant:"secondary",onClick:a,disabled:u,children:"Abbrechen"}),e.jsx(X,{variant:"danger",onClick:n,disabled:u,icon:u?e.jsx(W,{size:16,className:"animate-spin"}):e.jsx(Y,{size:16}),children:u?"L√∂schen...":"L√∂schen"})]})]})}):null,Gs=({category:t})=>{const[a,n]=o.useState(!1),u=Ls[t.category]||Ne,m=J(t.score);return e.jsxs(q,{className:"mb-2.5 overflow-hidden p-0",children:[e.jsxs("button",{onClick:()=>n(!a),className:"w-full p-3.5 bg-transparent border-none cursor-pointer flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center",style:{backgroundColor:`${m}15`},children:e.jsx(u,{size:18,style:{color:m}})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("h4",{className:"text-sm font-semibold text-slate-900 m-0",children:t.label})}),e.jsxs("span",{className:"text-base font-bold",style:{color:m},children:[Math.round(t.score),"%"]}),e.jsx(Ct,{size:18,className:`text-slate-400 transition-transform ${a?"rotate-180":""}`})]}),e.jsx(_t,{children:a&&e.jsx(M.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-3 border-t border-slate-100",children:[t.feedback&&e.jsx("p",{className:"text-[13px] text-slate-600 leading-snug mb-2.5",children:t.feedback}),t.strengths?.length>0&&e.jsxs("div",{className:"mb-2.5",children:[e.jsxs("h6",{className:"text-xs font-semibold text-green-600 mb-1 flex items-center gap-1",children:[e.jsx(Ge,{size:12})," St√§rken"]}),e.jsx("ul",{className:"m-0 pl-4 text-xs text-slate-600",children:t.strengths.map((i,p)=>e.jsx("li",{children:i},p))})]}),t.improvements?.length>0&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-xs font-semibold text-amber-600 mb-1 flex items-center gap-1",children:[e.jsx(Ee,{size:12})," Tipps"]}),e.jsx("ul",{className:"m-0 pl-4 text-xs text-slate-600",children:t.improvements.map((i,p)=>e.jsx("li",{children:i},p))})]})]})})})]})},Ws=({session:t,type:a,scenario:n,onBack:u,onContinueSession:m,onRepeatSession:i,onDeleteSession:p})=>{const x=Ae(),[j,N]=o.useState(!1);o.useEffect(()=>{const l=()=>{const y=window.innerWidth;N(y>=768&&y<1200)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]);const[r,S]=o.useState([]),[E,v]=o.useState(!0),[I,L]=o.useState(null),[A,d]=o.useState(!1),[C,F]=o.useState(!1),[O,f]=o.useState(!1),[w,ie]=o.useState(null),[se,V]=o.useState(n),H=a==="video",K=a==="simulator",G=a==="roleplay",ue=(()=>{const l=t?.questions||t?.questions_json;if(!l)return!1;try{const y=typeof l=="string"?JSON.parse(l):l;return Array.isArray(y)&&y.length>0}catch{return!1}})(),ke=(()=>{if(!K||!ue)return!1;const l=t?.total_questions||0,y=t?.completed_questions||0;return l>0&&y<l})(),ee=async()=>{if(p){F(!0);try{await p(t,a)}catch(l){console.error("Failed to delete session:",l),F(!1),d(!1)}}},pe=async()=>{if(!(O||!t?.id)){f(!0);try{let l;if(K)l=`${De()}/simulator/sessions/${t.id}/export-pdf`;else if(H)l=`${De()}/video-training/sessions/${t.id}/export-pdf`;else if(G)l=`${De()}/sessions/${t.id}/export-pdf`;else throw new Error("Unsupported session type for PDF export");const y=await fetch(l,{method:"POST",headers:{"X-WP-Nonce":de(),"Content-Type":"application/json"},credentials:"same-origin"}),T=await y.json();if(!y.ok)throw new Error(T.error||`HTTP ${y.status}`);if(!T.success||!T.pdf_base64)throw new Error(T.error||"PDF generation failed");const le=atob(T.pdf_base64),ze=new Array(le.length);for(let ce=0;ce<le.length;ce++)ze[ce]=le.charCodeAt(ce);const fe=new Uint8Array(ze),Ve=new Blob([fe],{type:T.content_type||"application/pdf"}),Le=window.URL.createObjectURL(Ve),Z=document.createElement("a");Z.href=Le,Z.download=T.filename||"Training.pdf",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),window.URL.revokeObjectURL(Le)}catch(l){console.error("Failed to download PDF:",l)}finally{f(!1)}}};o.useEffect(()=>{K&&t?.id?Me():G&&t?.id?ge():v(!1)},[t?.id,a]);const Me=async()=>{try{v(!0);const y=await(await fetch(`${De()}/simulator/sessions/${t.id}/answers`,{headers:{"X-WP-Nonce":de()}})).json();y.success&&y.data?.answers?S(y.data.answers):Array.isArray(y.data)&&S(y.data)}catch(l){console.error("Failed to load answers:",l),L("Fehler beim Laden der Antworten")}finally{v(!1)}},ge=async()=>{try{v(!0);const l=await bs(t.id);if(ie({...t,...l,feedback:Ns(l.feedback_json||t.feedback_json),audioAnalysis:ys(l.audio_analysis_json||t.audio_analysis_json),transcript:js(l.transcript||t.transcript)}),!n&&l.scenario_id)try{const y=await vs(l.scenario_id);V(y)}catch(y){console.warn("Could not load scenario:",y)}}catch(l){console.error("Failed to load roleplay data:",l),L("Fehler beim Laden der Gespr√§chsdaten")}finally{v(!1)}},k=t?.summary_feedback_json?typeof t.summary_feedback_json=="string"?JSON.parse(t.summary_feedback_json):t.summary_feedback_json:null,_=t?.category_scores||[],$=t?.analysis||{},re=(()=>{let l=0;return G&&w?.feedback?.rating?.overall?l=w.feedback.rating.overall:l=t?.overall_score||k?.overall_score||0,(K||G)&&l<=10?l*10:l})();return E?e.jsx("div",{className:"w-full min-h-[60vh] flex items-center justify-center p-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{size:48,className:"text-primary animate-spin mx-auto"}),e.jsx("p",{className:"text-slate-500 mt-4",children:"Analyse wird geladen..."})]})}):I?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-[400px] p-6",children:[e.jsx(ye,{size:48,className:"text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-slate-600 mb-6",children:I}),e.jsx(X,{variant:"secondary",onClick:u,children:"Zur√ºck"})]})}):e.jsxs("div",{className:"min-h-screen bg-slate-50 overflow-hidden max-w-full",children:[e.jsx("div",{className:`sticky top-0 z-40 ${x?"px-4 py-5":"px-8 py-6"}`,style:{background:"var(--header-gradient, linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%))"},children:e.jsxs("div",{className:"max-w-[1400px] mx-auto",children:[u&&e.jsxs("button",{onClick:u,className:"flex items-center gap-1.5 bg-white/15 border-none rounded-lg px-3 py-2 cursor-pointer text-white text-[13px] mb-4 hover:bg-white/25 transition-colors",children:[e.jsx(It,{size:16}),"Zur√ºck zur √úbersicht"]}),e.jsxs("div",{className:"flex items-center gap-6",children:[!x&&e.jsx(Rs,{score:re,size:100,isHeader:!0}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap mb-2",children:[e.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wide px-2.5 py-1 rounded-full bg-white/20 text-white",children:Ts(a)}),e.jsx("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-white/90",style:{color:J(re)},children:Os(re)})]}),e.jsx("h1",{className:`font-bold text-white m-0 mb-2 ${x?"text-xl":"text-2xl"}`,children:(G?se?.title:n?.title)||t?.scenario_title||t?.position||"Training"}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(_e,{size:14}),Fs(t?.created_at)]}),t?.duration&&e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(Ie,{size:14}),ve(t.duration)]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:pe,disabled:O,title:"Als PDF herunterladen",className:`flex items-center justify-center bg-white/20 border border-white/30 rounded-lg px-3 py-2.5 text-white outline-none transition-colors hover:bg-white/30 ${O?"cursor-wait opacity-70":"cursor-pointer"}`,children:O?e.jsx(W,{size:16,className:"animate-spin"}):e.jsx(Dt,{size:16})}),!x&&i&&e.jsxs("button",{onClick:()=>i(t,n),className:"flex items-center gap-2 bg-white/20 border border-white/30 rounded-lg px-5 py-2.5 cursor-pointer text-white text-sm font-medium outline-none hover:bg-white/30 transition-colors",children:[e.jsx(Ze,{size:16}),"Erneut √ºben"]}),p&&e.jsx("button",{onClick:()=>d(!0),className:`flex items-center gap-2 bg-red-500/20 border border-red-500/40 rounded-lg cursor-pointer text-white text-sm font-medium outline-none hover:bg-red-500/30 transition-colors ${x?"px-3 py-2.5":"px-4 py-2.5"}`,children:e.jsx(Y,{size:16})})]})]})]})}),e.jsx("div",{className:`overflow-hidden ${x?"p-4":"px-8 py-6"}`,children:e.jsxs("div",{className:"grid gap-6 overflow-hidden",style:{gridTemplateColumns:x||j?"1fr":"1fr 400px"},children:[e.jsxs("div",{className:"min-w-0 overflow-hidden",children:[H&&t?.video_url&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(q,{className:"mb-5 p-5",children:[e.jsxs("h3",{className:"text-[15px] font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[e.jsx(Re,{size:18,className:"text-primary"})," Deine Aufnahme"]}),e.jsx("video",{src:t.video_url,controls:!0,className:"w-full max-w-[640px] max-h-[360px] rounded-xl bg-black object-contain"})]})}),K&&r.length>0&&e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsxs("h3",{className:"text-base font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(we,{size:18,className:"text-primary"})," Deine Antworten (",r.length,")"]}),r.map((l,y)=>e.jsx(Ps,{answer:l,index:y},l.id||y)),ke&&(m||i)&&e.jsxs("div",{className:"flex gap-3 justify-center flex-wrap mt-6 p-5 bg-slate-50 rounded-xl border border-dashed border-slate-300",children:[e.jsx("p",{className:"w-full text-center text-slate-600 text-sm mb-3",children:"Diese Session ist noch nicht abgeschlossen."}),m&&e.jsx(X,{onClick:()=>m(t,n),icon:e.jsx(ut,{size:18}),children:"Fortsetzen"}),i&&e.jsx(X,{variant:"secondary",onClick:()=>i(t,n),icon:e.jsx(Ze,{size:18}),children:"Erneut starten"})]})]}),K&&r.length===0&&e.jsxs("div",{className:"text-center py-12 px-6 bg-slate-50 rounded-2xl",children:[e.jsx(ye,{size:48,className:"text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Keine Antworten vorhanden"}),e.jsx("p",{className:"text-slate-500 mb-6",children:ue?"Diese Session wurde nicht abgeschlossen. Du kannst sie fortsetzen oder erneut starten.":"Diese Session wurde verlassen, bevor Fragen generiert wurden."}),ke&&(m||i)&&e.jsxs("div",{className:"flex gap-3 justify-center flex-wrap",children:[m&&e.jsx(X,{onClick:()=>m(t,n),icon:e.jsx(ut,{size:18}),children:"Fortsetzen"}),i&&e.jsx(X,{variant:"secondary",onClick:()=>i(t,n),icon:e.jsx(Ze,{size:18}),children:"Erneut starten"})]})]}),G&&w&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-5",children:e.jsx($s,{sessionId:t.id,conversationId:w.conversation_id})}),G&&w?.transcript?.length>0&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(q,{className:"p-5",children:[e.jsxs("h3",{className:"text-[15px] font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Et,{size:18,className:"text-primary"})," Gespr√§chsverlauf"]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:w.transcript.map((l,y)=>e.jsx(Bs,{entry:l},y))})]})})]}),e.jsxs("div",{className:"min-w-0 overflow-hidden",children:[H&&_.length>0&&e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-5",children:[e.jsxs("h3",{className:"text-[15px] font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[e.jsx(Ne,{size:16,className:"text-primary"})," Detaillierte Bewertung"]}),_.map((l,y)=>e.jsx(Gs,{category:l},l.category||y))]}),H&&($.key_strengths?.length>0||$.actionable_tips?.length>0)&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(q,{className:"mb-5 p-5",children:[$.key_strengths?.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-600 mb-2.5 flex items-center gap-1.5",children:[e.jsx(Ge,{size:16})," Deine St√§rken"]}),e.jsx("ul",{className:"m-0 pl-5",children:$.key_strengths.map((l,y)=>e.jsx("li",{className:"text-[13px] text-slate-600 mb-1.5 leading-snug",children:l},y))})]}),$.actionable_tips?.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-primary mb-2.5 flex items-center gap-1.5",children:[e.jsx(Ee,{size:16})," Tipps zur Verbesserung"]}),e.jsx("ul",{className:"m-0 pl-5",children:$.actionable_tips.map((l,y)=>e.jsx("li",{className:"text-[13px] text-slate-600 mb-1.5 leading-snug",children:l},y))})]})]})}),H&&t?.summary_feedback&&e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-2.5",children:"Zusammenfassung"}),e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed m-0",children:t.summary_feedback})]})}),K&&k&&e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:[k.summary&&e.jsxs(q,{className:"mb-5 p-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-2.5",children:"Zusammenfassung"}),e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed m-0",children:k.summary})]}),k.scores&&e.jsxs(q,{className:"mb-5 p-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Bewertung"}),e.jsx("div",{className:"grid grid-cols-2 gap-2.5",children:Object.entries(k.scores).map(([l,y])=>{const T=y!=null?y*10:null;return e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg text-center",children:[e.jsx("div",{className:"text-xl font-bold",style:{color:J(T)},children:T!=null?Math.round(T):"-"}),e.jsx("div",{className:"text-[11px] text-slate-500 capitalize",children:l})]},l)})})]}),k.key_takeaways?.length>0&&e.jsxs("div",{className:"bg-green-50 rounded-2xl p-5",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-600 mb-2.5 flex items-center gap-1.5",children:[e.jsx(Ee,{size:16})," Wichtigste Erkenntnisse"]}),e.jsx("ul",{className:"m-0 pl-5 text-[13px] text-slate-900 leading-snug",children:k.key_takeaways.map((l,y)=>e.jsx("li",{className:"mb-1.5",children:l},y))})]})]}),G&&w?.feedback&&e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[w.feedback.rating&&e.jsxs(q,{className:"mb-5 p-5",children:[e.jsxs("h4",{className:"text-[15px] font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Ne,{size:16,className:"text-primary"})," Bewertungskriterien"]}),e.jsx("div",{className:"flex flex-col gap-2.5",children:Object.entries(w.feedback.rating).filter(([l])=>l!=="overall").map(([l,y])=>{const T=y*10;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"flex-1 text-[13px] font-medium text-slate-900 capitalize",children:l.replace(/_/g," ")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 h-1.5 bg-slate-200 rounded",children:e.jsx("div",{className:"h-full rounded",style:{width:`${T}%`,backgroundColor:J(T)}})}),e.jsx("span",{className:"text-sm font-semibold min-w-[45px]",style:{color:J(T)},children:Math.round(T)})]})]},l)})})]}),w.feedback.strengths?.length>0&&e.jsxs(q,{className:"mb-5 p-5",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-600 mb-3 flex items-center gap-1.5",children:[e.jsx(Ge,{size:16})," Deine St√§rken"]}),e.jsx("ul",{className:"m-0 pl-5",children:w.feedback.strengths.map((l,y)=>e.jsx("li",{className:"text-[13px] text-slate-600 mb-2 leading-snug",children:l},y))})]}),w.feedback.improvements?.length>0&&e.jsxs(q,{className:"mb-5 p-5",children:[e.jsxs("h4",{className:"text-sm font-semibold text-amber-600 mb-3 flex items-center gap-1.5",children:[e.jsx(Ee,{size:16})," Verbesserungspotenzial"]}),e.jsx("ul",{className:"m-0 pl-5",children:w.feedback.improvements.map((l,y)=>e.jsx("li",{className:"text-[13px] text-slate-600 mb-2 leading-snug",children:l},y))})]}),w.feedback.summary&&e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-2.5",children:"Zusammenfassung"}),e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed m-0",children:w.feedback.summary})]})]}),G&&!w?.feedback&&e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6 text-center",children:[e.jsx(ye,{size:32,className:"text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-500 m-0",children:"Keine Analyse verf√ºgbar f√ºr dieses Gespr√§ch."})]})]})]})}),e.jsx(Us,{isOpen:A,onClose:()=>d(!1),onConfirm:ee,isDeleting:C})]})},Ce=({title:t,onSave:a,className:n="",inputClassName:u="",placeholder:m="Titel eingeben..."})=>{const[i,p]=o.useState(!1),[x,j]=o.useState(t||""),[N,r]=o.useState(!1),S=o.useRef(null);o.useEffect(()=>{i&&S.current&&(S.current.focus(),S.current.select())},[i]),o.useEffect(()=>{i||j(t||"")},[t,i]);const E=d=>{d.stopPropagation(),p(!0)},v=d=>{d.stopPropagation(),j(t||""),p(!1)},I=async d=>{d.stopPropagation();const C=x.trim();if(!C||C===t){p(!1),j(t||"");return}r(!0);try{await a(C),p(!1)}catch(F){console.error("Error saving title:",F)}finally{r(!1)}},L=d=>{d.key==="Enter"?I(d):d.key==="Escape"&&v(d)},A=d=>{d.stopPropagation()};return i?e.jsxs("div",{className:"flex items-center gap-2",onClick:d=>d.stopPropagation(),children:[e.jsx("input",{ref:S,type:"text",value:x,onChange:d=>j(d.target.value),onKeyDown:L,onClick:A,placeholder:m,disabled:N,className:`flex-1 px-2 py-1 rounded-lg border border-slate-300 text-sm font-semibold text-slate-900 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary ${u}`,style:{minWidth:"150px"}}),e.jsx("button",{onClick:I,disabled:N,className:"p-1.5 rounded-lg border-none bg-green-500 text-white cursor-pointer flex items-center justify-center hover:bg-green-600 transition-colors disabled:opacity-50",title:"Speichern",children:N?e.jsx(W,{size:14,className:"animate-spin"}):e.jsx(as,{size:14})}),e.jsx("button",{onClick:v,disabled:N,className:"p-1.5 rounded-lg border-none bg-slate-200 text-slate-600 cursor-pointer flex items-center justify-center hover:bg-slate-300 transition-colors disabled:opacity-50",title:"Abbrechen",children:e.jsx(ns,{size:14})})]}):e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx("span",{className:n,children:t||m}),e.jsx("button",{onClick:E,className:"p-1 rounded-md border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center opacity-0 group-hover:opacity-100 hover:text-slate-600 hover:bg-slate-100 transition-all",title:"Umbenennen",children:e.jsx(is,{size:14})})]})},Vs=({briefing:t,onClick:a,onDelete:n,onRename:u,headerGradient:m,headerText:i,primaryAccent:p})=>{const[x,j]=o.useState(!1),[N,r]=o.useState(!1),[S,E]=o.useState(t.title),v=Ae(900),I=Ds(t.template_icon),L=async C=>{u&&(await u(t.id,C),E(C))},A=C=>{C.stopPropagation(),r(!0)},d=async()=>{j(!0);try{await n(t.id),r(!1)}catch(C){console.error("Error deleting briefing:",C)}finally{j(!1)}};return v?e.jsxs(M.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileTap:{scale:.98},children:[e.jsxs("div",{onClick:a,className:"bg-white rounded-2xl p-4 cursor-pointer border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(I,{className:"w-[22px] h-[22px] text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[u?e.jsx(Ce,{title:S||"Briefing",onSave:L,className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",placeholder:"Briefing"}):e.jsx("h3",{className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",children:S||"Briefing"}),e.jsx("div",{className:"text-[13px] text-slate-500",children:me(t.created_at)})]}),e.jsx("button",{onClick:A,disabled:x,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center shrink-0 hover:text-slate-600",title:"L√∂schen",children:x?e.jsx(W,{size:18,className:"animate-spin"}):e.jsx(Y,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-3 border-t border-slate-100",children:[e.jsx("span",{className:"bg-primary/10 text-primary px-2.5 py-1 rounded-[10px] text-xs font-medium max-w-[70%] overflow-hidden text-ellipsis whitespace-nowrap",children:t.template_title}),e.jsx(xe,{size:22,className:"text-slate-400 shrink-0"})]})]}),e.jsx(he,{isOpen:N,onClose:()=>r(!1),onConfirm:d,title:"Briefing l√∂schen",description:"M√∂chtest du dieses Briefing wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:x})]}):e.jsxs(M.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("div",{onClick:a,className:"bg-white rounded-2xl p-5 cursor-pointer border border-slate-200 shadow-sm hover:shadow-lg hover:border-slate-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(I,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[u?e.jsx(Ce,{title:S||"Briefing",onSave:L,className:"text-base font-semibold text-slate-900 mb-1 whitespace-nowrap overflow-hidden text-ellipsis",placeholder:"Briefing"}):e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1 whitespace-nowrap overflow-hidden text-ellipsis",children:S||"Briefing"}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap text-[13px] text-slate-500",children:[e.jsx("span",{className:"bg-primary/10 text-primary px-2 py-0.5 rounded-[10px] text-xs font-medium",children:t.template_title}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_e,{size:14}),me(t.created_at)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("button",{onClick:A,disabled:x,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center hover:text-red-500 transition-colors",title:"L√∂schen",children:x?e.jsx(W,{size:18,className:"animate-spin"}):e.jsx(Y,{size:18})}),e.jsx(xe,{size:20,className:"text-slate-400"})]})]})}),e.jsx(he,{isOpen:N,onClose:()=>r(!1),onConfirm:d,title:"Briefing l√∂schen",description:"M√∂chtest du dieses Briefing wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:x})]})},ne={SIMULATOR:"simulator",ROLEPLAY:"roleplay",VIDEO:"video"},Ks=({session:t,type:a,scenario:n,onClick:u,onContinueSession:m,onDeleteSession:i,onRename:p,headerGradient:x,headerText:j,primaryAccent:N})=>{const[r,S]=o.useState(!1),[E,v]=o.useState(!1),I=Ae(900),L=()=>t.custom_title||n?.title||t.scenario_title||`Session #${t.id}`,[A,d]=o.useState(L());o.useEffect(()=>{d(L())},[t.custom_title,n?.title,t.scenario_title,t.id]);const C=async k=>{if(p){d(k);try{await p(t,a,k)}catch(_){throw d(L()),_}}},F=()=>{let k=null;if(a===ne.SIMULATOR)k=t.overall_score||t.average_score;else if(a===ne.VIDEO)k=t.overall_score;else if(t.feedback_json)try{let _=t.feedback_json;if(typeof _=="string"){let $=_.trim();$.startsWith("```json")?$=$.replace(/```json\s*/g,"").replace(/```\s*$/g,""):$.startsWith("```")&&($=$.replace(/```\s*/g,"").replace(/```\s*$/g,"")),_=JSON.parse($)}k=_.rating?.overall||null}catch{k=null}return k==null||isNaN(k)||k===0?null:k},O=()=>a===ne.SIMULATOR||a===ne.VIDEO?t.status:t.feedback_json?"completed":"pending",f=F(),ie=O()==="completed",se=t.total_questions>0&&(t.completed_questions||0)<t.total_questions,V=a===ne.SIMULATOR&&se,H=()=>{if(!V)return null;const k=t.completed_questions||0,_=t.total_questions||0;return`${k}/${_} Fragen`},K=k=>{k.stopPropagation(),m&&m(t,n)},G=k=>{k.stopPropagation(),v(!0)},ue=async()=>{S(!0);try{await i(t,a),v(!1)}catch(k){console.error("Error deleting session:",k)}finally{S(!1)}},ee=(()=>{if(f==null||isNaN(f))return null;if(a===ne.SIMULATOR||a===ne.ROLEPLAY){const k=f<=10?f*10:f;return isNaN(k)?null:k}return isNaN(f)?null:f})(),pe=k=>{if(!k&&k!==0)return{background:B.slate[100],color:B.slate[500]};const _=parseFloat(k);return _>=80?{background:B.green[100],color:B.green[800]}:_>=60?{background:B.amber[100],color:B.amber[800]}:{background:B.red[100],color:B.red[800]}},ge=(()=>{switch(a){case ne.SIMULATOR:return We;case ne.VIDEO:return Re;default:return we}})();return I?e.jsxs(M.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileTap:{scale:.98},children:[e.jsxs("div",{onClick:u,className:"bg-white rounded-2xl p-4 cursor-pointer border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center shrink-0",style:{background:x},children:e.jsx(ge,{className:"w-[22px] h-[22px]",style:{color:j}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[p?e.jsx(Ce,{title:A,onSave:C,className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3]"}):e.jsx("h3",{className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3]",children:A}),e.jsx("div",{className:"text-[13px] text-slate-500",children:me(t.created_at)})]}),i&&e.jsx("button",{onClick:G,disabled:r,className:"p-3 rounded-xl border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center shrink-0 hover:text-slate-600 hover:bg-slate-100 transition-colors min-w-[44px] min-h-[44px]",title:"L√∂schen",children:r?e.jsx(W,{size:18,className:"animate-spin"}):e.jsx(Y,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[!ie&&!V&&e.jsxs("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-medium",children:[e.jsx(Ie,{size:12}),"In Bearbeitung"]}),e.jsxs("span",{className:"flex items-center gap-1 px-2.5 py-1.5 rounded-full text-[13px] font-semibold",style:pe(ee),children:[e.jsx(Ne,{size:13}),ee!==null?`${Math.round(ee)}%`:"-- %"]}),(t.duration||t.video_duration_seconds)&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(Ie,{size:12}),ve(t.duration||t.video_duration_seconds)]}),V&&e.jsx("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full bg-blue-100 text-blue-800 text-xs font-medium",children:H()})]}),V&&m?e.jsxs("button",{onClick:K,className:"flex items-center gap-1.5 px-4 py-2.5 rounded-[10px] border-none bg-primary text-white text-[13px] font-semibold cursor-pointer shadow-md hover:shadow-lg transition-shadow shrink-0",children:[e.jsx(Oe,{size:14}),"Fortsetzen"]}):e.jsx(xe,{size:22,className:"text-slate-400 shrink-0"})]})]}),e.jsx(he,{isOpen:E,onClose:()=>v(!1),onConfirm:ue,title:"Session l√∂schen",description:"M√∂chtest du diese Session wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:r})]}):e.jsxs(M.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("div",{onClick:u,className:"bg-white rounded-2xl p-5 cursor-pointer border border-slate-200 shadow-sm hover:shadow-lg hover:border-slate-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shrink-0",style:{background:x},children:e.jsx(ge,{className:"w-6 h-6",style:{color:j}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[p?e.jsx(Ce,{title:A,onSave:C,className:"text-base font-semibold text-slate-900 mb-1 whitespace-nowrap overflow-hidden text-ellipsis"}):e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1 whitespace-nowrap overflow-hidden text-ellipsis",children:A}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap text-[13px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_e,{size:14}),me(t.created_at)]}),t.duration||t.video_duration_seconds?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ie,{size:14}),ve(t.duration||t.video_duration_seconds)]}):null]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[V&&m&&e.jsxs("button",{onClick:K,className:"flex items-center gap-1.5 px-3.5 py-2 rounded-[10px] border-none bg-primary text-white text-[13px] font-semibold cursor-pointer shadow-md hover:scale-105 hover:shadow-lg transition-all",children:[e.jsx(Oe,{size:14}),"Fortsetzen"]}),V&&e.jsx("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full bg-blue-100 text-blue-800 text-xs font-medium",children:H()}),!ie&&!V&&e.jsxs("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-medium",children:[e.jsx(Ie,{size:12}),"In Bearbeitung"]}),e.jsxs("span",{className:"flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-semibold",style:pe(ee),children:[e.jsx(Ne,{size:14}),ee!==null?`${Math.round(ee)}%`:"-- %"]}),i&&e.jsx("button",{onClick:G,disabled:r,className:"p-3 rounded-xl border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center hover:text-red-500 hover:bg-red-50 transition-colors min-w-[44px] min-h-[44px]",title:"L√∂schen",children:r?e.jsx(W,{size:18,className:"animate-spin"}):e.jsx(Y,{size:18})}),e.jsx(xe,{size:20,className:"text-slate-400"})]})]})}),e.jsx(he,{isOpen:E,onClose:()=>v(!1),onConfirm:ue,title:"Session l√∂schen",description:"M√∂chtest du diese Session wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:r})]})},Nt=({proScore:t,contraScore:a})=>{const n=t+a,u=n>0?Math.round(t/n*100):50;return e.jsxs("div",{className:"h-1.5 rounded-[3px] overflow-hidden flex bg-slate-100 w-full max-w-[120px]",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-full",style:{width:`${u}%`}}),e.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 h-full",style:{width:`${100-u}%`}})]})},qs=({decision:t,onClick:a,onDelete:n,onRename:u,headerGradient:m,headerText:i,primaryAccent:p})=>{const[x,j]=o.useState(!1),[N,r]=o.useState(!1),[S,E]=o.useState(t.topic),v=Ae(900),I=async f=>{u&&(await u(t.id,f),E(f))},L=(t.pros||[]).reduce((f,w)=>f+(w.text?.trim()?w.weight||5:0),0),A=(t.cons||[]).reduce((f,w)=>f+(w.text?.trim()?w.weight||5:0),0),d=(t.pros||[]).filter(f=>f.text?.trim()).length,C=(t.cons||[]).filter(f=>f.text?.trim()).length,F=f=>{f.stopPropagation(),r(!0)},O=async()=>{j(!0);try{await n(t.id),r(!1)}catch(f){console.error("Error deleting decision:",f)}finally{j(!1)}};return v?e.jsxs(M.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileTap:{scale:.98},children:[e.jsxs("div",{onClick:a,className:"bg-white rounded-2xl p-4 cursor-pointer border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-purple-500/10 flex items-center justify-center shrink-0",children:e.jsx(Fe,{className:"w-[22px] h-[22px] text-purple-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[u?e.jsx(Ce,{title:S||"Entscheidung",onSave:I,className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",placeholder:"Entscheidung"}):e.jsx("h3",{className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",children:S||"Entscheidung"}),e.jsx("div",{className:"text-[13px] text-slate-500",children:me(t.created_at)})]}),e.jsx("button",{onClick:F,disabled:x,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center shrink-0 hover:text-slate-600",title:"L√∂schen",children:x?e.jsx(W,{size:18,className:"animate-spin"}):e.jsx(Y,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(gt,{size:14,className:"text-green-600"}),e.jsx("span",{className:"text-[13px] font-medium text-green-600",children:d})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ft,{size:14,className:"text-red-600"}),e.jsx("span",{className:"text-[13px] font-medium text-red-600",children:C})]}),e.jsx(Nt,{proScore:L,contraScore:A})]}),e.jsx(xe,{size:22,className:"text-slate-400 shrink-0"})]})]}),e.jsx(he,{isOpen:N,onClose:()=>r(!1),onConfirm:O,title:"Entscheidung l√∂schen",description:"M√∂chtest du diese Entscheidung wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:x})]}):e.jsxs(M.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("div",{onClick:a,className:"bg-white rounded-2xl p-5 cursor-pointer border border-slate-200 shadow-sm hover:shadow-lg hover:border-slate-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/10 flex items-center justify-center shrink-0",children:e.jsx(Fe,{className:"w-6 h-6 text-purple-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[u?e.jsx(Ce,{title:S||"Entscheidung",onSave:I,className:"text-base font-semibold text-slate-900 mb-1.5 whitespace-nowrap overflow-hidden text-ellipsis",placeholder:"Entscheidung"}):e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1.5 whitespace-nowrap overflow-hidden text-ellipsis",children:S||"Entscheidung"}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap text-[13px] text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(gt,{size:14,className:"text-green-600"}),e.jsxs("span",{className:"font-medium text-green-600",children:[d," Pro"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ft,{size:14,className:"text-red-600"}),e.jsxs("span",{className:"font-medium text-red-600",children:[C," Contra"]})]})]}),e.jsx(Nt,{proScore:L,contraScore:A}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_e,{size:14}),me(t.created_at)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("button",{onClick:F,disabled:x,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center hover:text-red-500 transition-colors",title:"L√∂schen",children:x?e.jsx(W,{size:18,className:"animate-spin"}):e.jsx(Y,{size:18})}),e.jsx(xe,{size:20,className:"text-slate-400"})]})]})}),e.jsx(he,{isOpen:N,onClose:()=>r(!1),onConfirm:O,title:"Entscheidung l√∂schen",description:"M√∂chtest du diese Entscheidung wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:x})]})},Hs={love:{icon:cs,color:U.love.color,label:"Liebe"},talent:{icon:Ne,color:U.talent.color,label:"Talent"},need:{icon:ls,color:U.need.color,label:"Welt"},market:{icon:rs,color:U.market.color,label:"Markt"}},vt=({dimensions:t})=>e.jsx("div",{className:"flex gap-1.5 flex-wrap",children:Object.entries(Hs).map(([a,n])=>{const u=t?.[a]||[],m=u.length>0,i=n.icon;return e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-xl text-xs font-medium",style:{backgroundColor:m?`${n.color}15`:B.slate[100],color:m?n.color:B.slate[400],border:m?`1px solid ${n.color}30`:`1px solid ${B.slate[200]}`},children:[e.jsx(i,{size:12}),e.jsx("span",{children:u.length})]},a)})}),Ys=({ikigai:t,onDelete:a,onNavigate:n,headerGradient:u,headerText:m,primaryAccent:i})=>{const[p,x]=o.useState(!1),[j,N]=o.useState(!1),r=Ae(900),S={love:t.love_tags||[],talent:t.talent_tags||[],need:t.need_tags||[],market:t.market_tags||[]},E=Object.values(S).filter(d=>d.length>0).length,v=t.status==="completed",I=t.paths?.[0]?.role_title||(v?"Ikigai-Analyse abgeschlossen":"Ikigai-Analyse"),L=d=>{d.stopPropagation(),N(!0)},A=async()=>{x(!0);try{await a(t.id),N(!1)}catch(d){console.error("Error deleting ikigai:",d)}finally{x(!1)}};return r?e.jsxs(M.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileTap:{scale:.98},children:[e.jsxs("div",{onClick:n,className:"bg-white rounded-2xl p-4 cursor-pointer border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center shrink-0",style:{background:v?`linear-gradient(135deg, ${U.love.color}, ${U.talent.color}, ${U.need.color}, ${U.market.color})`:`linear-gradient(135deg, ${B.indigo[500]}15, ${B.indigo[500]}30)`},children:e.jsx(Te,{className:`w-[22px] h-[22px] ${v?"text-white":"text-indigo-500"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",children:I}),e.jsx("div",{className:"text-[13px] text-slate-500",children:me(t.created_at)})]}),e.jsx("button",{onClick:L,disabled:p,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center shrink-0 hover:text-slate-600",title:"L√∂schen",children:p?e.jsx(W,{size:18,className:"animate-spin"}):e.jsx(Y,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 pt-3 border-t border-slate-100",children:[e.jsx(vt,{dimensions:S}),e.jsx(xe,{size:22,className:"text-slate-400 shrink-0"})]})]}),e.jsx(he,{isOpen:j,onClose:()=>N(!1),onConfirm:A,title:"Ikigai-Analyse l√∂schen",description:"M√∂chtest du diese Ikigai-Analyse wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:p})]}):e.jsxs(M.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("div",{onClick:n,className:"bg-white rounded-2xl p-5 cursor-pointer border border-slate-200 shadow-sm hover:shadow-lg hover:border-slate-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shrink-0",style:{background:v?`linear-gradient(135deg, ${U.love.color}, ${U.talent.color}, ${U.need.color}, ${U.market.color})`:`linear-gradient(135deg, ${B.indigo[500]}15, ${B.indigo[500]}30)`},children:e.jsx(Te,{className:`w-6 h-6 ${v?"text-white":"text-indigo-500"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900 whitespace-nowrap overflow-hidden text-ellipsis",children:I}),v&&e.jsx("span",{className:"px-2 py-0.5 rounded-[10px] text-[11px] font-semibold bg-gradient-to-r from-green-500 to-green-600 text-white",children:"Abgeschlossen"}),!v&&E>0&&e.jsxs("span",{className:"px-2 py-0.5 rounded-[10px] text-[11px] font-semibold bg-amber-500/10 text-amber-500",children:[E,"/4 Dimensionen"]})]}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap text-[13px] text-slate-500",children:[e.jsx(vt,{dimensions:S}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_e,{size:14}),me(t.created_at)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("button",{onClick:L,disabled:p,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center hover:text-red-500 transition-colors",title:"L√∂schen",children:p?e.jsx(W,{size:18,className:"animate-spin"}):e.jsx(Y,{size:18})}),e.jsx(xe,{size:20,className:"text-slate-400"})]})]})}),e.jsx(he,{isOpen:j,onClose:()=>N(!1),onConfirm:A,title:"Ikigai-Analyse l√∂schen",description:"M√∂chtest du diese Ikigai-Analyse wirklich l√∂schen? Diese Aktion kann nicht r√ºckg√§ngig gemacht werden.",isDeleting:p})]})},Xs=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",Js=t=>t>=90?"Ausgezeichnet!":t>=80?"Sehr gut!":t>=70?"Gut!":t>=60?"Solide Leistung":t>=50?"Ausbauf√§hig":"In Arbeit",wt={ikigai:{label:"Ikigai-Kompass",icon:Te},decision:{label:"Entscheidungs-Board",icon:Fe},briefing:{label:"Smart Briefing",icon:tt},simulator:{label:"Szenario-Training",icon:We},video:{label:"Wirkungs-Analyse",icon:Re},roleplay:{label:"Live-Simulation",icon:we}},Zs=({score:t,size:a=80})=>{const n=Math.min(100,Math.max(0,t||0)),u=(a-10)/2,m=u*2*Math.PI,i=m-n/100*m;return e.jsxs("div",{className:"relative",style:{width:a,height:a},children:[e.jsxs("svg",{width:a,height:a,className:"-rotate-90",children:[e.jsx("circle",{cx:a/2,cy:a/2,r:u,fill:"none",stroke:"rgba(255,255,255,0.25)",strokeWidth:8}),e.jsx(M.circle,{cx:a/2,cy:a/2,r:u,fill:"none",stroke:"#fff",strokeWidth:8,strokeLinecap:"round",strokeDasharray:m,initial:{strokeDashoffset:m},animate:{strokeDashoffset:i},transition:{duration:1.2,ease:"easeOut"}})]}),e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:e.jsx(M.span,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.4},className:"font-bold text-white leading-none",style:{fontSize:a/3},children:Math.round(t)})})]})},kt=({type:t,title:a,subtitle:n,score:u,status:m,createdAt:i,duration:p,onBack:x,onDelete:j,onDownload:N,isDeleting:r=!1,isDownloading:S=!1,extraActions:E})=>{const v=Ae(768),I=wt[t]||wt.simulator,L=I.icon,A=u!=null&&u>0;return e.jsx("div",{className:"sticky top-0 z-40 bg-brand-gradient",style:{padding:v?"20px 16px":"24px 32px"},children:e.jsxs("div",{className:"max-w-[1400px] mx-auto",children:[x&&e.jsxs("button",{onClick:x,className:"flex items-center gap-1.5 bg-white/15 border-none rounded-lg px-3 py-2 cursor-pointer text-white text-[13px] mb-4 hover:bg-white/25 transition-colors",children:[e.jsx(It,{size:16}),"Zur√ºck zur √úbersicht"]}),e.jsxs("div",{className:"flex items-center gap-6",children:[!v&&A&&e.jsx(Zs,{score:u,size:80}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap mb-2",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-[11px] font-semibold uppercase tracking-wider px-2.5 py-1 rounded-full bg-white/20 text-white",children:[e.jsx(L,{size:14}),I.label]}),A&&e.jsx("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-white/90",style:{color:J(u)},children:Js(u)}),m==="in_progress"&&e.jsx("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-white/90 text-amber-600",children:"In Bearbeitung"})]}),e.jsx("h1",{className:"font-bold text-white m-0 truncate",style:{fontSize:v?"20px":"24px",marginBottom:n?"4px":"8px"},children:a}),n&&e.jsx("p",{className:"text-sm text-white/80 m-0 mb-2",children:n}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[i&&e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(_e,{size:14}),Xs(i)]}),p&&e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(Ie,{size:14}),Math.floor(p/60),":",String(p%60).padStart(2,"0")," Min."]})]})]}),e.jsxs("div",{className:"flex gap-3 flex-shrink-0",children:[N&&e.jsxs("button",{onClick:N,disabled:S,title:"Als PDF herunterladen",className:"flex items-center justify-center gap-1.5 bg-white/15 border-none rounded-lg text-white text-[13px] font-medium hover:bg-white/25 transition-colors disabled:opacity-70",style:{padding:v?"10px":"10px 16px",cursor:S?"wait":"pointer"},children:[e.jsx(Dt,{size:16}),!v&&"PDF"]}),E,j&&e.jsxs("button",{onClick:j,disabled:r,title:"L√∂schen",className:"flex items-center justify-center gap-1.5 bg-red-500/20 border border-red-500/40 rounded-lg text-white text-[13px] font-medium hover:bg-red-500/30 transition-colors disabled:opacity-70",style:{padding:v?"10px":"10px 16px",cursor:r?"wait":"pointer"},children:[e.jsx(Y,{size:16}),!v&&"L√∂schen"]})]})]})]})})},St={love:{key:"love",label:"Liebe",icon:"‚ù§Ô∏è",color:U.love.color,question:"Vergiss mal Geld und Karriere. Bei welchen T√§tigkeiten vergisst du die Zeit?",placeholder:"Erz√§hle mir, was du wirklich liebst zu tun...",description:"Was du liebst"},talent:{key:"talent",label:"Talent",icon:"‚≠ê",color:U.talent.color,question:"Worin bist du richtig gut? Was f√§llt dir leicht, w√§hrend andere damit k√§mpfen?",placeholder:"Beschreibe deine St√§rken und F√§higkeiten...",description:"Worin du gut bist"},need:{key:"need",label:"Welt",icon:"üåç",color:U.need.color,question:"Welche Probleme der Welt w√ºrdest du gerne l√∂sen? Wo siehst du Bedarf?",placeholder:"Welchen Beitrag m√∂chtest du leisten...",description:"Was die Welt braucht"},market:{key:"market",label:"Markt",icon:"üí∞",color:U.market.color,question:"Wof√ºr werden Menschen in deinem Bereich bezahlt? Was ist gefragt?",placeholder:"Welche Berufe oder M√§rkte interessieren dich...",description:"Wof√ºr du bezahlt wirst"}},c={SIMULATOR:"simulator",ROLEPLAY:"roleplay",VIDEO:"video",BRIEFINGS:"briefings",DECISIONS:"decisions",IKIGAI:"ikigai"},Qe=[{id:c.BRIEFINGS,label:"Smart Briefings",icon:tt},{id:c.DECISIONS,label:"Entscheidungs-Kompass",icon:Fe},{id:c.IKIGAI,label:"Ikigai-Kompass",icon:Te},{id:c.SIMULATOR,label:"Szenario-Training",icon:We},{id:c.VIDEO,label:"Wirkungs-Analyse",icon:Re},{id:c.ROLEPLAY,label:"Live-Simulationen",icon:we}],ya=c,Na=({onBack:t,onSelectSession:a,isAuthenticated:n,onLoginClick:u,onContinueSession:m,onRepeatSession:i,initialTab:p,onNavigateToModule:x})=>{const{branding:j,demoCode:N}=xs(),[r,S]=o.useState(p||c.BRIEFINGS);o.useEffect(()=>{p&&S(p)},[p]);const[E,v]=o.useState(null),[I,L]=o.useState(null);o.useEffect(()=>{window.scrollTo(0,0)},[r,E]);const[A,d]=o.useState([]),[C,F]=o.useState([]),[O,f]=o.useState([]),[w,ie]=o.useState([]),[se,V]=o.useState([]),[H,K]=o.useState([]),[G,ue]=o.useState([]),[ke,ee]=o.useState([]),[pe,Me]=o.useState([]),[ge,k]=o.useState(null),[_,$]=o.useState(null),[$e,re]=o.useState(null),[l,y]=o.useState(null),[T,le]=o.useState({love:{input:"",tags:[]},talent:{input:"",tags:[]},need:{input:"",tags:[]},market:{input:"",tags:[]}}),[ze,fe]=o.useState(null),[Ve,Le]=o.useState(!1),[Z,ce]=o.useState(!0),[st,at]=o.useState(null);o.useEffect(()=>{n?Be():ce(!1)},[n]);const Be=async()=>{ce(!0),at(null);try{const s=De(),h=N?`&demo_code=${encodeURIComponent(N)}`:"",[g,b,D,R,Q,ae,be,Zt,Qt]=await Promise.all([ks({limit:50,...N&&{demo_code:N}}).catch(()=>({data:[]})),fetch(`${s}/simulator/sessions?limit=50${h}`,{headers:{"X-WP-Nonce":de()}}).then(z=>z.json()).catch(()=>({data:[]})),fetch(`${s}/video-training/sessions?limit=50${h}`,{headers:{"X-WP-Nonce":de()}}).then(z=>z.json()).catch(()=>({data:[]})),P.request(`/smartbriefing/briefings?limit=50${N?`&demo_code=${encodeURIComponent(N)}`:""}`,{method:"GET"}).catch(()=>({success:!1,data:{briefings:[]}})),P.getDecisions().catch(()=>({success:!1,data:{decisions:[]}})),P.getIkigais().catch(()=>({success:!1,data:{ikigais:[]}})),Ss().catch(()=>[]),fetch(`${s}/simulator/scenarios`,{headers:{"X-WP-Nonce":de()}}).then(z=>z.json()).catch(()=>({data:[]})),fetch(`${s}/video-training/scenarios`,{headers:{"X-WP-Nonce":de()}}).then(z=>z.json()).catch(()=>({data:[]}))]),Ye=(z,je="sessions")=>{let te=[];Array.isArray(z?.data)?te=z.data:Array.isArray(z?.data?.[je])?te=z.data[je]:Array.isArray(z?.[je])?te=z[je]:Array.isArray(z)&&(te=z);const Se=new Set,oe=te.filter(Pe=>Pe?.id?Se.has(Pe.id)?(console.warn("[SessionHistory] Duplicate session ID found:",Pe.id),!1):(Se.add(Pe.id),!0):!0);return oe.length!==te.length&&console.warn("[SessionHistory] Removed",te.length-oe.length,"duplicate sessions"),oe},Xe=z=>Array.isArray(z?.data?.scenarios)?z.data.scenarios:Array.isArray(z?.data)?z.data:Array.isArray(z)?z:[],Je=(z,je)=>{if(!Array.isArray(z))return[];const te=new Set,Se=z.filter(oe=>oe?.id?te.has(oe.id)?(console.warn(`[SessionHistory] Duplicate ${je} ID found:`,oe.id),!1):(te.add(oe.id),!0):!0);return Se.length!==z.length&&console.warn(`[SessionHistory] Removed ${z.length-Se.length} duplicate ${je}`),Se};d(Ye(g)),F(Ye(b)),f(Ye(D)),ie(Je(R?.data?.briefings||[],"briefing")),V(Je(Q?.data?.decisions||[],"decision")),K(Je(ae?.data?.ikigais||[],"ikigai")),ue(Xe(be)),ee(Xe(Zt)),Me(Xe(Qt))}catch(s){console.error("Failed to load sessions:",s),at(s.message||"Fehler beim Laden der Daten")}finally{ce(!1)}},nt=o.useMemo(()=>{const s={};return G.forEach(h=>{s[h.id]=h}),s},[G]),it=o.useMemo(()=>{const s={};return ke.forEach(h=>{s[h.id]=h}),s},[ke]),rt=o.useMemo(()=>{const s={};return pe.forEach(h=>{s[h.id]=h}),s},[pe]),Ft=()=>{switch(r){case c.SIMULATOR:return C;case c.VIDEO:return O;case c.BRIEFINGS:return w;case c.DECISIONS:return se;case c.IKIGAI:return H;default:return A}},Tt=()=>{switch(r){case c.SIMULATOR:return it;case c.VIDEO:return rt;default:return nt}},lt=A.length+C.length+O.length+w.length+se.length,ct=async s=>{(await P.request(`/smartbriefing/briefings/${s}`,{method:"DELETE"})).success&&ie(g=>g.filter(b=>b.id!==s))},Rt=async(s,h)=>{const g=await P.updateBriefing(s.id,{title:h});return ie(b=>b.map(D=>D.id===s.id?{...D,title:h}:D)),g},Mt=s=>{k(s)},$t=()=>{k(null)},ot=async s=>{(await P.deleteDecision(s)).success&&V(g=>g.filter(b=>b.id!==s))},Bt=async(s,h)=>{const g=await P.updateDecision(s.id,{topic:h});return V(b=>b.map(D=>D.id===s.id?{...D,topic:h}:D)),g},dt=async s=>{await P.deleteIkigai(s)&&K(g=>g.filter(b=>b.id!==s))},Pt=s=>{$(s)},xt=()=>{$(null),re(null)},Ut=s=>{y(s),le({love:{input:s.love_input||"",tags:s.love_tags||[]},talent:{input:s.talent_input||"",tags:s.talent_tags||[]},need:{input:s.need_input||"",tags:s.need_tags||[]},market:{input:s.market_input||"",tags:s.market_tags||[]}}),s.status==="completed"&&s.paths?fe({summary:s.summary,paths:s.paths}):fe(null)},Ke=()=>{y(null),le({love:{input:"",tags:[]},talent:{input:"",tags:[]},need:{input:"",tags:[]},market:{input:"",tags:[]}}),fe(null)},Gt=async(s,h,g)=>{if(le(b=>({...b,[s]:{input:h,tags:g}})),l?.id)try{await P.updateIkigai(l.id,{[`${s}_input`]:h,[`${s}_tags`]:g})}catch(b){console.error("[Ikigai] Failed to save dimension:",b)}},Wt=async(s,h)=>{try{return(await P.extractIkigaiKeywords(s,h))?.keywords||[]}catch(g){return console.error("[Ikigai] Failed to extract keywords:",g),[]}},Vt=(s,h)=>{le(g=>{const b=g[s].tags.filter(D=>D!==h);return{...g,[s]:{...g[s],tags:b}}})},Kt=async()=>{if(Object.values(T).every(h=>h.tags&&h.tags.length>0)){Le(!0);try{const h=await P.synthesizeIkigaiPaths({love_tags:T.love.tags,talent_tags:T.talent.tags,need_tags:T.need.tags,market_tags:T.market.tags});h&&(fe(h),l?.id&&(await P.updateIkigai(l.id,{summary:h.summary,paths:h.paths,status:"completed"}),K(g=>g.map(b=>b.id===l.id?{...b,summary:h.summary,paths:h.paths,status:"completed"}:b))))}catch(h){console.error("[Ikigai] Failed to synthesize paths:",h)}finally{Le(!1)}}},qt=Object.values(T).every(s=>s.tags&&s.tags.length>0),Ht=s=>{V(h=>h.map(g=>g.id===s.id?s:g)),$(s)},Yt=s=>{v(s),L(r)},qe=()=>{v(null),L(null)},He=async(s,h)=>{const g=De();try{let b,D;switch(h){case c.SIMULATOR:b=`${g}/simulator/sessions/${s.id}`,D=()=>F(ae=>ae.filter(be=>be.id!==s.id));break;case c.ROLEPLAY:b=`${g}/roleplays/sessions/${s.id}`,D=()=>d(ae=>ae.filter(be=>be.id!==s.id));break;case c.VIDEO:b=`${g}/video-training/sessions/${s.id}`,D=()=>f(ae=>ae.filter(be=>be.id!==s.id));break;default:throw new Error("Unknown session type")}const Q=await(await fetch(b,{method:"DELETE",headers:{"X-WP-Nonce":de()}})).json();if(Q.success)D(),E&&qe();else throw new Error(Q.message||"Delete failed")}catch(b){throw console.error("Failed to delete session:",b),b}},Xt=async(s,h,g)=>{try{let b;switch(h){case c.SIMULATOR:await P.updateSimulatorSession(s.id,{custom_title:g}),b=D=>D.map(R=>R.id===s.id?{...R,custom_title:g}:R),F(b);break;case c.ROLEPLAY:await P.updateSession(s.id,{custom_title:g}),b=D=>D.map(R=>R.id===s.id?{...R,custom_title:g}:R),d(b);break;case c.VIDEO:await P.updateVideoTraining(s.id,{custom_title:g}),b=D=>D.map(R=>R.id===s.id?{...R,custom_title:g}:R),f(b);break;default:throw new Error("Unknown session type")}}catch(b){throw console.error("Failed to rename session:",b),b}},mt=(s,h)=>(h===c.SIMULATOR?it:h===c.VIDEO?rt:nt)[s?.scenario_id];if(ge)return e.jsx(Es,{briefing:ge,onBack:$t,onDelete:ct});if(_){const s={topic:_.topic||"",context:_.context||"",pros:_.pros||[],cons:_.cons||[],proScore:_.pro_score||0,contraScore:_.contra_score||0},h=async(D,R)=>{try{const Q={topic:D.topic,context:D.context||null,pros:D.pros,cons:D.cons,pro_score:D.proScore,contra_score:D.contraScore,analysis:R,status:"completed"};await P.updateDecision(_.id,Q);const ae={..._,...Q};Ht(ae),re({data:D,result:R})}catch(Q){console.error("[SessionHistory] Failed to update decision:",Q)}},g=async D=>_.id,b=async(D,R)=>{try{await P.updateDecision(D,{topic:R.topic,context:R.context||null,pros:R.pros,cons:R.cons,pro_score:R.proScore,contra_score:R.contraScore,status:R.status||"draft"})}catch(Q){console.error("[SessionHistory] Failed to update decision:",Q)}};return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(kt,{type:"decision",title:_.topic||"Entscheidung",status:_.status,createdAt:_.created_at,onBack:xt,onDelete:()=>{window.confirm("M√∂chtest du diese Entscheidungs-Analyse wirklich l√∂schen?")&&(ot(_.id),xt())}}),e.jsx("div",{className:"p-6 max-w-[900px] mx-auto",children:$e?e.jsx(Cs,{decisionData:$e.data,analysisResult:$e.result,onStartNew:()=>{re(null),$(null)},onEditDecision:()=>{re(null)}}):e.jsx(_s,{initialData:s,onAnalysisComplete:h,isAuthenticated:n,savedDecisionId:_.id,onSaveDraft:g,onUpdateSession:b,onDecisionIdChange:()=>{}})})]})}if(l)return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(kt,{type:"ikigai",title:"Ikigai-Analyse",subtitle:l.status==="completed"?"Berufliche Orientierung":"In Bearbeitung",status:l.status,createdAt:l.created_at,onBack:Ke,onDelete:()=>{window.confirm("M√∂chtest du diese Ikigai-Analyse wirklich l√∂schen?")&&(dt(l.id),Ke())}}),e.jsx("div",{className:"p-6 max-w-[900px] mx-auto",children:ze?e.jsx(As,{dimensions:T,synthesisResult:ze,onStartNew:Ke,onEdit:()=>fe(null),DIMENSIONS:St}):e.jsx(zs,{dimensions:T,DIMENSIONS:St,onExtractKeywords:Wt,onUpdateDimension:Gt,onRemoveTag:Vt,allDimensionsFilled:qt,onSynthesize:Kt,isSynthesizing:Ve})})]});if(E){if(I===c.ROLEPLAY){const g=mt(E,I);return e.jsx(Is,{session:E,scenario:g,onBack:qe,onRepeat:()=>i?.(E,g,"roleplay"),onDelete:b=>He(b,c.ROLEPLAY)})}const h={[c.SIMULATOR]:"simulator",[c.VIDEO]:"video"}[I]||"simulator";return e.jsx(Ws,{session:E,type:I,scenario:mt(E,I),onBack:qe,onContinueSession:m,onRepeatSession:(g,b)=>i?.(g,b,h),onDeleteSession:He})}if(!n)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:e.jsx(bt,{className:"w-7 h-7 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-slate-900",children:"Meine Sessions"})]}),e.jsx("p",{className:"text-lg text-slate-500 max-w-[600px] mx-auto",children:"Hier findest du deine gespeicherten √úbungen und Fortschritte"})]}),e.jsxs(q,{className:"max-w-[500px] mx-auto mt-16 p-10 text-center rounded-2xl shadow-card",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center mx-auto mb-5",children:e.jsx(jt,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-3",children:"Anmeldung erforderlich"}),e.jsx("p",{className:"text-slate-500 mb-6 leading-relaxed",children:"Um deine gespeicherten Sessions zu sehen, musst du dich zuerst anmelden."}),e.jsx(X,{onClick:u,size:"lg",icon:e.jsx(jt,{className:"w-5 h-5"}),children:"Jetzt anmelden"})]})]});if(Z)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 mb-3",children:[e.jsx(Ue,{className:"w-12 h-12 rounded-2xl"}),e.jsx(Ue,{className:"h-10 w-48"})]}),e.jsx(Ue,{className:"h-5 w-32 mx-auto"})]}),e.jsx("div",{className:"flex justify-center gap-2 mb-8",children:[1,2,3,4,5,6].map(s=>e.jsx(Ue,{className:"h-12 w-28 rounded-xl"},s))}),e.jsx("div",{className:"space-y-3 max-w-4xl mx-auto",children:[1,2,3,4,5].map(s=>e.jsx(ds,{},s))})]});if(st)return e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-[400px] p-6",children:[e.jsx(ye,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-slate-500 mb-6",children:st}),e.jsx(X,{onClick:Be,children:"Erneut versuchen"})]})});const ht=Ft(),Jt=Tt();return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8 text-center relative",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:e.jsx(bt,{className:"w-7 h-7 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-slate-900",children:"Meine Sessions"})]}),e.jsxs("p",{className:"text-lg text-slate-500 max-w-[600px] mx-auto",children:[lt," ",lt===1?"√úbung":"√úbungen"," gespeichert"]}),e.jsx("button",{onClick:Be,disabled:Z,className:"absolute top-0 right-0 p-2.5 rounded-xl border border-slate-200 bg-white text-slate-500 shadow-sm flex items-center justify-center md:hidden disabled:opacity-50 hover:shadow-md transition-shadow",children:e.jsx(yt,{className:`w-5 h-5 ${Z?"animate-spin":""}`})})]}),e.jsx("div",{className:"hidden lg:flex flex-wrap gap-2 mx-6 mb-6 bg-slate-100 p-1.5 rounded-2xl",children:Qe.map(s=>{const h=s.icon,g=r===s.id,b=s.id===c.SIMULATOR?C.length:s.id===c.VIDEO?O.length:s.id===c.BRIEFINGS?w.length:s.id===c.DECISIONS?se.length:s.id===c.IKIGAI?H.length:A.length;return e.jsxs("button",{onClick:()=>S(s.id),className:`flex-1 min-w-fit py-3 px-4 rounded-xl border-none text-sm cursor-pointer flex items-center justify-center gap-2 transition-all ${g?"bg-white text-slate-900 font-semibold shadow-md":"bg-transparent text-slate-500 font-medium hover:bg-white/50"}`,children:[e.jsx(h,{size:18}),e.jsx("span",{children:s.label}),e.jsx("span",{className:`py-0.5 px-2 rounded-xl text-xs font-semibold min-w-[24px] text-center ${g?"bg-indigo-500 text-white":"bg-slate-200 text-slate-500"}`,children:b})]},s.id)})}),e.jsxs("div",{className:"lg:hidden mx-4 mb-4",children:[e.jsx("div",{className:"flex gap-2 justify-center mb-3",children:Qe.map(s=>{const h=s.icon,g=r===s.id,b=s.id===c.SIMULATOR?C.length:s.id===c.VIDEO?O.length:s.id===c.BRIEFINGS?w.length:s.id===c.DECISIONS?se.length:s.id===c.IKIGAI?H.length:A.length;return e.jsxs("button",{onClick:()=>S(s.id),className:`flex-1 max-w-[80px] py-3 px-2 rounded-xl border-2 cursor-pointer flex flex-col items-center justify-center gap-1 transition-all ${g?"bg-white shadow-md border-indigo-500":"bg-slate-100 border-transparent hover:bg-white/60"}`,children:[e.jsx(h,{size:20,className:g?"text-indigo-500":"text-slate-500"}),e.jsx("span",{className:`py-0.5 px-1.5 rounded-lg text-[11px] font-semibold min-w-[20px] text-center ${g?"bg-indigo-500 text-white":"bg-slate-200 text-slate-500"}`,children:b})]},s.id)})}),e.jsx("div",{className:"text-center text-[15px] font-semibold text-slate-900 py-2 px-4 bg-white rounded-xl shadow-sm",children:Qe.find(s=>s.id===r)?.label})]}),e.jsxs("div",{className:"hidden sm:flex justify-center lg:justify-end flex-wrap gap-3 mx-6 mb-6",children:[e.jsx(X,{variant:"outline",onClick:Be,disabled:Z,title:"Aktualisieren",children:e.jsx(yt,{className:`w-4 h-4 ${Z?"animate-spin":""}`})}),x&&e.jsxs(X,{onClick:()=>{const s={[c.BRIEFINGS]:"smart_briefing",[c.DECISIONS]:"decision_board",[c.IKIGAI]:"ikigai",[c.SIMULATOR]:"simulator",[c.VIDEO]:"video_training",[c.ROLEPLAY]:"dashboard"};x(s[r]||"overview")},children:[e.jsx(os,{className:"w-4 h-4 mr-2"}),r===c.BRIEFINGS?"Neues Briefing":r===c.DECISIONS?"Neue Entscheidungs-Analyse":r===c.IKIGAI?"Neue Ikigai-Analyse":r===c.SIMULATOR?"Neues Szenario-Training":r===c.VIDEO?"Neue Wirkungs-Analyse":"Neue Live-Simulation"]})]}),e.jsx("div",{className:"mx-4 sm:mx-6",children:ht.length===0?e.jsxs(q,{className:"text-center py-16 px-6 rounded-2xl shadow-card",children:[r===c.SIMULATOR&&e.jsx(We,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),r===c.ROLEPLAY&&e.jsx(we,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),r===c.VIDEO&&e.jsx(Re,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),r===c.BRIEFINGS&&e.jsx(tt,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),r===c.DECISIONS&&e.jsx(Fe,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),r===c.IKIGAI&&e.jsx(Te,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsxs("h3",{className:"text-xl font-semibold text-slate-600 mb-2",children:["Noch keine ",r===c.SIMULATOR?"Szenario-Trainings":r===c.VIDEO?"Wirkungs-Analysen":r===c.BRIEFINGS?"Smart Briefings":r===c.DECISIONS?"Entscheidungs-Analysen":r===c.IKIGAI?"Ikigai-Analysen":"Live-Simulationen"]}),e.jsx("p",{className:"text-slate-500 mb-6",children:r===c.BRIEFINGS?"Erstelle dein erstes Briefing, um dich optimal vorzubereiten.":r===c.DECISIONS?"Nutze den Entscheidungs-Kompass, um deine erste Entscheidung zu analysieren.":r===c.IKIGAI?"Entdecke deinen idealen Karrierepfad mit dem Ikigai-Kompass.":"Starte dein erstes Training, um hier deine Fortschritte zu sehen."}),e.jsxs(X,{onClick:()=>{if(x){const s={[c.BRIEFINGS]:"smart_briefing",[c.DECISIONS]:"decision_board",[c.IKIGAI]:"ikigai",[c.SIMULATOR]:"simulator",[c.VIDEO]:"video_training",[c.ROLEPLAY]:"dashboard"};x(s[r]||"overview")}else t?.()},children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),r===c.BRIEFINGS?"Briefing erstellen":r===c.DECISIONS?"Entscheidung analysieren":r===c.IKIGAI?"Ikigai entdecken":"Training starten"]})]}):e.jsx(M.div,{className:"flex flex-col gap-3",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},children:r===c.BRIEFINGS?w.map(s=>e.jsx(Vs,{briefing:s,onClick:()=>Mt(s),onDelete:ct,onRename:Rt},s.id)):r===c.DECISIONS?se.map(s=>e.jsx(qs,{decision:s,onClick:()=>Pt(s),onDelete:ot,onRename:Bt},s.id)):r===c.IKIGAI?H.map(s=>e.jsx(Ys,{ikigai:s,onDelete:dt,onNavigate:()=>Ut(s)},s.id)):ht.map(s=>{const h=Jt[s.scenario_id];return e.jsx(Ks,{session:s,type:r,scenario:h,onClick:()=>Yt(s),onContinueSession:m,onDeleteSession:He,onRename:Xt},s.id)})})})]})};export{ya as SESSION_TABS,Na as default};
