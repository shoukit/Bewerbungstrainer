import{j as s,S as F,aC as U}from"./ui-vendor-BAEfSb-X.js";import{a as t}from"./react-vendor-uDOJF2jQ.js";import{a as P,D as z}from"./DecisionBoardResult-DnLgolFW.js";import{u as _,D as L,w as p,c as T,C as u}from"./designTokens-LSOQEIoP.js";import{F as W,a as N}from"./index.js";import"./card-CRd_k1Xo.js";import"./utils-BEHD0UYf.js";import"./button-C27wFDRr.js";import"./input-B2p07toF.js";import"./textarea-AQGmZicy.js";import"./useBranding-CRmuKfX5.js";import"./AudioRecorder-LFdSK1H4.js";const c={INPUT:"input",RESULT:"result"},ne=({isAuthenticated:D,requireAuth:I,setPendingAction:O,onNavigateToHistory:i})=>{const[y,x]=t.useState(c.INPUT),[S,f]=t.useState(null),[j,d]=t.useState(null),[r,a]=t.useState(null),[G,M]=t.useState(!1),l=t.useRef(!1),{branding:C}=_(),g=C?.["--primary-accent"]||L["--primary-accent"],b=T(u.teal[500],u.teal[400]);t.useEffect(()=>{window.scrollTo(0,0)},[y]);const B=t.useCallback(async e=>{if(l.current||!e.topic?.trim())return null;try{const n={topic:e.topic,context:e.context||null,pros:e.pros||[],cons:e.cons||[],pro_score:e.proScore||0,contra_score:e.contraScore||0,status:"draft"},o=await p.createDecision(n);if(o?.id)return l.current=!0,a(o.id),console.log("[DecisionBoard] Draft session saved with ID:",o.id),o.id}catch(n){console.error("[DecisionBoard] Failed to save draft session:",n)}return null},[]),m=t.useCallback(async(e,n)=>{if(e)try{const o={topic:n.topic,context:n.context||null,pros:n.pros||[],cons:n.cons||[],pro_score:n.proScore||0,contra_score:n.contraScore||0,analysis:n.analysis||null,status:n.status||"completed"};await p.updateDecision(e,o),console.log("[DecisionBoard] Session updated:",e)}catch(o){console.error("[DecisionBoard] Failed to update session:",o)}},[]),w=t.useCallback(async e=>{if(e)try{await p.deleteDecision(e),console.log("[DecisionBoard] Session deleted:",e)}catch(n){console.error("[DecisionBoard] Failed to delete session:",n)}},[]),v=t.useCallback(async(e,n)=>{f(e),d(n),x(c.RESULT);try{if(r)await m(r,{...e,analysis:n,status:"completed"});else{const o={topic:e.topic,context:e.context||null,pros:e.pros,cons:e.cons,pro_score:e.proScore,contra_score:e.contraScore,analysis:n,status:"completed"},h=await p.createDecision(o);h?.id&&(a(h.id),l.current=!0,console.log("[DecisionBoard] Decision saved with ID:",h.id))}}catch(o){console.error("[DecisionBoard] Failed to save decision:",o)}},[r,m]),E=t.useCallback(()=>{f(null),d(null),a(null),l.current=!1,x(c.INPUT)},[]),R=t.useCallback(()=>{d(null),x(c.INPUT)},[]),k=t.useCallback(async()=>{r&&await w(r),f(null),d(null),a(null),l.current=!1,i&&i()},[r,w,i]),A=()=>{switch(y){case c.RESULT:return s.jsx(z,{decisionData:S,analysisResult:j,onStartNew:E,onEditDecision:R});case c.INPUT:default:return s.jsx(P,{initialData:S,onAnalysisComplete:v,onCancel:i?k:null,isAuthenticated:D,requireAuth:I,savedDecisionId:r,onSaveDraft:B,onUpdateSession:m,onDecisionIdChange:a})}};return s.jsxs(s.Fragment,{children:[s.jsx(W,{featureId:"decisionboard",showOnMount:!0}),s.jsxs("div",{style:{minHeight:"100%"},children:[s.jsx("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:s.jsx("div",{style:{marginBottom:"24px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"16px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:b,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(F,{style:{width:"24px",height:"24px",color:"white"}})}),s.jsxs("div",{children:[s.jsx("h1",{style:{fontSize:"28px",fontWeight:700,color:u.slate[900],margin:0},children:"Entscheidungs-Board"}),s.jsx("p",{style:{fontSize:"14px",color:u.slate[600],margin:0},children:"Strukturierte Entscheidungsfindung"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(N,{featureId:"decisionboard",size:"sm"}),D&&i&&s.jsxs("button",{onClick:i,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",borderRadius:"12px",border:`2px solid ${g}`,backgroundColor:"white",color:g,fontSize:"14px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:[s.jsx(U,{size:18}),"Meine Entscheidungen"]})]})]})})}),A()]})]})};export{ne as DecisionBoardApp,P as DecisionBoardInput,z as DecisionBoardResult};
