import{j as r,C as B}from"./ui-vendor-BAEfSb-X.js";import{a as t}from"./react-vendor-uDOJF2jQ.js";import{a as P,I as A}from"./IkigaiResults-jZsWqaCh.js";import{w as c,c as z,C as b}from"./designTokens-LSOQEIoP.js";import{F as L}from"./index.js";import{u as _,a as q,F as G}from"./useScrollToTop-D1M7Geea.js";import"./useBranding-CRmuKfX5.js";import"./useMobile-YxjH166V.js";import"./card-CRd_k1Xo.js";import"./utils-BEHD0UYf.js";import"./button-C27wFDRr.js";import"./AudioRecorder-LFdSK1H4.js";const m={love:{key:"love",label:"Leidenschaft",title:"Deine Leidenschaft",icon:"â¤ï¸",color:"#E11D48",question:"Stell dir vor, Geld spielt keine Rolle: Womit wÃ¼rdest du deinen Tag verbringen? Bei welchem Thema vergisst du vÃ¶llig die Zeit?",placeholder:"Schreib einfach drauf los: Hobbys, Themen, TÃ¤tigkeiten...",description:"Was treibt dich an?"},talent:{key:"talent",label:"StÃ¤rken",title:"Deine StÃ¤rken",icon:"â­",color:"#F59E0B",question:'WofÃ¼r bitten dich Freunde oder Kollegen oft um Rat? Was erledigst du "mit links", wÃ¤hrend andere daran verzweifeln?',placeholder:"Z.B. Organisieren, ZuhÃ¶ren, Coden, Designen...",description:"Was fÃ¤llt dir leicht?"},need:{key:"need",label:"Mission",title:"Deine Mission",icon:"ðŸŒ",color:"#10B981",question:"Welches Problem in der Gesellschaft oder Wirtschaft nervt dich? Wo wÃ¼rdest du gerne mitanpacken, um Dinge zu verbessern?",placeholder:"Z.B. Nachhaltigkeit, Bildung, bessere Software, Pflege...",description:"Welchen Beitrag leistest du?"},market:{key:"market",label:"Markt",title:"Der Markt",icon:"ðŸ’°",color:"#6366F1",question:"Welche deiner FÃ¤higkeiten sind bares Geld wert? FÃ¼r welche Jobs oder Dienstleistungen existiert ein echtes Budget?",placeholder:"Z.B. Projektmanagement, Beratung, Handwerk...",description:"WofÃ¼r wirst du bezahlt?"}};Object.values(m).map(u=>u.color);const o={COMPASS:"compass",RESULTS:"results"},se=({isAuthenticated:u,requireAuth:y,setPendingAction:N,onNavigateToHistory:v})=>{const[S,g]=t.useState(o.COMPASS),[l,f]=t.useState(null),[C,w]=t.useState(!1),F=z(b.purple[500],b.purple[400]),[i,h]=t.useState({love:{input:"",tags:[]},talent:{input:"",tags:[]},need:{input:"",tags:[]},market:{input:"",tags:[]}}),[x,p]=t.useState(null),I=t.useRef(!1);_(u,y),q({dependencies:[S]});const k=Object.values(i).every(e=>e.tags&&e.tags.length>0),d=t.useCallback(async()=>{if(l)return l;try{const e=await c.createIkigai();if(e?.id)return f(e.id),I.current=!0,console.log("[Ikigai] Session created with ID:",e.id),e.id}catch(e){console.error("[Ikigai] Failed to create session:",e)}return null},[l]),D=t.useCallback(async(e,a,s)=>{h(n=>({...n,[e]:{input:a,tags:s}}));try{const n=await d();n&&(await c.updateIkigai(n,{[`${e}_input`]:a,[`${e}_tags`]:s}),console.log(`[Ikigai] Dimension ${e} saved`))}catch(n){console.error("[Ikigai] Failed to save dimension:",n)}},[d]),R=t.useCallback(async(e,a)=>{try{const s=await c.extractIkigaiKeywords(e,a);return s?.keywords?s.keywords:[]}catch(s){return console.error("[Ikigai] Failed to extract keywords:",s),[]}},[]),M=t.useCallback(async()=>{if(k){w(!0);try{const e=await c.synthesizeIkigaiPaths({love_tags:i.love.tags,talent_tags:i.talent.tags,need_tags:i.need.tags,market_tags:i.market.tags});if(e){p(e);const a=l||await d();a&&await c.updateIkigai(a,{summary:e.summary,paths:e.paths,status:"completed"}),g(o.RESULTS)}}catch(e){console.error("[Ikigai] Failed to synthesize paths:",e)}finally{w(!1)}}},[k,i,l,d]),E=t.useCallback((e,a)=>{h(s=>{const n=s[e].tags.filter(j=>j!==a);return{...s,[e]:{...s[e],tags:n}}})},[]),O=t.useCallback(()=>{h({love:{input:"",tags:[]},talent:{input:"",tags:[]},need:{input:"",tags:[]},market:{input:"",tags:[]}}),p(null),f(null),I.current=!1,g(o.COMPASS)},[]),T=t.useCallback(()=>{p(null),g(o.COMPASS)},[]),W=()=>{switch(S){case o.RESULTS:return r.jsx(A,{dimensions:i,synthesisResult:x,onStartNew:O,onEdit:T,DIMENSIONS:m});case o.COMPASS:default:return r.jsx(P,{dimensions:i,DIMENSIONS:m,onExtractKeywords:R,onUpdateDimension:D,onRemoveTag:E,allDimensionsFilled:k,onSynthesize:M,isSynthesizing:C})}};return r.jsxs(r.Fragment,{children:[r.jsx(L,{featureId:"ikigai",showOnMount:!0}),r.jsxs("div",{style:{minHeight:"100%"},children:[r.jsx(G,{featureId:"ikigai",icon:B,title:"Ikigai-Kompass",subtitle:"Finde deine berufliche Bestimmung",gradient:F,historyLabel:"Meine Ikigai",onNavigateToHistory:v}),W()]})]})};export{se as default};
