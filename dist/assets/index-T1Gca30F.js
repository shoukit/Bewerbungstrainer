import{j as e,d as b,m as x,ab as K,ac as W,an as $,y as J,e as Q,af as X,f as Y,H as Z,h as _,l as q,a as ee,g as se}from"./ui-vendor-BPmrRjpn.js";import{a}from"./react-vendor-uDOJF2jQ.js";import{B as z}from"./select-native-DRUSZasO.js";import{w as j,k as te,q as L,C as c}from"./FeatureInfoButton-C-pllNNf.js";import"./dialog-ClMCq6FL.js";import{C as ne}from"./card-CnaoFFkT.js";import{F,u as ae}from"./useScrollToTop-Dq0GrOj9.js";import{M as ie,a as oe}from"./MicrophoneTestDialog-BMYyyjuu.js";import{a as le,D as re}from"./DecisionBoardResult-DsI6upfT.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";import"./input-Dg8SXIdV.js";import"./textarea-D_5UFHp6.js";import"./index.js";import"./AudioRecorder-B_-X6R96.js";import"./button-BoRGn9H8.js";const ce=[{icon:K,color:c.emerald[500],title:"Pro-Argumente",description:"Sammle alle Vorteile mit Gewichtung"},{icon:W,color:c.rose[500],title:"Contra-Argumente",description:"Erfasse Nachteile und Risiken"},{icon:$,color:c.violet[500],title:"KI-Analyse",description:"Objektive Auswertung deiner Argumente"},{icon:J,color:c.amber[500],title:"Coaching-Impulse",description:"Neue Perspektiven für deine Entscheidung"}],de=({onStartNew:p,onContinueSession:N,onNavigateToHistory:w,isAuthenticated:d,requireAuth:g,setPendingAction:o,selectedMicrophoneId:D,onMicrophoneChange:f,onTestMicrophone:B})=>{const[r,m]=a.useState([]),[h,E]=a.useState(!1),S=L(c.teal[500],c.teal[400]);a.useEffect(()=>{d&&y()},[d]);const y=async()=>{E(!0);try{const t=await j.getDecisions();if(t?.data?.decisions){const u=t.data.decisions.sort((C,T)=>new Date(T.created_at)-new Date(C.created_at)).slice(0,5);m(u)}}catch(t){console.error("[DecisionDashboard] Failed to load sessions:",t)}finally{E(!1)}},v=a.useCallback(()=>{if(!d){o&&o({type:"decision_start"}),g&&g(()=>{p()});return}p()},[d,g,o,p]),I=t=>new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}),k=t=>t.status==="completed"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700",children:[e.jsx(ee,{className:"w-3 h-3"}),"Abgeschlossen"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-700",children:[e.jsx(se,{className:"w-3 h-3"}),"Entwurf"]});return e.jsxs(e.Fragment,{children:[e.jsx(te,{featureId:"decisionboard",showOnMount:!0}),e.jsxs("div",{className:"min-h-full",children:[e.jsx(F,{featureId:"decisionboard",icon:b,title:"Entscheidungs-Board",subtitle:"Strukturierte Entscheidungsfindung",gradient:S,historyLabel:"Meine Entscheidungen",onNavigateToHistory:w,showHistoryButton:d&&r.length>0}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl mx-auto mb-6 flex items-center justify-center",style:{background:S},children:e.jsx(b,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Fundierte Entscheidungen treffen"}),e.jsx("p",{className:"text-slate-600 max-w-2xl mx-auto leading-relaxed",children:"Stehst du vor einer wichtigen Entscheidung? Das Entscheidungs-Board hilft dir, Pro- und Contra-Argumente systematisch zu sammeln, zu gewichten und mit KI-Unterstützung die richtige Wahl zu treffen."})]}),e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-10",children:ce.map((t,u)=>e.jsxs(x.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1+u*.05},className:"bg-white rounded-xl p-4 border border-slate-200 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl mx-auto mb-3 flex items-center justify-center",style:{backgroundColor:`${t.color}15`},children:e.jsx(t.icon,{className:"w-6 h-6",style:{color:t.color}})}),e.jsx("h3",{className:"font-semibold text-slate-800 text-sm mb-1",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500",children:t.description})]},t.title))}),e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:"mb-8",children:e.jsxs(ne,{className:"p-5 bg-white border border-slate-200 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2.5 mb-4",children:[e.jsx(Q,{className:"w-[22px] h-[22px] text-teal-500"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Mikrofon testen"})]}),e.jsx(ie,{selectedDeviceId:D,onDeviceChange:f,onTestClick:B})]})}),e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-center mb-12",children:[e.jsxs(z,{onClick:v,size:"lg",className:"px-8 py-4 text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all",style:{background:S,color:"white"},children:[e.jsx(X,{className:"w-5 h-5 mr-2"}),"Neue Entscheidung starten",e.jsx(Y,{className:"w-5 h-5 ml-2"})]}),!d&&e.jsx("p",{className:"text-sm text-slate-500 mt-3",children:"Anmeldung erforderlich zum Starten"})]}),d&&r.length>0&&e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-slate-400"}),"Letzte Entscheidungen"]}),r.length>=5&&e.jsxs(z,{variant:"ghost",size:"sm",onClick:w,className:"text-slate-600 hover:text-slate-800",children:["Alle anzeigen",e.jsx(_,{className:"w-4 h-4 ml-1"})]})]}),e.jsx("div",{className:"space-y-3",children:r.map((t,u)=>e.jsx(x.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5+u*.05},className:"bg-white rounded-xl p-4 border border-slate-200 hover:border-teal-300 hover:shadow-md transition-all cursor-pointer group",onClick:()=>N(t),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{background:`${c.teal[500]}15`},children:e.jsx(b,{className:"w-5 h-5",style:{color:c.teal[500]}})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:t.topic?t.topic.substring(0,50)+(t.topic.length>50?"...":""):"Entscheidungsanalyse"}),e.jsx("p",{className:"text-sm text-slate-500",children:I(t.created_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[k(t),e.jsx(_,{className:"w-5 h-5 text-slate-400 group-hover:text-teal-500 transition-colors"})]})]})},t.id))})]}),e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"mt-12 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-2xl p-6 border border-teal-100",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-teal-500"}),"So funktioniert's"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Fragestellung eingeben"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Beschreibe deine Entscheidung oder Frage"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Argumente sammeln"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Füge Pro- und Contra-Punkte mit Gewichtung hinzu"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"KI-Analyse erhalten"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Erhalte eine fundierte Empfehlung und neue Perspektiven"})]})]})]})]})]})]})]})},l={DASHBOARD:"dashboard",INPUT:"input",RESULT:"result"},Ce=({isAuthenticated:p,requireAuth:N,setPendingAction:w,onNavigateToHistory:d})=>{const[g,o]=a.useState(l.DASHBOARD),[D,f]=a.useState(null),[B,r]=a.useState(null),[m,h]=a.useState(null),[E,S]=a.useState(!1),[y,v]=a.useState(null),[I,k]=a.useState(!1),t=a.useRef(!1),u=L(c.teal[500],c.teal[400]);ae({dependencies:[g]});const C=a.useCallback(()=>{f(null),r(null),h(null),t.current=!1,o(l.INPUT)},[]),T=a.useCallback(async s=>{try{h(s.id),t.current=!0;const n={topic:s.topic||"",context:s.context||"",pros:s.pros||[],cons:s.cons||[],proScore:s.pro_score||0,contraScore:s.contra_score||0};f(n),s.status==="completed"&&s.analysis?(r(s.analysis),o(l.RESULT)):o(l.INPUT)}catch(n){console.error("[DecisionBoard] Failed to load session:",n)}},[]),M=a.useCallback(()=>{o(l.DASHBOARD)},[]),H=a.useCallback(async s=>{if(t.current||!s.topic?.trim())return null;try{const n={topic:s.topic,context:s.context||null,pros:s.pros||[],cons:s.cons||[],pro_score:s.proScore||0,contra_score:s.contraScore||0,status:"draft"},i=await j.createDecision(n);if(i?.id)return t.current=!0,h(i.id),console.log("[DecisionBoard] Draft session saved with ID:",i.id),i.id}catch(n){console.error("[DecisionBoard] Failed to save draft session:",n)}return null},[]),A=a.useCallback(async(s,n)=>{if(s)try{const i={topic:n.topic,context:n.context||null,pros:n.pros||[],cons:n.cons||[],pro_score:n.proScore||0,contra_score:n.contraScore||0,analysis:n.analysis||null,status:n.status||"completed"};await j.updateDecision(s,i),console.log("[DecisionBoard] Session updated:",s)}catch(i){console.error("[DecisionBoard] Failed to update session:",i)}},[]),U=a.useCallback(async s=>{if(s)try{await j.deleteDecision(s),console.log("[DecisionBoard] Session deleted:",s)}catch(n){console.error("[DecisionBoard] Failed to delete session:",n)}},[]),P=a.useCallback(async(s,n)=>{f(s),r(n),o(l.RESULT);try{if(m)await A(m,{...s,analysis:n,status:"completed"});else{const i={topic:s.topic,context:s.context||null,pros:s.pros,cons:s.cons,pro_score:s.proScore,contra_score:s.contraScore,analysis:n,status:"completed"},R=await j.createDecision(i);R?.id&&(h(R.id),t.current=!0,console.log("[DecisionBoard] Decision saved with ID:",R.id))}}catch(i){console.error("[DecisionBoard] Failed to save decision:",i)}},[m,A]),O=a.useCallback(()=>{r(null),o(l.INPUT)},[]),G=a.useCallback(async()=>{m&&await U(m),f(null),r(null),h(null),t.current=!1,o(l.DASHBOARD)},[m,U]),V=()=>{switch(g){case l.DASHBOARD:return e.jsx(de,{onStartNew:C,onContinueSession:T,onNavigateToHistory:d,isAuthenticated:p,requireAuth:N,setPendingAction:w,selectedMicrophoneId:y,onMicrophoneChange:v,onTestMicrophone:()=>k(!0)});case l.RESULT:return e.jsxs(e.Fragment,{children:[e.jsx(F,{featureId:"decisionboard",icon:b,title:"Entscheidungs-Board",subtitle:"Deine Analyse",gradient:u,showBackButton:!0,onBack:M}),e.jsx(re,{decisionData:D,analysisResult:B,onStartNew:C,onEditDecision:O})]});case l.INPUT:default:return e.jsxs(e.Fragment,{children:[e.jsx(F,{featureId:"decisionboard",icon:b,title:"Entscheidungs-Board",subtitle:"Strukturierte Entscheidungsfindung",gradient:u,showBackButton:!0,onBack:M}),e.jsx(le,{initialData:D,onAnalysisComplete:P,onCancel:G,isAuthenticated:p,requireAuth:N,savedDecisionId:m,onSaveDraft:H,onUpdateSession:A,onDecisionIdChange:h,selectedMicrophoneId:y,onMicrophoneChange:v})]})}};return e.jsxs("div",{className:"min-h-full",children:[V(),e.jsx(oe,{isOpen:I,onClose:()=>k(!1),deviceId:y})]})};export{Ce as DecisionBoardApp,le as DecisionBoardInput,re as DecisionBoardResult};
