import{j as e,D as ne,ak as ie,T as le,q,b as P,Z as ce,ar as oe,R as L,m as w,v as O,as as Y,t as de,A as J,p as X,a as xe,a4 as Q,at as me,_ as ee,al as ue,k as he,a7 as pe}from"./ui-vendor-B9DEMv6g.js";import{a as s}from"./react-vendor-uDOJF2jQ.js";import{u as be}from"./useMobile-YxjH166V.js";import{k as fe,v as je,l as we,m as Ne,M as ve,n as ge}from"./index.js";import{h as Se,w as B}from"./FeatureInfoButton-ZHD_p0zG.js";import{M as ye,a as ke}from"./MicrophoneTestDialog-CjRagsq0.js";import{B as M,C as R}from"./Button-CE7zPp3G.js";import{B as _e}from"./select-native-DGqpX1mm.js";import{V as Re,S as Me,a as Te}from"./ScenarioCard-DvRLBHYT.js";import"./dialog-BRm7JlyZ.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";import"./useBranding-B-qAk1eY.js";const te={rocket:L,shuffle:oe,zap:ce},G=({icon:t,label:r,value:p,isMobile:d})=>e.jsxs(R,{className:"p-4 md:p-6 shadow-card hover:shadow-card-hover transition-all duration-300 hover:-translate-y-0.5",children:[e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-xl bg-gradient-to-br from-violet-500 to-purple-600 flex-center mb-3 shadow-sm",children:e.jsx(t,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})}),e.jsx("div",{className:"text-2xl md:text-3xl font-bold text-slate-900",children:p}),e.jsx("div",{className:"text-xs md:text-sm text-slate-500 font-medium",children:r})]}),Ce=({mode:t,onBack:r,onStart:p})=>{const[d,a]=s.useState(""),[c,x]=s.useState(!1),[n,m]=s.useState(null),[v,o]=s.useState(!1),S=te[t.icon]||L;s.useEffect(()=>{t.id==="klassiker"?a(t.topic):t.getTopic&&a(t.getTopic())},[t]);const N=()=>{if(!t.getTopic)return;x(!0);const I=1500,T=100;let E=0;const b=setInterval(()=>{a(t.getTopic()),E+=T,E>=I&&(clearInterval(b),x(!1))},T)},y=()=>{p({mode:t,topic:d,duration:t.duration,selectedMicrophoneId:n})};return e.jsxs("div",{className:"min-h-full flex flex-col p-6",children:[e.jsx(w.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e.jsx(M,{variant:"secondary",size:"sm",icon:e.jsx(O,{}),onClick:r,className:"mb-8 w-fit",children:"ZurÃ¼ck zur Auswahl"})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center max-w-[600px] mx-auto w-full",children:[e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-center mb-8",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-violet-500 to-purple-600 flex-center mx-auto mb-5 shadow-lg",children:e.jsx(S,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:t.title}),e.jsxs("p",{className:"text-base text-slate-500",children:[t.duration," Sekunden â€¢ ",t.subtitle]})]}),e.jsxs(w.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2},className:"w-full bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl p-8 mb-6 shadow-card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-5",children:[e.jsxs("div",{className:"flex items-center gap-2.5 text-white/90",children:[e.jsx(Y,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold text-base",children:t.id==="klassiker"?"Deine Aufgabe":t.id==="stress"?"Die Frage":"Dein Thema"})]}),t.getTopic&&e.jsxs(w.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:N,disabled:c,className:"btn-glass flex items-center gap-2 px-4 py-2.5 border border-white/30 rounded-lg text-sm font-semibold disabled:cursor-not-allowed",children:[e.jsx(de,{className:`w-4 h-4 ${c?"animate-spin":""}`}),c?"Dreht...":"Neu wÃ¼rfeln"]})]}),e.jsx(J,{mode:"wait",children:e.jsxs(w.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"text-2xl font-semibold text-white leading-relaxed min-h-[66px]",children:['"',d,'"']},d)})]}),e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(R,{className:"w-full mb-6 shadow-card",children:[e.jsxs("div",{className:"flex items-center gap-2.5 mb-4 text-slate-700",children:[e.jsx(X,{className:"w-5 h-5 text-violet-600"}),e.jsx("span",{className:"font-semibold text-base",children:"Mikrofon auswÃ¤hlen"})]}),e.jsx(ye,{selectedDeviceId:n,onDeviceChange:m,onTestClick:()=>o(!0)})]})}),e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"w-full bg-violet-50 border border-violet-100 rounded-2xl p-5 mb-8 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-violet-900",children:[e.jsx(xe,{className:"w-4.5 h-4.5 text-violet-600"}),e.jsx("span",{className:"font-semibold text-sm",children:"Tipps fÃ¼r deine Antwort"})]}),e.jsxs("ul",{className:"m-0 pl-5 text-slate-600 text-sm leading-relaxed list-disc",children:[e.jsx("li",{children:"Atme tief durch bevor du beginnst"}),e.jsx("li",{children:"Sprich in einem ruhigen, gleichmÃ¤ÃŸigen Tempo"}),e.jsx("li",{children:'Mache bewusst Pausen statt "Ã„hm" zu sagen'}),e.jsx("li",{children:"Strukturiere deine Antwort: Einleitung â†’ Hauptteil â†’ Schluss"})]})]}),e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"w-full max-w-[400px]",children:e.jsx(M,{size:"lg",icon:e.jsx(Q,{}),onClick:y,fullWidth:!0,children:"Aufnahme starten"})})]}),e.jsx(ke,{isOpen:v,onClose:()=>o(!1),deviceId:n})]})},A={MODES:"modes",TOPIC:"topic"},Je=({onStartGame:t,isAuthenticated:r,requireAuth:p,setPendingAction:d})=>{const[a,c]=s.useState(A.MODES),[x,n]=s.useState(null),[m,v]=s.useState("grid"),[o,S]=s.useState({totalGames:0,bestScore:0,avgScore:0,totalPracticeTime:0}),N=be(),[y,I]=s.useState(null);s.useEffect(()=>{const u=async()=>{try{const l=await B.getGameStats();l.success&&l.data&&S({totalGames:l.data.total_games||0,bestScore:l.data.best_score||0,avgScore:l.data.avg_score||0,totalPracticeTime:l.data.total_practice_time||0})}catch(l){console.error("Failed to load stats:",l)}};a===A.MODES&&u()},[a]),s.useEffect(()=>{y&&r&&(n(y),c(A.TOPIC),I(null))},[y,r]),s.useEffect(()=>{window.scrollTo(0,0)},[a]);const T=u=>{if(!r){I(u),p&&p(()=>{},null);return}n(u),c(A.TOPIC)},E=()=>{n(null),c(A.MODES)},b=u=>{t(u)},C=Object.values(fe);return a===A.TOPIC&&x?e.jsx(Ce,{mode:x,onBack:E,onStart:b}):e.jsxs(e.Fragment,{children:[e.jsx(Se,{featureId:"rhetorikgym",showOnMount:!0}),e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"mb-5 md:mb-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2.5 md:gap-3 mb-2 md:mb-3",children:[e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 rounded-xl bg-gradient-to-br from-violet-500 to-purple-600 flex-center shadow-lg",children:e.jsx(ne,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900",children:"Der FÃ¼llwort-Killer"})]}),e.jsx("p",{className:"text-sm md:text-base text-slate-600 max-w-[600px] mx-auto",children:"Trainiere deine Rhetorik - sprich flÃ¼ssig und Ã¼berzeugend ohne Ã„hm und Ã–h!"})]}),e.jsxs("div",{className:"px-2 md:px-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2.5 md:gap-4 mb-6 md:mb-8",children:[e.jsx(G,{icon:ie,label:"Highscore",value:o.bestScore||"-",isMobile:N}),e.jsx(G,{icon:le,label:"Spiele",value:o.totalGames||0,isMobile:N}),e.jsx(G,{icon:q,label:"Durchschnitt",value:o.avgScore?Math.round(o.avgScore):"-",isMobile:N}),e.jsx(G,{icon:P,label:"Trainingszeit",value:o.totalPracticeTime?`${Math.round(o.totalPracticeTime/60)}m`:"0m",isMobile:N})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"WÃ¤hle deinen Modus"}),e.jsx(Re,{viewMode:m,onViewChange:v})]}),e.jsx(Me,{minCardWidth:"280px",viewMode:m,children:C.map(u=>{const l=te[u.icon]||L;return e.jsx(Te,{title:u.title,subtitle:u.subtitle,description:u.description,icon:l,meta:[{icon:P,text:`${u.duration} Sekunden`}],action:{label:"Starten",icon:q},onClick:()=>T(u),viewMode:m},u.id)})})]})]})]})},h={READY:"ready",COUNTDOWN:"countdown",RECORDING:"recording",PROCESSING:"processing",RESULTS:"results",ERROR:"error"},Ie=({count:t})=>e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-slate-900/90 flex-center z-50",children:e.jsxs(w.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},className:"text-white text-center",children:[e.jsx("div",{className:"text-[120px] font-bold mb-4",children:t}),e.jsx("div",{className:"text-2xl text-slate-400",children:t===3?"Mach dich bereit...":t===2?"Durchatmen...":"Los geht's!"})]},t)}),Ee=({seconds:t,total:r,isWarning:p})=>{const d=t/r*100,a=Math.floor(t/60),c=t%60;return e.jsxs("div",{className:"bg-white rounded-2xl shadow-card p-8 mb-6",children:[e.jsxs("div",{className:`text-7xl md:text-8xl font-bold font-mono text-center mb-4 ${p?"text-red-500":"bg-gradient-to-br from-violet-600 to-purple-600 bg-clip-text text-transparent"}`,children:[a,":",c.toString().padStart(2,"0")]}),e.jsx("div",{className:"h-3 bg-slate-100 rounded-full overflow-hidden shadow-inner",children:e.jsx(w.div,{className:`h-full rounded-full ${p?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-violet-500 to-purple-600"}`,initial:{width:"100%"},animate:{width:`${d}%`},transition:{duration:.5}})})]})},De=({word:t,count:r})=>e.jsxs(_e,{variant:"error",className:"gap-1",children:['"',t,'"',e.jsxs("span",{className:"bg-red-500/20 px-1.5 py-0.5 rounded text-xs",children:[r,"x"]})]}),Ae=t=>!t||t==="[Keine Sprache erkannt]"?0:t.trim().split(/\s+/).filter(r=>r.length>0).length,Oe=t=>!t||!Array.isArray(t)?0:t.reduce((r,p)=>r+(p.count||0),0),ze=(t,r,p,d)=>{const a=Ae(t),c=Oe(r),x=a>0?c/a*100:0,n=d>0?Math.round(a/d*60):0;let m=0;a>=60?m=25:a>=40?m=15:a>=20?m=10:a>=10&&(m=5);let v=25;x>25?v=0:x>15?v=10:x>10?v=15:x>5&&(v=20);let o=0,S="keine_sprache";a>0&&(n>=100&&n<=140?(o=10,S="optimal"):n>=80&&n<100||n>140&&n<=160?(o=5,S=n<100?"zu_langsam":"zu_schnell"):(o=0,S=n<80?"zu_langsam":"zu_schnell"));const N=Math.min(40,Math.max(0,p||0)),y=m+v+o+N;return{total_words:a,filler_count:c,filler_percentage:x,words_per_minute:n,pace_feedback:S,score:y,score_breakdown:{words_score:m,filler_score:v,tempo_score:o,content_score:N}}},Ge=({result:t,onPlayAgain:r,onBack:p})=>{const d=ge(t.score),a=t.score>=70,c=t.pace_feedback==="keine_sprache"||t.transcript==="[Keine Sprache erkannt]",x=c?"bg-gradient-to-br from-slate-500 to-slate-600":a?"bg-gradient-to-br from-green-500 to-primary":"bg-gradient-to-br from-amber-500 to-orange-500";return e.jsxs("div",{className:"max-w-[600px] mx-auto",children:[e.jsxs("div",{className:`${x} rounded-2xl p-10 mb-8 text-white text-center shadow-card`,children:[e.jsx("div",{className:"text-6xl mb-4",children:c?"ðŸŽ¤":d.emoji}),e.jsx("div",{className:"text-8xl font-bold mb-3",children:t.score}),e.jsx("div",{className:"text-2xl opacity-90 mb-5 font-semibold",children:"Punkte"}),e.jsx("p",{className:"text-lg leading-relaxed",children:c?"Keine Sprache erkannt. Bitte sprich lauter ins Mikrofon.":d.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs(R,{className:"p-5 shadow-card",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center mb-3",children:e.jsx(Y,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 mb-1",children:t.total_words}),e.jsx("div",{className:"text-sm text-slate-600 font-medium",children:"WÃ¶rter gesprochen"})]}),e.jsxs(R,{className:"p-5 shadow-card",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center mb-3",children:e.jsx(he,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 mb-1",children:t.filler_count}),e.jsxs("div",{className:"text-sm text-slate-600 font-medium",children:["FÃ¼llwÃ¶rter (",t.filler_percentage?.toFixed(1)||"0","%)"]})]}),e.jsxs(R,{className:"p-5 shadow-card",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center mb-3",children:e.jsx(pe,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 mb-1",children:t.words_per_minute}),e.jsx("div",{className:"text-sm text-slate-600 font-medium",children:"WPM Tempo"})]}),e.jsxs(R,{className:"p-5 shadow-card",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-slate-500 to-slate-600 flex items-center justify-center mb-3",children:e.jsx(P,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"text-3xl font-bold text-slate-900 mb-1",children:t.duration_seconds||0}),e.jsx("div",{className:"text-sm text-slate-600 font-medium",children:"Sekunden Sprechzeit"})]})]}),t.filler_words&&t.filler_words.length>0&&e.jsxs(R,{className:"mb-6 shadow-card",children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-4 text-base",children:"Erkannte FÃ¼llwÃ¶rter"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.filler_words.map((n,m)=>e.jsx(De,{word:n.word,count:n.count},m))})]}),!c&&e.jsxs("div",{className:"bg-violet-50 border border-violet-200 rounded-2xl p-5 mb-6 shadow-sm",children:[e.jsx("h4",{className:"font-semibold text-violet-900 mb-4 text-base",children:"Bewertung im Detail"}),t.score_breakdown&&e.jsxs("div",{className:`grid grid-cols-2 gap-2 ${t.content_feedback?"mb-3":""}`,children:[e.jsxs("div",{className:"text-[13px] text-slate-600",children:["ðŸ“ Wortanzahl: ",e.jsxs("strong",{children:[t.score_breakdown.words_score||0,"/25"]})]}),e.jsxs("div",{className:"text-[13px] text-slate-600",children:["ðŸš« FÃ¼llwÃ¶rter: ",e.jsxs("strong",{children:[t.score_breakdown.filler_score||0,"/25"]})]}),e.jsxs("div",{className:"text-[13px] text-slate-600",children:["â±ï¸ Tempo: ",e.jsxs("strong",{children:[t.score_breakdown.tempo_score||0,"/10"]})]}),e.jsxs("div",{className:"text-[13px] text-slate-600",children:["ðŸ’¡ Inhalt: ",e.jsxs("strong",{children:[t.score_breakdown.content_score||0,"/40"]})]})]}),t.content_feedback&&e.jsx("div",{className:"pt-4 border-t border-violet-200",children:e.jsxs("p",{className:"text-sm text-slate-700 leading-relaxed",children:[e.jsx("strong",{className:"text-violet-900",children:"Inhaltliches Feedback:"})," ",t.content_feedback]})})]}),t.pace_feedback&&t.pace_feedback!=="optimal"&&t.pace_feedback!=="keine_sprache"&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-2xl p-5 mb-6 shadow-sm",children:[e.jsx("h4",{className:"font-semibold text-amber-700 mb-3 text-base",children:"Tempo-Hinweis"}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:t.pace_feedback==="zu_schnell"?"Du sprichst etwas zu schnell. Versuche, bewusst langsamer und deutlicher zu sprechen.":"Du sprichst etwas zu langsam. Versuche, etwas mehr Energie in deine PrÃ¤sentation zu legen."})]}),t.transcript&&t.transcript!=="[Keine Sprache erkannt]"&&e.jsxs(R,{className:"mb-8 bg-slate-50 shadow-card",children:[e.jsx("h4",{className:"font-semibold text-slate-900 mb-4 text-base",children:"Transkript"}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:t.transcript})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(M,{icon:e.jsx(ee,{}),onClick:r,fullWidth:!0,children:"Nochmal spielen"}),e.jsx(M,{variant:"secondary",icon:e.jsx(O,{}),onClick:p,fullWidth:!0,children:"ZurÃ¼ck"})]})]})},Xe=({gameConfig:t,onBack:r,onComplete:p})=>{const[d,a]=s.useState(h.COUNTDOWN),[c,x]=s.useState(3),[n,m]=s.useState(t.duration),[v,o]=s.useState(null),[S,N]=s.useState(null),[y,I]=s.useState(0),[T,E]=s.useState(!1),b=s.useRef(null),C=s.useRef([]),u=s.useRef(null),l=s.useRef(null),k=s.useRef(null),F=s.useRef(null),U=s.useRef(null),V=B.getGeminiApiKey(),z=s.useCallback(()=>{u.current&&clearInterval(u.current),F.current&&cancelAnimationFrame(F.current),k.current&&(k.current.close(),k.current=null),b.current&&b.current.state!=="inactive"&&b.current.stop()},[]);s.useEffect(()=>z,[z]),s.useEffect(()=>{T||(E(!0),se())},[T]);const se=async()=>{a(h.COUNTDOWN),x(3);try{const j=t.selectedMicrophoneId?{deviceId:{exact:t.selectedMicrophoneId}}:!0,f=await navigator.mediaDevices.getUserMedia({audio:j});k.current=new(window.AudioContext||window.webkitAudioContext);const _=k.current.createMediaStreamSource(f);l.current=k.current.createAnalyser(),l.current.fftSize=256,_.connect(l.current),b.current=new MediaRecorder(f,{mimeType:MediaRecorder.isTypeSupported("audio/webm")?"audio/webm":"audio/mp4"}),C.current=[],b.current.ondataavailable=g=>{g.data.size>0&&C.current.push(g.data)};let i=3;const D=setInterval(()=>{i--,x(i),i===0&&(clearInterval(D),K())},1e3)}catch(j){console.error("Microphone access denied:",j),N("Bitte erlaube den Zugriff auf das Mikrofon, um zu spielen."),a(h.ERROR)}},Z=s.useCallback(async()=>{a(h.COUNTDOWN),x(3);try{const j=t.selectedMicrophoneId?{deviceId:{exact:t.selectedMicrophoneId}}:!0,f=await navigator.mediaDevices.getUserMedia({audio:j});k.current=new(window.AudioContext||window.webkitAudioContext);const _=k.current.createMediaStreamSource(f);l.current=k.current.createAnalyser(),l.current.fftSize=256,_.connect(l.current),b.current=new MediaRecorder(f,{mimeType:MediaRecorder.isTypeSupported("audio/webm")?"audio/webm":"audio/mp4"}),C.current=[],b.current.ondataavailable=g=>{g.data.size>0&&C.current.push(g.data)};let i=3;const D=setInterval(()=>{i--,x(i),i===0&&(clearInterval(D),K())},1e3)}catch(j){console.error("Microphone access denied:",j),N("Bitte erlaube den Zugriff auf das Mikrofon, um zu spielen."),a(h.ERROR)}},[t.selectedMicrophoneId]),K=s.useCallback(()=>{a(h.RECORDING),m(t.duration),U.current=Date.now(),b.current.start();const j=()=>{if(l.current){const f=new Uint8Array(l.current.frequencyBinCount);l.current.getByteFrequencyData(f);const _=f.reduce((i,D)=>i+D)/f.length;I(_/255)}F.current=requestAnimationFrame(j)};j(),u.current=setInterval(()=>{m(f=>f<=1?($(),0):f-1)},1e3)},[t.duration]),$=s.useCallback(()=>{const j=U.current?Math.round((Date.now()-U.current)/1e3):t.duration;z(),a(h.PROCESSING),b.current.onstop=async()=>{const f=new Blob(C.current,{type:b.current.mimeType});b.current.stream.getTracks().forEach(i=>i.stop());const _=je(f,{minSize:ve});if(!_.valid){console.warn("[GameSession] Audio validation failed:",_.error,"Size:",f.size);const i={...we("game"),score:0,word_count:0,filler_count:0,words_per_minute:0,duration_seconds:j};o(i),a(h.RESULTS);return}try{const i=await Ne(f,V,t.topic,t.duration),g={...ze(i.transcript,i.filler_words,i.content_score,j),transcript:i.transcript||"[Keine Sprache erkannt]",filler_words:i.filler_words||[],content_feedback:i.content_feedback||"",duration_seconds:j};o(g),a(h.RESULTS);try{const W={game_type:t.mode.id,topic:t.topic,duration_seconds:j,score:g.score,filler_count:g.filler_count,words_per_minute:g.words_per_minute,transcript:g.transcript,analysis_json:JSON.stringify(g)};await B.createGameSession(W)}catch(W){console.error("[GameSession] Failed to save game session:",W)}}catch(i){console.error("Analysis failed:",i),N(`Analyse fehlgeschlagen: ${i.message}`),a(h.ERROR)}},b.current.stop()},[V,t,z]),ae=()=>{$()},H=()=>{o(null),N(null),m(t.duration),Z()},re=()=>{switch(d){case h.READY:return e.jsx("div",{className:"text-center py-10 px-5",children:e.jsxs("div",{className:"max-w-[500px] mx-auto",children:[e.jsx("div",{className:"text-6xl mb-6",children:"ðŸŽ¤"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-3",children:"Bereit?"}),e.jsx("p",{className:"text-base text-slate-600 mb-6 leading-relaxed",children:t.topic}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-100 rounded-full text-slate-600 text-sm mb-8",children:[e.jsx(P,{className:"w-4 h-4"}),t.duration," Sekunden"]}),e.jsx("div",{children:e.jsx(M,{size:"lg",icon:e.jsx(Q,{}),onClick:Z,children:"Aufnahme starten"})}),e.jsxs("button",{onClick:r,className:"mt-6 px-5 py-2.5 border-none bg-transparent text-slate-400 text-sm cursor-pointer inline-flex items-center gap-1.5",children:[e.jsx(O,{className:"w-4 h-4"}),"ZurÃ¼ck zur Auswahl"]})]})});case h.RECORDING:return e.jsx("div",{className:"text-center py-10 px-5",children:e.jsxs("div",{className:"max-w-[500px] mx-auto",children:[e.jsx(Ee,{seconds:n,total:t.duration,isWarning:n<=10}),e.jsxs("div",{className:"mb-8 p-5 bg-violet-50 border border-violet-100 rounded-2xl shadow-sm",children:[e.jsx("p",{className:"text-sm text-violet-600 mb-2 font-medium",children:"Dein Thema:"}),e.jsx("p",{className:"text-base font-semibold text-slate-900",children:t.topic})]}),e.jsx("div",{className:"mb-8",children:e.jsx(w.div,{className:"h-24 bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl flex-center shadow-card",animate:{opacity:.7+y*.3},children:e.jsx(w.div,{className:"w-16 h-16 rounded-full bg-white/30 flex-center backdrop-blur-sm",animate:{scale:1+y*.4},children:e.jsx(X,{className:"w-8 h-8 text-white"})})})}),e.jsxs("div",{className:"flex-center gap-2 mb-8",children:[e.jsx(w.div,{animate:{scale:[1,1.2,1],opacity:1},transition:{repeat:1/0,duration:1},className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"font-medium text-red-500 text-sm",children:"Aufnahme lÃ¤uft..."})]}),e.jsx(M,{variant:"danger",icon:e.jsx(ue,{}),onClick:ae,children:"Aufnahme beenden"})]})});case h.PROCESSING:return e.jsxs("div",{className:"text-center py-20 px-5",children:[e.jsx(w.div,{animate:{rotate:360},transition:{repeat:1/0,duration:1,ease:"linear"},className:"w-16 h-16 border-4 border-violet-600 border-t-transparent rounded-full mx-auto mb-6"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-3",children:"Analysiere deine Aufnahme..."}),e.jsx("p",{className:"text-base text-slate-600",children:"Der FÃ¼llwort-Killer zÃ¤hlt nach"})]});case h.RESULTS:return e.jsx(Ge,{result:v,onPlayAgain:H,onBack:r});case h.ERROR:return e.jsx("div",{className:"text-center py-16 px-5",children:e.jsxs("div",{className:"max-w-[400px] mx-auto",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-red-100 flex-center mx-auto mb-6 shadow-sm",children:e.jsx(me,{className:"w-10 h-10 text-red-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Fehler"}),e.jsx("p",{className:"text-base text-slate-600 mb-8 leading-relaxed",children:S}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(M,{icon:e.jsx(ee,{}),onClick:H,children:"Erneut versuchen"}),e.jsx(M,{variant:"secondary",icon:e.jsx(O,{}),onClick:r,children:"ZurÃ¼ck"})]})]})});default:return null}};return e.jsxs("div",{className:"min-h-full pb-8",children:[e.jsx(J,{children:d===h.COUNTDOWN&&e.jsx(Ie,{count:c})}),d!==h.COUNTDOWN&&d!==h.RECORDING&&e.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-white sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-[600px] mx-auto flex items-center justify-between",children:[e.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 border-none bg-transparent text-slate-600 text-sm cursor-pointer",children:[e.jsx(O,{className:"w-4.5 h-4.5"}),"ZurÃ¼ck"]}),e.jsx("h1",{className:"font-semibold text-slate-900 text-base",children:t.mode.title}),e.jsx("div",{className:"w-[60px]"})]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"max-w-[600px] mx-auto",children:re()})})]})};export{Xe as GameSession,Je as RhetorikGym};
