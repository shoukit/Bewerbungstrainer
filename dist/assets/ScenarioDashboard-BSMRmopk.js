import{av as O,T as Ee,ad as Ie,c as Ae,as as $e,q as ze,U as De,B as Me,j as e,aU as ee,aM as be,aL as re,aV as Be,l as Te,z as Ue,az as _e}from"./ui-vendor-B9DEMv6g.js";import{a as x}from"./react-vendor-uDOJF2jQ.js";import{w as Oe,u as Re,D as X}from"./FeatureInfoButton-Df0Ex1oW.js";import{S as Fe,a as Ge}from"./ScenarioCard-Bh8TqK0p.js";import{D as Ke,a as He,b as We,c as Ye}from"./dialog-BRm7JlyZ.js";import{u as Ze}from"./useMobile-YxjH166V.js";import{B as qe}from"./Button-BHvYxNT_.js";import"./select-native-BpAm0hLd.js";const Je={briefcase:Me,users:De,"trending-up":ze,"message-circle":$e,shield:Ae,heart:Ie,target:Ee,folder:O},C=O,j=s=>!s||typeof s!="string"?C:Je[s.toLowerCase()]||C,z=s=>!s||typeof s!="string"?"":s.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/[^a-z0-9]/g,""),P={career:"karriere",leadership:"fuehrung",sales:"vertrieb",communication:"kommunikation",service:"service",social:"social",karriere:"karriere",fuehrung:"fuehrung",vertrieb:"vertrieb",kommunikation:"kommunikation",meine:"meine",selfpresentation:"karriere",interview:"karriere",pitch:"vertrieb",negotiation:"vertrieb",vorstellungsgespraech:"karriere",gehaltsverhandlung:"vertrieb",fuehrungsgespraech:"fuehrung",praesentation:"kommunikation",selbstvorstellung:"karriere",training:"kommunikation"};let D=null,V=null;const Qe=300*1e3;function Xe(){const[s,m]=x.useState(D||[]),[c,u]=x.useState(!D),[p,w]=x.useState(null),b=x.useCallback(async()=>{if(D&&V&&Date.now()-V<Qe)return m(D),u(!1),D;try{u(!0),w(null);const n=await Oe.getCategories();return D=n,V=Date.now(),m(n),n}catch(n){return console.error("[useCategories] Failed to fetch categories:",n),w(n.message||"Failed to fetch categories"),[]}finally{u(!1)}},[]);x.useEffect(()=>{b()},[b]);const f=x.useCallback(n=>{if(!n||!s.length)return null;const o=z(n),i=P[o]||o,t=s.find(r=>z(r.slug)===i||z(r.name)===i);return t?{...t,IconComponent:j(t.icon),bgColor:`${t.color}15`}:null},[s]),g=x.useCallback(n=>{if(Array.isArray(n)){for(const t of n){if(typeof t!="string")continue;const r=f(t);if(r)return{key:r.slug,label:r.name,shortLabel:r.shortName||r.name,icon:j(r.icon),IconComponent:j(r.icon),color:r.color,bgColor:r.bgColor}}const i=n.find(t=>typeof t=="string")||"unknown";return{key:String(i),label:String(i),shortLabel:String(i),icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"}}if(typeof n!="string")return{key:"unknown",label:"Unbekannt",shortLabel:"Unbekannt",icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"};const o=f(n);return o?{key:o.slug,label:o.name,shortLabel:o.shortName||o.name,icon:j(o.icon),IconComponent:j(o.icon),color:o.color,bgColor:o.bgColor}:{key:n||"unknown",label:n||"Unbekannt",shortLabel:n||"Unbekannt",icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"}},[f]),N=x.useCallback((n=[])=>{if(!s.length)return[];if(!n.length)return s.map(i=>({key:i.slug,label:i.name,shortLabel:i.shortName||i.name,icon:j(i.icon),IconComponent:j(i.icon),color:i.color,bgColor:`${i.color}15`}));const o=new Map;return n.forEach(i=>{if(i){if(Array.isArray(i))i.forEach(t=>{if(!t||typeof t!="string"||!t.trim())return;const r=f(t);r&&!o.has(r.slug)&&o.set(r.slug,{key:r.slug,label:r.name,shortLabel:r.shortName||r.name,icon:j(r.icon),IconComponent:j(r.icon),color:r.color,bgColor:r.bgColor})});else if(typeof i=="string"&&i.trim()){const t=f(i);t&&!o.has(t.slug)&&o.set(t.slug,{key:t.slug,label:t.name,shortLabel:t.shortName||t.name,icon:j(t.icon),IconComponent:j(t.icon),color:t.color,bgColor:t.bgColor})}}}),Array.from(o.values())},[s,f]),v=x.useCallback((n,o)=>{if(!n||!o)return!1;const i=z(o);if(Array.isArray(n))return n.some(L=>{const I=z(L);return(P[I]||I)===i});const t=z(n);return(P[t]||t)===i},[]),S=x.useMemo(()=>{const n=new Map;return s.forEach(o=>{n.set(o.slug,{...o,IconComponent:j(o.icon),bgColor:`${o.color}15`})}),n},[s]);return{categories:s,categoriesMap:S,loading:c,error:p,refetch:b,getCategoryBySlug:f,getCategoryConfig:g,getCategoriesForFilter:N,matchesCategory:v}}const _=({label:s,icon:m,isSelected:c,onClick:u})=>e.jsxs("button",{onClick:u,className:`inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold
      border-2 cursor-pointer transition-all whitespace-nowrap
      ${c?"border-primary bg-primary text-white shadow-md":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[m&&e.jsx(m,{className:"w-3.5 h-3.5"}),s]}),Pe=({count:s})=>s===0?null:e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-md bg-red-500 text-white text-xs font-semibold flex items-center justify-center",children:s}),Ve=({value:s,onChange:m,placeholder:c,className:u=""})=>e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(be,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-[18px] h-[18px] text-slate-400 pointer-events-none z-10"}),e.jsx("input",{type:"text",placeholder:c,value:s,onChange:p=>m(p.target.value),className:"w-full py-3 pl-11 pr-4 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 placeholder:text-slate-400"})]}),ue=({value:s,onChange:m,options:c,className:u=""})=>e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(re,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("select",{value:s,onChange:p=>m(p.target.value),className:"w-full py-3 pl-10 pr-10 rounded-lg border border-slate-200 text-base text-slate-900 bg-white cursor-pointer outline-none appearance-none bg-no-repeat",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundPosition:"right 12px center"},children:c.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]}),pe=({viewMode:s,onViewModeChange:m,compact:c=!1})=>e.jsxs("div",{className:`flex items-center gap-1 ${c?"p-[3px]":"p-1"} bg-slate-100 rounded-lg`,children:[e.jsx("button",{onClick:()=>m("grid"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${s==="grid"?"bg-white shadow-sm":"bg-transparent"}`,title:"Kachelansicht",children:e.jsx(ee,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${s==="grid"?"text-primary":"text-slate-500"}`})}),e.jsx("button",{onClick:()=>m("list"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${s==="list"?"bg-white shadow-sm":"bg-transparent"}`,title:"Listenansicht",children:e.jsx(Be,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${s==="list"?"text-primary":"text-slate-500"}`})})]}),er=({searchQuery:s,onSearchChange:m,searchPlaceholder:c="Durchsuchen...",showSearch:u=!0,categories:p=[],selectedCategory:w,onCategoryChange:b,showCategories:f=!0,difficultyOptions:g=[],selectedDifficulty:N,onDifficultyChange:v,showDifficulty:S=!1,viewMode:n,onViewModeChange:o,showViewToggle:i=!0,renderCustomFilters:t,customActions:r,children:L})=>{const[I,A]=x.useState(!1),R=Ze(),$=[w?1:0,N&&N!=="all"?1:0,s?.trim()?1:0].reduce((h,M)=>h+M,0);return R?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[u&&e.jsxs("div",{className:"relative flex-1",children:[e.jsx(be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:s,onChange:h=>m(h.target.value),className:"w-full py-2 pl-9 pr-3 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none"})]}),e.jsxs("button",{onClick:()=>A(!0),className:`relative flex items-center justify-center w-11 h-11 rounded-lg border flex-shrink-0 cursor-pointer
            ${$>0?"border-primary bg-primary/10":"border-slate-200 bg-white"}`,children:[e.jsx(re,{className:`w-[18px] h-[18px] ${$>0?"text-primary":"text-slate-500"}`}),e.jsx(Pe,{count:$})]}),i&&n&&e.jsx(pe,{viewMode:n,onViewModeChange:o,compact:!0})]}),r&&e.jsx("div",{className:"mt-2",children:r}),e.jsx(Ke,{open:I,onOpenChange:A,children:e.jsxs(He,{className:"fixed bottom-0 left-0 right-0 top-auto transform-none max-w-full w-full rounded-t-2xl max-h-[80vh] overflow-auto",children:[e.jsx(We,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ye,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-primary"}),"Filter"]}),$>0&&e.jsx("button",{onClick:()=>{b?.(null),v?.("all"),m?.("")},className:"px-3 py-1 rounded-md border-none bg-slate-100 text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-200 transition-colors",children:"Zurücksetzen"})]})}),e.jsxs("div",{className:"flex flex-col gap-5 py-2",children:[S&&g.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Schwierigkeit"}),e.jsx(ue,{value:N,onChange:v,options:g})]}),f&&p.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Kategorie"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{label:"Alle",icon:ee,isSelected:!w,onClick:()=>b(null)}),p.map(h=>e.jsx(_,{label:h.label,icon:h.icon,isSelected:w===h.key,onClick:()=>b(h.key)},h.key))]})]}),t&&e.jsx("div",{children:t()})]}),e.jsx(qe,{variant:"primary",size:"lg",onClick:()=>A(!1),fullWidth:!0,className:"mt-3",children:"Filter anwenden"})]})}),L]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[u&&e.jsx(Ve,{value:s,onChange:m,placeholder:c,className:"flex-1 min-w-[200px]"}),S&&g.length>0&&e.jsx(ue,{value:N,onChange:v,options:g,className:"min-w-[180px]"}),t&&t(),r,i&&n&&e.jsx(pe,{viewMode:n,onViewModeChange:o})]}),f&&p.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{label:"Alle",icon:ee,isSelected:!w,onClick:()=>b(null)}),p.map(h=>e.jsx(_,{label:h.label,icon:h.icon,isSelected:w===h.key,onClick:()=>b(h.key)},h.key))]}),L]})},he=({category:s,getCategoryConfig:m})=>{const c=m(s);if(!c)return null;const u=c.IconComponent||c.icon||O;return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:c.bgColor,color:c.color},children:[e.jsx(u,{style:{width:"12px",height:"12px"}}),c.shortLabel]})},rr=({category:s,getCategoryConfig:m})=>Array.isArray(s)?e.jsx("div",{className:"flex flex-wrap gap-1",children:s.map((c,u)=>e.jsx(he,{category:c,getCategoryConfig:m},u))}):e.jsx(he,{category:s,getCategoryConfig:m}),xr=({title:s,subtitle:m,headerIcon:c,fetchScenarios:u,moduleKey:p,historyButtonLabel:w="Meine Sessions",onNavigateToHistory:b,showHistoryButton:f=!0,onSelectScenario:g,renderCardMeta:N,renderCategoryBadge:v,getIconForScenario:S,cardActionLabel:n="Starten",cardActionIcon:o,getCardCustomActions:i,categoryField:t="category",customCategoryConfig:r,emptyStateIcon:L,emptyStateTitle:I="Keine Szenarien verfügbar",emptyStateMessage:A="Bitte kontaktieren Sie den Administrator.",searchPlaceholder:R="Durchsuchen...",headerActions:$,filterActions:h,renderInfoBox:M,extraContent:fe,isAuthenticated:B,requireAuth:F,setPendingAction:G,setPendingScenario:K,demoCode:te,pendingScenario:H,clearPendingScenario:W,loadingMessage:ge="Szenarien werden geladen...",errorRetryLabel:je="Erneut versuchen"})=>{const[se,we]=x.useState([]),[Ne,le]=x.useState(!0),[ne,ae]=x.useState(null),[E,oe]=x.useState(null),[Y,ve]=x.useState("grid"),[T,ke]=x.useState(""),{branding:Z,filterScenariosBySetupAndPartner:ie}=Re(),{getCategoryConfig:q,getCategoriesForFilter:ce,matchesCategory:U}=Xe(),ye=Z?.["--header-gradient"]||X["--header-gradient"],Ce=Z?.["--header-text"]||X["--header-text"];Z?.["--primary-accent"]||X["--primary-accent"];const J=x.useCallback(async()=>{try{le(!0),ae(null);const l=await u();we(l||[])}catch(l){console.error(`[${s}] Error loading scenarios:`,l),ae(l.message||"Fehler beim Laden")}finally{le(!1)}},[u,s]);x.useEffect(()=>{J()},[J]);const xe=x.useRef(!1);x.useEffect(()=>{H&&B&&!xe.current&&(xe.current=!0,W&&W(),g(H))},[H,B,W,g]);const k=x.useMemo(()=>ie([...se],p),[se,ie,p]),Q=x.useMemo(()=>{if(r){const a=new Set;return k.forEach(d=>{const y=d[t];y&&r[y]&&a.add(y)}),Array.from(a)}const l=k.flatMap(a=>{const d=a[t];return Array.isArray(d)?d.filter(y=>y&&typeof y=="string"&&y.trim()):d&&typeof d=="string"&&d.trim()?[d]:[]});return[...new Set(l)]},[k,t,r]),me=x.useMemo(()=>r?Q.filter(a=>k.some(d=>d[t]===a)).map(a=>({key:a,label:r[a]?.label||a,shortLabel:r[a]?.label||a,color:r[a]?.color,bgColor:r[a]?.bgColor,icon:r[a]?.icon,IconComponent:r[a]?.icon})):ce(Q).filter(a=>!a||!a.label||!a.label.trim()?!1:k.some(d=>U(d[t],a.key))),[Q,r,ce,k,t,U]),de=x.useMemo(()=>{let l=[...k];if(E&&(r?l=l.filter(a=>a[t]===E):l=l.filter(a=>U(a[t],E))),T.trim()){const a=T.toLowerCase();l=l.filter(d=>d.title?.toLowerCase().includes(a)||d.description?.toLowerCase().includes(a))}return l},[k,E,T,t,r,U]),Se=x.useCallback(l=>{if(!B&&!te){K?K(l):G&&G({type:"SELECT_SCENARIO",scenario:l}),F&&F(()=>{g(l)},{type:"SELECT_SCENARIO",scenario:l});return}g(l)},[B,te,K,G,F,g]),Le=x.useCallback(l=>{const a=l[t];if(!a)return null;if(v)return v(l,q);if(r&&r[a]){const d=r[a];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:d.bgColor,color:d.color},children:[d.icon&&e.jsx(d.icon,{style:{width:"12px",height:"12px"}}),d.label]})}return e.jsx(rr,{category:a,getCategoryConfig:q})},[t,v,r,q]);return Ne?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-[60px_20px] gap-4",children:[e.jsx(Te,{className:"w-12 h-12 text-primary animate-spin"}),e.jsx("p",{className:"text-slate-600 text-base",children:ge})]}):ne?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-[60px_20px] gap-4",children:[e.jsx(Ue,{className:"w-12 h-12 text-red-500"}),e.jsx("p",{className:"text-red-500 text-base text-center",children:ne}),e.jsx("button",{onClick:J,className:"px-6 py-3 rounded-xl border-none bg-primary text-white text-sm font-semibold cursor-pointer hover:opacity-90 transition-opacity",children:je})]}):e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:ye},children:c&&e.jsx(c,{style:{width:"24px",height:"24px",color:Ce}})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[28px] font-bold text-slate-900 m-0",children:s}),e.jsx("p",{className:"text-sm text-slate-600 m-0",children:m})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[$,f&&b&&e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-5 py-3 rounded-xl border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-all",children:[e.jsx(_e,{size:18}),w]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(er,{searchQuery:T,onSearchChange:ke,searchPlaceholder:R,categories:me.map(l=>({key:l.key,label:l.label,shortLabel:l.shortLabel||l.label,color:l.color,bgColor:l.bgColor,icon:l.IconComponent||l.icon})),selectedCategory:E,onCategoryChange:oe,showCategories:me.length>0,showDifficulty:!1,viewMode:Y,onViewModeChange:ve,customActions:h})})]}),de.length>0?e.jsx(Fe,{minCardWidth:"340px",viewMode:Y,children:de.map(l=>{const a=S?S(l):null,d=N?N(l):[],y=i?i(l):null;return e.jsx(Ge,{title:l.title,description:l.description,icon:a,categoryBadge:Le(l),meta:d,action:o?{label:n,icon:o}:{label:n},onClick:()=>Se(l),viewMode:Y,customActions:y},l.id)})}):e.jsxs("div",{className:"text-center p-12 px-6 bg-white rounded-2xl border border-slate-200",children:[e.jsx("div",{className:"flex justify-center mb-4",children:L?e.jsx(L,{className:"w-12 h-12 text-slate-300"}):e.jsx(O,{className:"w-12 h-12 text-slate-300"})}),e.jsx("h3",{className:"text-slate-500 m-0 mb-2 font-medium",children:I}),e.jsx("p",{className:"text-slate-400 m-0 text-sm",children:E?"In der ausgewählten Kategorie sind keine Szenarien verfügbar.":A}),E&&k.length>0&&e.jsx("button",{onClick:()=>oe(null),className:"mt-4 px-5 py-2.5 rounded-[20px] border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-colors",children:"Alle Szenarien anzeigen"})]}),M&&M(),fe]})};export{xr as S};
