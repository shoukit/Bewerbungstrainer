import{c as Y,a as u,j as e,L as E,o as te,h as ae,T as xe}from"./colors-uXoD1ofg.js";import{u as fe}from"./useBranding-Cxdgj0iN.js";import{u as ue}from"./useMobile-CWVpMrbN.js";import{f as X}from"./formatting-B67Bmjxp.js";import{b as ge,e as he,d as ye,p as me,i as je}from"./roleplay-feedback-adapter-iPFERy0V.js";import{A as be}from"./arrow-left-CtCRDCiU.js";import{C as ve}from"./calendar-D_hT1Fz4.js";import{C as Se,c as A,m as v,M as Q,b as P,T as ke,a as we}from"./index.js";import{D as se}from"./download-770bHVxi.js";import{P as N}from"./play-q3i8YB9n.js";import{T as U}from"./trash-2-5YY_ZL8K.js";import{B as ze}from"./bot-Dk2VNoZg.js";import{U as Ce}from"./user-C299kFlx.js";import{V as J}from"./volume-2-DsiN52jK.js";import{C as Re}from"./circle-alert-EMpUppYH.js";import{S as Ie,P as Me}from"./skip-back-CY8RiVmy.js";import{S as We}from"./skip-forward-DBeOEIJP.js";import{A as Te}from"./award-fyGeNNIF.js";import{C as ee}from"./circle-check-ZmDrGT7a.js";import{L as Ae}from"./lightbulb-DN4XDJmu.js";import{S as Be}from"./star-fNCV08Od.js";const Z=Y("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);const Le=Y("Music2",[["circle",{cx:"8",cy:"18",r:"4",key:"1fc0mg"}],["path",{d:"M12 18V2l7 4",key:"g04rme"}]]);const De=Y("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);const oe=Y("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),C={COACHING:"coaching",ANALYSEN:"analysen"},_e=t=>t>=90?"Ausgezeichnet!":t>=80?"Sehr gut!":t>=70?"Gut!":t>=60?"Solide Leistung":t>=50?"Ausbaufähig":"Weiter üben!",$e=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",He=t=>t>=80?{color:"#22c55e",bg:"#f0fdf4",label:"Sehr selbstsicher"}:t>=60?{color:"#3b82f6",bg:"#eff6ff",label:"Selbstsicher"}:t>=40?{color:"#f59e0b",bg:"#fffbeb",label:"Ausbaufähig"}:{color:"#ef4444",bg:"#fef2f2",label:"Unsicher"},Fe=t=>{switch(t){case"zu_langsam":return 15;case"optimal":return 50;case"zu_schnell":return 85;default:return 50}},le=t=>{if(typeof t=="number")return t;if(!t||typeof t!="string")return 0;const l=t.split(":");if(l.length===2){const i=parseInt(l[0],10)||0,n=parseInt(l[1],10)||0;return i*60+n}if(l.length===3){const i=parseInt(l[0],10)||0,n=parseInt(l[1],10)||0,s=parseInt(l[2],10)||0;return i*3600+n*60+s}return parseFloat(t)||0},Ee=({score:t,size:l=100,primaryAccent:i,isHeader:n=!1})=>{const s=Math.min(100,Math.max(0,t||0)),o=(l-10)/2,x=o*2*Math.PI,d=x-s/100*x,r=te(t,i);return e.jsxs("div",{style:{position:"relative",width:l,height:l},children:[e.jsxs("svg",{width:l,height:l,style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:l/2,cy:l/2,r:o,fill:"none",stroke:n?"rgba(255,255,255,0.25)":"#e2e8f0",strokeWidth:8}),e.jsx(v.circle,{cx:l/2,cy:l/2,r:o,fill:"none",stroke:n?"#fff":r,strokeWidth:8,strokeLinecap:"round",strokeDasharray:x,initial:{strokeDashoffset:x},animate:{strokeDashoffset:d},transition:{duration:1.2,ease:"easeOut"}})]}),e.jsx("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:e.jsx(v.span,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.4},style:{fontSize:l/3,fontWeight:700,color:n?"#fff":r,lineHeight:1},children:Math.round(t)})})]})},Ne=({audioUrl:t,duration:l,primaryAccent:i,branding:n,onSeek:s})=>{const o=u.useRef(null),x=u.useRef(null),d=u.useRef(null),[r,g]=u.useState(!1),[S,k]=u.useState(!1),[w,R]=u.useState(0),[b,a]=u.useState(l||0),[f,c]=u.useState(!0),[m,h]=u.useState(null);u.useEffect(()=>{if(!t)return;let j=!0;const W=t.includes("/wp-json/")||t.includes("/api/");return(async()=>{try{c(!0),h(null);let z=t;if(W){const D=await fetch(t,{method:"GET",headers:{"X-WP-Nonce":ae()},credentials:"same-origin"});if(!D.ok)throw new Error(`HTTP ${D.status}`);const _=await D.blob();if(!j)return;if(_.size===0)throw new Error("Audio nicht verfügbar");const $=URL.createObjectURL(_);d.current=$,z=$}const y=new Audio(z);o.current=y,y.addEventListener("loadedmetadata",()=>{j&&(a(y.duration),c(!1))}),y.addEventListener("timeupdate",()=>{j&&R(y.currentTime)}),y.addEventListener("ended",()=>{j&&(g(!1),R(0))}),y.addEventListener("error",()=>{j&&(h("Audio konnte nicht geladen werden"),c(!1))})}catch(z){console.error("[AudioPlayer] Failed to load audio:",z),j&&(h("Audio konnte nicht geladen werden"),c(!1))}})(),()=>{j=!1,o.current&&(o.current.pause(),o.current.src=""),d.current&&URL.revokeObjectURL(d.current)}},[t]);const B=()=>{o.current&&(r?o.current.pause():o.current.play(),g(!r))},K=()=>{o.current&&(o.current.muted=!S,k(!S))},L=j=>{o.current&&(o.current.currentTime=Math.max(0,Math.min(b,o.current.currentTime+j)))},p=j=>{o.current&&(o.current.currentTime=j,R(j),r||(o.current.play(),g(!0)))};u.useEffect(()=>{s&&(s.current=p)},[s]);const M=j=>{if(!x.current||!b)return;const W=x.current.getBoundingClientRect(),O=(j.clientX-W.left)/W.width;p(O*b)};return t?e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${n.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(J,{size:18,color:i}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:n.textMain},children:"Gesprächsaufnahme"})]}),e.jsx("div",{ref:x,onClick:M,style:{position:"relative",height:"48px",background:n.cardBgHover,borderRadius:"12px",cursor:"pointer",overflow:"hidden",marginBottom:"16px"},children:f?e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx(E,{size:24,color:i,style:{animation:"spin 1s linear infinite"}})}):m?e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",gap:"8px"},children:[e.jsx(Re,{size:18,color:n.warning}),e.jsx("span",{style:{fontSize:"13px",color:n.textMuted},children:m})]}):e.jsxs(e.Fragment,{children:[e.jsx(v.div,{initial:{width:0},animate:{width:`${b>0?w/b*100:0}%`},style:{position:"absolute",inset:0,background:`linear-gradient(90deg, ${i}40, ${i}60)`,borderRadius:"12px"}}),e.jsx("div",{style:{position:"absolute",left:`${b>0?w/b*100:0}%`,top:0,bottom:0,width:"3px",background:i,transform:"translateX(-50%)"}})]})}),!m&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("button",{onClick:()=>L(-10),disabled:f,style:{width:"36px",height:"36px",borderRadius:"8px",border:"none",background:n.cardBgHover,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:f?.5:1},children:e.jsx(Ie,{size:20,color:n.textSecondary})}),e.jsx("button",{onClick:B,disabled:f,style:{width:"48px",height:"48px",borderRadius:"50%",border:"none",background:i,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:f?.5:1},children:r?e.jsx(Me,{size:20,color:"#fff"}):e.jsx(N,{size:20,color:"#fff",style:{marginLeft:"2px"}})}),e.jsx("button",{onClick:()=>L(10),disabled:f,style:{width:"36px",height:"36px",borderRadius:"8px",border:"none",background:n.cardBgHover,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:f?.5:1},children:e.jsx(We,{size:20,color:n.textSecondary})})]}),e.jsxs("div",{style:{flex:1,textAlign:"center",fontSize:"14px",color:n.textSecondary,fontFamily:"monospace"},children:[X(w)," / ",X(b)]}),e.jsx("button",{onClick:K,disabled:f,style:{width:"36px",height:"36px",borderRadius:"8px",border:"none",background:n.cardBgHover,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:S?e.jsx(oe,{size:20,color:n.textSecondary}):e.jsx(J,{size:20,color:n.textSecondary})})]})]}):e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${n.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(J,{size:18,color:n.textMuted}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:n.textMain},children:"Gesprächsaufnahme"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"80px",background:n.cardBgHover,borderRadius:"12px",color:n.textMuted,fontSize:"13px"},children:[e.jsx(oe,{size:20,style:{marginRight:"8px"}}),"Keine Audioaufnahme verfügbar"]})]})},Oe=({transcript:t,scenario:l,primaryAccent:i,branding:n,onSeekToTime:s})=>!t||t.length===0?e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"40px 20px",border:`1px solid ${n.borderColor}`,textAlign:"center"},children:[e.jsx(Q,{size:32,color:n.textMuted,style:{marginBottom:"12px"}}),e.jsx("p",{style:{color:n.textMuted,fontSize:"14px"},children:"Kein Transkript verfügbar"})]}):e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${n.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(Q,{size:18,color:i}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:n.textMain},children:"Gesprächsverlauf"})]}),e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto",paddingRight:"8px"},children:t.map((o,x)=>{const d=o.role==="agent",r=o.timeLabel||(o.elapsedTime!==void 0?X(o.elapsedTime):null);return e.jsxs(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:x*.03},style:{display:"flex",gap:"10px",marginBottom:"12px",flexDirection:d?"row":"row-reverse"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",flexShrink:0},children:[d?l?.interviewer_profile?.image_url?e.jsx("img",{src:l.interviewer_profile.image_url,alt:l.interviewer_profile.name||"Interviewer",style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",border:`2px solid ${i}30`}}):e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:`linear-gradient(135deg, ${i}, ${i}cc)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ze,{size:16,color:"#fff"})}):e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"linear-gradient(135deg, #14b8a6, #0d9488)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ce,{size:16,color:"#fff"})}),!d&&r&&e.jsx("button",{onClick:()=>s?.(o.elapsedTime),style:{fontSize:"10px",fontFamily:"monospace",color:i,background:"none",border:"none",cursor:"pointer",padding:0},children:r})]}),e.jsx("div",{style:{maxWidth:"85%",padding:"10px 14px",borderRadius:d?"4px 16px 16px 16px":"16px 4px 16px 16px",background:d?n.cardBgHover:"linear-gradient(135deg, #14b8a6, #0d9488)",color:d?n.textMain:"#fff",fontSize:"13px",lineHeight:1.5,border:d?`1px solid ${n.borderColor}`:"none"},children:o.text})]},x)})})]}),V=({label:t,value:l,maxValue:i=10,primaryAccent:n,branding:s})=>{const o=l/i*100,x=i===10?l*10:l,d=te(x,n);return e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[e.jsx("span",{style:{fontSize:"13px",color:s.textSecondary},children:t}),e.jsx("span",{style:{fontSize:"13px",fontWeight:600,color:d},children:x})]}),e.jsx("div",{style:{height:"6px",background:s.cardBgHover,borderRadius:"3px",overflow:"hidden"},children:e.jsx(v.div,{initial:{width:0},animate:{width:`${o}%`},transition:{duration:.8,ease:"easeOut"},style:{height:"100%",background:d,borderRadius:"3px"}})})]})},Ge=({feedback:t,audioAnalysis:l,primaryAccent:i,branding:n})=>{const[s,o]=u.useState("summary"),x=d=>{o(s===d?null:d)};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t?.summary&&e.jsxs("div",{style:{background:`${i}08`,borderRadius:"12px",border:`1px solid ${i}20`,overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>x("summary"),style:{width:"100%",padding:"14px 16px",display:"flex",alignItems:"center",gap:"10px",background:"none",border:"none",cursor:"pointer",textAlign:"left"},children:[e.jsx(Te,{size:18,color:i}),e.jsx("span",{style:{flex:1,fontSize:"14px",fontWeight:600,color:n.textMain},children:"Gesamtbewertung"}),e.jsx(P,{size:18,color:n.textMuted,style:{transform:s==="summary"?"rotate(180deg)":"none",transition:"transform 0.2s"}})]}),e.jsx(A,{children:s==="summary"&&e.jsx(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsx("div",{style:{padding:"0 16px 16px"},children:e.jsx("p",{style:{fontSize:"13px",lineHeight:1.7,color:n.textSecondary},children:t.summary})})})})]}),t?.strengths?.length>0&&e.jsxs("div",{style:{background:"#f0fdf4",borderRadius:"12px",border:"1px solid #bbf7d0",overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>x("strengths"),style:{width:"100%",padding:"14px 16px",display:"flex",alignItems:"center",gap:"10px",background:"none",border:"none",cursor:"pointer",textAlign:"left"},children:[e.jsx(ee,{size:18,color:"#22c55e"}),e.jsx("span",{style:{flex:1,fontSize:"14px",fontWeight:600,color:"#166534"},children:"Deine Superkräfte"}),e.jsxs("span",{style:{fontSize:"12px",color:"#22c55e",fontWeight:500},children:[t.strengths.length," Stärken"]}),e.jsx(P,{size:18,color:"#22c55e",style:{transform:s==="strengths"?"rotate(180deg)":"none",transition:"transform 0.2s"}})]}),e.jsx(A,{children:s==="strengths"&&e.jsx(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsx("div",{style:{padding:"0 16px 16px"},children:t.strengths.map((d,r)=>e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"#dcfce7",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"2px"},children:e.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"#22c55e"},children:"✓"})}),e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:"#166534",margin:0},children:d})]},r))})})})]}),t?.improvements?.length>0&&e.jsxs("div",{style:{background:"#fffbeb",borderRadius:"12px",border:"1px solid #fde68a",overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>x("improvements"),style:{width:"100%",padding:"14px 16px",display:"flex",alignItems:"center",gap:"10px",background:"none",border:"none",cursor:"pointer",textAlign:"left"},children:[e.jsx(xe,{size:18,color:"#f59e0b"}),e.jsx("span",{style:{flex:1,fontSize:"14px",fontWeight:600,color:"#92400e"},children:"Dein Trainingsfeld"}),e.jsxs("span",{style:{fontSize:"12px",color:"#f59e0b",fontWeight:500},children:[t.improvements.length," Punkte"]}),e.jsx(P,{size:18,color:"#f59e0b",style:{transform:s==="improvements"?"rotate(180deg)":"none",transition:"transform 0.2s"}})]}),e.jsx(A,{children:s==="improvements"&&e.jsx(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsx("div",{style:{padding:"0 16px 16px"},children:t.improvements.map((d,r)=>e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"#fef3c7",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"2px"},children:e.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"#f59e0b"},children:r+1})}),e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:"#92400e",margin:0},children:d})]},r))})})})]}),t?.tips?.length>0&&e.jsxs("div",{style:{background:"#eff6ff",borderRadius:"12px",border:"1px solid #bfdbfe",overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>x("tips"),style:{width:"100%",padding:"14px 16px",display:"flex",alignItems:"center",gap:"10px",background:"none",border:"none",cursor:"pointer",textAlign:"left"},children:[e.jsx(Ae,{size:18,color:"#3b82f6"}),e.jsx("span",{style:{flex:1,fontSize:"14px",fontWeight:600,color:"#1e40af"},children:"Praktische Tipps"}),e.jsxs("span",{style:{fontSize:"12px",color:"#3b82f6",fontWeight:500},children:[t.tips.length," Tipps"]}),e.jsx(P,{size:18,color:"#3b82f6",style:{transform:s==="tips"?"rotate(180deg)":"none",transition:"transform 0.2s"}})]}),e.jsx(A,{children:s==="tips"&&e.jsx(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsx("div",{style:{padding:"0 16px 16px"},children:t.tips.map((d,r)=>e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[e.jsx(ke,{size:16,color:"#3b82f6",style:{flexShrink:0,marginTop:"2px"}}),e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:"#1e40af",margin:0},children:d})]},r))})})})]}),t?.rating&&e.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"16px",border:`1px solid ${n.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(Be,{size:18,color:i}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:n.textMain},children:"Bewertungskriterien"})]}),t.rating.communication!==void 0&&e.jsx(V,{label:"Kommunikation",value:t.rating.communication,primaryAccent:i,branding:n}),t.rating.motivation!==void 0&&e.jsx(V,{label:"Motivation",value:t.rating.motivation,primaryAccent:i,branding:n}),t.rating.professionalism!==void 0&&e.jsx(V,{label:"Professionalität",value:t.rating.professionalism,primaryAccent:i,branding:n}),t.rating.preparation!==void 0&&e.jsx(V,{label:"Vorbereitung",value:t.rating.preparation,primaryAccent:i,branding:n})]})]})},Pe=({audioAnalysis:t,primaryAccent:l,branding:i,onJumpToTimestamp:n})=>{const s=t?.audio_metrics||t,o=s&&(s.confidence_score!==void 0||s.speech_cleanliness||s.pacing||s.tonality);if(!t||!o)return e.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"40px 20px",border:`1px solid ${i.borderColor}`,textAlign:"center"},children:[e.jsx(Z,{size:32,color:i.textMuted,style:{marginBottom:"12px"}}),e.jsx("p",{style:{color:i.textMuted,fontSize:"14px"},children:"Keine Audio-Analyse verfügbar"})]});const x=s.confidence_score,d=s.speech_cleanliness,r=s.pacing,g=s.tonality,S=d?.total_filler_count||0,k=d?.filler_word_analysis||[];k.map(a=>a.word);const w=d?.feedback,R=a=>a==="lebendig"?"Lebendig":a==="natürlich"?"Natürlich":"Monoton",b=a=>a==="lebendig"?{base:20,variance:30}:a==="natürlich"?{base:25,variance:20}:{base:35,variance:8};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[x!==void 0&&e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${i.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(Z,{size:18,color:l}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:i.textMain},children:"Selbstsicherheit"})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"16px"},children:(()=>{const a=x,f=He(a),c=140,m=c/2-12,h=Math.PI*m,B=h-a/100*h;return e.jsxs("div",{style:{background:f.bg,borderRadius:"16px",padding:"20px 30px",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",width:c,height:c/2+20},children:[e.jsxs("svg",{width:c,height:c/2+20,style:{overflow:"visible"},children:[e.jsx("path",{d:`M 12 ${c/2} A ${m} ${m} 0 0 1 ${c-12} ${c/2}`,fill:"none",stroke:"#e2e8f0",strokeWidth:"10",strokeLinecap:"round"}),e.jsx(v.path,{d:`M 12 ${c/2} A ${m} ${m} 0 0 1 ${c-12} ${c/2}`,fill:"none",stroke:f.color,strokeWidth:"10",strokeLinecap:"round",strokeDasharray:h,initial:{strokeDashoffset:h},animate:{strokeDashoffset:B},transition:{duration:1.2,ease:"easeOut"}})]}),e.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end",paddingBottom:"4px"},children:[e.jsx(v.span,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.5},style:{fontSize:"32px",fontWeight:700,color:f.color},children:Math.round(a)}),e.jsx("span",{style:{fontSize:"11px",color:i.textMuted},children:"/ 100"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"8px"},children:[e.jsx(Z,{size:14,color:f.color}),e.jsx("span",{style:{fontSize:"13px",fontWeight:600,color:f.color},children:f.label})]})]})})()}),s.summary_text&&e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:i.textSecondary,textAlign:"center"},children:s.summary_text})]}),d&&e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${i.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Q,{size:18,color:"#f97316"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:i.textMain},children:"Füllwörter"})]}),e.jsxs("span",{style:{fontSize:"13px",fontWeight:600,padding:"4px 10px",borderRadius:"20px",background:S<=2?"#dcfce7":S<=5?"#fef3c7":"#fee2e2",color:S<=2?"#166534":S<=5?"#92400e":"#991b1b"},children:[S,"x gesamt"]})]}),k.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"12px"},children:k.map((a,f)=>e.jsxs("div",{style:{borderRadius:"8px",background:"#fef3c7",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px"},children:[e.jsxs("span",{style:{fontSize:"13px",color:"#92400e",fontWeight:500},children:['"',a.word,'"']}),e.jsxs("span",{style:{fontSize:"12px",color:"#92400e",fontWeight:600},children:[a.count,"x"]})]}),a.examples?.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",padding:"8px 12px",background:"#fef9e7",borderTop:"1px solid #fde68a"},children:a.examples.map((c,m)=>e.jsxs("button",{onClick:()=>n?.(le(c.timestamp)),style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"4px 8px",borderRadius:"6px",border:"none",background:"#fef3c7",cursor:"pointer",fontSize:"11px",color:"#92400e",transition:"all 0.15s"},onMouseOver:h=>h.currentTarget.style.background="#fde68a",onMouseOut:h=>h.currentTarget.style.background="#fef3c7",children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:c.timestamp}),e.jsx(N,{size:10})]},m))})]},f))}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#22c55e"},children:[e.jsx(ee,{size:16}),e.jsx("span",{style:{fontSize:"13px"},children:"Keine Füllwörter erkannt!"})]}),w&&e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:i.textSecondary,marginTop:"12px"},children:w})]}),r&&e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${i.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(De,{size:18,color:"#3b82f6"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:i.textMain},children:"Sprechtempo"})]}),r.estimated_wpm&&e.jsxs("span",{style:{fontSize:"12px",fontFamily:"monospace",padding:"4px 10px",borderRadius:"6px",background:i.cardBgHover,color:i.textSecondary},children:["~",r.estimated_wpm," WPM"]})]}),e.jsxs("div",{style:{position:"relative",height:"40px",marginBottom:"8px"},children:[e.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"8px",borderRadius:"4px",background:"linear-gradient(90deg, #93c5fd, #86efac, #fca5a5)",transform:"translateY(-50%)"}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",width:"60px",height:"16px",background:"rgba(34, 197, 94, 0.2)",border:"1px solid #22c55e",borderRadius:"8px",transform:"translate(-50%, -50%)"}}),e.jsx(v.div,{initial:{left:"50%"},animate:{left:`${Fe(r.rating)}%`},transition:{duration:.8,ease:"easeOut"},style:{position:"absolute",top:"50%",width:"16px",height:"16px",borderRadius:"50%",background:r.rating==="optimal"?"#22c55e":"#f59e0b",border:"2px solid #fff",boxShadow:"0 2px 6px rgba(0,0,0,0.2)",transform:"translate(-50%, -50%)"}}),e.jsxs("div",{style:{position:"absolute",bottom:"-4px",left:0,right:0,display:"flex",justifyContent:"space-between",fontSize:"10px",color:i.textMuted},children:[e.jsx("span",{children:"Langsam"}),e.jsx("span",{style:{color:"#22c55e",fontWeight:500},children:"Optimal"}),e.jsx("span",{children:"Schnell"})]})]}),r.feedback&&e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:i.textSecondary,marginTop:"16px"},children:r.feedback})]}),g&&e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${i.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Le,{size:18,color:"#14b8a6"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:i.textMain},children:"Betonung & Melodie"})]}),e.jsx("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"6px",background:"#f0fdfa",color:"#0d9488"},children:R(g.rating)})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",height:"48px",marginBottom:"12px"},children:Array.from({length:30}).map((a,f)=>{const{base:c,variance:m}=b(g.rating),h=c+Math.sin(f*.5)*m+Math.sin(f*12.9898)%1*(m/2);return e.jsx(v.div,{initial:{height:0},animate:{height:`${Math.max(10,Math.min(100,h))}%`},transition:{duration:.5,delay:f*.02},style:{width:"4px",borderRadius:"2px",background:"#14b8a6"}},f)})}),g.highlights?.length>0&&e.jsx("div",{style:{marginBottom:"12px"},children:g.highlights.map((a,f)=>e.jsxs("button",{onClick:()=>n?.(le(a.timestamp)),style:{width:"100%",display:"flex",alignItems:"flex-start",gap:"8px",padding:"10px 12px",marginBottom:"6px",borderRadius:"8px",border:"none",background:a.type==="positive"?"#f0fdf4":"#fef2f2",cursor:"pointer",textAlign:"left"},children:[e.jsx("span",{style:{fontSize:"11px",fontFamily:"monospace",padding:"2px 6px",borderRadius:"4px",background:a.type==="positive"?"#dcfce7":"#fee2e2",color:a.type==="positive"?"#166534":"#991b1b",flexShrink:0},children:a.timestamp}),e.jsx("span",{style:{flexShrink:0,marginTop:"1px"},children:a.type==="positive"?e.jsx(ee,{size:14,color:"#22c55e"}):e.jsx(we,{size:14,color:"#ef4444"})}),e.jsx("span",{style:{fontSize:"12px",color:i.textSecondary,flex:1,lineHeight:1.5,wordBreak:"break-word",whiteSpace:"normal"},children:a.note}),e.jsx(N,{size:12,color:i.textMuted,style:{flexShrink:0,marginTop:"2px"}})]},f))}),g.feedback&&e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:i.textSecondary},children:g.feedback})]})]})},ft=({session:t,scenario:l,feedback:i,audioAnalysis:n,onBack:s,onRepeat:o,onDelete:x,isLoading:d=!1})=>{const r=fe(),g=ue(768),S=u.useRef(null),[k,w]=u.useState(C.COACHING),[R,b]=u.useState(!1),[a,f]=u.useState(!1),[c,m]=u.useState(!1),[h,B]=u.useState(null),[K,L]=u.useState(!1),p=h||t;u.useEffect(()=>{t?.id&&!t?.audio_analysis_json&&!n&&!h&&(L(!0),ge(t.id).then(H=>{B(H)}).catch(H=>{console.error("Failed to fetch full session:",H)}).finally(()=>{L(!1)}))},[t?.id,t?.audio_analysis_json,n,h]);const M=u.useMemo(()=>i&&typeof i=="object"?i:p?.feedback_json?he(p.feedback_json):null,[i,p?.feedback_json]),j=u.useMemo(()=>n&&typeof n=="object"?n:p?.audio_analysis_json?ye(p.audio_analysis_json):null,[n,p?.audio_analysis_json]),W=u.useMemo(()=>p?.transcript?me(p.transcript):[],[p?.transcript]),O=u.useMemo(()=>p?.audio_url?p.audio_url:p?.id?je(p.id):null,[p?.id,p?.audio_url]),z=u.useMemo(()=>M?.rating?.overall!==void 0?M.rating.overall*10:0,[M]),y=r.primaryAccent,D=r.headerGradient,_=I=>{S.current&&S.current(I)},$=async()=>{if(!(!p?.id||c)){m(!0);try{const H=(window.wpApiSettings||{}).root||"/wp-json/",de=ae(),ie=await fetch(`${H}bewerbungstrainer/v1/sessions/${p.id}/export-pdf`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":de}}),T=await ie.json();if(!ie.ok)throw console.error("[PDF] Server error:",T),new Error(T.error||"PDF-Export fehlgeschlagen");if(T.pdf_base64&&T.filename){const q=atob(T.pdf_base64),ne=new Array(q.length);for(let G=0;G<q.length;G++)ne[G]=q.charCodeAt(G);const ce=new Uint8Array(ne),pe=new Blob([ce],{type:"application/pdf"}),re=window.URL.createObjectURL(pe),F=document.createElement("a");F.href=re,F.download=T.filename,document.body.appendChild(F),F.click(),document.body.removeChild(F),window.URL.revokeObjectURL(re)}}catch(I){console.error("[PDF] Download failed:",I)}finally{m(!1)}}};return d||K?e.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"16px"},children:[e.jsx(E,{size:40,color:y,style:{animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{color:r.textSecondary,fontSize:"14px"},children:"Lade Report..."})]}):e.jsxs("div",{style:{minHeight:"100vh",background:r.pageBg},children:[e.jsx("div",{style:{background:D,padding:g?"20px 16px":"24px 32px",position:"sticky",top:0,zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[s&&e.jsxs("button",{onClick:s,style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",color:"#fff",fontSize:"13px",marginBottom:"16px"},children:[e.jsx(be,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px"},children:[!g&&e.jsx(Ee,{score:z,size:100,primaryAccent:y,isHeader:!0}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.2)",color:"#fff"},children:"Live-Simulation"}),e.jsx("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.9)",color:te(z,y)},children:_e(z)})]}),e.jsx("h1",{style:{fontSize:g?"20px":"24px",fontWeight:700,color:"#fff",margin:0,marginBottom:"8px"},children:l?.title||p?.scenario_title||"Übungssession"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(ve,{size:14}),$e(p?.created_at)]}),p?.duration&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(Se,{size:14}),X(p.duration)]})]})]}),!g&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[p?.id&&e.jsxs("button",{onClick:$,disabled:c,style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:c?"wait":"pointer",color:"#fff",fontSize:"14px",fontWeight:500,opacity:c?.7:1},children:[c?e.jsx(E,{size:16,style:{animation:"spin 1s linear infinite"}}):e.jsx(se,{size:16}),"PDF Export"]}),o&&e.jsxs("button",{onClick:o,style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[e.jsx(N,{size:16}),"Erneut üben"]}),x&&e.jsx("button",{onClick:()=>b(!0),style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.4)",borderRadius:"10px",padding:"10px 16px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:e.jsx(U,{size:16})})]})]})]})}),e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:g?"16px":"24px 32px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:g?"1fr":"30fr 70fr",gap:"24px",alignItems:"start"},children:[e.jsxs("div",{style:{order:g?2:1},children:[e.jsx(Oe,{transcript:W,scenario:l,primaryAccent:y,branding:r,onSeekToTime:_}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsx(Ne,{audioUrl:O,duration:p?.duration,primaryAccent:y,branding:r,onSeek:S})})]}),e.jsxs("div",{style:{order:g?1:2},children:[e.jsxs("div",{style:{display:"flex",background:"#fff",borderRadius:"12px",padding:"4px",marginBottom:"16px",border:`1px solid ${r.borderColor}`},children:[e.jsx("button",{onClick:()=>w(C.COACHING),style:{flex:1,padding:"10px 16px",borderRadius:"8px",border:"none",background:k===C.COACHING?y:"transparent",color:k===C.COACHING?"#fff":r.textSecondary,fontSize:"13px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:"Coaching"}),e.jsx("button",{onClick:()=>w(C.ANALYSEN),style:{flex:1,padding:"10px 16px",borderRadius:"8px",border:"none",background:k===C.ANALYSEN?y:"transparent",color:k===C.ANALYSEN?"#fff":r.textSecondary,fontSize:"13px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:"Analysen"})]}),e.jsx(A,{mode:"wait",children:e.jsx(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:k===C.COACHING?e.jsx(Ge,{feedback:M,audioAnalysis:j,primaryAccent:y,branding:r}):e.jsx(Pe,{audioAnalysis:j,primaryAccent:y,branding:r,onJumpToTimestamp:_})},k)})]})]}),g&&e.jsxs("div",{style:{marginTop:"24px",display:"flex",flexDirection:"column",gap:"12px"},children:[p?.id&&e.jsxs("button",{onClick:$,disabled:c,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:y,border:"none",borderRadius:"12px",padding:"14px 24px",cursor:c?"wait":"pointer",color:"#fff",fontSize:"15px",fontWeight:600,opacity:c?.7:1},children:[c?e.jsx(E,{size:18,style:{animation:"spin 1s linear infinite"}}):e.jsx(se,{size:18}),"PDF Export"]}),o&&e.jsxs("button",{onClick:o,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:r.cardBg,border:`1px solid ${r.borderColor}`,borderRadius:"12px",padding:"14px 24px",cursor:"pointer",color:r.textMain,fontSize:"15px",fontWeight:600},children:[e.jsx(N,{size:18}),"Erneut üben"]}),x&&e.jsxs("button",{onClick:()=>b(!0),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:"transparent",border:"1px solid #ef4444",borderRadius:"12px",padding:"14px 24px",cursor:"pointer",color:"#ef4444",fontSize:"15px",fontWeight:600},children:[e.jsx(U,{size:18}),"Session löschen"]})]})]}),e.jsx(A,{children:R&&e.jsxs(e.Fragment,{children:[e.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>b(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1e3}}),e.jsx(v.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",zIndex:1001,boxShadow:"0 20px 40px rgba(0,0,0,0.2)"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"50%",background:"rgba(239,68,68,0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(U,{size:24,color:"#ef4444"})}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:600,color:r.textMain,marginBottom:"8px"},children:"Session löschen?"}),e.jsx("p",{style:{fontSize:"14px",color:r.textSecondary,marginBottom:"24px"},children:"Diese Aktion kann nicht rückgängig gemacht werden. Dein Transkript und Feedback werden dauerhaft gelöscht."}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{onClick:()=>b(!1),disabled:a,style:{flex:1,padding:"12px 16px",borderRadius:"10px",border:`1px solid ${r.borderColor}`,background:"#fff",color:r.textMain,fontSize:"14px",fontWeight:500,cursor:a?"not-allowed":"pointer",opacity:a?.5:1},children:"Abbrechen"}),e.jsx("button",{onClick:async()=>{if(!(!x||!p?.id)){f(!0);try{await x(p)}catch(I){console.error("Failed to delete session:",I)}finally{f(!1),b(!1)}}},disabled:a,style:{flex:1,padding:"12px 16px",borderRadius:"10px",border:"none",background:"#ef4444",color:"#fff",fontSize:"14px",fontWeight:500,cursor:a?"not-allowed":"pointer",opacity:a?.7:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:a?e.jsxs(e.Fragment,{children:[e.jsx(E,{size:16,style:{animation:"spin 1s linear infinite"}}),"Löschen..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{size:16}),"Löschen"]})})]})]})})]})}),e.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})};export{ft as R,oe as V};
