import{j as e,Y as q,F as M,av as ve,h as Pe,z as se,ah as K,ac as it,aw as de,i as at,ag as lt,R as ne,c as xe,S as he,a2 as ue,ax as pe,ay as be,a1 as ge,l as re,at as ie,x as fe,U as je,am as ae,r as le,w as Oe,y as Se,C as ye,E as X,a as Ce,_ as Me,b as Ie,$ as Re,u as ot,az as _e,L as Be,m as me,X as ct,aA as Te,a3 as dt,aB as mt,aC as xt,A as ze,aD as Ve}from"./ui-vendor-yht_HmbK.js";import{a as i}from"./react-vendor-CQ8o-PK1.js";import{w as U,k as ht,F as ut,C as pt}from"./FeatureInfoButton-dPxIiVOv.js";import{S as bt}from"./ScenarioDashboard-BaFTkXdN.js";import{B as ee,C as te}from"./select-native-BjHv-Qcb.js";import"./dialog-DUOP1XW_.js";import{F as gt}from"./fullscreen-loader-DW8pQl7V.js";import{D as ft}from"./DynamicFormField-CInZi6VT.js";import{a as jt,B as yt}from"./BriefingWorkbook-DLUcIRMA.js";import{u as Nt}from"./useMobile-TMJ3QDEQ.js";import"./ScenarioCard-CFWqzXpB.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";import"./index.js";const kt={"file-text":M,briefcase:le,banknote:ae,users:je,user:fe,"message-circle":ie,target:re,award:ge,book:be,clipboard:pe,star:ue,lightbulb:se,shield:he,compass:xe,rocket:ne,heart:lt,folder:ve,"trending-up":at},P={key:"MEINE",label:"Meine Templates",shortLabel:"Meine",color:"#7C3AED",bgColor:"#EDE9FE",icon:ve},wt=({onSelectTemplate:n,onShowList:j,onCreateTemplate:g,onEditTemplate:o,onCopyTemplate:b,isAuthenticated:a,requireAuth:d,setPendingAction:m,demoCode:u})=>{const[N,h]=i.useState(null),[r,x]=i.useState(0),c=i.useCallback(async()=>{const p=new URLSearchParams;u&&p.append("demo_code",u);const k=await U.request(`/smartbriefing/templates?${p.toString()}`,{method:"GET"});if(k.success&&k.data?.templates)return k.data.templates;throw new Error("Unerwartete API-Antwort")},[u,r]),w=()=>{if(!a&&!u){d&&(m(()=>g),d());return}g?.()},f=(p,k)=>{p.stopPropagation(),o?.(k)},S=(p,k)=>{p.stopPropagation(),h(k)},l=(p,k)=>{if(p.stopPropagation(),!a&&!u){d&&(m(()=>()=>b?.({...k,title:`${k.title} (Kopie)`,id:null,is_custom:!0})),d());return}b?.({...k,title:`${k.title} (Kopie)`,id:null,is_custom:!0})},C=async()=>{if(N)try{const p=new URLSearchParams;u&&p.append("demo_code",u),(await U.request(`/smartbriefing/templates/${N.id}?${p.toString()}`,{method:"DELETE"})).success&&x(L=>L+1)}catch(p){console.error("[SmartBriefing] Error deleting template:",p)}finally{h(null)}},R=p=>kt[p.icon]||M,v=p=>{const k=p.variables_schema?.length||0;return[{text:`${k} Eingabefeld${k!==1?"er":""}`}]},z=(p,k)=>{const G=(Array.isArray(p.category)?p.category:[p.category]).includes("MEINE"),F=p.category&&!G?k(p.category):null;return e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[p.is_custom&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:P.bgColor,color:P.color},children:[e.jsx(ve,{style:{width:"12px",height:"12px"}}),P.shortLabel]}),F&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:F.bgColor,color:F.color},children:[F.IconComponent&&e.jsx(F.IconComponent,{style:{width:"12px",height:"12px"}}),F.shortLabel]})]})},A=p=>p.is_custom?"ring-2 ring-violet-200 bg-violet-50/30":"",I=p=>p.is_custom?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:k=>f(k,p),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-slate-100 hover:text-primary",title:"Template bearbeiten",children:e.jsx(it,{size:16})}),e.jsx("button",{onClick:k=>S(k,p),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-red-50 hover:text-red-500",title:"Template lÃ¶schen",children:e.jsx(q,{size:16})})]}):b?e.jsx("div",{className:"flex gap-1",children:e.jsx("button",{onClick:k=>l(k,p),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-indigo-50 hover:text-indigo-600",title:"Als eigenes Template kopieren",children:e.jsx(de,{size:16})})}):null,$=(a||u)&&g?e.jsxs("button",{onClick:w,className:"flex items-center gap-2 py-2.5 px-4 rounded-xl border-2 border-dashed border-indigo-200 bg-white text-indigo-500 text-sm font-medium cursor-pointer transition-all whitespace-nowrap hover:border-indigo-400 hover:bg-indigo-50 hover:shadow-sm",children:[e.jsx(K,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"persÃ¶nliches Template"}),e.jsx("span",{className:"sm:hidden",children:"Template"})]}):null,V=()=>e.jsx("div",{className:"mt-12 py-5 px-6 bg-indigo-50 rounded-2xl border border-indigo-100",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(se,{size:20,className:"text-indigo-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-1",children:"So funktioniert Smart Briefing"}),e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed",children:"WÃ¤hle ein Template aus, gib deine spezifischen Informationen ein (z.B. Unternehmen, Position), und erhalte ein maÃŸgeschneidertes Briefing mit Insider-Wissen, Fachbegriffen und cleveren RÃ¼ckfragen."})]})]})}),_=N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>h(null),children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-[400px] w-full shadow-2xl transform transition-all",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-red-50 flex items-center justify-center",children:e.jsx(q,{size:24,className:"text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Template lÃ¶schen?"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Diese Aktion kann nicht rÃ¼ckgÃ¤ngig gemacht werden."})]})]}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-5",children:e.jsx("p",{className:"text-sm text-slate-700",children:e.jsx("strong",{children:N.title})})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(ee,{variant:"secondary",onClick:()=>h(null),children:"Abbrechen"}),e.jsx(ee,{variant:"danger",onClick:C,children:"LÃ¶schen"})]})]})});return e.jsxs(e.Fragment,{children:[e.jsx(ht,{featureId:"smartbriefing",showOnMount:!0}),e.jsx(bt,{title:"Smart Briefing",subtitle:"Dein KI-gestÃ¼tzter Vorbereitungs-Assistent",headerIcon:M,headerActions:e.jsx(ut,{featureId:"smartbriefing",size:"sm"}),fetchScenarios:c,moduleKey:"briefings",historyButtonLabel:"Meine Briefings",onNavigateToHistory:j,onSelectScenario:n,renderCardMeta:v,renderCategoryBadge:z,getIconForScenario:R,getCardCustomActions:I,getCardClassName:A,cardActionLabel:"Briefing erstellen",cardActionIcon:Pe,categoryField:"category",additionalCategories:[{key:P.key,label:P.label,shortLabel:P.shortLabel,color:P.color,bgColor:P.bgColor,icon:P.icon,IconComponent:P.icon,filterFn:p=>p.is_custom===!0}],emptyStateIcon:M,emptyStateTitle:"Keine Templates gefunden",emptyStateMessage:"Es wurden noch keine Briefing-Templates erstellt.",searchPlaceholder:"Briefings durchsuchen...",filterActions:$,renderInfoBox:V,extraContent:_,isAuthenticated:a,requireAuth:d,setPendingAction:m,demoCode:u,loadingMessage:"Templates werden geladen..."},r)]})},vt=({template:n,onBack:j,onBriefingGenerated:g,isAuthenticated:o})=>{const[b,a]=i.useState({}),[d,m]=i.useState({}),[u,N]=i.useState(!1),[h,r]=i.useState(null),[x,c]=i.useState(""),[w,f]=i.useState(!1),S=jt(n?.icon);i.useEffect(()=>{if(n?.variables_schema){const v={};n.variables_schema.forEach(z=>{z.default&&(v[z.key]=z.default)}),a(v)}c(""),f(!1)},[n]);const l=(v,z)=>{a(A=>({...A,[v]:z})),d[v]&&m(A=>{const I={...A};return delete I[v],I})},C=()=>{const v={};return n?.variables_schema?.forEach(z=>{z.required&&!b[z.key]&&(v[z.key]="Dieses Feld ist erforderlich")}),v},R=async v=>{v.preventDefault();const z=C();if(Object.keys(z).length>0){m(z);return}N(!0),r(null);try{const A={template_id:n.id,variables:b};x.trim()&&(A.additional_info=x.trim());const I=await U.request("/smartbriefing/generate",{method:"POST",body:JSON.stringify(A)});if(I.success&&I.data?.briefing)g(I.data.briefing);else throw new Error("Unerwartete API-Antwort")}catch(A){console.error("[SmartBriefing] Error generating briefing:",A),r(A.message||"Fehler beim Generieren des Briefings")}finally{N(!1)}};return n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 pt-8 max-w-[700px] mx-auto",children:[e.jsxs("button",{onClick:j,disabled:u,className:`flex items-center gap-2 py-2 border-none bg-transparent text-slate-500 text-sm font-medium cursor-pointer mb-6 transition-opacity ${u?"opacity-50 cursor-not-allowed":"hover:text-slate-700"}`,children:[e.jsx(Oe,{size:18}),e.jsx("span",{className:"leading-relaxed",children:"ZurÃ¼ck zur Ãœbersicht"})]}),e.jsx(te,{className:"p-6 mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(S,{size:28,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[22px] font-bold text-slate-900 mb-1",children:n.title}),e.jsx("p",{className:"text-sm text-slate-500",children:n.description})]})]})}),e.jsxs(te,{className:"p-6",children:[e.jsx("h2",{className:"text-base font-semibold text-slate-900 mb-5 pb-4 border-b border-slate-100",children:"Deine Angaben"}),e.jsxs("form",{onSubmit:R,children:[n.variables_schema?.map(v=>e.jsx(ft,{field:v,value:b[v.key],onChange:l,error:d[v.key]},v.key)),n.allow_custom_variables&&e.jsxs("div",{className:"mt-6 mb-5 pt-5 border-t border-slate-100",children:[e.jsxs("button",{type:"button",onClick:()=>f(!w),className:"flex items-center gap-2 p-0 border-none bg-transparent text-slate-500 text-sm font-medium cursor-pointer text-left",children:[w?e.jsx(Se,{size:18}):e.jsx(ye,{size:18}),e.jsx("span",{className:"leading-relaxed",children:"ZusÃ¤tzliche Informationen (optional)"})]}),w&&e.jsxs("div",{className:"mt-4 bg-slate-50 rounded-xl p-4",children:[e.jsx("p",{className:"text-[13px] text-slate-500 mb-3",children:"ErgÃ¤nze hier alles, was dein Briefing noch relevanter machen kÃ¶nnte."}),e.jsx("textarea",{value:x,onChange:v=>c(v.target.value),placeholder:"z.B. besondere Erfahrungen, spezifische Herausforderungen, wichtige Hintergrundinformationen...",rows:4,className:"w-full py-3 px-3.5 rounded-lg border border-slate-200 bg-white text-sm resize-y min-h-[100px] box-border outline-none focus:border-primary focus:ring-2 focus:ring-primary/10 placeholder:text-slate-400"})]})]}),h&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-5 flex items-start gap-3",children:[e.jsx(X,{size:20,className:"text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:h})]}),e.jsx(ee,{type:"submit",disabled:u,size:"lg",fullWidth:!0,icon:e.jsx(Ce,{size:20}),children:"Briefing generieren"})]})]})]}),e.jsx(gt,{isLoading:u,message:"Smart Briefing wird erstellt...",subMessage:"Die KI analysiert deine Angaben und erstellt ein maÃŸgeschneidertes Briefing."})]}):null},St={"file-text":M,briefcase:le,banknote:ae,users:je,user:fe,"message-circle":ie,target:re,award:ge,book:be,clipboard:pe,star:ue,lightbulb:se,shield:he,compass:xe,rocket:ne},Ct=({content:n})=>{if(!n)return null;const j=o=>{const b=o.split(`
`),a=[];let d=[],m=null;const u=()=>{d.length>0&&(a.push(e.jsx("ul",{className:"my-3 pl-6 list-none",children:d.map((N,h)=>e.jsxs("li",{className:"mb-2 text-[15px] leading-relaxed text-gray-700 relative pl-5",children:[e.jsx("span",{className:"absolute left-0 text-primary font-bold",children:m==="number"?`${h+1}.`:"â€¢"}),g(N)]},h))},`list-${a.length}`)),d=[],m=null)};return b.forEach((N,h)=>{const r=N.trim();if(!r){u();return}if(r.startsWith("### ")){u(),a.push(e.jsx("h3",{className:`text-lg font-bold text-slate-900 my-6 mb-3 pt-4 flex items-center gap-2 ${h>0?"border-t border-slate-100":""}`,children:g(r.substring(4))},`h3-${h}`));return}if(r.startsWith("## ")){u(),a.push(e.jsx("h2",{className:"text-xl font-bold text-slate-900 my-7 mb-3.5",children:g(r.substring(3))},`h2-${h}`));return}if(r.startsWith("# ")){u(),a.push(e.jsx("h1",{className:"text-2xl font-bold text-slate-900 my-8 mb-4",children:g(r.substring(2))},`h1-${h}`));return}if(r.startsWith("- ")||r.startsWith("* ")){m!=="bullet"&&(u(),m="bullet"),d.push(r.substring(2));return}const x=r.match(/^(\d+)\.\s/);if(x){m!=="number"&&(u(),m="number"),d.push(r.substring(x[0].length));return}u(),a.push(e.jsx("p",{className:"my-3 text-[15px] leading-relaxed text-gray-700",children:g(r)},`p-${h}`))}),u(),a},g=o=>{const b=[];let a=o,d=0;for(;a.length>0;){const m=a.match(/\*\*(.+?)\*\*/),u=a.match(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)|_([^_]+)_")),N=a.match(/`([^`]+)`/),h=[{match:m,type:"bold"},{match:u,type:"italic"},{match:N,type:"code"}].filter(x=>x.match);if(h.length===0){b.push(a);break}const r=h.reduce((x,c)=>(x.match?.index??1/0)<(c.match?.index??1/0)?x:c);switch(r.match.index>0&&b.push(a.substring(0,r.match.index)),r.type){case"bold":b.push(e.jsx("strong",{className:"font-semibold text-slate-900",children:r.match[1]},d++));break;case"italic":b.push(e.jsx("em",{className:"italic",children:r.match[1]||r.match[2]},d++));break;case"code":b.push(e.jsx("code",{className:"bg-slate-100 px-1.5 py-0.5 rounded text-[13px] font-mono text-primary",children:r.match[1]},d++));break}a=a.substring(r.match.index+r.match[0].length)}return b};return e.jsx("div",{children:j(n)})},Bt=({briefing:n,template:j,onBack:g,onCreateNew:o,onGenerateAnother:b})=>{const a=Nt(),[d,m]=i.useState(!1),u=i.useRef(null),N=St[j?.icon||n?.template_icon]||M,h=c=>c?new Date(c).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",r=async()=>{try{await navigator.clipboard.writeText(n.content_markdown),m(!0),setTimeout(()=>m(!1),2e3)}catch(c){console.error("[SmartBriefing] Failed to copy:",c)}},x=()=>{const c=`${j?.title||n?.template_title}
${"=".repeat(50)}

Erstellt am: ${h(n.created_at)}

${n.content_markdown}`,w=new Blob([c],{type:"text/plain;charset=utf-8"}),f=URL.createObjectURL(w),S=document.createElement("a");S.href=f,S.download=`briefing-${n.id}.txt`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(f)};return n?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:`bg-brand-gradient sticky top-0 z-40 ${a?"px-4 py-5":"px-8 py-6"}`,children:e.jsxs("div",{className:"max-w-[1400px] mx-auto",children:[g&&e.jsxs("button",{onClick:g,className:"flex items-center gap-1.5 bg-white/15 border-none rounded-lg px-3 py-2 cursor-pointer text-white text-[13px] mb-4 hover:bg-white/25 transition-colors",children:[e.jsx(Oe,{size:16}),"ZurÃ¼ck zur Ãœbersicht"]}),e.jsxs("div",{className:`flex items-center gap-6 ${a?"flex-col items-start gap-4":""}`,children:[e.jsx("div",{className:`rounded-full bg-white/20 flex items-center justify-center flex-shrink-0 ${a?"w-[70px] h-[70px]":"w-[90px] h-[90px]"}`,children:e.jsx(N,{size:a?32:40,color:pt.white})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap mb-2",children:[e.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wide px-2.5 py-1 rounded-full bg-white/20 text-white",children:"Smart Briefing"}),e.jsxs("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-white/90 text-primary flex items-center gap-1",children:[e.jsx(Ce,{size:12}),"Fertig!"]})]}),e.jsx("h1",{className:`font-bold text-white m-0 mb-2 ${a?"text-xl":"text-2xl"}`,children:j?.title||n?.template_title}),e.jsx("div",{className:"flex items-center gap-4 flex-wrap",children:e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(Me,{size:14}),h(n.created_at)]})})]}),!a&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:r,className:`flex items-center gap-2 rounded-xl px-5 py-2.5 cursor-pointer text-white text-sm font-medium border border-white/30 transition-colors ${d?"bg-green-500/30":"bg-white/20 hover:bg-white/30"}`,children:[d?e.jsx(Ie,{size:16}):e.jsx(de,{size:16}),d?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:x,className:"flex items-center gap-2 bg-white/20 border border-white/30 rounded-xl px-5 py-2.5 cursor-pointer text-white text-sm font-medium hover:bg-white/30 transition-colors",children:[e.jsx(Re,{size:16}),"Speichern"]})]})]})]})}),e.jsxs("div",{className:`max-w-[900px] mx-auto ${a?"p-4":"px-8 py-6"}`,children:[a&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("button",{onClick:r,className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-3 rounded-xl border text-[13px] font-medium cursor-pointer transition-colors ${d?"bg-green-50 border-green-200 text-green-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"}`,children:[d?e.jsx(Ie,{size:16}):e.jsx(de,{size:16}),d?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:x,className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 text-[13px] font-medium cursor-pointer hover:bg-slate-50 transition-colors",children:[e.jsx(Re,{size:16}),"Speichern"]})]}),e.jsx("div",{ref:u,className:"bg-white rounded-2xl shadow-sm overflow-hidden border border-slate-200",children:e.jsx("div",{className:a?"p-5":"p-8",children:e.jsx(Ct,{content:n.content_markdown})})}),e.jsxs("div",{className:"flex gap-3 mt-6 flex-wrap",children:[e.jsxs("button",{onClick:b,className:"flex-1 min-w-[200px] flex items-center justify-center gap-2 px-6 py-3.5 rounded-xl border-2 border-primary bg-white text-primary text-[15px] font-semibold cursor-pointer transition-all hover:bg-primary/5",children:[e.jsx(ot,{size:18}),"Mit anderen Angaben neu generieren"]}),e.jsxs("button",{onClick:o,className:"flex-1 min-w-[200px] flex items-center justify-center gap-2 px-6 py-3.5 rounded-xl border-none bg-brand-gradient text-white text-[15px] font-semibold cursor-pointer transition-all shadow-primary/40 shadow-lg hover:shadow-xl",children:[e.jsx(K,{size:18}),"Neues Briefing erstellen"]})]})]})]}):null},zt={"file-text":M,briefcase:le,banknote:ae,users:je,user:fe,"message-circle":ie,target:re,award:ge,book:be,clipboard:pe,star:ue,lightbulb:se,shield:he,compass:xe,rocket:ne},Et=n=>n?new Date(n).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",At=({briefing:n,onOpen:j,onDelete:g,isDeleting:o})=>{const[b,a]=i.useState(!1),[d,m]=i.useState(!1),u=zt[n.template_icon]||M,N=h=>{h.stopPropagation(),d?(g(n.id),m(!1)):(m(!0),setTimeout(()=>m(!1),3e3))};return e.jsxs(te,{onClick:()=>j(n),onMouseEnter:()=>a(!0),onMouseLeave:()=>{a(!1),m(!1)},className:`p-5 cursor-pointer transition-all duration-300 relative ${b?"border-primary shadow-lg -translate-y-0.5":"border-slate-200 hover:border-slate-300"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-[10px] bg-primary/10 flex items-center justify-center",children:e.jsx(u,{size:22,className:"text-primary"})}),e.jsx("button",{onClick:N,disabled:o,className:`p-2 rounded-lg border-none cursor-pointer transition-all ${d?"bg-red-50 text-red-500":b?"bg-slate-100 text-slate-400":"bg-transparent text-slate-400"} ${b||d?"opacity-100":"opacity-0"} ${o?"cursor-not-allowed":""}`,children:o?e.jsx(Be,{size:18,className:"animate-spin"}):e.jsx(q,{size:18})})]}),e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1 leading-tight truncate",children:n.title||"Unbenanntes Briefing"}),e.jsx("p",{className:"text-[13px] text-slate-500 mb-3",children:n.template_title}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-xs",children:[e.jsx(Me,{size:14}),Et(n.created_at)]}),e.jsxs("div",{className:"flex items-center gap-1 text-primary text-[13px] font-medium",children:["Ã–ffnen",e.jsx(Pe,{size:16})]})]}),d&&e.jsx("div",{className:"absolute top-2 right-2 bg-red-50 border border-red-200 rounded-lg py-2 px-3 text-xs text-red-600 font-medium z-10",onClick:h=>h.stopPropagation(),children:"Nochmal klicken zum LÃ¶schen"})]})},$t=({onOpenBriefing:n,onCreateNew:j,isAuthenticated:g})=>{const[o,b]=i.useState([]),[a,d]=i.useState(!0),[m,u]=i.useState(null),[N,h]=i.useState(null);i.useEffect(()=>{(async()=>{if(!g){d(!1);return}try{d(!0),u(null);const c=await U.request("/smartbriefing/briefings",{method:"GET"});if(c.success&&c.data?.briefings){const w=c.data.briefings.filter(f=>f.status==="completed");b(w)}else throw new Error("Unerwartete API-Antwort")}catch(c){console.error("[SmartBriefing] Error fetching briefings:",c),u(c.message||"Fehler beim Laden der Briefings")}finally{d(!1)}})()},[g]);const r=async x=>{try{if(h(x),(await U.request(`/smartbriefing/briefings/${x}`,{method:"DELETE"})).success)b(w=>w.filter(f=>f.id!==x));else throw new Error("Fehler beim LÃ¶schen")}catch(c){console.error("[SmartBriefing] Error deleting briefing:",c),u(c.message||"Fehler beim LÃ¶schen des Briefings")}finally{h(null)}};return g?e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Meine Briefings"}),e.jsxs("p",{className:"text-sm text-slate-500",children:[o.length," gespeicherte Briefings"]})]}),e.jsx(ee,{onClick:j,icon:e.jsx(K,{size:18}),children:"Neues Briefing"})]}),a&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Be,{size:40,className:"text-primary animate-spin"}),e.jsx("p",{className:"mt-4 text-slate-500",children:"Briefings werden geladen..."})]}),m&&!a&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 flex items-start gap-3",children:[e.jsx(X,{size:24,className:"text-red-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base text-red-600 font-medium mb-1",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-sm text-red-700",children:m})]})]}),!a&&!m&&e.jsx(e.Fragment,{children:o.length===0?e.jsxs(te,{className:"py-12 px-6 text-center",children:[e.jsx(_e,{size:48,className:"text-slate-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg text-slate-500 mb-2",children:"Noch keine Briefings"}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Erstelle dein erstes Briefing, um loszulegen."}),e.jsx(ee,{onClick:j,icon:e.jsx(K,{size:18}),children:"Briefing erstellen"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:o.map(x=>e.jsx(At,{briefing:x,onOpen:n,onDelete:r,isDeleting:N===x.id},x.id))})})]}):e.jsx("div",{className:"p-6 max-w-[800px] mx-auto",children:e.jsxs(te,{className:"py-12 px-6 text-center",children:[e.jsx(_e,{size:48,className:"text-slate-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg text-slate-500 mb-2",children:"Anmeldung erforderlich"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Melde dich an, um deine gespeicherten Briefings zu sehen."})]})})},Ke=[{key:"file-text",icon:M,label:"Dokument"},{key:"briefcase",icon:le,label:"Koffer"},{key:"banknote",icon:ae,label:"Geld"},{key:"users",icon:je,label:"Team"},{key:"user",icon:fe,label:"Person"},{key:"target",icon:re,label:"Ziel"},{key:"lightbulb",icon:se,label:"Idee"},{key:"star",icon:ue,label:"Stern"},{key:"shield",icon:he,label:"Schutz"},{key:"compass",icon:xe,label:"Kompass"},{key:"rocket",icon:ne,label:"Rakete"},{key:"message-circle",icon:ie,label:"Nachricht"},{key:"award",icon:ge,label:"Auszeichnung"},{key:"book",icon:be,label:"Buch"},{key:"clipboard",icon:pe,label:"Checkliste"}],Fe=[{value:"text",label:"Einzeiliges Textfeld"},{value:"textarea",label:"Mehrzeiliges Textfeld"},{value:"select",label:"Dropdown-Auswahl"}],Le=[{key:"empty",label:"--- Vorlage wÃ¤hlen ---",icon:M,aiRole:"",sections:[],aiBehavior:"",variables:[]},{key:"sales",label:"ðŸŽ¯ Sales / KundengesprÃ¤ch",icon:re,aiRole:"Du bist ein erfahrener Sales-Coach und Vertriebsexperte mit 15+ Jahren Erfahrung im B2B-Vertrieb.",sections:[{id:"hook",title:"The Hook ðŸª",instruction:"Erstelle einen packenden GesprÃ¤chseinstieg fÃ¼r ${customer_type} Kunden"},{id:"discovery",title:"Discovery Questions ðŸ”",instruction:"Formuliere 5-7 offene Fragen um Bedarf zu wecken und Pain Points zu identifizieren"},{id:"value",title:"Value Proposition ðŸ’Ž",instruction:"Beschreibe den Mehrwert basierend auf ${product_service}"},{id:"objections",title:"Einwandbehandlung ðŸ›¡ï¸",instruction:"Liste typische EinwÃ¤nde und passende Antworten"},{id:"closing",title:"Closing Path ðŸŽ¯",instruction:"Entwickle einen Weg zum Ziel: ${meeting_goal}"}],aiBehavior:"Schreibe praxisnah und actionable. Jeder Punkt soll direkt umsetzbar sein. Vermeide Theorie - fokussiere auf konkrete Formulierungen und Techniken.",variables:[{key:"customer_type",label:"Kundentyp",type:"text",placeholder:"z.B. Enterprise, KMU, Startup"},{key:"product_service",label:"Produkt/Service",type:"text",placeholder:"Was verkaufst du?"},{key:"meeting_goal",label:"Ziel des GesprÃ¤chs",type:"text",placeholder:"z.B. Demo-Termin, Angebot"}]},{key:"career",label:"ðŸ’¼ Karriere / VorstellungsgesprÃ¤ch",icon:le,aiRole:"Du bist ein erfahrener Karriere-Coach und HR-Experte mit umfassender Erfahrung in Bewerbungsprozessen.",sections:[{id:"company",title:"Unternehmens-Insights ðŸ¢",instruction:"Recherchiere wichtige Fakten Ã¼ber ${unternehmen} die im GesprÃ¤ch relevant sind"},{id:"position",title:"Positions-Analyse ðŸ“‹",instruction:"Analysiere die Anforderungen fÃ¼r ${position} und wie der Kandidat diese erfÃ¼llt"},{id:"questions",title:"Typische Fragen â“",instruction:"Liste die 10 wahrscheinlichsten Interviewfragen mit Antwortstrategien"},{id:"stories",title:"STAR-Stories â­",instruction:"Entwickle 3-5 Erfolgsgeschichten nach der STAR-Methode"},{id:"questions_to_ask",title:"Eigene Fragen ðŸ™‹",instruction:"Formuliere 5-7 kluge RÃ¼ckfragen an den Interviewer"}],aiBehavior:"Sei konkret und praxisorientiert. Gib FormulierungsvorschlÃ¤ge die direkt verwendet werden kÃ¶nnen. BerÃ¼cksichtige deutsche GeschÃ¤ftskultur.",variables:[{key:"unternehmen",label:"Unternehmen",type:"text",placeholder:"Name des Unternehmens"},{key:"position",label:"Position",type:"text",placeholder:"Stelle, auf die du dich bewirbst"}]},{key:"negotiation",label:"ðŸ’° Gehaltsverhandlung",icon:ae,aiRole:"Du bist ein Experte fÃ¼r Gehaltsverhandlungen und Karriereentwicklung.",sections:[{id:"market",title:"Marktanalyse ðŸ“Š",instruction:"Analysiere Gehaltsspannen fÃ¼r ${position} in ${branche} und ${region}"},{id:"arguments",title:"Argumente ðŸ’ª",instruction:"Entwickle 5-7 Ã¼berzeugende Argumente fÃ¼r eine GehaltserhÃ¶hung basierend auf ${erfolge}"},{id:"counter",title:"Konterstrategien ðŸ›¡ï¸",instruction:"Bereite Antworten auf typische Gegenargumente des Arbeitgebers vor"},{id:"tactics",title:"Verhandlungstaktiken ðŸŽ¯",instruction:"Beschreibe bewÃ¤hrte Taktiken fÃ¼r die Gehaltsverhandlung"},{id:"alternatives",title:"Alternativen ðŸ”„",instruction:"Liste nicht-monetÃ¤re Benefits die verhandelbar sind"}],aiBehavior:"Fokussiere auf konkrete Zahlen und Formulierungen. Sei selbstbewusst aber nicht arrogant im Ton.",variables:[{key:"position",label:"Position",type:"text",placeholder:"Deine aktuelle/angestrebte Position"},{key:"branche",label:"Branche",type:"text",placeholder:"z.B. IT, Finanzen, Marketing"},{key:"region",label:"Region",type:"text",placeholder:"z.B. MÃ¼nchen, Berlin, Remote"},{key:"erfolge",label:"Deine Erfolge",type:"textarea",placeholder:"Beschreibe deine wichtigsten Leistungen"}]},{key:"presentation",label:"ðŸŽ¤ PrÃ¤sentation / Pitch",icon:ne,aiRole:"Du bist ein PrÃ¤sentations-Coach und Storytelling-Experte.",sections:[{id:"hook",title:"ErÃ¶ffnung ðŸŽ¬",instruction:"Erstelle einen aufmerksamkeitsstarken Einstieg fÃ¼r ${thema}"},{id:"problem",title:"Problem/Herausforderung âš¡",instruction:"Beschreibe das Problem das ${zielgruppe} hat"},{id:"solution",title:"LÃ¶sung/Angebot ðŸ’¡",instruction:"PrÃ¤sentiere die LÃ¶sung klar und Ã¼berzeugend"},{id:"proof",title:"Beweise/Beispiele ðŸ“ˆ",instruction:"Liste Erfolgsbeispiele, Zahlen und Social Proof"},{id:"cta",title:"Call-to-Action ðŸŽ¯",instruction:"Formuliere einen klaren nÃ¤chsten Schritt"}],aiBehavior:"Schreibe in aktivem, energetischem Stil. Jeder Abschnitt soll eine klare Botschaft haben. Nutze Storytelling-Elemente.",variables:[{key:"thema",label:"Thema der PrÃ¤sentation",type:"text",placeholder:"WorÃ¼ber prÃ¤sentierst du?"},{key:"zielgruppe",label:"Zielgruppe",type:"text",placeholder:"Wer ist dein Publikum?"}]},{key:"feedback",label:"ðŸ’¬ Feedback-GesprÃ¤ch",icon:ie,aiRole:"Du bist ein erfahrener Leadership-Coach und Experte fÃ¼r MitarbeiterfÃ¼hrung.",sections:[{id:"context",title:"GesprÃ¤chsrahmen ðŸ“‹",instruction:"Bereite den Rahmen fÃ¼r das Feedback-GesprÃ¤ch mit ${mitarbeiter_name} vor"},{id:"positive",title:"StÃ¤rken & Erfolge â­",instruction:"Liste konkrete positive Beobachtungen und Erfolge"},{id:"development",title:"Entwicklungsfelder ðŸŒ±",instruction:"Beschreibe Verbesserungspotenziale konstruktiv"},{id:"goals",title:"Zielvereinbarung ðŸŽ¯",instruction:"Formuliere SMART-Ziele fÃ¼r die nÃ¤chste Periode"},{id:"support",title:"UnterstÃ¼tzungsangebote ðŸ¤",instruction:"Liste mÃ¶gliche UnterstÃ¼tzungsmaÃŸnahmen"}],aiBehavior:"Schreibe wertschÃ¤tzend und konstruktiv. Fokussiere auf Verhalten, nicht auf PersÃ¶nlichkeit. Nutze die SBI-Methode (Situation-Behavior-Impact).",variables:[{key:"mitarbeiter_name",label:"Name des Mitarbeiters",type:"text",placeholder:'Vorname oder "der Mitarbeiter"'}]}],O=()=>`var_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Dt=()=>({id:O(),key:"",label:"",type:"text",required:!0,placeholder:"",options:[]}),It=()=>({id:O(),value:"",label:""}),Rt=()=>({id:O(),title:"",instruction:""}),_t=({variable:n,index:j,total:g,onChange:o,onDelete:b,onMoveUp:a,onMoveDown:d})=>{const[m,u]=i.useState(!0),[N,h]=i.useState(n.label);i.useEffect(()=>{h(n.label)},[n.label]);const r=(l,C)=>{o({...n,[l]:C})},x=()=>{const l=[...n.options||[],It()];o({...n,options:l})},c=(l,C,R)=>{const v=n.options.map(z=>z.id===l?{...z,[C]:R}:z);o({...n,options:v})},w=l=>{const C=n.options.filter(R=>R.id!==l);o({...n,options:C})},f=l=>l.toLowerCase().replace(/[Ã¤Ã¶Ã¼ÃŸ]/g,C=>({Ã¤:"ae",Ã¶:"oe",Ã¼:"ue",ÃŸ:"ss"})[C]).replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),S=()=>{if(N!==n.label){const l={label:N};(!n.key||n.key===f(n.label))&&(l.key=f(N)),o({...n,...l})}};return e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 mb-3 overflow-hidden",children:[e.jsxs("div",{className:`flex items-center gap-2 px-4 py-3 bg-white cursor-pointer ${m?"border-b border-slate-200":""}`,onClick:()=>u(!m),children:[e.jsx(Ve,{size:16,className:"text-slate-400 cursor-grab"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:n.label||`Variable ${j+1}`}),n.key&&e.jsxs("span",{className:"ml-2 text-slate-500 text-xs",children:["$","{","$",n.key,"}"]})]}),e.jsx("span",{className:"px-2 py-0.5 rounded text-[11px] font-medium bg-primary/10 text-primary",children:Fe.find(l=>l.value===n.type)?.label||n.type}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),a()},disabled:j===0,className:`p-1 border-none bg-transparent ${j===0?"cursor-not-allowed opacity-30":"cursor-pointer"}`,children:e.jsx(Se,{size:16,className:"text-slate-500"})}),e.jsx("button",{onClick:l=>{l.stopPropagation(),d()},disabled:j===g-1,className:`p-1 border-none bg-transparent ${j===g-1?"cursor-not-allowed opacity-30":"cursor-pointer"}`,children:e.jsx(ye,{size:16,className:"text-slate-500"})})]}),e.jsx("button",{onClick:l=>{l.stopPropagation(),b()},className:"p-1.5 border-none bg-transparent cursor-pointer text-red-500",children:e.jsx(q,{size:16})})]}),e.jsx(ze,{children:m&&e.jsx(me.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs("div",{className:"p-4 flex flex-col gap-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Feldbezeichnung *"}),e.jsx("input",{type:"text",value:N,onChange:l=>h(l.target.value),onBlur:S,placeholder:"z.B. Unternehmen",className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Variablenname *"}),e.jsx("input",{type:"text",value:n.key,onChange:l=>r("key",l.target.value),placeholder:"z.B. unternehmen",className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm font-mono"})]})]}),e.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Feldtyp"}),e.jsx("select",{value:n.type,onChange:l=>r("type",l.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm bg-white",children:Fe.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("label",{className:"flex items-center gap-2 py-2.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n.required,onChange:l=>r("required",l.target.checked),className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"text-sm text-slate-600",children:"Pflichtfeld"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Platzhalter-Text (optional)"}),e.jsx("input",{type:"text",value:n.placeholder,onChange:l=>r("placeholder",l.target.value),placeholder:"z.B. BMW AG, Siemens, etc.",className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm"})]}),n.type==="select"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-2",children:"Auswahloptionen"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[(n.options||[]).map(l=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"text",value:l.value,onChange:C=>c(l.id,"value",C.target.value),placeholder:"Wert",className:"flex-1 px-2.5 py-2 rounded-md border border-slate-200 text-[13px] font-mono"}),e.jsx("input",{type:"text",value:l.label,onChange:C=>c(l.id,"label",C.target.value),placeholder:"Anzeigename",className:"flex-[2] px-2.5 py-2 rounded-md border border-slate-200 text-[13px]"}),e.jsx("button",{onClick:()=>w(l.id),className:"p-1.5 border-none bg-transparent cursor-pointer text-red-500",children:e.jsx(q,{size:14})})]},l.id)),e.jsxs("button",{onClick:x,className:"flex items-center gap-1.5 px-3 py-2 border border-dashed border-slate-300 rounded-md bg-transparent text-slate-500 text-[13px] cursor-pointer mt-1 hover:bg-slate-50",children:[e.jsx(K,{size:14}),"Option hinzufÃ¼gen"]})]})]})]})})})]})},Tt=({section:n,index:j,total:g,variables:o,onChange:b,onDelete:a,onMoveUp:d,onMoveDown:m,onInsertVariable:u})=>{const N=i.useRef(null),h=(x,c)=>{b({...n,[x]:c})},r=x=>{const c=N.current;if(c){const w=c.selectionStart,f=c.selectionEnd,S=n.instruction,l=`\${${x}}`,C=S.substring(0,w)+l+S.substring(f);h("instruction",C),setTimeout(()=>{c.focus(),c.setSelectionRange(w+l.length,w+l.length)},0)}else h("instruction",n.instruction+`\${${x}}`)};return e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 mb-3 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-gradient-to-r from-indigo-50 to-violet-50 border-b border-slate-200",children:[e.jsx(Ve,{size:16,className:"text-slate-400 cursor-grab"}),e.jsx("span",{className:"w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 text-xs font-bold flex items-center justify-center",children:j+1}),e.jsx("input",{type:"text",value:n.title,onChange:x=>h("title",x.target.value),placeholder:"Abschnittstitel (z.B. 'Discovery Questions ðŸ”')",className:"flex-1 px-2 py-1 rounded border-0 bg-transparent text-sm font-semibold text-slate-800 placeholder:text-slate-400"}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("button",{onClick:d,disabled:j===0,className:`p-1 border-none bg-transparent ${j===0?"opacity-30":"cursor-pointer"}`,children:e.jsx(Se,{size:16,className:"text-slate-500"})}),e.jsx("button",{onClick:m,disabled:j===g-1,className:`p-1 border-none bg-transparent ${j===g-1?"opacity-30":"cursor-pointer"}`,children:e.jsx(ye,{size:16,className:"text-slate-500"})})]}),e.jsx("button",{onClick:a,className:"p-1.5 border-none bg-transparent cursor-pointer text-red-500 hover:bg-red-50 rounded",children:e.jsx(q,{size:16})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Anweisung fÃ¼r diesen Abschnitt"}),o.length>0&&e.jsx(we,{variables:o,onSelect:r})]}),e.jsx("textarea",{ref:N,value:n.instruction,onChange:x=>h("instruction",x.target.value),placeholder:"z.B. 'Erstelle 5-7 offene Fragen um Bedarf zu wecken basierend auf ${customer_type}'",rows:2,className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm resize-y"})]})]})},we=({variables:n,onSelect:j})=>{const[g,o]=i.useState(!1),b=i.useRef(null);return i.useEffect(()=>{const a=d=>{b.current&&!b.current.contains(d.target)&&o(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),n.length===0?null:e.jsxs("div",{className:"relative",ref:b,children:[e.jsxs("button",{onClick:()=>o(!g),className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-md bg-indigo-50 text-indigo-600 text-xs font-medium border-none cursor-pointer hover:bg-indigo-100 transition-colors",children:[e.jsx(K,{size:14}),"Variable einfÃ¼gen",e.jsx(ye,{size:14,className:`transition-transform ${g?"rotate-180":""}`})]}),e.jsx(ze,{children:g&&e.jsx(me.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"absolute right-0 top-full mt-1 bg-white rounded-lg shadow-lg border border-slate-200 z-50 min-w-[180px] py-1",children:n.map(a=>e.jsxs("button",{onClick:()=>{j(a.key),o(!1)},className:"w-full px-3 py-2.5 text-left text-sm hover:bg-indigo-50 border-none bg-transparent cursor-pointer flex items-center justify-between gap-3",children:[e.jsx("span",{className:"text-slate-800 font-medium",children:a.label}),e.jsxs("code",{className:"text-xs text-indigo-700 bg-indigo-100 px-2 py-1 rounded font-mono font-semibold whitespace-nowrap",children:["$","{","$",a.key,"}"]})]},a.id))})})]})},Ft=({selectedIcon:n,onSelect:j})=>e.jsx("div",{className:"flex flex-wrap gap-3",children:Ke.map(({key:g,icon:o,label:b})=>{const a=n===g;return e.jsx("button",{onClick:()=>j(g),title:b,className:`w-[60px] h-[60px] rounded-xl border-2 flex items-center justify-center cursor-pointer transition-all ${a?"border-primary bg-primary/10":"border-slate-200 bg-white hover:border-primary/40"}`,children:e.jsx(o,{size:28,className:a?"text-primary":"text-slate-500"})},g)})}),Lt=({isOpen:n,onClose:j,onSave:g,editTemplate:o=null,demoCode:b})=>{const[a,d]=i.useState(""),[m,u]=i.useState(""),[N,h]=i.useState("file-text"),[r,x]=i.useState([]),[c,w]=i.useState(""),[f,S]=i.useState([]),[l,C]=i.useState(""),[R,v]=i.useState("empty"),[z,A]=i.useState(!1),[I,$]=i.useState(null),[V,_]=i.useState("basics"),[p,k]=i.useState(null),[L,G]=i.useState(null),[F,Z]=i.useState(!1),oe=i.useRef(null),ce=i.useRef(null),Ne=t=>{if(!t)return{aiRole:"",sections:[],aiBehavior:""};let s="",y=[],B="";const T=t.match(/\n*WICHTIG:\s*([\s\S]*?)$/i);T&&(B=T[1].trim(),t=t.replace(T[0],"").trim());const J=/###\s*\d+\.\s*([^\n]+)\n([\s\S]*?)(?=###\s*\d+\.|$)/g;let Y;const H=[];for(;(Y=J.exec(t))!==null;)H.push({id:O(),title:Y[1].trim(),instruction:Y[2].trim()});if(H.length>0){y=H;const Q=t.indexOf("###"),ke=t.indexOf("Erstelle ein strukturiertes Briefing");ke!==-1&&ke<Q?s=t.substring(0,ke).trim():Q!==-1&&(s=t.substring(0,Q).trim())}else s=t;return{aiRole:s,sections:y,aiBehavior:B}};i.useEffect(()=>{if(o){if(d(o.title||""),u(o.description||""),h(o.icon||"file-text"),x((o.variables_schema||[]).map(t=>({...t,id:t.id||O(),options:(t.options||[]).map(s=>({...s,id:s.id||O()}))}))),o.ai_role){if(w(o.ai_role),o.ai_task)try{const t=JSON.parse(o.ai_task);Array.isArray(t)&&S(t.map(s=>({...s,id:s.id||O()})))}catch{S([{id:O(),title:"Hauptabschnitt",instruction:o.ai_task}])}C(o.ai_behavior||"")}else if(o.system_prompt){const t=Ne(o.system_prompt);w(t.aiRole),S(t.sections),C(t.aiBehavior)}Z(o.allow_user_variables||!1),v("empty")}else d(""),u(""),h("file-text"),x([]),w(""),S([]),C(""),Z(!1),v("empty");_("basics"),$(null),G(null)},[o,n]);const E=()=>c.trim()||f.length>0||l.trim()||r.length>0,W=t=>{const s=Le.find(y=>y.key===t);if(!s||t==="empty"){v("empty");return}E()?k(s):Ee(s)},Ee=t=>{v(t.key),w(t.aiRole),S(t.sections.map(s=>({...s,id:O()}))),C(t.aiBehavior),h(Ke.find(s=>s.icon===t.icon)?.key||"file-text"),t.variables&&t.variables.length>0&&x(t.variables.map(s=>({...s,id:O(),required:!0,options:[]}))),k(null)},Ue=()=>{k(null)},Ge=()=>{x([...r,Dt()])},We=(t,s)=>{const y=[...r];y[t]=s,x(y)},He=t=>{x(r.filter((s,y)=>y!==t))},qe=t=>{if(t===0)return;const s=[...r];[s[t-1],s[t]]=[s[t],s[t-1]],x(s)},Ze=t=>{if(t===r.length-1)return;const s=[...r];[s[t],s[t+1]]=[s[t+1],s[t]],x(s)},Je=()=>{S([...f,Rt()])},Ye=(t,s)=>{const y=[...f];y[t]=s,S(y)},Qe=t=>{S(f.filter((s,y)=>y!==t))},Xe=t=>{if(t===0)return;const s=[...f];[s[t-1],s[t]]=[s[t],s[t-1]],S(s)},et=t=>{if(t===f.length-1)return;const s=[...f];[s[t],s[t+1]]=[s[t+1],s[t]],S(s)},Ae=(t,s,y,B)=>{const T=t.current;if(T){const J=T.selectionStart,Y=T.selectionEnd,H=`\${${B}}`,Q=y.substring(0,J)+H+y.substring(Y);s(Q),setTimeout(()=>{T.focus(),T.setSelectionRange(J+H.length,J+H.length)},0)}else s(y+`\${${B}}`)},$e=()=>{let t=c+`

`;return f.length>0&&(t+=`Erstelle ein strukturiertes Briefing mit folgenden Abschnitten:

`,f.forEach((s,y)=>{t+=`### ${y+1}. ${s.title}
${s.instruction}

`})),l&&(t+=`
WICHTIG: ${l}`),t},tt=()=>{const t=$e(),s=/\$\{(\w+)\}/g,y=[];let B;for(;(B=s.exec(t))!==null;)y.includes(B[1])||y.push(B[1]);return y},De=()=>{const t=tt(),s=r.map(B=>B.key).filter(B=>B.trim()),y=t.filter(B=>!s.includes(B));return{success:y.length===0,undefinedVars:y,usedVariables:t,definedKeys:s}},st=()=>{const t=De();return G(t),t.success?$(null):($(`Undefinierte Variablen im Prompt gefunden: ${t.undefinedVars.map(s=>"${"+s+"}").join(", ")}`),_("prompt")),t.success},nt=()=>{if(!a.trim())return $("Bitte gib einen Titel ein."),_("basics"),!1;if(!c.trim())return $("Bitte definiere eine KI-Rolle."),_("prompt"),!1;if(f.length===0)return $("Bitte fÃ¼ge mindestens einen Abschnitt hinzu."),_("prompt"),!1;for(const s of f)if(!s.title.trim())return $("Alle Abschnitte benÃ¶tigen einen Titel."),_("prompt"),!1;for(const s of r){if(!s.key.trim()||!s.label.trim())return $("Alle Variablen benÃ¶tigen einen Namen und eine Bezeichnung."),_("variables"),!1;if(s.type==="select"&&(!s.options||s.options.length===0))return $(`Variable "${s.label}" benÃ¶tigt mindestens eine Auswahloption.`),_("variables"),!1}const t=De();return G(t),t.success?!0:($(`Undefinierte Variablen im Prompt: ${t.undefinedVars.map(s=>"${"+s+"}").join(", ")}. Bitte definiere diese Variablen unter "Eingabefelder".`),_("prompt"),!1)},rt=async()=>{if($(null),!!nt()){A(!0);try{const t=r.map(B=>({key:B.key,label:B.label,type:B.type,required:B.required,placeholder:B.placeholder,...B.type==="select"?{options:B.options.map(T=>({value:T.value,label:T.label}))}:{}})),s={title:a.trim(),description:m.trim(),icon:N,ai_role:c,ai_task:JSON.stringify(f.map(B=>({title:B.title,instruction:B.instruction}))),ai_behavior:l,system_prompt:$e(),variables_schema:t,allow_user_variables:F,...b?{demo_code:b}:{}};let y;if(o?y=await U.request(`/smartbriefing/templates/${o.id}`,{method:"PUT",body:JSON.stringify(s)}):y=await U.request("/smartbriefing/templates",{method:"POST",body:JSON.stringify(s)}),y.success)g?.(y.data.template),j();else throw new Error(y.message||"Fehler beim Speichern")}catch(t){console.error("[CreateTemplateDialog] Save error:",t),$(t.message||"Fehler beim Speichern des Templates")}finally{A(!1)}}};return n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(me.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl w-full max-w-[750px] max-h-[90vh] flex flex-col shadow-2xl overflow-hidden",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-5 border-b border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"m-0 text-xl font-bold text-slate-900",children:o?"Template bearbeiten":"Neues Template erstellen"}),e.jsx("p",{className:"mt-1 mb-0 text-sm text-slate-500",children:"Erstelle ein persÃ¶nliches Briefing-Template"})]}),e.jsx("button",{onClick:j,className:"p-2 border-none bg-slate-100 rounded-lg cursor-pointer hover:bg-slate-200 transition-colors",children:e.jsx(ct,{size:20,className:"text-slate-500"})})]}),e.jsx("div",{className:"flex border-b border-slate-200 px-6 gap-1",children:[{key:"basics",label:"1. Grundlagen"},{key:"variables",label:"2. Eingabefelder"},{key:"prompt",label:"3. KI-Anweisung"}].map(t=>{const s=V===t.key;return e.jsx("button",{onClick:()=>_(t.key),className:"px-5 py-3 text-sm font-semibold cursor-pointer transition-all rounded-t-lg",style:{backgroundColor:s?"#E0E7FF":"transparent",color:s?"#4338CA":"#64748B",borderBottom:s?"3px solid #4F46E5":"3px solid transparent",marginBottom:"-1px"},children:t.label},t.key)})}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[I&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg px-4 py-3 mb-4 flex items-center gap-2",children:[e.jsx(X,{size:18,className:"text-red-500 flex-shrink-0"}),e.jsx("span",{className:"text-red-700 text-sm",children:I})]}),V==="basics"&&e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-violet-50 rounded-xl p-4 border border-indigo-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ce,{size:18,className:"text-indigo-600"}),e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:o?"Vorlage anwenden":"Schnellstart mit Vorlage"})]}),e.jsx("select",{value:R,onChange:t=>W(t.target.value),className:"w-full px-3.5 py-3 rounded-xl border border-indigo-200 text-sm bg-white cursor-pointer",children:Le.map(t=>e.jsx("option",{value:t.key,children:t.label},t.key))}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:o?"WÃ¤hle eine Vorlage, um die KI-Anweisungen zu ersetzen. Titel und Beschreibung bleiben erhalten.":"Eine Vorlage fÃ¼llt Eingabefelder und KI-Anweisungen automatisch aus."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-1.5",children:"Titel *"}),e.jsx("input",{type:"text",value:a,onChange:t=>d(t.target.value),placeholder:"z.B. Sales Discovery Call Prep",className:"w-full px-3.5 py-3 rounded-xl border border-slate-200 text-[15px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-1.5",children:"Beschreibung"}),e.jsx("textarea",{value:m,onChange:t=>u(t.target.value),placeholder:"Kurze Beschreibung, wofÃ¼r dieses Template verwendet wird...",rows:3,className:"w-full px-3.5 py-3 rounded-xl border border-slate-200 text-sm resize-y"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-2",children:"Symbol"}),e.jsx(Ft,{selectedIcon:N,onSelect:h})]})]}),V==="variables"&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Te,{size:16,className:"text-slate-500"}),e.jsxs("span",{className:"text-[13px] text-slate-500",children:["Definiere die Eingabefelder, die der Nutzer beim Erstellen eines Briefings ausfÃ¼llen soll. Diese kÃ¶nnen dann im Prompt als $","{variablenname}"," verwendet werden."]})]})}),r.map((t,s)=>e.jsx(_t,{variable:t,index:s,total:r.length,onChange:y=>We(s,y),onDelete:()=>He(s),onMoveUp:()=>qe(s),onMoveDown:()=>Ze(s)},t.id)),e.jsxs("button",{onClick:Ge,className:"flex items-center justify-center gap-2 w-full px-3.5 py-3.5 rounded-xl border-2 border-dashed border-slate-300 bg-white text-slate-500 text-sm font-medium cursor-pointer transition-all hover:border-primary hover:text-primary",children:[e.jsx(K,{size:18}),"Eingabefeld hinzufÃ¼gen"]}),r.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Noch keine Eingabefelder definiert."}),e.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:F,onChange:t=>Z(t.target.checked),className:"w-5 h-5 accent-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:"Nutzer darf eigene Variablen hinzufÃ¼gen"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Wenn aktiviert, kann der Nutzer beim Erstellen eines Briefings eigene zusÃ¤tzliche Eingabefelder definieren."})]})]})})]}),V==="prompt"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"KI-Rolle *"}),r.length>0&&e.jsx(we,{variables:r,onSelect:t=>Ae(oe,w,c,t)})]}),e.jsx("textarea",{ref:oe,value:c,onChange:t=>w(t.target.value),placeholder:"z.B. 'Du bist ein erfahrener Sales-Coach mit 15+ Jahren B2B-Vertriebserfahrung...'",rows:3,className:"w-full px-3.5 py-3 rounded-xl border border-slate-200 text-sm resize-y"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"Briefing-Abschnitte *"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[f.length," Abschnitt",f.length!==1?"e":""]})]}),f.map((t,s)=>e.jsx(Tt,{section:t,index:s,total:f.length,variables:r,onChange:y=>Ye(s,y),onDelete:()=>Qe(s),onMoveUp:()=>Xe(s),onMoveDown:()=>et(s)},t.id)),e.jsxs("button",{onClick:Je,className:"flex items-center justify-center gap-2 w-full px-3.5 py-3 rounded-xl border-2 border-dashed border-indigo-300 bg-indigo-50/50 text-indigo-600 text-sm font-medium cursor-pointer transition-all hover:bg-indigo-100",children:[e.jsx(K,{size:18}),"Abschnitt hinzufÃ¼gen"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"Verhalten & Stil (optional)"}),r.length>0&&e.jsx(we,{variables:r,onSelect:t=>Ae(ce,C,l,t)})]}),e.jsx("textarea",{ref:ce,value:l,onChange:t=>C(t.target.value),placeholder:"z.B. 'Schreibe praxisnah und actionable. Vermeide Theorie - fokussiere auf konkrete Formulierungen.'",rows:2,className:"w-full px-3.5 py-3 rounded-xl border border-slate-200 text-sm resize-y"})]}),r.length>0&&e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Te,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-semibold text-slate-500",children:"VerfÃ¼gbare Variablen (klicken zum Kopieren)"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(t=>e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(`\${${t.key}}`)},className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 bg-white rounded-lg border border-slate-200 text-xs cursor-pointer hover:border-indigo-300 hover:bg-indigo-50 transition-colors",children:[e.jsx("span",{className:"text-slate-600",children:t.label}),e.jsxs("code",{className:"font-mono text-indigo-600",children:["$","{","$",t.key,"}"]}),e.jsx(de,{size:12,className:"text-slate-400"})]},t.id))})]})]})]}),L&&e.jsx("div",{className:`px-6 py-3 border-t ${L.success?"bg-green-50 border-green-200":"bg-amber-50 border-amber-200"}`,children:e.jsx("div",{className:"flex items-center gap-2",children:L.success?e.jsxs(e.Fragment,{children:[e.jsx(dt,{size:18,className:"text-green-600"}),e.jsxs("span",{className:"text-green-700 text-sm font-medium",children:["Syntax OK - Alle ",L.usedVariables.length," Variablen sind definiert."]})]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{size:18,className:"text-amber-600"}),e.jsxs("span",{className:"text-amber-700 text-sm",children:[e.jsx("strong",{children:"Undefinierte Variablen:"})," ",L.undefinedVars.map(t=>"${"+t+"}").join(", ")]})]})})}),e.jsxs("div",{className:"px-6 py-4 border-t border-slate-200 flex justify-between items-center gap-3",children:[e.jsx("button",{onClick:j,className:"px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-50 transition-colors",children:"Abbrechen"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:st,className:"flex items-center gap-2 px-4 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-50 transition-colors",children:[e.jsx(mt,{size:16}),"Syntax prÃ¼fen"]}),e.jsx("button",{onClick:rt,disabled:z,className:`flex items-center gap-2 px-6 py-3 rounded-xl border-none bg-brand-gradient text-white text-sm font-semibold transition-all ${z?"cursor-not-allowed opacity-70":"cursor-pointer"}`,children:z?e.jsxs(e.Fragment,{children:[e.jsx(Be,{size:18,className:"animate-spin"}),"Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xt,{size:18}),o?"Speichern":"Template erstellen"]})})]})]})]})}),e.jsx(ze,{children:p&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[70] p-4",children:e.jsxs(me.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl w-full max-w-[420px] shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-amber-50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(X,{size:24,className:"text-amber-600"}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Daten Ã¼berschreiben?"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:"text-slate-600 text-sm mb-4",children:["Du hast bereits Eingabefelder oder KI-Anweisungen definiert. Wenn du die Vorlage ",e.jsxs("strong",{children:['"',p.label,'"']})," anwendest, werden diese Daten Ã¼berschrieben."]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-xs text-slate-500 font-medium mb-1",children:"Was wird Ã¼berschrieben:"}),e.jsxs("ul",{className:"text-sm text-slate-600 space-y-1",children:[r.length>0&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),r.length," Eingabefeld",r.length!==1?"er":""]}),c&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),"KI-Rolle"]}),f.length>0&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),f.length," Briefing-Abschnitt",f.length!==1?"e":""]}),l&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),"Verhalten & Stil"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Ue,className:"flex-1 px-4 py-2.5 rounded-xl border border-slate-200 bg-white text-slate-700 font-medium text-sm cursor-pointer hover:bg-slate-50 transition-colors",children:"Abbrechen"}),e.jsx("button",{onClick:()=>Ee(p),className:"flex-1 px-4 py-2.5 rounded-xl border-none bg-amber-500 text-white font-medium text-sm cursor-pointer hover:bg-amber-600 transition-colors",children:"Ãœberschreiben"})]})]})]})})})]}):null},D={DASHBOARD:"dashboard",FORM:"form",RESULT:"result",LIST:"list",WORKBOOK:"workbook"},Xt=({isAuthenticated:n,requireAuth:j,setPendingAction:g,onNavigateToSimulator:o,onNavigateToHistory:b,demoCode:a})=>{const[d,m]=i.useState(D.DASHBOARD),[u,N]=i.useState(null),[h,r]=i.useState(null),[x,c]=i.useState(null),[w,f]=i.useState(null),[S,l]=i.useState(!1),[C,R]=i.useState(null),[v,z]=i.useState(0);i.useEffect(()=>{w&&n&&(N(w),m(D.FORM),f(null))},[w,n]),i.useEffect(()=>{window.scrollTo(0,0)},[d]);const A=i.useCallback(E=>{N(E),m(D.FORM)},[]),I=i.useCallback(()=>{N(null),r(null),c(null),m(D.DASHBOARD)},[]),$=i.useCallback(E=>{r(E),c(E),m(D.WORKBOOK)},[]),V=i.useCallback(()=>{r(null),c(null),N(null),m(D.DASHBOARD)},[]),_=i.useCallback(()=>{r(null),c(null),m(D.FORM)},[]);i.useCallback(()=>{m(D.LIST)},[]);const p=i.useCallback(E=>{c(E),m(D.WORKBOOK)},[]);i.useCallback(()=>{c(null),m(D.LIST)},[]);const k=i.useCallback(E=>{o&&o(E)},[o]),L=i.useCallback(async E=>{try{if((await U.request(`/smartbriefing/briefings/${E.id}`,{method:"DELETE"})).success)c(null),m(D.DASHBOARD);else throw new Error("Fehler beim LÃ¶schen")}catch(W){throw console.error("[SmartBriefing] Error deleting briefing:",W),W}},[]),G=i.useCallback(()=>{R(null),l(!0)},[]),F=i.useCallback(E=>{R(E),l(!0)},[]),Z=i.useCallback(E=>{R(E),l(!0)},[]),oe=i.useCallback(()=>{l(!1),R(null)},[]),ce=i.useCallback(E=>{z(W=>W+1)},[]),Ne=()=>{switch(d){case D.FORM:return e.jsx(vt,{template:u,onBack:I,onBriefingGenerated:$,isAuthenticated:n});case D.RESULT:return e.jsx(Bt,{briefing:h,template:u,onBack:I,onCreateNew:V,onGenerateAnother:_});case D.LIST:return e.jsx($t,{onOpenBriefing:p,onCreateNew:V,isAuthenticated:n});case D.WORKBOOK:return e.jsx(yt,{briefing:x,onBack:I,onDelete:L,onStartSimulation:o?k:null});case D.DASHBOARD:default:return e.jsx(wt,{onSelectTemplate:A,onShowList:b,onCreateTemplate:G,onEditTemplate:F,onCopyTemplate:Z,isAuthenticated:n,requireAuth:j,setPendingAction:g,demoCode:a},v)}};return e.jsxs("div",{className:"min-h-full",children:[Ne(),e.jsx(Lt,{isOpen:S,onClose:oe,onSave:ce,editTemplate:C,demoCode:a})]})};export{$t as BriefingList,Bt as BriefingResult,yt as BriefingWorkbook,Xt as SmartBriefingApp,wt as SmartBriefingDashboard,vt as SmartBriefingForm};
