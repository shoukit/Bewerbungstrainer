import{av as R,T as Ee,ad as Ie,c as Ae,as as $e,q as ze,U as Me,B as De,j as e,aU as re,aM as fe,aL as se,aV as Be,z as Te,az as Ue}from"./ui-vendor-B9DEMv6g.js";import{a as m}from"./react-vendor-uDOJF2jQ.js";import{w as _e,u as Oe,D as P}from"./FeatureInfoButton-BL-uvPDu.js";import{S as Re,a as Fe}from"./ScenarioCard-RDjNylX4.js";import{D as Ge,a as Ke,b as He,c as We}from"./dialog-l-KFjSys.js";import{u as Ye}from"./useMobile-YxjH166V.js";import{B as Ze}from"./Button-CE7zPp3G.js";import{S as _,b as qe}from"./select-native-CL_xNWig.js";const Je={briefcase:De,users:Me,"trending-up":ze,"message-circle":$e,shield:Ae,heart:Ie,target:Ee,folder:R},C=R,j=l=>!l||typeof l!="string"?C:Je[l.toLowerCase()]||C,z=l=>!l||typeof l!="string"?"":l.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/[^a-z0-9]/g,""),V={career:"karriere",leadership:"fuehrung",sales:"vertrieb",communication:"kommunikation",service:"service",social:"social",karriere:"karriere",fuehrung:"fuehrung",vertrieb:"vertrieb",kommunikation:"kommunikation",meine:"meine",selfpresentation:"karriere",interview:"karriere",pitch:"vertrieb",negotiation:"vertrieb",vorstellungsgespraech:"karriere",gehaltsverhandlung:"vertrieb",fuehrungsgespraech:"fuehrung",praesentation:"kommunikation",selbstvorstellung:"karriere",training:"kommunikation"};let M=null,ee=null;const Qe=300*1e3;function Xe(){const[l,x]=m.useState(M||[]),[c,u]=m.useState(!M),[p,w]=m.useState(null),b=m.useCallback(async()=>{if(M&&ee&&Date.now()-ee<Qe)return x(M),u(!1),M;try{u(!0),w(null);const n=await _e.getCategories();return M=n,ee=Date.now(),x(n),n}catch(n){return console.error("[useCategories] Failed to fetch categories:",n),w(n.message||"Failed to fetch categories"),[]}finally{u(!1)}},[]);m.useEffect(()=>{b()},[b]);const f=m.useCallback(n=>{if(!n||!l.length)return null;const o=z(n),i=V[o]||o,s=l.find(r=>z(r.slug)===i||z(r.name)===i);return s?{...s,IconComponent:j(s.icon),bgColor:`${s.color}15`}:null},[l]),g=m.useCallback(n=>{if(Array.isArray(n)){for(const s of n){if(typeof s!="string")continue;const r=f(s);if(r)return{key:r.slug,label:r.name,shortLabel:r.shortName||r.name,icon:j(r.icon),IconComponent:j(r.icon),color:r.color,bgColor:r.bgColor}}const i=n.find(s=>typeof s=="string")||"unknown";return{key:String(i),label:String(i),shortLabel:String(i),icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"}}if(typeof n!="string")return{key:"unknown",label:"Unbekannt",shortLabel:"Unbekannt",icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"};const o=f(n);return o?{key:o.slug,label:o.name,shortLabel:o.shortName||o.name,icon:j(o.icon),IconComponent:j(o.icon),color:o.color,bgColor:o.bgColor}:{key:n||"unknown",label:n||"Unbekannt",shortLabel:n||"Unbekannt",icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"}},[f]),N=m.useCallback((n=[])=>{if(!l.length)return[];if(!n.length)return l.map(i=>({key:i.slug,label:i.name,shortLabel:i.shortName||i.name,icon:j(i.icon),IconComponent:j(i.icon),color:i.color,bgColor:`${i.color}15`}));const o=new Map;return n.forEach(i=>{if(i){if(Array.isArray(i))i.forEach(s=>{if(!s||typeof s!="string"||!s.trim())return;const r=f(s);r&&!o.has(r.slug)&&o.set(r.slug,{key:r.slug,label:r.name,shortLabel:r.shortName||r.name,icon:j(r.icon),IconComponent:j(r.icon),color:r.color,bgColor:r.bgColor})});else if(typeof i=="string"&&i.trim()){const s=f(i);s&&!o.has(s.slug)&&o.set(s.slug,{key:s.slug,label:s.name,shortLabel:s.shortName||s.name,icon:j(s.icon),IconComponent:j(s.icon),color:s.color,bgColor:s.bgColor})}}}),Array.from(o.values())},[l,f]),v=m.useCallback((n,o)=>{if(!n||!o)return!1;const i=z(o);if(Array.isArray(n))return n.some(L=>{const I=z(L);return(V[I]||I)===i});const s=z(n);return(V[s]||s)===i},[]),S=m.useMemo(()=>{const n=new Map;return l.forEach(o=>{n.set(o.slug,{...o,IconComponent:j(o.icon),bgColor:`${o.color}15`})}),n},[l]);return{categories:l,categoriesMap:S,loading:c,error:p,refetch:b,getCategoryBySlug:f,getCategoryConfig:g,getCategoriesForFilter:N,matchesCategory:v}}const O=({label:l,icon:x,isSelected:c,onClick:u})=>e.jsxs("button",{onClick:u,className:`inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold
      border-2 cursor-pointer transition-all whitespace-nowrap
      ${c?"border-primary bg-primary text-white shadow-lg shadow-primary/40":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[x&&e.jsx(x,{className:"w-3.5 h-3.5"}),l]}),Pe=({count:l})=>l===0?null:e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-md bg-red-500 text-white text-xs font-semibold flex items-center justify-center",children:l}),Ve=({value:l,onChange:x,placeholder:c,className:u=""})=>e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(fe,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-[18px] h-[18px] text-slate-400 pointer-events-none z-10"}),e.jsx("input",{type:"text",placeholder:c,value:l,onChange:p=>x(p.target.value),className:"w-full py-3 pl-14 pr-4 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20 placeholder:text-slate-400"})]}),pe=({value:l,onChange:x,options:c,className:u=""})=>e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(se,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("select",{value:l,onChange:p=>x(p.target.value),className:"w-full py-3 pl-10 pr-10 rounded-lg border border-slate-200 text-base text-slate-900 bg-white cursor-pointer outline-none appearance-none bg-no-repeat",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundPosition:"right 12px center"},children:c.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))})]}),he=({viewMode:l,onViewModeChange:x,compact:c=!1})=>e.jsxs("div",{className:`flex items-center gap-1 ${c?"p-[3px]":"p-1"} bg-slate-100 rounded-lg`,children:[e.jsx("button",{onClick:()=>x("grid"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${l==="grid"?"bg-white shadow-sm":"bg-transparent"}`,title:"Kachelansicht",children:e.jsx(re,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${l==="grid"?"text-primary":"text-slate-500"}`})}),e.jsx("button",{onClick:()=>x("list"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${l==="list"?"bg-white shadow-sm":"bg-transparent"}`,title:"Listenansicht",children:e.jsx(Be,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${l==="list"?"text-primary":"text-slate-500"}`})})]}),er=({searchQuery:l,onSearchChange:x,searchPlaceholder:c="Durchsuchen...",showSearch:u=!0,categories:p=[],selectedCategory:w,onCategoryChange:b,showCategories:f=!0,difficultyOptions:g=[],selectedDifficulty:N,onDifficultyChange:v,showDifficulty:S=!1,viewMode:n,onViewModeChange:o,showViewToggle:i=!0,renderCustomFilters:s,customActions:r,children:L})=>{const[I,A]=m.useState(!1),F=Ye(),$=[w?1:0,N&&N!=="all"?1:0,l?.trim()?1:0].reduce((h,D)=>h+D,0);return F?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[u&&e.jsxs("div",{className:"relative flex-1",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:l,onChange:h=>x(h.target.value),className:"w-full py-2 pl-9 pr-3 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none"})]}),e.jsxs("button",{onClick:()=>A(!0),className:`relative flex items-center justify-center w-11 h-11 rounded-lg border flex-shrink-0 cursor-pointer
            ${$>0?"border-primary bg-primary/10":"border-slate-200 bg-white"}`,children:[e.jsx(se,{className:`w-[18px] h-[18px] ${$>0?"text-primary":"text-slate-500"}`}),e.jsx(Pe,{count:$})]}),i&&n&&e.jsx(he,{viewMode:n,onViewModeChange:o,compact:!0})]}),r&&e.jsx("div",{className:"mt-2",children:r}),e.jsx(Ge,{open:I,onOpenChange:A,children:e.jsxs(Ke,{className:"fixed bottom-0 left-0 right-0 top-auto transform-none max-w-full w-full rounded-t-2xl max-h-[80vh] overflow-auto",children:[e.jsx(He,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(We,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-primary"}),"Filter"]}),$>0&&e.jsx("button",{onClick:()=>{b?.(null),v?.("all"),x?.("")},className:"px-3 py-1 rounded-md border-none bg-slate-100 text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-200 transition-colors",children:"Zurücksetzen"})]})}),e.jsxs("div",{className:"flex flex-col gap-5 py-2",children:[S&&g.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Schwierigkeit"}),e.jsx(pe,{value:N,onChange:v,options:g})]}),f&&p.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Kategorie"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(O,{label:"Alle",icon:re,isSelected:!w,onClick:()=>b(null)}),p.map(h=>e.jsx(O,{label:h.label,icon:h.icon,isSelected:w===h.key,onClick:()=>b(h.key)},h.key))]})]}),s&&e.jsx("div",{children:s()})]}),e.jsx(Ze,{variant:"primary",size:"lg",onClick:()=>A(!1),fullWidth:!0,className:"mt-3",children:"Filter anwenden"})]})}),L]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[u&&e.jsx(Ve,{value:l,onChange:x,placeholder:c,className:"flex-1 min-w-[200px]"}),S&&g.length>0&&e.jsx(pe,{value:N,onChange:v,options:g,className:"min-w-[180px]"}),s&&s(),r,i&&n&&e.jsx(he,{viewMode:n,onViewModeChange:o})]}),f&&p.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(O,{label:"Alle",icon:re,isSelected:!w,onClick:()=>b(null)}),p.map(h=>e.jsx(O,{label:h.label,icon:h.icon,isSelected:w===h.key,onClick:()=>b(h.key)},h.key))]}),L]})},be=({category:l,getCategoryConfig:x})=>{const c=x(l);if(!c)return null;const u=c.IconComponent||c.icon||R;return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:c.bgColor,color:c.color},children:[e.jsx(u,{style:{width:"12px",height:"12px"}}),c.shortLabel]})},rr=({category:l,getCategoryConfig:x})=>Array.isArray(l)?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.map((c,u)=>e.jsx(be,{category:c,getCategoryConfig:x},u))}):e.jsx(be,{category:l,getCategoryConfig:x}),xr=({title:l,subtitle:x,headerIcon:c,fetchScenarios:u,moduleKey:p,historyButtonLabel:w="Meine Sessions",onNavigateToHistory:b,showHistoryButton:f=!0,onSelectScenario:g,renderCardMeta:N,renderCategoryBadge:v,getIconForScenario:S,cardActionLabel:n="Starten",cardActionIcon:o,getCardCustomActions:i,categoryField:s="category",customCategoryConfig:r,emptyStateIcon:L,emptyStateTitle:I="Keine Szenarien verfügbar",emptyStateMessage:A="Bitte kontaktieren Sie den Administrator.",searchPlaceholder:F="Durchsuchen...",headerActions:$,filterActions:h,renderInfoBox:D,extraContent:ge,isAuthenticated:B,requireAuth:G,setPendingAction:K,setPendingScenario:H,demoCode:te,pendingScenario:W,clearPendingScenario:Y,loadingMessage:sr="Szenarien werden geladen...",errorRetryLabel:je="Erneut versuchen"})=>{const[le,we]=m.useState([]),[Ne,ne]=m.useState(!0),[ae,oe]=m.useState(null),[E,ie]=m.useState(null),[Z,ve]=m.useState("grid"),[T,ke]=m.useState(""),{branding:q,filterScenariosBySetupAndPartner:ce}=Oe(),{getCategoryConfig:J,getCategoriesForFilter:me,matchesCategory:U}=Xe(),ye=q?.["--header-gradient"]||P["--header-gradient"],Ce=q?.["--header-text"]||P["--header-text"];q?.["--primary-accent"]||P["--primary-accent"];const Q=m.useCallback(async()=>{try{ne(!0),oe(null);const t=await u();we(t||[])}catch(t){console.error(`[${l}] Error loading scenarios:`,t),oe(t.message||"Fehler beim Laden")}finally{ne(!1)}},[u,l]);m.useEffect(()=>{Q()},[Q]);const xe=m.useRef(!1);m.useEffect(()=>{W&&B&&!xe.current&&(xe.current=!0,Y&&Y(),g(W))},[W,B,Y,g]);const k=m.useMemo(()=>ce([...le],p),[le,ce,p]),X=m.useMemo(()=>{if(r){const a=new Set;return k.forEach(d=>{const y=d[s];y&&r[y]&&a.add(y)}),Array.from(a)}const t=k.flatMap(a=>{const d=a[s];return Array.isArray(d)?d.filter(y=>y&&typeof y=="string"&&y.trim()):d&&typeof d=="string"&&d.trim()?[d]:[]});return[...new Set(t)]},[k,s,r]),de=m.useMemo(()=>r?X.filter(a=>k.some(d=>d[s]===a)).map(a=>({key:a,label:r[a]?.label||a,shortLabel:r[a]?.label||a,color:r[a]?.color,bgColor:r[a]?.bgColor,icon:r[a]?.icon,IconComponent:r[a]?.icon})):me(X).filter(a=>!a||!a.label||!a.label.trim()?!1:k.some(d=>U(d[s],a.key))),[X,r,me,k,s,U]),ue=m.useMemo(()=>{let t=[...k];if(E&&(r?t=t.filter(a=>a[s]===E):t=t.filter(a=>U(a[s],E))),T.trim()){const a=T.toLowerCase();t=t.filter(d=>d.title?.toLowerCase().includes(a)||d.description?.toLowerCase().includes(a))}return t},[k,E,T,s,r,U]),Se=m.useCallback(t=>{if(!B&&!te){H?H(t):K&&K({type:"SELECT_SCENARIO",scenario:t}),G&&G(()=>{g(t)},{type:"SELECT_SCENARIO",scenario:t});return}g(t)},[B,te,H,K,G,g]),Le=m.useCallback(t=>{const a=t[s];if(!a)return null;if(v)return v(t,J);if(r&&r[a]){const d=r[a];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:d.bgColor,color:d.color},children:[d.icon&&e.jsx(d.icon,{style:{width:"12px",height:"12px"}}),d.label]})}return e.jsx(rr,{category:a,getCategoryConfig:J})},[s,v,r,J]);return Ne?e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(_,{className:"w-12 h-12 rounded-xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"h-7 w-48"}),e.jsx(_,{className:"h-4 w-64"})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[1,2,3,4,5].map(t=>e.jsx(_,{className:"h-10 w-24 rounded-full flex-shrink-0"},t))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(t=>e.jsx(qe,{},t))})]}):ae?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-[60px_20px] gap-4",children:[e.jsx(Te,{className:"w-12 h-12 text-red-500"}),e.jsx("p",{className:"text-red-500 text-base text-center",children:ae}),e.jsx("button",{onClick:Q,className:"px-6 py-3 rounded-xl border-none bg-primary text-white text-sm font-semibold cursor-pointer hover:opacity-90 transition-opacity",children:je})]}):e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:ye},children:c&&e.jsx(c,{style:{width:"24px",height:"24px",color:Ce}})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[28px] font-bold text-slate-900 m-0",children:l}),e.jsx("p",{className:"text-sm text-slate-600 m-0",children:x})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[$,f&&b&&e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-5 py-3 rounded-xl border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-all",children:[e.jsx(Ue,{size:18}),w]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(er,{searchQuery:T,onSearchChange:ke,searchPlaceholder:F,categories:de.map(t=>({key:t.key,label:t.label,shortLabel:t.shortLabel||t.label,color:t.color,bgColor:t.bgColor,icon:t.IconComponent||t.icon})),selectedCategory:E,onCategoryChange:ie,showCategories:de.length>0,showDifficulty:!1,viewMode:Z,onViewModeChange:ve,customActions:h})})]}),ue.length>0?e.jsx(Re,{minCardWidth:"340px",viewMode:Z,children:ue.map(t=>{const a=S?S(t):null,d=N?N(t):[],y=i?i(t):null;return e.jsx(Fe,{title:t.title,description:t.description,icon:a,categoryBadge:Le(t),meta:d,action:o?{label:n,icon:o}:{label:n},onClick:()=>Se(t),viewMode:Z,customActions:y},t.id)})}):e.jsxs("div",{className:"text-center p-12 px-6 bg-white rounded-2xl border border-slate-200",children:[e.jsx("div",{className:"flex justify-center mb-4",children:L?e.jsx(L,{className:"w-12 h-12 text-slate-300"}):e.jsx(R,{className:"w-12 h-12 text-slate-300"})}),e.jsx("h3",{className:"text-slate-500 m-0 mb-2 font-medium",children:I}),e.jsx("p",{className:"text-slate-400 m-0 text-sm",children:E?"In der ausgewählten Kategorie sind keine Szenarien verfügbar.":A}),E&&k.length>0&&e.jsx("button",{onClick:()=>ie(null),className:"mt-4 px-5 py-2.5 rounded-[20px] border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-colors",children:"Alle Szenarien anzeigen"})]}),D&&D(),ge]})};export{xr as S};
