import{av as K,l as $e,ag as ze,S as De,at as Me,i as Te,U as Be,r as Ue,j as e,aV as re,aN as je,aM as le,aW as Fe,E as _e,az as Oe}from"./ui-vendor-DSq21R2h.js";import{a as d}from"./react-vendor-uDOJF2jQ.js";import{w as Re,u as Ge,D as ee}from"./FeatureInfoButton-CFo_jWu4.js";import{S as Ke,a as We}from"./ScenarioCard-DCVt-s6H.js";import{D as He,a as Ye,b as Ze,c as Je}from"./dialog-Df16UbCK.js";import{u as Qe}from"./useMobile-YxjH166V.js";import{B as Xe,S as R,c as qe}from"./select-native-miEO34sQ.js";const Ve={briefcase:Ue,users:Be,"trending-up":Te,"message-circle":Me,shield:De,heart:ze,target:$e,folder:K},E=K,N=r=>!r||typeof r!="string"?E:Ve[r.toLowerCase()]||E,D=r=>!r||typeof r!="string"?"":r.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/[^a-z0-9]/g,""),se={career:"karriere",leadership:"fuehrung",sales:"vertrieb",communication:"kommunikation",service:"service",social:"social",karriere:"karriere",fuehrung:"fuehrung",vertrieb:"vertrieb",kommunikation:"kommunikation",meine:"meine",selfpresentation:"karriere",interview:"karriere",pitch:"vertrieb",negotiation:"vertrieb",vorstellungsgespraech:"karriere",gehaltsverhandlung:"vertrieb",fuehrungsgespraech:"fuehrung",praesentation:"kommunikation",selbstvorstellung:"karriere",training:"kommunikation"};let M=null,te=null;const Pe=300*1e3;function es(){const[r,x]=d.useState(M||[]),[c,p]=d.useState(!M),[h,k]=d.useState(null),g=d.useCallback(async()=>{if(M&&te&&Date.now()-te<Pe)return x(M),p(!1),M;try{p(!0),k(null);const n=await Re.getCategories();return M=n,te=Date.now(),x(n),n}catch(n){return console.error("[useCategories] Failed to fetch categories:",n),k(n.message||"Failed to fetch categories"),[]}finally{p(!1)}},[]);d.useEffect(()=>{g()},[g]);const j=d.useCallback(n=>{if(!n||!r.length)return null;const o=D(n),i=se[o]||o,a=r.find(l=>D(l.slug)===i||D(l.name)===i);return a?{...a,IconComponent:N(a.icon),bgColor:`${a.color}15`}:null},[r]),w=d.useCallback(n=>{if(Array.isArray(n)){for(const a of n){if(typeof a!="string")continue;const l=j(a);if(l)return{key:l.slug,label:l.name,shortLabel:l.shortName||l.name,icon:N(l.icon),IconComponent:N(l.icon),color:l.color,bgColor:l.bgColor}}const i=n.find(a=>typeof a=="string")||"unknown";return{key:String(i),label:String(i),shortLabel:String(i),icon:E,IconComponent:E,color:"#64748b",bgColor:"#f1f5f9"}}if(typeof n!="string")return{key:"unknown",label:"Unbekannt",shortLabel:"Unbekannt",icon:E,IconComponent:E,color:"#64748b",bgColor:"#f1f5f9"};const o=j(n);return o?{key:o.slug,label:o.name,shortLabel:o.shortName||o.name,icon:N(o.icon),IconComponent:N(o.icon),color:o.color,bgColor:o.bgColor}:{key:n||"unknown",label:n||"Unbekannt",shortLabel:n||"Unbekannt",icon:E,IconComponent:E,color:"#64748b",bgColor:"#f1f5f9"}},[j]),y=d.useCallback((n=[])=>{if(!r.length)return[];if(!n.length)return r.map(i=>({key:i.slug,label:i.name,shortLabel:i.shortName||i.name,icon:N(i.icon),IconComponent:N(i.icon),color:i.color,bgColor:`${i.color}15`}));const o=new Map;return n.forEach(i=>{if(i){if(Array.isArray(i))i.forEach(a=>{if(!a||typeof a!="string"||!a.trim())return;const l=j(a);l&&!o.has(l.slug)&&o.set(l.slug,{key:l.slug,label:l.name,shortLabel:l.shortName||l.name,icon:N(l.icon),IconComponent:N(l.icon),color:l.color,bgColor:l.bgColor})});else if(typeof i=="string"&&i.trim()){const a=j(i);a&&!o.has(a.slug)&&o.set(a.slug,{key:a.slug,label:a.name,shortLabel:a.shortName||a.name,icon:N(a.icon),IconComponent:N(a.icon),color:a.color,bgColor:a.bgColor})}}}),Array.from(o.values())},[r,j]),S=d.useCallback((n,o)=>{if(!n||!o)return!1;const i=D(o);if(Array.isArray(n))return n.some(m=>{const A=D(m);return(se[A]||A)===i});const a=D(n);return(se[a]||a)===i},[]),I=d.useMemo(()=>{const n=new Map;return r.forEach(o=>{n.set(o.slug,{...o,IconComponent:N(o.icon),bgColor:`${o.color}15`})}),n},[r]);return{categories:r,categoriesMap:I,loading:c,error:h,refetch:g,getCategoryBySlug:j,getCategoryConfig:w,getCategoriesForFilter:y,matchesCategory:S}}const G=({label:r,icon:x,isSelected:c,onClick:p})=>e.jsxs("button",{onClick:p,className:`inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold
      border-2 cursor-pointer transition-all whitespace-nowrap
      ${c?"border-indigo-500 bg-indigo-500 text-white shadow-lg shadow-indigo-500/40":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[x&&e.jsx(x,{className:"w-3.5 h-3.5"}),r]}),ss=({count:r})=>r===0?null:e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-md bg-red-500 text-white text-xs font-semibold flex items-center justify-center",children:r}),ts=({value:r,onChange:x,placeholder:c,className:p=""})=>e.jsxs("div",{className:`relative ${p}`,children:[e.jsx(je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none z-10"}),e.jsx("input",{type:"text",placeholder:c,value:r,onChange:h=>x(h.target.value),className:"w-full py-3 pr-4 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none transition-all focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 placeholder:text-slate-400",style:{paddingLeft:"44px"}})]}),fe=({value:r,onChange:x,options:c,className:p=""})=>e.jsxs("div",{className:`relative ${p}`,children:[e.jsx(le,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("select",{value:r,onChange:h=>x(h.target.value),className:"w-full py-3 pl-10 pr-10 rounded-lg border border-slate-200 text-base text-slate-900 bg-white cursor-pointer outline-none appearance-none bg-no-repeat",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundPosition:"right 12px center"},children:c.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]}),be=({viewMode:r,onViewModeChange:x,compact:c=!1})=>e.jsxs("div",{className:`flex items-center gap-1 ${c?"p-[3px]":"p-1"} bg-slate-100 rounded-lg`,children:[e.jsx("button",{onClick:()=>x("grid"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${r==="grid"?"bg-white shadow-sm":"bg-transparent"}`,title:"Kachelansicht",children:e.jsx(re,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${r==="grid"?"text-indigo-600":"text-slate-500"}`})}),e.jsx("button",{onClick:()=>x("list"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${r==="list"?"bg-white shadow-sm":"bg-transparent"}`,title:"Listenansicht",children:e.jsx(Fe,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${r==="list"?"text-indigo-600":"text-slate-500"}`})})]}),rs=({searchQuery:r,onSearchChange:x,searchPlaceholder:c="Durchsuchen...",showSearch:p=!0,categories:h=[],selectedCategory:k,onCategoryChange:g,showCategories:j=!0,difficultyOptions:w=[],selectedDifficulty:y,onDifficultyChange:S,showDifficulty:I=!1,viewMode:n,onViewModeChange:o,showViewToggle:i=!0,renderCustomFilters:a,customActions:l,children:m})=>{const[A,$]=d.useState(!1),W=Qe(),z=[k?1:0,y&&y!=="all"?1:0,r?.trim()?1:0].reduce((f,H)=>f+H,0);return W?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[p&&e.jsxs("div",{className:"relative flex-1",children:[e.jsx(je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:r,onChange:f=>x(f.target.value),className:"w-full py-2 pr-3 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none",style:{paddingLeft:"40px"}})]}),e.jsxs("button",{onClick:()=>$(!0),className:`relative flex items-center justify-center w-11 h-11 rounded-lg border flex-shrink-0 cursor-pointer
            ${z>0?"border-indigo-500 bg-indigo-50":"border-slate-200 bg-white"}`,children:[e.jsx(le,{className:`w-[18px] h-[18px] ${z>0?"text-indigo-600":"text-slate-500"}`}),e.jsx(ss,{count:z})]}),i&&n&&e.jsx(be,{viewMode:n,onViewModeChange:o,compact:!0})]}),l&&e.jsx("div",{className:"mt-2",children:l}),e.jsx(He,{open:A,onOpenChange:$,children:e.jsxs(Ye,{className:"fixed bottom-0 left-0 right-0 top-auto transform-none max-w-full w-full rounded-t-2xl max-h-[80vh] overflow-auto",children:[e.jsx(Ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Je,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-indigo-600"}),"Filter"]}),z>0&&e.jsx("button",{onClick:()=>{g?.(null),S?.("all"),x?.("")},className:"px-3 py-1 rounded-md border-none bg-slate-100 text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-200 transition-colors",children:"Zurücksetzen"})]})}),e.jsxs("div",{className:"flex flex-col gap-5 py-2",children:[I&&w.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Schwierigkeit"}),e.jsx(fe,{value:y,onChange:S,options:w})]}),j&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Kategorie"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(G,{label:"Alle",icon:re,isSelected:!k,onClick:()=>g(null)}),h.map(f=>e.jsx(G,{label:f.label,icon:f.icon,isSelected:k===f.key,onClick:()=>g(f.key)},f.key))]})]}),a&&e.jsx("div",{children:a()})]}),e.jsx(Xe,{variant:"primary",size:"lg",onClick:()=>$(!1),fullWidth:!0,className:"mt-3",children:"Filter anwenden"})]})}),m]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[p&&e.jsx(ts,{value:r,onChange:x,placeholder:c,className:"flex-1 min-w-[200px]"}),I&&w.length>0&&e.jsx(fe,{value:y,onChange:S,options:w,className:"min-w-[180px]"}),a&&a(),l,i&&n&&e.jsx(be,{viewMode:n,onViewModeChange:o})]}),j&&h.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(G,{label:"Alle",icon:re,isSelected:!k,onClick:()=>g(null)}),h.map(f=>e.jsx(G,{label:f.label,icon:f.icon,isSelected:k===f.key,onClick:()=>g(f.key)},f.key))]}),m]})},ge=({category:r,getCategoryConfig:x})=>{const c=x(r);if(!c)return null;const p=c.IconComponent||c.icon||K;return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:c.bgColor,color:c.color},children:[e.jsx(p,{style:{width:"12px",height:"12px"}}),c.shortLabel]})},ls=({category:r,getCategoryConfig:x})=>Array.isArray(r)?e.jsx("div",{className:"flex flex-wrap gap-1",children:r.map((c,p)=>e.jsx(ge,{category:c,getCategoryConfig:x},p))}):e.jsx(ge,{category:r,getCategoryConfig:x}),us=({title:r,subtitle:x,headerIcon:c,fetchScenarios:p,moduleKey:h,historyButtonLabel:k="Meine Sessions",onNavigateToHistory:g,showHistoryButton:j=!0,onSelectScenario:w,renderCardMeta:y,renderCategoryBadge:S,getIconForScenario:I,cardActionLabel:n="Starten",cardActionIcon:o,getCardCustomActions:i,getCardClassName:a,categoryField:l="category",customCategoryConfig:m,emptyStateIcon:A,emptyStateTitle:$="Keine Szenarien verfügbar",emptyStateMessage:W="Bitte kontaktieren Sie den Administrator.",searchPlaceholder:z="Durchsuchen...",headerActions:f,filterActions:H,renderInfoBox:ne,extraContent:we,isAuthenticated:F,requireAuth:Y,setPendingAction:Z,setPendingScenario:J,demoCode:ae,pendingScenario:C,clearPendingScenario:T,loadingMessage:ns="Szenarien werden geladen...",errorRetryLabel:Ne="Erneut versuchen",additionalCategories:_=[]})=>{const[B,ve]=d.useState([]),[ke,oe]=d.useState(!0),[ie,ce]=d.useState(null),[L,de]=d.useState(null),[Q,ye]=d.useState("grid"),[O,Se]=d.useState(""),{branding:X,filterScenariosBySetupAndPartner:xe}=Ge(),{getCategoryConfig:q,getCategoriesForFilter:me,matchesCategory:U}=es(),Ce=X?.["--header-gradient"]||ee["--header-gradient"],Le=X?.["--header-text"]||ee["--header-text"];X?.["--primary-accent"]||ee["--primary-accent"];const V=d.useCallback(async()=>{try{oe(!0),ce(null);const s=await p();ve(s||[])}catch(s){console.error(`[${r}] Error loading scenarios:`,s),ce(s.message||"Fehler beim Laden")}finally{oe(!1)}},[p,r]);d.useEffect(()=>{V()},[V]);const ue=d.useRef(!1);d.useEffect(()=>{if(C&&F&&B.length>0&&!ue.current){ue.current=!0;let s=C;if(C.id&&!C.title){const u=B.find(t=>t.id===C.id||String(t.id)===String(C.id));if(u)s=u,console.log("[ScenarioDashboard] Found scenario by ID:",u.title);else{console.warn("[ScenarioDashboard] Scenario not found for ID:",C.id),T&&T();return}}T&&T(),w(s)}},[C,F,B,T,w]);const v=d.useMemo(()=>xe([...B],h),[B,xe,h]),P=d.useMemo(()=>{if(m){const u=new Set;return v.forEach(t=>{const b=t[l];b&&m[b]&&u.add(b)}),Array.from(u)}const s=v.flatMap(u=>{const t=u[l];return Array.isArray(t)?t.filter(b=>b&&typeof b=="string"&&b.trim()):t&&typeof t=="string"&&t.trim()?[t]:[]});return[...new Set(s)]},[v,l,m]),pe=d.useMemo(()=>{let s=[];return m?s=P.filter(t=>v.some(b=>b[l]===t)).map(t=>({key:t,label:m[t]?.label||t,shortLabel:m[t]?.label||t,color:m[t]?.color,bgColor:m[t]?.bgColor,icon:m[t]?.icon,IconComponent:m[t]?.icon})):(s=me(P),s=s.filter(t=>!t||!t.label||!t.label.trim()?!1:v.some(b=>U(b[l],t.key)))),[..._.filter(t=>!t||!t.key?!1:t.filterFn?v.some(t.filterFn):v.some(b=>b[l]===t.key||U(b[l],t.key))),...s]},[P,m,me,v,l,U,_]),he=d.useMemo(()=>{let s=[...v];if(L){const u=_.find(t=>t.key===L);u?.filterFn?s=s.filter(u.filterFn):m?s=s.filter(t=>t[l]===L):s=s.filter(t=>U(t[l],L))}if(O.trim()){const u=O.toLowerCase();s=s.filter(t=>t.title?.toLowerCase().includes(u)||t.description?.toLowerCase().includes(u))}return s},[v,L,O,l,m,U,_]),Ee=d.useCallback(s=>{if(!F&&!ae){J?J(s):Z&&Z({type:"SELECT_SCENARIO",scenario:s}),Y&&Y(()=>{w(s)},{type:"SELECT_SCENARIO",scenario:s});return}w(s)},[F,ae,J,Z,Y,w]),Ie=d.useCallback(s=>{const u=s[l];if(!u)return null;if(S)return S(s,q);if(m&&m[u]){const t=m[u];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:t.bgColor,color:t.color},children:[t.icon&&e.jsx(t.icon,{style:{width:"12px",height:"12px"}}),t.label]})}return e.jsx(ls,{category:u,getCategoryConfig:q})},[l,S,m,q]);return ke?e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(R,{className:"w-12 h-12 rounded-xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{className:"h-7 w-48"}),e.jsx(R,{className:"h-4 w-64"})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[1,2,3,4,5].map(s=>e.jsx(R,{className:"h-10 w-24 rounded-full flex-shrink-0"},s))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(s=>e.jsx(qe,{},s))})]}):ie?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-[60px_20px] gap-4",children:[e.jsx(_e,{className:"w-12 h-12 text-red-500"}),e.jsx("p",{className:"text-red-500 text-base text-center",children:ie}),e.jsx("button",{onClick:V,className:"px-6 py-3 rounded-xl border-none bg-primary text-white text-sm font-semibold cursor-pointer hover:opacity-90 transition-opacity",children:Ne})]}):e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:Ce},children:c&&e.jsx(c,{style:{width:"24px",height:"24px",color:Le}})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[28px] font-bold text-slate-900 m-0",children:r}),e.jsx("p",{className:"text-sm text-slate-600 m-0",children:x})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[f,j&&g&&e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-5 py-3 rounded-xl border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-all",children:[e.jsx(Oe,{size:18}),k]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(rs,{searchQuery:O,onSearchChange:Se,searchPlaceholder:z,categories:pe.map(s=>({key:s.key,label:s.label,shortLabel:s.shortLabel||s.label,color:s.color,bgColor:s.bgColor,icon:s.IconComponent||s.icon})),selectedCategory:L,onCategoryChange:de,showCategories:pe.length>0,showDifficulty:!1,viewMode:Q,onViewModeChange:ye,customActions:H})})]}),he.length>0?e.jsx(Ke,{minCardWidth:"340px",viewMode:Q,children:he.map(s=>{const u=I?I(s):null,t=y?y(s):[],b=i?i(s):null,Ae=a?a(s):"";return e.jsx(We,{title:s.title,description:s.description,icon:u,categoryBadge:Ie(s),meta:t,action:o?{label:n,icon:o}:{label:n},onClick:()=>Ee(s),viewMode:Q,customActions:b,className:Ae},s.id)})}):e.jsxs("div",{className:"text-center p-12 px-6 bg-white rounded-2xl border border-slate-200",children:[e.jsx("div",{className:"flex justify-center mb-4",children:A?e.jsx(A,{className:"w-12 h-12 text-slate-300"}):e.jsx(K,{className:"w-12 h-12 text-slate-300"})}),e.jsx("h3",{className:"text-slate-500 m-0 mb-2 font-medium",children:$}),e.jsx("p",{className:"text-slate-400 m-0 text-sm",children:L?"In der ausgewählten Kategorie sind keine Szenarien verfügbar.":W}),L&&v.length>0&&e.jsx("button",{onClick:()=>de(null),className:"mt-4 px-5 py-2.5 rounded-[20px] border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-colors",children:"Alle Szenarien anzeigen"})]}),ne&&ne(),we]})};export{us as S};
