import{aw as O,l as Ae,ad as $e,S as ze,as as Me,i as De,U as Be,B as Ue,j as e,aU as se,aM as ge,aL as re,aV as Te,z as _e,az as Oe}from"./ui-vendor-BaF13Yzb.js";import{a as d}from"./react-vendor-uDOJF2jQ.js";import{w as Re,u as Fe,D as P}from"./FeatureInfoButton-DPifsdNw.js";import{S as Ge,a as Ke}from"./ScenarioCard-Dxee9Sfp.js";import{D as He,a as We,b as Ye,c as Ze}from"./dialog-CNQsgZ9g.js";import{u as Je}from"./useMobile-YxjH166V.js";import{B as Qe,S as T,c as Xe}from"./select-native-DR-o3jUm.js";const qe={briefcase:Ue,users:Be,"trending-up":De,"message-circle":Me,shield:ze,heart:$e,target:Ae,folder:O},S=O,w=r=>!r||typeof r!="string"?S:qe[r.toLowerCase()]||S,z=r=>!r||typeof r!="string"?"":r.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/[^a-z0-9]/g,""),V={career:"karriere",leadership:"fuehrung",sales:"vertrieb",communication:"kommunikation",service:"service",social:"social",karriere:"karriere",fuehrung:"fuehrung",vertrieb:"vertrieb",kommunikation:"kommunikation",meine:"meine",selfpresentation:"karriere",interview:"karriere",pitch:"vertrieb",negotiation:"vertrieb",vorstellungsgespraech:"karriere",gehaltsverhandlung:"vertrieb",fuehrungsgespraech:"fuehrung",praesentation:"kommunikation",selbstvorstellung:"karriere",training:"kommunikation"};let M=null,ee=null;const Pe=300*1e3;function Ve(){const[r,x]=d.useState(M||[]),[c,p]=d.useState(!M),[h,N]=d.useState(null),f=d.useCallback(async()=>{if(M&&ee&&Date.now()-ee<Pe)return x(M),p(!1),M;try{p(!0),N(null);const l=await Re.getCategories();return M=l,ee=Date.now(),x(l),l}catch(l){return console.error("[useCategories] Failed to fetch categories:",l),N(l.message||"Failed to fetch categories"),[]}finally{p(!1)}},[]);d.useEffect(()=>{f()},[f]);const g=d.useCallback(l=>{if(!l||!r.length)return null;const o=z(l),i=V[o]||o,n=r.find(t=>z(t.slug)===i||z(t.name)===i);return n?{...n,IconComponent:w(n.icon),bgColor:`${n.color}15`}:null},[r]),j=d.useCallback(l=>{if(Array.isArray(l)){for(const n of l){if(typeof n!="string")continue;const t=g(n);if(t)return{key:t.slug,label:t.name,shortLabel:t.shortName||t.name,icon:w(t.icon),IconComponent:w(t.icon),color:t.color,bgColor:t.bgColor}}const i=l.find(n=>typeof n=="string")||"unknown";return{key:String(i),label:String(i),shortLabel:String(i),icon:S,IconComponent:S,color:"#64748b",bgColor:"#f1f5f9"}}if(typeof l!="string")return{key:"unknown",label:"Unbekannt",shortLabel:"Unbekannt",icon:S,IconComponent:S,color:"#64748b",bgColor:"#f1f5f9"};const o=g(l);return o?{key:o.slug,label:o.name,shortLabel:o.shortName||o.name,icon:w(o.icon),IconComponent:w(o.icon),color:o.color,bgColor:o.bgColor}:{key:l||"unknown",label:l||"Unbekannt",shortLabel:l||"Unbekannt",icon:S,IconComponent:S,color:"#64748b",bgColor:"#f1f5f9"}},[g]),v=d.useCallback((l=[])=>{if(!r.length)return[];if(!l.length)return r.map(i=>({key:i.slug,label:i.name,shortLabel:i.shortName||i.name,icon:w(i.icon),IconComponent:w(i.icon),color:i.color,bgColor:`${i.color}15`}));const o=new Map;return l.forEach(i=>{if(i){if(Array.isArray(i))i.forEach(n=>{if(!n||typeof n!="string"||!n.trim())return;const t=g(n);t&&!o.has(t.slug)&&o.set(t.slug,{key:t.slug,label:t.name,shortLabel:t.shortName||t.name,icon:w(t.icon),IconComponent:w(t.icon),color:t.color,bgColor:t.bgColor})});else if(typeof i=="string"&&i.trim()){const n=g(i);n&&!o.has(n.slug)&&o.set(n.slug,{key:n.slug,label:n.name,shortLabel:n.shortName||n.name,icon:w(n.icon),IconComponent:w(n.icon),color:n.color,bgColor:n.bgColor})}}}),Array.from(o.values())},[r,g]),k=d.useCallback((l,o)=>{if(!l||!o)return!1;const i=z(o);if(Array.isArray(l))return l.some(u=>{const E=z(u);return(V[E]||E)===i});const n=z(l);return(V[n]||n)===i},[]),L=d.useMemo(()=>{const l=new Map;return r.forEach(o=>{l.set(o.slug,{...o,IconComponent:w(o.icon),bgColor:`${o.color}15`})}),l},[r]);return{categories:r,categoriesMap:L,loading:c,error:h,refetch:f,getCategoryBySlug:g,getCategoryConfig:j,getCategoriesForFilter:v,matchesCategory:k}}const _=({label:r,icon:x,isSelected:c,onClick:p})=>e.jsxs("button",{onClick:p,className:`inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold
      border-2 cursor-pointer transition-all whitespace-nowrap
      ${c?"border-indigo-500 bg-indigo-500 text-white shadow-lg shadow-indigo-500/40":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[x&&e.jsx(x,{className:"w-3.5 h-3.5"}),r]}),es=({count:r})=>r===0?null:e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-md bg-red-500 text-white text-xs font-semibold flex items-center justify-center",children:r}),ss=({value:r,onChange:x,placeholder:c,className:p=""})=>e.jsxs("div",{className:`relative ${p}`,children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none z-10"}),e.jsx("input",{type:"text",placeholder:c,value:r,onChange:h=>x(h.target.value),className:"w-full py-3 pr-4 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none transition-all focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 placeholder:text-slate-400",style:{paddingLeft:"44px"}})]}),he=({value:r,onChange:x,options:c,className:p=""})=>e.jsxs("div",{className:`relative ${p}`,children:[e.jsx(re,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("select",{value:r,onChange:h=>x(h.target.value),className:"w-full py-3 pl-10 pr-10 rounded-lg border border-slate-200 text-base text-slate-900 bg-white cursor-pointer outline-none appearance-none bg-no-repeat",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundPosition:"right 12px center"},children:c.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]}),be=({viewMode:r,onViewModeChange:x,compact:c=!1})=>e.jsxs("div",{className:`flex items-center gap-1 ${c?"p-[3px]":"p-1"} bg-slate-100 rounded-lg`,children:[e.jsx("button",{onClick:()=>x("grid"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${r==="grid"?"bg-white shadow-sm":"bg-transparent"}`,title:"Kachelansicht",children:e.jsx(se,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${r==="grid"?"text-indigo-600":"text-slate-500"}`})}),e.jsx("button",{onClick:()=>x("list"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${r==="list"?"bg-white shadow-sm":"bg-transparent"}`,title:"Listenansicht",children:e.jsx(Te,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${r==="list"?"text-indigo-600":"text-slate-500"}`})})]}),rs=({searchQuery:r,onSearchChange:x,searchPlaceholder:c="Durchsuchen...",showSearch:p=!0,categories:h=[],selectedCategory:N,onCategoryChange:f,showCategories:g=!0,difficultyOptions:j=[],selectedDifficulty:v,onDifficultyChange:k,showDifficulty:L=!1,viewMode:l,onViewModeChange:o,showViewToggle:i=!0,renderCustomFilters:n,customActions:t,children:u})=>{const[E,A]=d.useState(!1),R=Je(),$=[N?1:0,v&&v!=="all"?1:0,r?.trim()?1:0].reduce((b,F)=>b+F,0);return R?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[p&&e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:r,onChange:b=>x(b.target.value),className:"w-full py-2 pr-3 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none",style:{paddingLeft:"40px"}})]}),e.jsxs("button",{onClick:()=>A(!0),className:`relative flex items-center justify-center w-11 h-11 rounded-lg border flex-shrink-0 cursor-pointer
            ${$>0?"border-indigo-500 bg-indigo-50":"border-slate-200 bg-white"}`,children:[e.jsx(re,{className:`w-[18px] h-[18px] ${$>0?"text-indigo-600":"text-slate-500"}`}),e.jsx(es,{count:$})]}),i&&l&&e.jsx(be,{viewMode:l,onViewModeChange:o,compact:!0})]}),t&&e.jsx("div",{className:"mt-2",children:t}),e.jsx(He,{open:E,onOpenChange:A,children:e.jsxs(We,{className:"fixed bottom-0 left-0 right-0 top-auto transform-none max-w-full w-full rounded-t-2xl max-h-[80vh] overflow-auto",children:[e.jsx(Ye,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ze,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-indigo-600"}),"Filter"]}),$>0&&e.jsx("button",{onClick:()=>{f?.(null),k?.("all"),x?.("")},className:"px-3 py-1 rounded-md border-none bg-slate-100 text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-200 transition-colors",children:"Zurücksetzen"})]})}),e.jsxs("div",{className:"flex flex-col gap-5 py-2",children:[L&&j.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Schwierigkeit"}),e.jsx(he,{value:v,onChange:k,options:j})]}),g&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Kategorie"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{label:"Alle",icon:se,isSelected:!N,onClick:()=>f(null)}),h.map(b=>e.jsx(_,{label:b.label,icon:b.icon,isSelected:N===b.key,onClick:()=>f(b.key)},b.key))]})]}),n&&e.jsx("div",{children:n()})]}),e.jsx(Qe,{variant:"primary",size:"lg",onClick:()=>A(!1),fullWidth:!0,className:"mt-3",children:"Filter anwenden"})]})}),u]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[p&&e.jsx(ss,{value:r,onChange:x,placeholder:c,className:"flex-1 min-w-[200px]"}),L&&j.length>0&&e.jsx(he,{value:v,onChange:k,options:j,className:"min-w-[180px]"}),n&&n(),t,i&&l&&e.jsx(be,{viewMode:l,onViewModeChange:o})]}),g&&h.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{label:"Alle",icon:se,isSelected:!N,onClick:()=>f(null)}),h.map(b=>e.jsx(_,{label:b.label,icon:b.icon,isSelected:N===b.key,onClick:()=>f(b.key)},b.key))]}),u]})},fe=({category:r,getCategoryConfig:x})=>{const c=x(r);if(!c)return null;const p=c.IconComponent||c.icon||O;return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:c.bgColor,color:c.color},children:[e.jsx(p,{style:{width:"12px",height:"12px"}}),c.shortLabel]})},ts=({category:r,getCategoryConfig:x})=>Array.isArray(r)?e.jsx("div",{className:"flex flex-wrap gap-1",children:r.map((c,p)=>e.jsx(fe,{category:c,getCategoryConfig:x},p))}):e.jsx(fe,{category:r,getCategoryConfig:x}),ms=({title:r,subtitle:x,headerIcon:c,fetchScenarios:p,moduleKey:h,historyButtonLabel:N="Meine Sessions",onNavigateToHistory:f,showHistoryButton:g=!0,onSelectScenario:j,renderCardMeta:v,renderCategoryBadge:k,getIconForScenario:L,cardActionLabel:l="Starten",cardActionIcon:o,getCardCustomActions:i,getCardClassName:n,categoryField:t="category",customCategoryConfig:u,emptyStateIcon:E,emptyStateTitle:A="Keine Szenarien verfügbar",emptyStateMessage:R="Bitte kontaktieren Sie den Administrator.",searchPlaceholder:$="Durchsuchen...",headerActions:b,filterActions:F,renderInfoBox:te,extraContent:je,isAuthenticated:D,requireAuth:G,setPendingAction:K,setPendingScenario:H,demoCode:le,pendingScenario:W,clearPendingScenario:Y,loadingMessage:ls="Szenarien werden geladen...",errorRetryLabel:we="Erneut versuchen"})=>{const[ne,Ne]=d.useState([]),[ve,ae]=d.useState(!0),[oe,ie]=d.useState(null),[I,ce]=d.useState(null),[Z,ke]=d.useState("grid"),[B,ye]=d.useState(""),{branding:J,filterScenariosBySetupAndPartner:de}=Fe(),{getCategoryConfig:Q,getCategoriesForFilter:xe,matchesCategory:U}=Ve(),Ce=J?.["--header-gradient"]||P["--header-gradient"],Se=J?.["--header-text"]||P["--header-text"];J?.["--primary-accent"]||P["--primary-accent"];const X=d.useCallback(async()=>{try{ae(!0),ie(null);const s=await p();Ne(s||[])}catch(s){console.error(`[${r}] Error loading scenarios:`,s),ie(s.message||"Fehler beim Laden")}finally{ae(!1)}},[p,r]);d.useEffect(()=>{X()},[X]);const me=d.useRef(!1);d.useEffect(()=>{W&&D&&!me.current&&(me.current=!0,Y&&Y(),j(W))},[W,D,Y,j]);const y=d.useMemo(()=>de([...ne],h),[ne,de,h]),q=d.useMemo(()=>{if(u){const a=new Set;return y.forEach(m=>{const C=m[t];C&&u[C]&&a.add(C)}),Array.from(a)}const s=y.flatMap(a=>{const m=a[t];return Array.isArray(m)?m.filter(C=>C&&typeof C=="string"&&C.trim()):m&&typeof m=="string"&&m.trim()?[m]:[]});return[...new Set(s)]},[y,t,u]),ue=d.useMemo(()=>u?q.filter(a=>y.some(m=>m[t]===a)).map(a=>({key:a,label:u[a]?.label||a,shortLabel:u[a]?.label||a,color:u[a]?.color,bgColor:u[a]?.bgColor,icon:u[a]?.icon,IconComponent:u[a]?.icon})):xe(q).filter(a=>!a||!a.label||!a.label.trim()?!1:y.some(m=>U(m[t],a.key))),[q,u,xe,y,t,U]),pe=d.useMemo(()=>{let s=[...y];if(I&&(u?s=s.filter(a=>a[t]===I):s=s.filter(a=>U(a[t],I))),B.trim()){const a=B.toLowerCase();s=s.filter(m=>m.title?.toLowerCase().includes(a)||m.description?.toLowerCase().includes(a))}return s},[y,I,B,t,u,U]),Le=d.useCallback(s=>{if(!D&&!le){H?H(s):K&&K({type:"SELECT_SCENARIO",scenario:s}),G&&G(()=>{j(s)},{type:"SELECT_SCENARIO",scenario:s});return}j(s)},[D,le,H,K,G,j]),Ee=d.useCallback(s=>{const a=s[t];if(!a)return null;if(k)return k(s,Q);if(u&&u[a]){const m=u[a];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:m.bgColor,color:m.color},children:[m.icon&&e.jsx(m.icon,{style:{width:"12px",height:"12px"}}),m.label]})}return e.jsx(ts,{category:a,getCategoryConfig:Q})},[t,k,u,Q]);return ve?e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(T,{className:"w-12 h-12 rounded-xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{className:"h-7 w-48"}),e.jsx(T,{className:"h-4 w-64"})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[1,2,3,4,5].map(s=>e.jsx(T,{className:"h-10 w-24 rounded-full flex-shrink-0"},s))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(s=>e.jsx(Xe,{},s))})]}):oe?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-[60px_20px] gap-4",children:[e.jsx(_e,{className:"w-12 h-12 text-red-500"}),e.jsx("p",{className:"text-red-500 text-base text-center",children:oe}),e.jsx("button",{onClick:X,className:"px-6 py-3 rounded-xl border-none bg-primary text-white text-sm font-semibold cursor-pointer hover:opacity-90 transition-opacity",children:we})]}):e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:Ce},children:c&&e.jsx(c,{style:{width:"24px",height:"24px",color:Se}})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[28px] font-bold text-slate-900 m-0",children:r}),e.jsx("p",{className:"text-sm text-slate-600 m-0",children:x})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[b,g&&f&&e.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-5 py-3 rounded-xl border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-all",children:[e.jsx(Oe,{size:18}),N]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(rs,{searchQuery:B,onSearchChange:ye,searchPlaceholder:$,categories:ue.map(s=>({key:s.key,label:s.label,shortLabel:s.shortLabel||s.label,color:s.color,bgColor:s.bgColor,icon:s.IconComponent||s.icon})),selectedCategory:I,onCategoryChange:ce,showCategories:ue.length>0,showDifficulty:!1,viewMode:Z,onViewModeChange:ke,customActions:F})})]}),pe.length>0?e.jsx(Ge,{minCardWidth:"340px",viewMode:Z,children:pe.map(s=>{const a=L?L(s):null,m=v?v(s):[],C=i?i(s):null,Ie=n?n(s):"";return e.jsx(Ke,{title:s.title,description:s.description,icon:a,categoryBadge:Ee(s),meta:m,action:o?{label:l,icon:o}:{label:l},onClick:()=>Le(s),viewMode:Z,customActions:C,className:Ie},s.id)})}):e.jsxs("div",{className:"text-center p-12 px-6 bg-white rounded-2xl border border-slate-200",children:[e.jsx("div",{className:"flex justify-center mb-4",children:E?e.jsx(E,{className:"w-12 h-12 text-slate-300"}):e.jsx(O,{className:"w-12 h-12 text-slate-300"})}),e.jsx("h3",{className:"text-slate-500 m-0 mb-2 font-medium",children:A}),e.jsx("p",{className:"text-slate-400 m-0 text-sm",children:I?"In der ausgewählten Kategorie sind keine Szenarien verfügbar.":R}),I&&y.length>0&&e.jsx("button",{onClick:()=>ce(null),className:"mt-4 px-5 py-2.5 rounded-[20px] border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-colors",children:"Alle Szenarien anzeigen"})]}),te&&te(),je]})};export{ms as S};
