import{j as e,p as _,Y as b}from"./ui-vendor-DceLfMgS.js";import{a as t}from"./react-vendor-uDOJF2jQ.js";import{B as x}from"./button-Dm1kv8LK.js";import{e as S,d as N,b as k,h as v}from"./roleplay-feedback-adapter-rbpgf1-A.js";import{R as w}from"./RoleplaySessionReport-CGHnqsCi.js";import"./formatting-aEs8dNBb.js";import"./designTokens-DbcSlXo4.js";import"./gemini-BjR8xqgX.js";import"./audio-BZs8f3gH.js";import"./useBranding-ZLJ6DZNt.js";import"./useMobile-YxjH166V.js";function B({session:n,onBack:r,onRepeatSession:c}){const[i,p]=t.useState(n),[o,f]=t.useState(null),[j,l]=t.useState(!0),[d,m]=t.useState(null),h=t.useMemo(()=>S(i?.feedback_json),[i?.feedback_json]),y=t.useMemo(()=>N(i?.audio_analysis_json),[i?.audio_analysis_json]);t.useEffect(()=>{u()},[n?.id]);const u=async()=>{try{l(!0),m(null);const s=await k(n.id);if(p(a=>({...s,feedback_json:s.feedback_json||a?.feedback_json,audio_analysis_json:s.audio_analysis_json||a?.audio_analysis_json,transcript:s.transcript||a?.transcript,conversation_id:s.conversation_id||a?.conversation_id})),s.scenario_id)try{const a=await v(s.scenario_id);f(a)}catch(a){console.warn("Could not load scenario:",a)}}catch(s){console.error("Failed to load session:",s),m(s.message||"Fehler beim Laden der Session")}finally{l(!1)}};return j?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"w-12 h-12 text-ocean-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Gesprächsanalyse wird geladen..."})]})}):d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[e.jsx(b,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-slate-600 mb-4",children:d}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(x,{variant:"outline",onClick:r,children:"Zurück"}),e.jsx(x,{onClick:u,children:"Erneut versuchen"})]})]})}):e.jsx(w,{session:i,scenario:o,feedback:h,audioAnalysis:y,onBack:r,onRepeat:o&&c?()=>c(i,o,"roleplay"):void 0})}export{B as default};
