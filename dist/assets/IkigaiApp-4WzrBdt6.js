import{j as r,c as B}from"./ui-vendor-CgXEyNXi.js";import{a as t}from"./react-vendor-uDOJF2jQ.js";import{a as P,I as A}from"./IkigaiResults-D8-ht391.js";import{w as c,i as z,o as L,C as b}from"./FeatureInfoButton-BUfqVR8e.js";import{u as N,a as _,F as q}from"./useScrollToTop-B6j6jc4A.js";import"./useBranding-CHnx5Uxf.js";import"./useMobile-YxjH166V.js";import"./card-h-69AINb.js";import"./index-CklPxmEV.js";import"./utils-BEHD0UYf.js";import"./button-xzdvQGR3.js";import"./AudioRecorder-5hzQyYyg.js";import"./index.js";import"./DeviceSettingsDialog-BlRrTbjP.js";import"./DeviceSetupPage-SATOB3io.js";import"./MicrophoneTestDialog-BayuTD9w.js";const k={love:{key:"love",label:"Leidenschaft",title:"Deine Leidenschaft",icon:"â¤ï¸",color:"#E11D48",question:"Stell dir vor, Geld spielt keine Rolle: Womit wÃ¼rdest du deinen Tag verbringen? Bei welchem Thema vergisst du vÃ¶llig die Zeit?",placeholder:"Schreib einfach drauf los: Hobbys, Themen, TÃ¤tigkeiten...",description:"Was treibt dich an?"},talent:{key:"talent",label:"StÃ¤rken",title:"Deine StÃ¤rken",icon:"â­",color:"#F59E0B",question:'WofÃ¼r bitten dich Freunde oder Kollegen oft um Rat? Was erledigst du "mit links", wÃ¤hrend andere daran verzweifeln?',placeholder:"Z.B. Organisieren, ZuhÃ¶ren, Coden, Designen...",description:"Was fÃ¤llt dir leicht?"},need:{key:"need",label:"Mission",title:"Deine Mission",icon:"ðŸŒ",color:"#10B981",question:"Welches Problem in der Gesellschaft oder Wirtschaft nervt dich? Wo wÃ¼rdest du gerne mitanpacken, um Dinge zu verbessern?",placeholder:"Z.B. Nachhaltigkeit, Bildung, bessere Software, Pflege...",description:"Welchen Beitrag leistest du?"},market:{key:"market",label:"Markt",title:"Der Markt",icon:"ðŸ’°",color:"#6366F1",question:"Welche deiner FÃ¤higkeiten sind bares Geld wert? FÃ¼r welche Jobs oder Dienstleistungen existiert ein echtes Budget?",placeholder:"Z.B. Projektmanagement, Beratung, Handwerk...",description:"WofÃ¼r wirst du bezahlt?"}};Object.values(k).map(u=>u.color);const o={COMPASS:"compass",RESULTS:"results"},re=({isAuthenticated:u,requireAuth:y,setPendingAction:G,onNavigateToHistory:v})=>{const[S,g]=t.useState(o.COMPASS),[l,f]=t.useState(null),[C,w]=t.useState(!1),x=L(b.purple[500],b.purple[400]),[a,p]=t.useState({love:{input:"",tags:[]},talent:{input:"",tags:[]},need:{input:"",tags:[]},market:{input:"",tags:[]}}),[D,h]=t.useState(null),I=t.useRef(!1);N(u,y),_({dependencies:[S]});const m=Object.values(a).every(e=>e.tags&&e.tags.length>0),d=t.useCallback(async()=>{if(l)return l;try{const e=await c.createIkigai();if(e?.id)return f(e.id),I.current=!0,console.log("[Ikigai] Session created with ID:",e.id),e.id}catch(e){console.error("[Ikigai] Failed to create session:",e)}return null},[l]),F=t.useCallback(async(e,i,s)=>{p(n=>({...n,[e]:{input:i,tags:s}}));try{const n=await d();n&&(await c.updateIkigai(n,{[`${e}_input`]:i,[`${e}_tags`]:s}),console.log(`[Ikigai] Dimension ${e} saved`))}catch(n){console.error("[Ikigai] Failed to save dimension:",n)}},[d]),R=t.useCallback(async(e,i)=>{try{const s=await c.extractIkigaiKeywords(e,i);return s?.keywords?s.keywords:[]}catch(s){return console.error("[Ikigai] Failed to extract keywords:",s),[]}},[]),M=t.useCallback(async()=>{if(m){w(!0);try{const e=await c.synthesizeIkigaiPaths({love_tags:a.love.tags,talent_tags:a.talent.tags,need_tags:a.need.tags,market_tags:a.market.tags});if(e){h(e);const i=l||await d();i&&await c.updateIkigai(i,{summary:e.summary,paths:e.paths,status:"completed"}),g(o.RESULTS)}}catch(e){console.error("[Ikigai] Failed to synthesize paths:",e)}finally{w(!1)}}},[m,a,l,d]),E=t.useCallback((e,i)=>{p(s=>{const n=s[e].tags.filter(j=>j!==i);return{...s,[e]:{...s[e],tags:n}}})},[]),O=t.useCallback(()=>{p({love:{input:"",tags:[]},talent:{input:"",tags:[]},need:{input:"",tags:[]},market:{input:"",tags:[]}}),h(null),f(null),I.current=!1,g(o.COMPASS)},[]),T=t.useCallback(()=>{h(null),g(o.COMPASS)},[]),W=()=>{switch(S){case o.RESULTS:return r.jsx(A,{dimensions:a,synthesisResult:D,onStartNew:O,onEdit:T,DIMENSIONS:k});case o.COMPASS:default:return r.jsx(P,{dimensions:a,DIMENSIONS:k,onExtractKeywords:R,onUpdateDimension:F,onRemoveTag:E,allDimensionsFilled:m,onSynthesize:M,isSynthesizing:C})}};return r.jsxs(r.Fragment,{children:[r.jsx(z,{featureId:"ikigai",showOnMount:!0}),r.jsxs("div",{className:"min-h-full",children:[r.jsx(q,{featureId:"ikigai",icon:B,title:"Ikigai-Kompass",subtitle:"Finde deine berufliche Bestimmung",gradient:x,historyLabel:"Meine Ikigai",onNavigateToHistory:v}),W()]})]})};export{re as default};
