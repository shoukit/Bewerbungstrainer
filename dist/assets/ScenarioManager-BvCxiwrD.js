import{a as l,w as b,j as e,L as w}from"./colors-uXoD1ofg.js";import{C as k,c as z}from"./card-yT1Kc5UP.js";import{B as n}from"./button-DQcX-0MN.js";import{I as u}from"./input-uBKhtwx2.js";import{T as N}from"./textarea-sJoyi7Lz.js";import{D as E,a as L,b as A,c as T,d as B,e as I}from"./dialog-CY6-yJYz.js";import{F as ie,a as R}from"./form-accordion-SGrPXVDv.js";import{C as re}from"./circle-check-big-i8yN9nVa.js";import{C as K}from"./circle-alert-EMpUppYH.js";import{X as le,M as F,F as ne}from"./index.js";import{A as ae}from"./arrow-left-CtCRDCiU.js";import{P as ce}from"./plus-Ccuv5nNX.js";import{S as oe}from"./search-OidDqMnQ.js";import{P as de}from"./pencil-uVLlUdS0.js";import{T as he}from"./trash-2-5YY_ZL8K.js";import{U as me}from"./user-C299kFlx.js";import{S as xe}from"./settings-D2vnp0Xs.js";import"./utils-BEHD0UYf.js";import"./designTokens-DbcSlXo4.js";function Be({onBack:t}){const[r,i]=l.useState([]),[y,O]=l.useState(!0),[S,P]=l.useState(null),[h,V]=l.useState(""),[$,p]=l.useState(!1),[Q,g]=l.useState(!1),[Z,j]=l.useState(!1),[C,G]=l.useState(null),[c,o]=l.useState(!1),[d,f]=l.useState({title:"",description:"",agent_id:"",initial_message:"",difficulty:"medium",status:"draft",coaching_hints:"",interviewer_profile:{name:"",role:"",properties:""}}),[v,_]=l.useState(null);l.useEffect(()=>{m()},[]);const m=async()=>{try{O(!0),P(null);const s=await b.adminGetRoleplayScenarios();if(s.success)i(s.data||[]);else throw new Error("Fehler beim Laden der Szenarien")}catch(s){P(s.message),a("error","Fehler beim Laden der Szenarien")}finally{O(!1)}},a=(s,x)=>{_({type:s,message:x}),setTimeout(()=>_(null),4e3)},M=()=>{f({title:"",description:"",agent_id:"",initial_message:"",difficulty:"medium",status:"draft",coaching_hints:"",interviewer_profile:{name:"",role:"",properties:""}}),p(!0)},q=s=>{G(s),f({title:s.title||"",description:s.description||"",agent_id:s.agent_id||"",initial_message:s.initial_message||"",difficulty:s.difficulty||"medium",status:s.status||"draft",coaching_hints:s.coaching_hints||"",interviewer_profile:{name:s.interviewer_profile?.name||"",role:s.interviewer_profile?.role||"",properties:s.interviewer_profile?.properties||""}}),g(!0)},X=s=>{G(s),j(!0)},J=async()=>{if(!d.title.trim()){a("error","Bitte geben Sie einen Titel ein");return}try{if(o(!0),(await b.adminCreateRoleplayScenario(d)).success)a("success","Szenario erfolgreich erstellt"),p(!1),m();else throw new Error("Fehler beim Erstellen")}catch(s){a("error",s.message)}finally{o(!1)}},W=async()=>{if(!d.title.trim()){a("error","Bitte geben Sie einen Titel ein");return}try{if(o(!0),(await b.adminUpdateRoleplayScenario(C.id,d)).success)a("success","Szenario erfolgreich aktualisiert"),g(!1),m();else throw new Error("Fehler beim Aktualisieren")}catch(s){a("error",s.message)}finally{o(!1)}},Y=async()=>{try{if(o(!0),(await b.adminDeleteRoleplayScenario(C.id)).success)a("success","Szenario erfolgreich gelöscht"),j(!1),m();else throw new Error("Fehler beim Löschen")}catch(s){a("error",s.message)}finally{o(!1)}},H=r.filter(s=>s.title?.toLowerCase().includes(h.toLowerCase())||s.description?.toLowerCase().includes(h.toLowerCase())),D=s=>({easy:"Einfach",medium:"Mittel",hard:"Schwer"})[s]||s,ee=s=>({easy:"bg-green-100 text-green-700",medium:"bg-yellow-100 text-yellow-700",hard:"bg-red-100 text-red-700"})[s]||"bg-gray-100 text-gray-700",se=s=>({publish:"Veröffentlicht",draft:"Entwurf",pending:"Ausstehend"})[s]||s,te=s=>({publish:"bg-green-100 text-green-700",draft:"bg-gray-100 text-gray-700",pending:"bg-yellow-100 text-yellow-700"})[s]||"bg-gray-100 text-gray-700";return e.jsxs("div",{className:"space-y-6",children:[v&&e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center gap-2 px-4 py-3 rounded-lg shadow-lg ${v.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:[v.type==="success"?e.jsx(re,{className:"w-5 h-5"}):e.jsx(K,{className:"w-5 h-5"}),v.message,e.jsx("button",{onClick:()=>_(null),className:"ml-2 hover:opacity-80",children:e.jsx(le,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{variant:"ghost",onClick:t,className:"p-2",children:e.jsx(ae,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:e.jsx(F,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-[var(--text-main)]",children:"Live-Simulationen (Roleplays)"}),e.jsxs("p",{className:"text-sm text-[var(--text-secondary)]",children:[r.length," Szenarien"]})]})]})]}),e.jsxs(n,{onClick:M,className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"Neues Szenario"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-[var(--text-muted)]"}),e.jsx(u,{placeholder:"Szenarien durchsuchen...",value:h,onChange:s=>V(s.target.value),className:"pl-10"})]}),y&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(w,{className:"w-8 h-8 animate-spin text-[var(--primary-accent)]"})}),S&&!y&&e.jsx(k,{className:"border-red-200 bg-red-50",children:e.jsx(z,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-red-700",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("p",{children:S}),e.jsx(n,{variant:"outline",size:"sm",onClick:m,children:"Erneut versuchen"})]})})}),!y&&!S&&e.jsx("div",{className:"space-y-3",children:H.length===0?e.jsx(k,{children:e.jsx(z,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"w-12 h-12 text-[var(--text-muted)] mx-auto mb-3"}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:h?"Keine Szenarien gefunden":"Noch keine Szenarien vorhanden"}),!h&&e.jsx(n,{onClick:M,className:"mt-4",children:"Erstes Szenario erstellen"})]})})}):H.map(s=>e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(z,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-main)]",children:s.title}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${te(s.status)}`,children:se(s.status)}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${ee(s.difficulty)}`,children:D(s.difficulty)})]}),s.description&&e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-[var(--text-muted)]",children:[s.agent_id&&e.jsxs("span",{children:["Agent: ",s.agent_id.substring(0,12),"..."]}),e.jsxs("span",{children:["ID: ",s.id]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>q(s),className:"text-[var(--text-secondary)] hover:text-[var(--primary-accent)]",children:e.jsx(de,{className:"w-4 h-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>X(s),className:"text-[var(--text-secondary)] hover:text-red-600",children:e.jsx(he,{className:"w-4 h-4"})})]})]})})},s.id))}),e.jsx(E,{open:$,onOpenChange:p,children:e.jsxs(L,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(A,{children:[e.jsx(T,{children:"Neues Szenario erstellen"}),e.jsx(B,{children:"Erstellen Sie ein neues Roleplay-Szenario für Live-Simulationen."})]}),e.jsx(U,{formData:d,setFormData:f}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>p(!1),children:"Abbrechen"}),e.jsxs(n,{onClick:J,disabled:c,children:[c&&e.jsx(w,{className:"w-4 h-4 mr-2 animate-spin"}),"Erstellen"]})]})]})}),e.jsx(E,{open:Q,onOpenChange:g,children:e.jsxs(L,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(A,{children:[e.jsx(T,{children:"Szenario bearbeiten"}),e.jsx(B,{children:"Bearbeiten Sie das ausgewählte Roleplay-Szenario."})]}),e.jsx(U,{formData:d,setFormData:f}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>g(!1),children:"Abbrechen"}),e.jsxs(n,{onClick:W,disabled:c,children:[c&&e.jsx(w,{className:"w-4 h-4 mr-2 animate-spin"}),"Speichern"]})]})]})}),e.jsx(E,{open:Z,onOpenChange:j,children:e.jsxs(L,{children:[e.jsxs(A,{children:[e.jsx(T,{children:"Szenario löschen"}),e.jsxs(B,{children:['Sind Sie sicher, dass Sie das Szenario "',C?.title,'" löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.']})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>j(!1),children:"Abbrechen"}),e.jsxs(n,{variant:"destructive",onClick:Y,disabled:c,children:[c&&e.jsx(w,{className:"w-4 h-4 mr-2 animate-spin"}),"Löschen"]})]})]})})]})}function U({formData:t,setFormData:r}){return e.jsxs(ie,{children:[e.jsx(R,{title:"Grundinformationen",subtitle:"Titel, Beschreibung und Basiseinstellungen",icon:ne,accentColor:"blue",defaultExpanded:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Titel ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{value:t.title,onChange:i=>r({...t,title:i.target.value}),placeholder:"z.B. Vorstellungsgespräch IT-Consultant"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Beschreibung"}),e.jsx(N,{value:t.description,onChange:i=>r({...t,description:i.target.value}),placeholder:"Kurze Beschreibung des Szenarios...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:t.status,onChange:i=>r({...t,status:i.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"draft",children:"Entwurf"}),e.jsx("option",{value:"publish",children:"Veröffentlicht"}),e.jsx("option",{value:"pending",children:"Ausstehend"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Schwierigkeit"}),e.jsxs("select",{value:t.difficulty,onChange:i=>r({...t,difficulty:i.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"easy",children:"Einfach"}),e.jsx("option",{value:"medium",children:"Mittel"}),e.jsx("option",{value:"hard",children:"Schwer"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ElevenLabs Agent ID"}),e.jsx(u,{value:t.agent_id,onChange:i=>r({...t,agent_id:i.target.value}),placeholder:"agent_xxx..."}),e.jsx("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:"Die Agent ID aus Ihrem ElevenLabs Dashboard"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Erste Nachricht"}),e.jsx(N,{value:t.initial_message,onChange:i=>r({...t,initial_message:i.target.value}),placeholder:"Die erste Nachricht des KI-Gesprächspartners...",rows:3}),e.jsxs("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:["Platzhalter: ","{{user_name}}",", ","{{company_name}}",", ","{{position}}"]})]})]})}),e.jsx(R,{title:"Gesprächspartner-Profil",subtitle:"Name, Rolle und Eigenschaften des KI-Interviewers",icon:me,accentColor:"teal",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx(u,{value:t.interviewer_profile.name,onChange:i=>r({...t,interviewer_profile:{...t.interviewer_profile,name:i.target.value}}),placeholder:"z.B. Dr. Maria Schmidt"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Rolle/Position"}),e.jsx(u,{value:t.interviewer_profile.role,onChange:i=>r({...t,interviewer_profile:{...t.interviewer_profile,role:i.target.value}}),placeholder:"z.B. HR-Leiterin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Eigenschaften"}),e.jsx(N,{value:t.interviewer_profile.properties,onChange:i=>r({...t,interviewer_profile:{...t.interviewer_profile,properties:i.target.value}}),placeholder:"Charaktereigenschaften (eine pro Zeile)...",rows:3})]})]})}),e.jsx(R,{title:"Erweiterte Einstellungen",subtitle:"Coaching-Hinweise und zusätzliche Konfiguration",icon:xe,accentColor:"purple",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Coaching-Hinweise"}),e.jsx(N,{value:t.coaching_hints,onChange:i=>r({...t,coaching_hints:i.target.value}),placeholder:"Tipps für den Benutzer während des Gesprächs (eine pro Zeile)...",rows:4}),e.jsx("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:"Diese Hinweise werden im Live-Coaching-Panel angezeigt"})]})})})]})}export{Be as default};
