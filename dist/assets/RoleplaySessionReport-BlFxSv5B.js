import{j as e,m as b,a7 as J,a6 as se,l as H,z as pe,a2 as xe,a3 as fe,a4 as E,a5 as ue,M as Q,N as ge,w as he,a8 as ye,e as G,A as B,u as Z,q as me,y as je,T as be,a0 as ve,af as q,ag as Se,ah as ke,k as we,v as ze,O as Ce,b as Re,Q as re,_ as P}from"./ui-vendor-BmgxlMsf.js";import{a as u}from"./react-vendor-uDOJF2jQ.js";import{u as Ie}from"./useBranding-D1cHbBzE.js";import{u as Me}from"./useMobile-YxjH166V.js";import{i as ee,h as Y,b as le}from"./FeatureInfoButton-nGplUxMY.js";import{b as We,e as Te,d as Be,p as Ae,i as Le}from"./index.js";const _e=({score:t,size:l=100,primaryAccent:i,isHeader:n=!1})=>{const r=Math.min(100,Math.max(0,t||0)),o=(l-10)/2,p=o*2*Math.PI,a=p-r/100*p,s=ee(t,i);return e.jsxs("div",{style:{position:"relative",width:l,height:l},children:[e.jsxs("svg",{width:l,height:l,style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:l/2,cy:l/2,r:o,fill:"none",stroke:n?"rgba(255,255,255,0.25)":"#e2e8f0",strokeWidth:8}),e.jsx(b.circle,{cx:l/2,cy:l/2,r:o,fill:"none",stroke:n?"#fff":s,strokeWidth:8,strokeLinecap:"round",strokeDasharray:p,initial:{strokeDashoffset:p},animate:{strokeDashoffset:a},transition:{duration:1.2,ease:"easeOut"}})]}),e.jsx("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:e.jsx(b.span,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.4},style:{fontSize:l/3,fontWeight:700,color:n?"#fff":s,lineHeight:1},children:Math.round(t)})})]})},De=({audioUrl:t,duration:l,primaryAccent:i,branding:n,onSeek:r})=>{const o=u.useRef(null),p=u.useRef(null),a=u.useRef(null),[s,y]=u.useState(!1),[v,S]=u.useState(!1),[k,g]=u.useState(0),[d,x]=u.useState(l||0),[h,f]=u.useState(!0),[w,R]=u.useState(null);u.useEffect(()=>{if(!t)return;let j=!0;const W=t.includes("/wp-json/")||t.includes("/api/");return(async()=>{try{f(!0),R(null);let z=t;if(W){const L=await fetch(t,{method:"GET",headers:{"X-WP-Nonce":le()},credentials:"same-origin"});if(!L.ok)throw new Error(`HTTP ${L.status}`);const _=await L.blob();if(!j)return;if(_.size===0)throw new Error("Audio nicht verfügbar");const D=URL.createObjectURL(_);a.current=D,z=D}const m=new Audio(z);o.current=m,m.addEventListener("loadedmetadata",()=>{j&&(x(m.duration),f(!1))}),m.addEventListener("timeupdate",()=>{j&&g(m.currentTime)}),m.addEventListener("ended",()=>{j&&(y(!1),g(0))}),m.addEventListener("error",()=>{j&&(R("Audio konnte nicht geladen werden"),f(!1))})}catch(z){console.error("[AudioPlayer] Failed to load audio:",z),j&&(R("Audio konnte nicht geladen werden"),f(!1))}})(),()=>{j=!1,o.current&&(o.current.pause(),o.current.src=""),a.current&&URL.revokeObjectURL(a.current)}},[t]);const K=()=>{o.current&&(s?o.current.pause():o.current.play(),y(!s))},V=()=>{o.current&&(o.current.muted=!v,S(!v))},A=j=>{o.current&&(o.current.currentTime=Math.max(0,Math.min(d,o.current.currentTime+j)))},c=j=>{o.current&&(o.current.currentTime=j,g(j),s||(o.current.play(),y(!0)))};u.useEffect(()=>{r&&(r.current=c)},[r]);const M=j=>{if(!p.current||!d)return;const W=p.current.getBoundingClientRect(),N=(j.clientX-W.left)/W.width;c(N*d)};return t?e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${n.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(J,{size:18,color:i}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:n.textMain},children:"Gesprächsaufnahme"})]}),e.jsx("div",{ref:p,onClick:M,style:{position:"relative",height:"48px",background:n.cardBgHover,borderRadius:"12px",cursor:"pointer",overflow:"hidden",marginBottom:"16px"},children:h?e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx(H,{size:24,color:i,style:{animation:"spin 1s linear infinite"}})}):w?e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",gap:"8px"},children:[e.jsx(pe,{size:18,color:n.warning}),e.jsx("span",{style:{fontSize:"13px",color:n.textMuted},children:w})]}):e.jsxs(e.Fragment,{children:[e.jsx(b.div,{initial:{width:0},animate:{width:`${d>0?k/d*100:0}%`},style:{position:"absolute",inset:0,background:`linear-gradient(90deg, ${i}40, ${i}60)`,borderRadius:"12px"}}),e.jsx("div",{style:{position:"absolute",left:`${d>0?k/d*100:0}%`,top:0,bottom:0,width:"3px",background:i,transform:"translateX(-50%)"}})]})}),!w&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("button",{onClick:()=>A(-10),disabled:h,style:{width:"36px",height:"36px",borderRadius:"8px",border:"none",background:n.cardBgHover,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:h?.5:1},children:e.jsx(xe,{size:20,color:n.textSecondary})}),e.jsx("button",{onClick:K,disabled:h,style:{width:"48px",height:"48px",borderRadius:"50%",border:"none",background:i,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:h?.5:1},children:s?e.jsx(fe,{size:20,color:"#fff"}):e.jsx(E,{size:20,color:"#fff",style:{marginLeft:"2px"}})}),e.jsx("button",{onClick:()=>A(10),disabled:h,style:{width:"36px",height:"36px",borderRadius:"8px",border:"none",background:n.cardBgHover,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:h?.5:1},children:e.jsx(ue,{size:20,color:n.textSecondary})})]}),e.jsxs("div",{style:{flex:1,textAlign:"center",fontSize:"14px",color:n.textSecondary,fontFamily:"monospace"},children:[Y(k)," / ",Y(d)]}),e.jsx("button",{onClick:V,disabled:h,style:{width:"36px",height:"36px",borderRadius:"8px",border:"none",background:n.cardBgHover,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:v?e.jsx(se,{size:20,color:n.textSecondary}):e.jsx(J,{size:20,color:n.textSecondary})})]})]}):e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${n.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(J,{size:18,color:n.textMuted}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:n.textMain},children:"Gesprächsaufnahme"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"80px",background:n.cardBgHover,borderRadius:"12px",color:n.textMuted,fontSize:"13px"},children:[e.jsx(se,{size:20,style:{marginRight:"8px"}}),"Keine Audioaufnahme verfügbar"]})]})},$e=({transcript:t,scenario:l,primaryAccent:i,branding:n,onSeekToTime:r})=>!t||t.length===0?e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"40px 20px",border:`1px solid ${n.borderColor}`,textAlign:"center"},children:[e.jsx(Q,{size:32,color:n.textMuted,style:{marginBottom:"12px"}}),e.jsx("p",{style:{color:n.textMuted,fontSize:"14px"},children:"Kein Transkript verfügbar"})]}):e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${n.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(Q,{size:18,color:i}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:n.textMain},children:"Gesprächsverlauf"})]}),e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto",paddingRight:"8px"},children:t.map((o,p)=>{const a=o.role==="agent",s=o.timeLabel||(o.elapsedTime!==void 0?Y(o.elapsedTime):null);return e.jsxs(b.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:p*.03},style:{display:"flex",gap:"10px",marginBottom:"12px",flexDirection:a?"row":"row-reverse"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",flexShrink:0},children:[a?l?.interviewer_profile?.image_url?e.jsx("img",{src:l.interviewer_profile.image_url,alt:l.interviewer_profile.name||"Interviewer",style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",border:`2px solid ${i}30`}}):e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:`linear-gradient(135deg, ${i}, ${i}cc)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ge,{size:16,color:"#fff"})}):e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"linear-gradient(135deg, #14b8a6, #0d9488)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{size:16,color:"#fff"})}),!a&&s&&e.jsx("button",{onClick:()=>r?.(o.elapsedTime),style:{fontSize:"10px",fontFamily:"monospace",color:i,background:"none",border:"none",cursor:"pointer",padding:0},children:s})]}),e.jsx("div",{style:{maxWidth:"85%",padding:"10px 14px",borderRadius:a?"4px 16px 16px 16px":"16px 4px 16px 16px",background:a?n.cardBgHover:"linear-gradient(135deg, #14b8a6, #0d9488)",color:a?n.textMain:"#fff",fontSize:"13px",lineHeight:1.5,border:a?`1px solid ${n.borderColor}`:"none"},children:o.text})]},p)})})]}),U=({label:t,value:l,maxValue:i=10,primaryAccent:n,branding:r})=>{const o=l/i*100,p=i===10?l*10:l,a=ee(p,n);return e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[e.jsx("span",{style:{fontSize:"13px",color:r.textSecondary},children:t}),e.jsx("span",{style:{fontSize:"13px",fontWeight:600,color:a},children:p})]}),e.jsx("div",{style:{height:"6px",background:r.cardBgHover,borderRadius:"3px",overflow:"hidden"},children:e.jsx(b.div,{initial:{width:0},animate:{width:`${o}%`},transition:{duration:.8,ease:"easeOut"},style:{height:"100%",background:a,borderRadius:"3px"}})})]})},Fe=({feedback:t,audioAnalysis:l,primaryAccent:i,branding:n})=>{const[r,o]=u.useState("summary"),p=a=>{o(r===a?null:a)};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t?.summary&&e.jsxs("div",{style:{background:`${i}08`,borderRadius:"12px",border:`1px solid ${i}20`,overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>p("summary"),style:{width:"100%",padding:"14px 16px",display:"flex",alignItems:"center",gap:"10px",background:"none",border:"none",cursor:"pointer",textAlign:"left"},children:[e.jsx(ye,{size:18,color:i}),e.jsx("span",{style:{flex:1,fontSize:"14px",fontWeight:600,color:n.textMain},children:"Gesamtbewertung"}),e.jsx(G,{size:18,color:n.textMuted,style:{transform:r==="summary"?"rotate(180deg)":"none",transition:"transform 0.2s"}})]}),e.jsx(B,{children:r==="summary"&&e.jsx(b.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsx("div",{style:{padding:"0 16px 16px"},children:e.jsx("p",{style:{fontSize:"13px",lineHeight:1.7,color:n.textSecondary},children:t.summary})})})})]}),t?.strengths?.length>0&&e.jsxs("div",{style:{background:"#f0fdf4",borderRadius:"12px",border:"1px solid #bbf7d0",overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>p("strengths"),style:{width:"100%",padding:"14px 16px",display:"flex",alignItems:"center",gap:"10px",background:"none",border:"none",cursor:"pointer",textAlign:"left"},children:[e.jsx(Z,{size:18,color:"#22c55e"}),e.jsx("span",{style:{flex:1,fontSize:"14px",fontWeight:600,color:"#166534"},children:"Deine Superkräfte"}),e.jsxs("span",{style:{fontSize:"12px",color:"#22c55e",fontWeight:500},children:[t.strengths.length," Stärken"]}),e.jsx(G,{size:18,color:"#22c55e",style:{transform:r==="strengths"?"rotate(180deg)":"none",transition:"transform 0.2s"}})]}),e.jsx(B,{children:r==="strengths"&&e.jsx(b.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsx("div",{style:{padding:"0 16px 16px"},children:t.strengths.map((a,s)=>e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"#dcfce7",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"2px"},children:e.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"#22c55e"},children:"✓"})}),e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:"#166534",margin:0},children:a})]},s))})})})]}),t?.improvements?.length>0&&e.jsxs("div",{style:{background:"#fffbeb",borderRadius:"12px",border:"1px solid #fde68a",overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>p("improvements"),style:{width:"100%",padding:"14px 16px",display:"flex",alignItems:"center",gap:"10px",background:"none",border:"none",cursor:"pointer",textAlign:"left"},children:[e.jsx(me,{size:18,color:"#f59e0b"}),e.jsx("span",{style:{flex:1,fontSize:"14px",fontWeight:600,color:"#92400e"},children:"Dein Trainingsfeld"}),e.jsxs("span",{style:{fontSize:"12px",color:"#f59e0b",fontWeight:500},children:[t.improvements.length," Punkte"]}),e.jsx(G,{size:18,color:"#f59e0b",style:{transform:r==="improvements"?"rotate(180deg)":"none",transition:"transform 0.2s"}})]}),e.jsx(B,{children:r==="improvements"&&e.jsx(b.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsx("div",{style:{padding:"0 16px 16px"},children:t.improvements.map((a,s)=>e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[e.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:"#fef3c7",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"2px"},children:e.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"#f59e0b"},children:s+1})}),e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:"#92400e",margin:0},children:a})]},s))})})})]}),t?.tips?.length>0&&e.jsxs("div",{style:{background:"#eff6ff",borderRadius:"12px",border:"1px solid #bfdbfe",overflow:"hidden"},children:[e.jsxs("button",{onClick:()=>p("tips"),style:{width:"100%",padding:"14px 16px",display:"flex",alignItems:"center",gap:"10px",background:"none",border:"none",cursor:"pointer",textAlign:"left"},children:[e.jsx(je,{size:18,color:"#3b82f6"}),e.jsx("span",{style:{flex:1,fontSize:"14px",fontWeight:600,color:"#1e40af"},children:"Praktische Tipps"}),e.jsxs("span",{style:{fontSize:"12px",color:"#3b82f6",fontWeight:500},children:[t.tips.length," Tipps"]}),e.jsx(G,{size:18,color:"#3b82f6",style:{transform:r==="tips"?"rotate(180deg)":"none",transition:"transform 0.2s"}})]}),e.jsx(B,{children:r==="tips"&&e.jsx(b.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:e.jsx("div",{style:{padding:"0 16px 16px"},children:t.tips.map((a,s)=>e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[e.jsx(be,{size:16,color:"#3b82f6",style:{flexShrink:0,marginTop:"2px"}}),e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:"#1e40af",margin:0},children:a})]},s))})})})]}),t?.rating&&e.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"16px",border:`1px solid ${n.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(ve,{size:18,color:i}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:n.textMain},children:"Bewertungskriterien"})]}),t.rating.communication!==void 0&&e.jsx(U,{label:"Kommunikation",value:t.rating.communication,primaryAccent:i,branding:n}),t.rating.motivation!==void 0&&e.jsx(U,{label:"Motivation",value:t.rating.motivation,primaryAccent:i,branding:n}),t.rating.professionalism!==void 0&&e.jsx(U,{label:"Professionalität",value:t.rating.professionalism,primaryAccent:i,branding:n}),t.rating.preparation!==void 0&&e.jsx(U,{label:"Vorbereitung",value:t.rating.preparation,primaryAccent:i,branding:n})]})]})},He=t=>t>=80?{color:"#22c55e",bg:"#f0fdf4",label:"Sehr selbstsicher"}:t>=60?{color:"#3b82f6",bg:"#eff6ff",label:"Selbstsicher"}:t>=40?{color:"#f59e0b",bg:"#fffbeb",label:"Ausbaufähig"}:{color:"#ef4444",bg:"#fef2f2",label:"Unsicher"},Ee=t=>{switch(t){case"zu_langsam":return 15;case"optimal":return 50;case"zu_schnell":return 85;default:return 50}},oe=t=>{if(typeof t=="number")return t;if(!t||typeof t!="string")return 0;const l=t.split(":");if(l.length===2){const i=parseInt(l[0],10)||0,n=parseInt(l[1],10)||0;return i*60+n}if(l.length===3){const i=parseInt(l[0],10)||0,n=parseInt(l[1],10)||0,r=parseInt(l[2],10)||0;return i*3600+n*60+r}return parseFloat(t)||0},Ne=t=>t==="lebendig"?"Lebendig":t==="natürlich"?"Natürlich":"Monoton",Oe=t=>t==="lebendig"?{base:20,variance:30}:t==="natürlich"?{base:25,variance:20}:{base:35,variance:8},Ge=({audioAnalysis:t,primaryAccent:l,branding:i,onJumpToTimestamp:n})=>{const r=t?.audio_metrics||t,o=r&&(r.confidence_score!==void 0||r.speech_cleanliness||r.pacing||r.tonality);if(!t||!o)return e.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"40px 20px",border:`1px solid ${i.borderColor}`,textAlign:"center"},children:[e.jsx(q,{size:32,color:i.textMuted,style:{marginBottom:"12px"}}),e.jsx("p",{style:{color:i.textMuted,fontSize:"14px"},children:"Keine Audio-Analyse verfügbar"})]});const p=r.confidence_score,a=r.speech_cleanliness,s=r.pacing,y=r.tonality,v=a?.total_filler_count||0,S=a?.filler_word_analysis||[],k=a?.feedback;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[p!==void 0&&e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${i.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(q,{size:18,color:l}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:i.textMain},children:"Selbstsicherheit"})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"16px"},children:(()=>{const g=p,d=He(g),x=140,h=x/2-12,f=Math.PI*h,w=f-g/100*f;return e.jsxs("div",{style:{background:d.bg,borderRadius:"16px",padding:"20px 30px",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",width:x,height:x/2+20},children:[e.jsxs("svg",{width:x,height:x/2+20,style:{overflow:"visible"},children:[e.jsx("path",{d:`M 12 ${x/2} A ${h} ${h} 0 0 1 ${x-12} ${x/2}`,fill:"none",stroke:"#e2e8f0",strokeWidth:"10",strokeLinecap:"round"}),e.jsx(b.path,{d:`M 12 ${x/2} A ${h} ${h} 0 0 1 ${x-12} ${x/2}`,fill:"none",stroke:d.color,strokeWidth:"10",strokeLinecap:"round",strokeDasharray:f,initial:{strokeDashoffset:f},animate:{strokeDashoffset:w},transition:{duration:1.2,ease:"easeOut"}})]}),e.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end",paddingBottom:"4px"},children:[e.jsx(b.span,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.5},style:{fontSize:"32px",fontWeight:700,color:d.color},children:Math.round(g)}),e.jsx("span",{style:{fontSize:"11px",color:i.textMuted},children:"/ 100"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"8px"},children:[e.jsx(q,{size:14,color:d.color}),e.jsx("span",{style:{fontSize:"13px",fontWeight:600,color:d.color},children:d.label})]})]})})()}),r.summary_text&&e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:i.textSecondary,textAlign:"center"},children:r.summary_text})]}),a&&e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${i.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Q,{size:18,color:"#f97316"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:i.textMain},children:"Füllwörter"})]}),e.jsxs("span",{style:{fontSize:"13px",fontWeight:600,padding:"4px 10px",borderRadius:"20px",background:v<=2?"#dcfce7":v<=5?"#fef3c7":"#fee2e2",color:v<=2?"#166534":v<=5?"#92400e":"#991b1b"},children:[v,"x gesamt"]})]}),S.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",marginBottom:"12px"},children:S.map((g,d)=>e.jsxs("div",{style:{borderRadius:"8px",background:"#fef3c7",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px"},children:[e.jsxs("span",{style:{fontSize:"13px",color:"#92400e",fontWeight:500},children:['"',g.word,'"']}),e.jsxs("span",{style:{fontSize:"12px",color:"#92400e",fontWeight:600},children:[g.count,"x"]})]}),g.examples?.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",padding:"8px 12px",background:"#fef9e7",borderTop:"1px solid #fde68a"},children:g.examples.map((x,h)=>e.jsxs("button",{onClick:()=>n?.(oe(x.timestamp)),style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"4px 8px",borderRadius:"6px",border:"none",background:"#fef3c7",cursor:"pointer",fontSize:"11px",color:"#92400e",transition:"all 0.15s"},onMouseOver:f=>f.currentTarget.style.background="#fde68a",onMouseOut:f=>f.currentTarget.style.background="#fef3c7",children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:x.timestamp}),e.jsx(E,{size:10})]},h))})]},d))}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#22c55e"},children:[e.jsx(Z,{size:16}),e.jsx("span",{style:{fontSize:"13px"},children:"Keine Füllwörter erkannt!"})]}),k&&e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:i.textSecondary,marginTop:"12px"},children:k})]}),s&&e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${i.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Se,{size:18,color:"#3b82f6"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:i.textMain},children:"Sprechtempo"})]}),s.estimated_wpm&&e.jsxs("span",{style:{fontSize:"12px",fontFamily:"monospace",padding:"4px 10px",borderRadius:"6px",background:i.cardBgHover,color:i.textSecondary},children:["~",s.estimated_wpm," WPM"]})]}),e.jsxs("div",{style:{position:"relative",height:"40px",marginBottom:"8px"},children:[e.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"8px",borderRadius:"4px",background:"linear-gradient(90deg, #93c5fd, #86efac, #fca5a5)",transform:"translateY(-50%)"}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",width:"60px",height:"16px",background:"rgba(34, 197, 94, 0.2)",border:"1px solid #22c55e",borderRadius:"8px",transform:"translate(-50%, -50%)"}}),e.jsx(b.div,{initial:{left:"50%"},animate:{left:`${Ee(s.rating)}%`},transition:{duration:.8,ease:"easeOut"},style:{position:"absolute",top:"50%",width:"16px",height:"16px",borderRadius:"50%",background:s.rating==="optimal"?"#22c55e":"#f59e0b",border:"2px solid #fff",boxShadow:"0 2px 6px rgba(0,0,0,0.2)",transform:"translate(-50%, -50%)"}}),e.jsxs("div",{style:{position:"absolute",bottom:"-4px",left:0,right:0,display:"flex",justifyContent:"space-between",fontSize:"10px",color:i.textMuted},children:[e.jsx("span",{children:"Langsam"}),e.jsx("span",{style:{color:"#22c55e",fontWeight:500},children:"Optimal"}),e.jsx("span",{children:"Schnell"})]})]}),s.feedback&&e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:i.textSecondary,marginTop:"16px"},children:s.feedback})]}),y&&e.jsxs("div",{style:{background:"#fff",borderRadius:"16px",padding:"20px",border:`1px solid ${i.borderColor}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ke,{size:18,color:"#14b8a6"}),e.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:i.textMain},children:"Betonung & Melodie"})]}),e.jsx("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"6px",background:"#f0fdfa",color:"#0d9488"},children:Ne(y.rating)})]}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",height:"48px",marginBottom:"12px"},children:Array.from({length:30}).map((g,d)=>{const{base:x,variance:h}=Oe(y.rating),f=x+Math.sin(d*.5)*h+Math.sin(d*12.9898)%1*(h/2);return e.jsx(b.div,{initial:{height:0},animate:{height:`${Math.max(10,Math.min(100,f))}%`},transition:{duration:.5,delay:d*.02},style:{width:"4px",borderRadius:"2px",background:"#14b8a6"}},d)})}),y.highlights?.length>0&&e.jsx("div",{style:{marginBottom:"12px"},children:y.highlights.map((g,d)=>e.jsxs("button",{onClick:()=>n?.(oe(g.timestamp)),style:{width:"100%",display:"flex",alignItems:"flex-start",gap:"8px",padding:"10px 12px",marginBottom:"6px",borderRadius:"8px",border:"none",background:g.type==="positive"?"#f0fdf4":"#fef2f2",cursor:"pointer",textAlign:"left"},children:[e.jsx("span",{style:{fontSize:"11px",fontFamily:"monospace",padding:"2px 6px",borderRadius:"4px",background:g.type==="positive"?"#dcfce7":"#fee2e2",color:g.type==="positive"?"#166534":"#991b1b",flexShrink:0},children:g.timestamp}),e.jsx("span",{style:{flexShrink:0,marginTop:"1px"},children:g.type==="positive"?e.jsx(Z,{size:14,color:"#22c55e"}):e.jsx(we,{size:14,color:"#ef4444"})}),e.jsx("span",{style:{fontSize:"12px",color:i.textSecondary,flex:1,lineHeight:1.5,wordBreak:"break-word",whiteSpace:"normal"},children:g.note}),e.jsx(E,{size:12,color:i.textMuted,style:{flexShrink:0,marginTop:"2px"}})]},d))}),y.feedback&&e.jsx("p",{style:{fontSize:"13px",lineHeight:1.6,color:i.textSecondary},children:y.feedback})]})]})},C={COACHING:"coaching",ANALYSEN:"analysen"},Pe=t=>t>=90?"Ausgezeichnet!":t>=80?"Sehr gut!":t>=70?"Gut!":t>=60?"Solide Leistung":t>=50?"Ausbaufähig":"Weiter üben!",Ue=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",Ze=({session:t,scenario:l,feedback:i,audioAnalysis:n,onBack:r,onRepeat:o,onDelete:p,isLoading:a=!1})=>{const s=Ie(),y=Me(768),v=u.useRef(null),[S,k]=u.useState(C.COACHING),[g,d]=u.useState(!1),[x,h]=u.useState(!1),[f,w]=u.useState(!1),[R,K]=u.useState(null),[V,A]=u.useState(!1),c=R||t;u.useEffect(()=>{t?.id&&!t?.audio_analysis_json&&!n&&!R&&(A(!0),We(t.id).then($=>{K($)}).catch($=>{console.error("Failed to fetch full session:",$)}).finally(()=>{A(!1)}))},[t?.id,t?.audio_analysis_json,n,R]);const M=u.useMemo(()=>i&&typeof i=="object"?i:c?.feedback_json?Te(c.feedback_json):null,[i,c?.feedback_json]),j=u.useMemo(()=>n&&typeof n=="object"?n:c?.audio_analysis_json?Be(c.audio_analysis_json):null,[n,c?.audio_analysis_json]),W=u.useMemo(()=>c?.transcript?Ae(c.transcript):[],[c?.transcript]),N=u.useMemo(()=>c?.audio_url?c.audio_url:c?.id?Le(c.id):null,[c?.id,c?.audio_url]),z=u.useMemo(()=>M?.rating?.overall!==void 0?M.rating.overall*10:0,[M]),m=s.primaryAccent,L=s.headerGradient,_=I=>{v.current&&v.current(I)},D=async()=>{if(!(!c?.id||f)){w(!0);try{const $=(window.wpApiSettings||{}).root||"/wp-json/",ae=le(),te=await fetch(`${$}bewerbungstrainer/v1/sessions/${c.id}/export-pdf`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":ae}}),T=await te.json();if(!te.ok)throw console.error("[PDF] Server error:",T),new Error(T.error||"PDF-Export fehlgeschlagen");if(T.pdf_base64&&T.filename){const X=atob(T.pdf_base64),ie=new Array(X.length);for(let O=0;O<X.length;O++)ie[O]=X.charCodeAt(O);const de=new Uint8Array(ie),ce=new Blob([de],{type:"application/pdf"}),ne=window.URL.createObjectURL(ce),F=document.createElement("a");F.href=ne,F.download=T.filename,document.body.appendChild(F),F.click(),document.body.removeChild(F),window.URL.revokeObjectURL(ne)}}catch(I){console.error("[PDF] Download failed:",I)}finally{w(!1)}}};return a||V?e.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"16px"},children:[e.jsx(H,{size:40,color:m,style:{animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{color:s.textSecondary,fontSize:"14px"},children:"Lade Report..."})]}):e.jsxs("div",{style:{minHeight:"100vh",background:s.pageBg},children:[e.jsx("div",{style:{background:L,padding:y?"20px 16px":"24px 32px",position:"sticky",top:0,zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[r&&e.jsxs("button",{onClick:r,style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",color:"#fff",fontSize:"13px",marginBottom:"16px"},children:[e.jsx(ze,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px"},children:[!y&&e.jsx(_e,{score:z,size:100,primaryAccent:m,isHeader:!0}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.2)",color:"#fff"},children:"Live-Simulation"}),e.jsx("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.9)",color:ee(z,m)},children:Pe(z)})]}),e.jsx("h1",{style:{fontSize:y?"20px":"24px",fontWeight:700,color:"#fff",margin:0,marginBottom:"8px"},children:l?.title||c?.scenario_title||"Übungssession"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(Ce,{size:14}),Ue(c?.created_at)]}),c?.duration&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(Re,{size:14}),Y(c.duration)]})]})]}),!y&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[c?.id&&e.jsxs("button",{onClick:D,disabled:f,style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:f?"wait":"pointer",color:"#fff",fontSize:"14px",fontWeight:500,opacity:f?.7:1},children:[f?e.jsx(H,{size:16,style:{animation:"spin 1s linear infinite"}}):e.jsx(re,{size:16}),"PDF Export"]}),o&&e.jsxs("button",{onClick:o,style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[e.jsx(E,{size:16}),"Erneut üben"]}),p&&e.jsx("button",{onClick:()=>d(!0),style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.4)",borderRadius:"10px",padding:"10px 16px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:e.jsx(P,{size:16})})]})]})]})}),e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto",padding:y?"16px":"24px 32px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:y?"1fr":"30fr 70fr",gap:"24px",alignItems:"start"},children:[e.jsxs("div",{style:{order:y?2:1},children:[e.jsx($e,{transcript:W,scenario:l,primaryAccent:m,branding:s,onSeekToTime:_}),e.jsx("div",{style:{marginTop:"16px"},children:e.jsx(De,{audioUrl:N,duration:c?.duration,primaryAccent:m,branding:s,onSeek:v})})]}),e.jsxs("div",{style:{order:y?1:2},children:[e.jsxs("div",{style:{display:"flex",background:"#fff",borderRadius:"12px",padding:"4px",marginBottom:"16px",border:`1px solid ${s.borderColor}`},children:[e.jsx("button",{onClick:()=>k(C.COACHING),style:{flex:1,padding:"10px 16px",borderRadius:"8px",border:"none",background:S===C.COACHING?m:"transparent",color:S===C.COACHING?"#fff":s.textSecondary,fontSize:"13px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:"Coaching"}),e.jsx("button",{onClick:()=>k(C.ANALYSEN),style:{flex:1,padding:"10px 16px",borderRadius:"8px",border:"none",background:S===C.ANALYSEN?m:"transparent",color:S===C.ANALYSEN?"#fff":s.textSecondary,fontSize:"13px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:"Analysen"})]}),e.jsx(B,{mode:"wait",children:e.jsx(b.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:S===C.COACHING?e.jsx(Fe,{feedback:M,audioAnalysis:j,primaryAccent:m,branding:s}):e.jsx(Ge,{audioAnalysis:j,primaryAccent:m,branding:s,onJumpToTimestamp:_})},S)})]})]}),y&&e.jsxs("div",{style:{marginTop:"24px",display:"flex",flexDirection:"column",gap:"12px"},children:[c?.id&&e.jsxs("button",{onClick:D,disabled:f,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:m,border:"none",borderRadius:"12px",padding:"14px 24px",cursor:f?"wait":"pointer",color:"#fff",fontSize:"15px",fontWeight:600,opacity:f?.7:1},children:[f?e.jsx(H,{size:18,style:{animation:"spin 1s linear infinite"}}):e.jsx(re,{size:18}),"PDF Export"]}),o&&e.jsxs("button",{onClick:o,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:s.cardBg,border:`1px solid ${s.borderColor}`,borderRadius:"12px",padding:"14px 24px",cursor:"pointer",color:s.textMain,fontSize:"15px",fontWeight:600},children:[e.jsx(E,{size:18}),"Erneut üben"]}),p&&e.jsxs("button",{onClick:()=>d(!0),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",background:"transparent",border:"1px solid #ef4444",borderRadius:"12px",padding:"14px 24px",cursor:"pointer",color:"#ef4444",fontSize:"15px",fontWeight:600},children:[e.jsx(P,{size:18}),"Session löschen"]})]})]}),e.jsx(B,{children:g&&e.jsxs(e.Fragment,{children:[e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>d(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1e3}}),e.jsx(b.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",zIndex:1001,boxShadow:"0 20px 40px rgba(0,0,0,0.2)"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"50%",background:"rgba(239,68,68,0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(P,{size:24,color:"#ef4444"})}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:600,color:s.textMain,marginBottom:"8px"},children:"Session löschen?"}),e.jsx("p",{style:{fontSize:"14px",color:s.textSecondary,marginBottom:"24px"},children:"Diese Aktion kann nicht rückgängig gemacht werden. Dein Transkript und Feedback werden dauerhaft gelöscht."}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{onClick:()=>d(!1),disabled:x,style:{flex:1,padding:"12px 16px",borderRadius:"10px",border:`1px solid ${s.borderColor}`,background:"#fff",color:s.textMain,fontSize:"14px",fontWeight:500,cursor:x?"not-allowed":"pointer",opacity:x?.5:1},children:"Abbrechen"}),e.jsx("button",{onClick:async()=>{if(!(!p||!c?.id)){h(!0);try{await p(c)}catch(I){console.error("Failed to delete session:",I)}finally{h(!1),d(!1)}}},disabled:x,style:{flex:1,padding:"12px 16px",borderRadius:"10px",border:"none",background:"#ef4444",color:"#fff",fontSize:"14px",fontWeight:500,cursor:x?"not-allowed":"pointer",opacity:x?.7:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:x?e.jsxs(e.Fragment,{children:[e.jsx(H,{size:16,style:{animation:"spin 1s linear infinite"}}),"Löschen..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{size:16}),"Löschen"]})})]})]})})]})}),e.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})};export{Ze as R};
