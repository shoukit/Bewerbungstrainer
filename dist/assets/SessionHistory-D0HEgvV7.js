import{j as e,Q as X,L as Y,E as ve,w as $t,Y as Me,g as Re,_ as Bt,$ as xt,m as R,V as Ke,a0 as ht,a1 as we,e as Le,a2 as at,z as ze,M as ke,a3 as Et,F as Gt,x as Ut,a4 as gs,C as ut,A as pt,a5 as Wt,a6 as Kt,a7 as Ge,a8 as Vt,a9 as fs,aa as js,b as bs,X as ys,ab as Ns,h as oe,l as nt,d as Ue,ac as Dt,ad as Ct,c as We,ae as vs,t as ws,af as Ss,a as gt,H as At,p as _t,u as Rt,i as ks,ag as Is,q as Es}from"./ui-vendor-zeH2bUSD.js";import{a as l}from"./react-vendor-uDOJF2jQ.js";import{B as Q,C as G,S as tt,a as Ds}from"./select-native-CSFtBRq_.js";import{g as Oe,a as ce,m as te,l as Se,C as B,n as ue,I as H,u as Cs,w as K}from"./FeatureInfoButton-CSO-N4qQ.js";import{D as As,a as _s,b as Rs,c as Os,d as zs,e as Ls}from"./dialog-CxUaA3gX.js";import{b as Ts,p as Ms,d as Ps,e as Fs,f as $s,h as Bs,i as Gs,g as Us}from"./index.js";import{u as Pe}from"./useMobile-YxjH166V.js";import{n as Ht,h as qt,A as Yt}from"./audioMetricsAdapter-Deh5rdpP.js";import{R as Ws}from"./RoleplaySessionReport-CYDMTXGO.js";import{g as Ks,B as Vs}from"./BriefingWorkbook-4GqNjiyr.js";import{D as Hs,a as qs}from"./DecisionBoardResult-BlqY1h2K.js";import{I as Ys,a as Js}from"./IkigaiResults-CS9FzuuB.js";import{P as Xs}from"./ProgressChart--HNgVwnc.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";import"./input-Dvr3Lmdt.js";import"./textarea-BfSRTQPu.js";import"./AudioRecorder-DCjJMUul.js";import"./button-C6grF3c1.js";import"./card-CaCiWvdm.js";import"./DeviceSettingsDialog-Dc176VPG.js";import"./DeviceSetupPage-NSIP-0UL.js";import"./MicrophoneTestDialog-fz4CO27n.js";const pe=({isOpen:t,onClose:n,onConfirm:r,title:m="Löschen bestätigen",description:u="Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:c=!1,confirmLabel:g="Löschen",cancelLabel:x="Abbrechen"})=>e.jsx(As,{open:t,onOpenChange:n,children:e.jsxs(_s,{className:"max-w-[400px]",children:[e.jsxs(Rs,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-[10px] bg-gradient-to-br from-red-500 to-red-600 flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-white"})}),e.jsx(Os,{children:m})]}),e.jsx(zs,{children:u})]}),e.jsxs(Ls,{className:"mt-4",children:[e.jsx("button",{onClick:n,disabled:c,style:{minWidth:"100px",height:"40px",padding:"8px 20px",borderRadius:"8px",border:"1px solid #E2E8F0",backgroundColor:"#FFFFFF",color:"#1E293B",fontSize:"14px",fontWeight:"500",cursor:c?"not-allowed":"pointer",opacity:c?.5:1,transition:"all 0.15s ease"},onMouseEnter:w=>{c||(w.target.style.backgroundColor="#F8FAFC")},onMouseLeave:w=>{w.target.style.backgroundColor="#FFFFFF"},children:x}),e.jsx("button",{onClick:r,disabled:c,style:{minWidth:"100px",height:"40px",padding:"8px 20px",borderRadius:"8px",border:"none",background:"linear-gradient(to bottom right, #EF4444, #DC2626)",color:"#FFFFFF",fontSize:"14px",fontWeight:"500",cursor:c?"not-allowed":"pointer",opacity:c?.5:1,transition:"all 0.15s ease",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:c?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-4 h-4 animate-spin"}),g,"..."]}):g})]})]})}),Qs={auftreten:gs,selbstbewusstsein:ht,koerpersprache:Ut,kommunikation:ke,professionalitaet:ht,inhalt:ze},Ot=t=>t>=90?"Ausgezeichnet!":t>=80?"Sehr gut!":t>=70?"Gut!":t>=60?"Solide Leistung":t>=50?"Ausbaufähig":"Weiter üben!",Zs=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",ea=t=>t==="video"?"Wirkungs-Analyse":t==="roleplay"?"Live-Simulation":"Szenario-Training",zt=({score:t,size:n=120,isHeader:r=!1})=>{const m=Math.min(100,Math.max(0,t||0)),u=(n-12)/2,c=u*2*Math.PI,g=c-m/100*c,x=te(t);return e.jsxs("div",{className:"relative",style:{width:n,height:n},children:[e.jsxs("svg",{width:n,height:n,style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:n/2,cy:n/2,r:u,fill:"none",stroke:r?"rgba(255,255,255,0.3)":B.slate[200],strokeWidth:10}),e.jsx(R.circle,{cx:n/2,cy:n/2,r:u,fill:"none",stroke:x,strokeWidth:10,strokeLinecap:"round",strokeDasharray:c,initial:{strokeDashoffset:c},animate:{strokeDashoffset:g},transition:{duration:1,ease:"easeOut"}})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{style:{fontSize:n/3.5,fontWeight:700,color:x},children:Math.round(t)}),e.jsx("span",{className:`${r?"text-white":"text-slate-500"}`,style:{fontSize:n/10},children:"von 100"})]})]})},ta=({audioUrl:t,durationHint:n})=>{const r=l.useRef(null),[m,u]=l.useState(!1),[c,g]=l.useState(0),[x,w]=l.useState(n||0),[k,i]=l.useState(!0),[j,N]=l.useState(null);l.useEffect(()=>{if(!t)return;i(!0),N(null),w(n||0);const o=new Audio;r.current=o;const C=()=>{const y=o.duration;y&&isFinite(y)&&y>0&&w(y),i(!1)},L=()=>{const y=o.duration;y&&isFinite(y)&&y>0&&w(y)},z=()=>{i(!1);const y=o.duration;y&&isFinite(y)&&y>0&&w(y)};return o.addEventListener("loadedmetadata",C),o.addEventListener("durationchange",L),o.addEventListener("canplaythrough",z),o.addEventListener("timeupdate",()=>g(o.currentTime)),o.addEventListener("play",()=>u(!0)),o.addEventListener("pause",()=>u(!1)),o.addEventListener("ended",()=>u(!1)),o.addEventListener("error",()=>{N("Audio nicht verfügbar"),i(!1)}),o.src=t,o.load(),()=>{o.pause(),o.removeEventListener("loadedmetadata",C),o.removeEventListener("durationchange",L),o.removeEventListener("canplaythrough",z),o.src=""}},[t,n]);const v=()=>{r.current&&(m?r.current.pause():r.current.play())},I=o=>{const C=o.currentTarget.getBoundingClientRect(),L=(o.clientX-C.left)/C.width;r.current&&(r.current.currentTime=L*x)},O=o=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(r.current.currentTime+o,x)))};if(j)return e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg text-slate-500 text-[13px] flex items-center gap-2",children:[e.jsx(ve,{size:16})," ",j]});if(!t)return null;const A=x>0?c/x*100:0;return e.jsxs(G,{className:"p-5",children:[e.jsx("div",{onClick:I,className:"h-2 bg-slate-200 rounded cursor-pointer mb-4",children:e.jsx("div",{className:"h-full bg-primary rounded transition-all duration-100",style:{width:`${A}%`}})}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:()=>O(-10),className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600",children:e.jsx(Wt,{size:20})}),e.jsx("button",{onClick:v,disabled:k,className:`w-12 h-12 rounded-full bg-primary border-none flex items-center justify-center text-white ${k?"cursor-wait opacity-70":"cursor-pointer"}`,children:k?e.jsx(Y,{size:22,className:"animate-spin"}):m?e.jsx(Kt,{size:22,fill:"white"}):e.jsx(Ge,{size:22,fill:"white",className:"ml-0.5"})}),e.jsx("button",{onClick:()=>O(10),className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600",children:e.jsx(Vt,{size:20})})]}),e.jsxs("div",{className:"text-center mt-2 text-[13px] text-slate-500",children:[Se(c)," / ",Se(x)]})]})},sa=({sessionId:t,conversationId:n})=>{const r=l.useRef(null),[m,u]=l.useState(!1),[c,g]=l.useState(!1),[x,w]=l.useState(0),[k,i]=l.useState(0),[j,N]=l.useState(null),[v,I]=l.useState(!0);l.useEffect(()=>{if(!n){I(!1),N("Keine Audio-Aufnahme verfügbar");return}const L=Bs(t);return I(!0),N(null),fetch(L,{headers:{"X-WP-Nonce":ce()},credentials:"same-origin"}).then(z=>{if(!z.ok)throw new Error(`HTTP ${z.status}`);return z.blob()}).then(z=>{const y=URL.createObjectURL(z),S=new Audio(y);r.current=S,S._objectUrl=y,S.addEventListener("loadedmetadata",()=>{i(S.duration),I(!1)}),S.addEventListener("timeupdate",()=>w(S.currentTime)),S.addEventListener("play",()=>u(!0)),S.addEventListener("pause",()=>u(!1)),S.addEventListener("ended",()=>u(!1)),S.addEventListener("error",()=>{N("Audio konnte nicht abgespielt werden."),I(!1)})}).catch(()=>{N("Audio nicht verfügbar."),I(!1)}),()=>{r.current&&(r.current.pause(),r.current._objectUrl&&URL.revokeObjectURL(r.current._objectUrl),r.current=null)}},[t,n]);const O=()=>{r.current&&(m?r.current.pause():r.current.play())},A=()=>{r.current&&(r.current.muted=!c,g(!c))},o=L=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(r.current.currentTime+L,k)))},C=L=>{const z=L.currentTarget.getBoundingClientRect(),y=(L.clientX-z.left)/z.width;r.current&&(r.current.currentTime=y*k)};return v?e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6 text-center",children:[e.jsx(Y,{size:24,className:"text-primary animate-spin mx-auto"}),e.jsx("p",{className:"text-[13px] text-slate-500 mt-2",children:"Audio wird geladen..."})]}):j?e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6 text-center",children:[e.jsx(ve,{size:24,className:"text-slate-400 mx-auto"}),e.jsx("p",{className:"text-[13px] text-slate-500 mt-2",children:j})]}):e.jsxs(G,{className:"p-5",children:[e.jsxs("h3",{className:"text-[15px] font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Le,{size:18,className:"text-primary"})," Gesprächsaufnahme"]}),e.jsx("div",{onClick:C,className:"h-2 bg-slate-200 rounded cursor-pointer mb-4",children:e.jsx("div",{className:"h-full bg-primary rounded transition-all duration-100",style:{width:`${x/k*100||0}%`}})}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:()=>o(-10),className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600",children:e.jsx(Wt,{size:20})}),e.jsx("button",{onClick:O,className:"w-12 h-12 rounded-full bg-primary border-none cursor-pointer flex items-center justify-center text-white",children:m?e.jsx(Kt,{size:22,fill:"white"}):e.jsx(Ge,{size:22,fill:"white",className:"ml-0.5"})}),e.jsx("button",{onClick:()=>o(10),className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600",children:e.jsx(Vt,{size:20})}),e.jsx("button",{onClick:A,className:"p-2 bg-transparent border-none cursor-pointer text-slate-400 hover:text-slate-600 ml-auto",children:c?e.jsx(fs,{size:20}):e.jsx(js,{size:20})})]}),e.jsxs("div",{className:"text-center mt-2 text-[13px] text-slate-500",children:[Se(x)," / ",Se(k)]})]})},aa=({entry:t})=>{const n=t.role==="user";return e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex-shrink-0 flex items-center justify-center ${n?"bg-primary":"bg-slate-200"}`,children:e.jsx(Ut,{size:16,className:n?"text-white":"text-slate-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-xs font-semibold mb-1 ${n?"text-primary":"text-slate-400"}`,children:n?"Du":"Interviewer"}),e.jsx("p",{className:"text-sm text-slate-900 leading-relaxed m-0",children:t.text||t.message})]})]})},he=({title:t,icon:n,iconColor:r="text-primary",children:m,defaultOpen:u=!0,className:c=""})=>{const[g,x]=l.useState(u);return e.jsxs("div",{className:`border border-slate-100 rounded-lg overflow-hidden ${c}`,children:[e.jsxs("button",{onClick:()=>x(!g),className:"w-full px-3 py-2.5 bg-slate-50 border-none cursor-pointer flex items-center gap-2 text-left hover:bg-slate-100 transition-colors",children:[n&&e.jsx(n,{size:14,className:r}),e.jsx("span",{className:"flex-1 text-[13px] font-semibold text-slate-900",children:t}),e.jsx(ut,{size:16,className:`text-slate-400 transition-transform ${g?"rotate-180":""}`})]}),e.jsx(pt,{children:g&&e.jsx(R.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:e.jsx("div",{className:"p-3",children:m})})})]})},na=({answer:t,index:n})=>{const[r,m]=l.useState(!1),u=l.useRef(null),c=t.feedback?typeof t.feedback=="string"?JSON.parse(t.feedback):t.feedback:null,g=t.audio_analysis?typeof t.audio_analysis=="string"?JSON.parse(t.audio_analysis):t.audio_analysis:null,x=t.transcript==="[Keine Sprache erkannt]"||g?.speech_rate==="keine_sprache",w=l.useMemo(()=>Ht(g),[g]),k=qt(g)&&!x,i=j=>{u.current&&(u.current.currentTime=j,u.current.play())};return e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.05},children:e.jsxs(G,{className:"mb-4 overflow-hidden p-0",children:[e.jsxs("button",{onClick:()=>m(!r),className:"w-full p-4 bg-transparent border-none cursor-pointer flex items-center gap-3 text-left",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-primary/10 flex items-center justify-center text-primary font-bold text-sm flex-shrink-0",children:n+1}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h4",{className:"text-sm font-semibold text-slate-900 m-0 truncate",children:t.question_text||`Frage ${n+1}`})}),t.overall_score!=null&&e.jsx("span",{className:"text-base font-bold",style:{color:x?B.slate[400]:te(t.overall_score*10)},children:x?"–":`${Math.round(t.overall_score*10)}%`}),e.jsx(ut,{size:18,className:`text-slate-400 transition-transform ${r?"rotate-180":""}`})]}),e.jsx(pt,{children:r&&e.jsx(R.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-3 border-t border-slate-100 flex flex-col gap-3",children:[t.question_text&&e.jsx(he,{title:"Frage / Situation",icon:ke,defaultOpen:!1,children:e.jsx("p",{className:"text-sm text-slate-900 leading-relaxed bg-primary/5 p-3 rounded-lg m-0 border border-primary/10",children:t.question_text})}),t.audio_url&&e.jsx(he,{title:"Deine Aufnahme",icon:Le,defaultOpen:!0,children:e.jsx(ta,{audioUrl:t.audio_url,durationHint:t.audio_duration_seconds})}),t.transcript&&e.jsx(he,{title:"Transkript",icon:Gt,defaultOpen:!0,children:e.jsxs("p",{className:`text-[13px] leading-relaxed bg-slate-50 p-3 rounded-lg m-0 italic break-words ${x?"text-slate-400":"text-slate-600"}`,children:['"',t.transcript,'"']})}),c?.scores&&!x&&e.jsxs(he,{title:"Bewertung",icon:we,defaultOpen:!0,children:[e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-2",children:[{key:"content",label:"Inhalt"},{key:"structure",label:"Struktur"},{key:"relevance",label:"Relevanz"},{key:"delivery",label:"Präsentation"}].map(({key:j,label:N})=>{const v=c.scores[j],I=v!=null?v*10:null;return e.jsxs("div",{className:"p-2.5 bg-slate-50 rounded-lg text-center",children:[e.jsx("div",{className:"text-base font-bold",style:{color:I!=null?te(I):B.slate[400]},children:I!=null?Math.round(I):"-"}),e.jsx("div",{className:"text-[10px] text-slate-500 mt-0.5",children:N})]},j)})}),(()=>{const j=c.scores.overall,N=j!=null?j*10:null;return e.jsxs("div",{className:"p-3 bg-primary/10 rounded-lg text-center border border-primary/20 flex items-center justify-center gap-3",children:[e.jsx("div",{className:"text-[10px] text-slate-500",children:"Gesamt"}),e.jsx("div",{className:"text-xl font-bold",style:{color:N!=null?te(N):B.slate[400]},children:N!=null?Math.round(N):"-"})]})})(),c?.summary&&e.jsx("p",{className:"text-[13px] text-slate-600 leading-snug mt-3",children:c.summary})]}),c?.strengths?.length>0&&!x&&e.jsx(he,{title:"Stärken",icon:at,iconColor:"text-green-600",defaultOpen:!0,children:e.jsx("ul",{className:"m-0 pl-4 text-slate-600 text-xs",children:c.strengths.map((j,N)=>e.jsx("li",{className:"mb-1",children:j},N))})}),c?.improvements?.length>0&&e.jsx(he,{title:"Verbesserungspotenzial",icon:ve,iconColor:"text-amber-600",defaultOpen:!0,children:e.jsx("ul",{className:"m-0 pl-4 text-slate-600 text-xs",children:c.improvements.map((j,N)=>e.jsx("li",{className:"mb-1",children:j},N))})}),c?.tips?.length>0&&!x&&e.jsx(he,{title:"Tipps",icon:ze,iconColor:"text-primary",defaultOpen:!0,children:e.jsx("ul",{className:"m-0 pl-4 text-slate-600 text-xs",children:c.tips.map((j,N)=>e.jsx("li",{className:"mb-1",children:j},N))})}),k&&e.jsx(he,{title:"Sprechanalyse",icon:Le,defaultOpen:!1,children:e.jsx(Yt,{audioAnalysis:w,onJumpToTimestamp:i})})]})})})]})})},ia=({isOpen:t,onClose:n,onConfirm:r,isDeleting:m})=>t?e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",onClick:n,children:e.jsxs(R.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl p-6 max-w-[400px] w-[90%] shadow-2xl",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-100 flex items-center justify-center",children:e.jsx(X,{size:24,className:"text-red-500"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 m-0",children:"Session löschen?"})]}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed mb-6",children:"Möchtest du diese Session wirklich löschen? Alle Antworten und Feedback werden unwiderruflich entfernt."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(Q,{variant:"secondary",onClick:n,disabled:m,children:"Abbrechen"}),e.jsx(Q,{variant:"danger",onClick:r,disabled:m,icon:m?e.jsx(Y,{size:16,className:"animate-spin"}):e.jsx(X,{size:16}),children:m?"Löschen...":"Löschen"})]})]})}):null,ra=({category:t})=>{const[n,r]=l.useState(!1),m=Qs[t.category]||we,u=te(t.score);return e.jsxs(G,{className:"mb-2.5 overflow-hidden p-0",children:[e.jsxs("button",{onClick:()=>r(!n),className:"w-full p-3.5 bg-transparent border-none cursor-pointer flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center",style:{backgroundColor:`${u}15`},children:e.jsx(m,{size:18,style:{color:u}})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("h4",{className:"text-sm font-semibold text-slate-900 m-0",children:t.label})}),e.jsxs("span",{className:"text-base font-bold",style:{color:u},children:[Math.round(t.score),"%"]}),e.jsx(ut,{size:18,className:`text-slate-400 transition-transform ${n?"rotate-180":""}`})]}),e.jsx(pt,{children:n&&e.jsx(R.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsxs("div",{className:"px-4 pb-4 pt-3 border-t border-slate-100",children:[t.feedback&&e.jsx("p",{className:"text-[13px] text-slate-600 leading-snug mb-2.5",children:t.feedback}),t.strengths?.length>0&&e.jsxs("div",{className:"mb-2.5",children:[e.jsxs("h6",{className:"text-xs font-semibold text-green-600 mb-1 flex items-center gap-1",children:[e.jsx(at,{size:12})," Stärken"]}),e.jsx("ul",{className:"m-0 pl-4 text-xs text-slate-600",children:t.strengths.map((c,g)=>e.jsx("li",{children:c},g))})]}),t.improvements?.length>0&&e.jsxs("div",{children:[e.jsxs("h6",{className:"text-xs font-semibold text-amber-600 mb-1 flex items-center gap-1",children:[e.jsx(ze,{size:12})," Tipps"]}),e.jsx("ul",{className:"m-0 pl-4 text-xs text-slate-600",children:t.improvements.map((c,g)=>e.jsx("li",{children:c},g))})]})]})})})]})},la=({session:t,type:n,scenario:r,onBack:m,onContinueSession:u,onRepeatSession:c,onDeleteSession:g})=>{const x=Pe(),[w,k]=l.useState(!1);l.useEffect(()=>{const d=()=>{const f=window.innerWidth;k(f>=768&&f<1200)};return d(),window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const[i,j]=l.useState([]),[N,v]=l.useState(!0),[I,O]=l.useState(null),[A,o]=l.useState(!1),[C,L]=l.useState(!1),[z,y]=l.useState(!1),[S,Ie]=l.useState(null),[Z,J]=l.useState(r),V=n==="video",q=n==="simulator",F=n==="roleplay",ne=(()=>{const d=t?.questions||t?.questions_json;if(!d)return!1;try{const f=typeof d=="string"?JSON.parse(d):d;return Array.isArray(f)&&f.length>0}catch{return!1}})(),Ee=(()=>{if(!q||!ne)return!1;const d=t?.total_questions||0,f=t?.completed_questions||0;return d>0&&f<d})(),se=async()=>{if(g){L(!0);try{await g(t,n)}catch(d){console.error("Failed to delete session:",d),L(!1),o(!1)}}},ge=async()=>{if(!(z||!t?.id)){y(!0);try{let d;if(q)d=`${Oe()}/simulator/sessions/${t.id}/export-pdf`;else if(V)d=`${Oe()}/video-training/sessions/${t.id}/export-pdf`;else if(F)d=`${Oe()}/sessions/${t.id}/export-pdf`;else throw new Error("Unsupported session type for PDF export");const f=await fetch(d,{method:"POST",headers:{"X-WP-Nonce":ce(),"Content-Type":"application/json"},credentials:"same-origin"}),P=await f.json();if(!f.ok)throw new Error(P.error||`HTTP ${f.status}`);if(!P.success||!P.pdf_base64)throw new Error(P.error||"PDF generation failed");const Ae=atob(P.pdf_base64),de=new Array(Ae.length);for(let be=0;be<Ae.length;be++)de[be]=Ae.charCodeAt(be);const it=new Uint8Array(de),He=new Blob([it],{type:P.content_type||"application/pdf"}),xe=window.URL.createObjectURL(He),ie=document.createElement("a");ie.href=xe,ie.download=P.filename||"Training.pdf",document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),window.URL.revokeObjectURL(xe)}catch(d){console.error("Failed to download PDF:",d)}finally{y(!1)}}};l.useEffect(()=>{q&&t?.id?Ve():F&&t?.id?fe():v(!1)},[t?.id,n]);const Ve=async()=>{try{v(!0);const f=await(await fetch(`${Oe()}/simulator/sessions/${t.id}/answers`,{headers:{"X-WP-Nonce":ce()}})).json();f.success&&f.data?.answers?j(f.data.answers):Array.isArray(f.data)&&j(f.data)}catch(d){console.error("Failed to load answers:",d),O("Fehler beim Laden der Antworten")}finally{v(!1)}},fe=async()=>{try{v(!0);const d=await Ts(t.id);if(Ie({...t,...d,feedback:Fs(d.feedback_json||t.feedback_json),audioAnalysis:Ps(d.audio_analysis_json||t.audio_analysis_json),transcript:Ms(d.transcript||t.transcript)}),!r&&d.scenario_id)try{const f=await $s(d.scenario_id);J(f)}catch(f){console.warn("Could not load scenario:",f)}}catch(d){console.error("Failed to load roleplay data:",d),O("Fehler beim Laden der Gesprächsdaten")}finally{v(!1)}},E=t?.summary_feedback_json?typeof t.summary_feedback_json=="string"?JSON.parse(t.summary_feedback_json):t.summary_feedback_json:null,$=t?.category_scores||[],M=t?.analysis||{},je=l.useRef(null),De=l.useMemo(()=>!V||!M?null:M.filler_words||M.speech_metrics?{filler_words:M.filler_words,speech_metrics:M.speech_metrics}:null,[V,M]),U=l.useMemo(()=>Ht(De),[De]),Ce=qt(De),Fe=d=>{je.current&&(je.current.currentTime=d,je.current.play())},W=(()=>{let d=0;return F&&S?.feedback?.rating?.overall?d=S.feedback.rating.overall:d=t?.overall_score||E?.overall_score||0,(q||F)&&d<=10?d*10:d})();return N?e.jsx("div",{className:"w-full min-h-[60vh] flex items-center justify-center p-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Y,{size:48,className:"text-primary animate-spin mx-auto"}),e.jsx("p",{className:"text-slate-500 mt-4",children:"Analyse wird geladen..."})]})}):I?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-[400px] p-6",children:[e.jsx(ve,{size:48,className:"text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-slate-600 mb-6",children:I}),e.jsx(Q,{variant:"secondary",onClick:m,children:"Zurück"})]})}):e.jsxs("div",{className:"min-h-screen bg-slate-50 overflow-hidden max-w-full",children:[e.jsx("div",{className:`sticky top-0 z-40 ${x?"px-4 py-5":"px-8 py-6"}`,style:{background:"var(--header-gradient, linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%))"},children:e.jsxs("div",{className:"max-w-[1400px] mx-auto",children:[m&&e.jsxs("button",{onClick:m,className:"flex items-center gap-1.5 bg-white/15 border-none rounded-lg px-3 py-2 cursor-pointer text-white text-[13px] mb-4 hover:bg-white/25 transition-colors",children:[e.jsx($t,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{className:"flex items-center gap-6",children:[!x&&e.jsx(zt,{score:W,size:100,isHeader:!0}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap mb-2",children:[e.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wide px-2.5 py-1 rounded-full bg-white/20 text-white",children:ea(n)}),e.jsx("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-white/90",style:{color:te(W)},children:Ot(W)})]}),e.jsx("h1",{className:`font-bold text-white m-0 mb-2 ${x?"text-xl":"text-2xl"}`,children:(F?Z?.title:r?.title)||t?.scenario_title||t?.position||"Training"}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(Me,{size:14}),Zs(t?.created_at)]}),t?.duration&&e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(Re,{size:14}),Se(t.duration)]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ge,disabled:z,title:"Als PDF herunterladen",className:`flex items-center justify-center bg-white/20 border border-white/30 rounded-lg px-3 py-2.5 text-white outline-none transition-colors hover:bg-white/30 ${z?"cursor-wait opacity-70":"cursor-pointer"}`,children:z?e.jsx(Y,{size:16,className:"animate-spin"}):e.jsx(Bt,{size:16})}),!x&&c&&e.jsxs("button",{onClick:()=>c(t,r),className:"flex items-center gap-2 bg-white/20 border border-white/30 rounded-lg px-5 py-2.5 cursor-pointer text-white text-sm font-medium outline-none hover:bg-white/30 transition-colors",children:[e.jsx(xt,{size:16}),"Erneut üben"]}),g&&e.jsx("button",{onClick:()=>o(!0),className:`flex items-center gap-2 bg-red-500/20 border border-red-500/40 rounded-lg cursor-pointer text-white text-sm font-medium outline-none hover:bg-red-500/30 transition-colors ${x?"px-3 py-2.5":"px-4 py-2.5"}`,children:e.jsx(X,{size:16})})]})]})]})}),e.jsxs("div",{className:`overflow-hidden ${x?"p-4":"px-8 py-6"}`,children:[V&&e.jsxs("div",{className:"max-w-[1400px] mx-auto",children:[e.jsxs("div",{className:`grid gap-5 mb-5 ${x||w?"grid-cols-1":"grid-cols-2"}`,children:[t?.video_url&&e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(G,{className:"p-4 h-full",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[e.jsx(Ke,{size:16,className:"text-primary"})," Deine Aufnahme"]}),e.jsx("video",{ref:je,src:t.video_url,controls:!0,className:"w-full rounded-xl bg-black object-contain",style:{maxHeight:"280px"}})]})}),e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},children:e.jsxs(G,{className:"p-4 h-full flex flex-col",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[e.jsx(ht,{size:16,className:"text-primary"})," Gesamtbewertung"]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center",children:[e.jsx(zt,{score:W,size:100}),e.jsx("p",{className:"text-lg font-semibold mt-2",style:{color:te(W)},children:Ot(W)}),t?.summary_feedback&&e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed text-center mt-3 line-clamp-4",children:t.summary_feedback})]})]})})]}),e.jsxs("div",{className:`grid gap-5 mb-5 ${x||w?"grid-cols-1":"grid-cols-2"}`,children:[$.length>0&&e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(G,{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[e.jsx(we,{size:16,className:"text-primary"})," Detaillierte Bewertung"]}),e.jsx("div",{className:x||w?"":"max-h-[300px] overflow-y-auto pr-1",children:$.map((d,f)=>e.jsx(ra,{category:d},d.category||f))})]})}),Ce&&e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},children:e.jsxs(G,{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 mb-3 flex items-center gap-2",children:[e.jsx(Le,{size:16,className:"text-primary"})," Sprechanalyse"]}),e.jsx("div",{className:x||w?"":"max-h-[300px] overflow-y-auto pr-1",children:e.jsx(Yt,{audioAnalysis:U,onJumpToTimestamp:Fe})})]})})]}),(M.key_strengths?.length>0||M.actionable_tips?.length>0)&&e.jsxs("div",{className:`grid gap-5 ${x||w?"grid-cols-1":"grid-cols-2"}`,children:[M.key_strengths?.length>0&&e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(G,{className:"p-4 h-full",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-600 mb-3 flex items-center gap-1.5",children:[e.jsx(at,{size:16})," Deine Stärken"]}),e.jsx("ul",{className:"m-0 pl-5",children:M.key_strengths.map((d,f)=>e.jsx("li",{className:"text-[13px] text-slate-600 mb-1.5 leading-snug",children:d},f))})]})}),M.actionable_tips?.length>0&&e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.35},children:e.jsxs(G,{className:"p-4 h-full",children:[e.jsxs("h4",{className:"text-sm font-semibold text-primary mb-3 flex items-center gap-1.5",children:[e.jsx(ze,{size:16})," Tipps zur Verbesserung"]}),e.jsx("ul",{className:"m-0 pl-5",children:M.actionable_tips.map((d,f)=>e.jsx("li",{className:"text-[13px] text-slate-600 mb-1.5 leading-snug",children:d},f))})]})})]})]}),!V&&e.jsxs("div",{className:"grid gap-6 overflow-hidden",style:{gridTemplateColumns:x||w?"1fr":"1fr 400px"},children:[e.jsxs("div",{className:"min-w-0 overflow-hidden",children:[q&&i.length>0&&e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsxs("h3",{className:"text-base font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(ke,{size:18,className:"text-primary"})," Deine Antworten (",i.length,")"]}),i.map((d,f)=>e.jsx(na,{answer:d,index:f},d.id||f)),Ee&&(u||c)&&e.jsxs("div",{className:"flex gap-3 justify-center flex-wrap mt-6 p-5 bg-slate-50 rounded-xl border border-dashed border-slate-300",children:[e.jsx("p",{className:"w-full text-center text-slate-600 text-sm mb-3",children:"Diese Session ist noch nicht abgeschlossen."}),u&&e.jsx(Q,{onClick:()=>u(t,r),icon:e.jsx(Et,{size:18}),children:"Fortsetzen"}),c&&e.jsx(Q,{variant:"secondary",onClick:()=>c(t,r),icon:e.jsx(xt,{size:18}),children:"Erneut starten"})]})]}),q&&i.length===0&&e.jsxs("div",{className:"text-center py-12 px-6 bg-slate-50 rounded-2xl",children:[e.jsx(ve,{size:48,className:"text-slate-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Keine Antworten vorhanden"}),e.jsx("p",{className:"text-slate-500 mb-6",children:ne?"Diese Session wurde nicht abgeschlossen. Du kannst sie fortsetzen oder erneut starten.":"Diese Session wurde verlassen, bevor Fragen generiert wurden."}),Ee&&(u||c)&&e.jsxs("div",{className:"flex gap-3 justify-center flex-wrap",children:[u&&e.jsx(Q,{onClick:()=>u(t,r),icon:e.jsx(Et,{size:18}),children:"Fortsetzen"}),c&&e.jsx(Q,{variant:"secondary",onClick:()=>c(t,r),icon:e.jsx(xt,{size:18}),children:"Erneut starten"})]})]}),F&&S&&e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-5",children:e.jsx(sa,{sessionId:t.id,conversationId:S.conversation_id})}),F&&S?.transcript?.length>0&&e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(G,{className:"p-5",children:[e.jsxs("h3",{className:"text-[15px] font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Gt,{size:18,className:"text-primary"})," Gesprächsverlauf"]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:S.transcript.map((d,f)=>e.jsx(aa,{entry:d},f))})]})})]}),e.jsxs("div",{className:"min-w-0 overflow-hidden",children:[q&&E&&e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:[E.summary&&e.jsxs(G,{className:"mb-5 p-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-2.5",children:"Zusammenfassung"}),e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed m-0",children:E.summary})]}),E.scores&&e.jsxs(G,{className:"mb-5 p-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Bewertung"}),e.jsx("div",{className:"grid grid-cols-2 gap-2.5",children:Object.entries(E.scores).map(([d,f])=>{const P=f!=null?f*10:null;return e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg text-center",children:[e.jsx("div",{className:"text-xl font-bold",style:{color:te(P)},children:P!=null?Math.round(P):"-"}),e.jsx("div",{className:"text-[11px] text-slate-500 capitalize",children:d})]},d)})})]}),E.key_takeaways?.length>0&&e.jsxs("div",{className:"bg-green-50 rounded-2xl p-5",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-600 mb-2.5 flex items-center gap-1.5",children:[e.jsx(ze,{size:16})," Wichtigste Erkenntnisse"]}),e.jsx("ul",{className:"m-0 pl-5 text-[13px] text-slate-900 leading-snug",children:E.key_takeaways.map((d,f)=>e.jsx("li",{className:"mb-1.5",children:d},f))})]})]}),F&&S?.feedback&&e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[S.feedback.rating&&e.jsxs(G,{className:"mb-5 p-5",children:[e.jsxs("h4",{className:"text-[15px] font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(we,{size:16,className:"text-primary"})," Bewertungskriterien"]}),e.jsx("div",{className:"flex flex-col gap-2.5",children:Object.entries(S.feedback.rating).filter(([d])=>d!=="overall").map(([d,f])=>{const P=f*10;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[e.jsx("div",{className:"flex-1 text-[13px] font-medium text-slate-900 capitalize",children:d.replace(/_/g," ")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 h-1.5 bg-slate-200 rounded",children:e.jsx("div",{className:"h-full rounded",style:{width:`${P}%`,backgroundColor:te(P)}})}),e.jsx("span",{className:"text-sm font-semibold min-w-[45px]",style:{color:te(P)},children:Math.round(P)})]})]},d)})})]}),S.feedback.strengths?.length>0&&e.jsxs(G,{className:"mb-5 p-5",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-600 mb-3 flex items-center gap-1.5",children:[e.jsx(at,{size:16})," Deine Stärken"]}),e.jsx("ul",{className:"m-0 pl-5",children:S.feedback.strengths.map((d,f)=>e.jsx("li",{className:"text-[13px] text-slate-600 mb-2 leading-snug",children:d},f))})]}),S.feedback.improvements?.length>0&&e.jsxs(G,{className:"mb-5 p-5",children:[e.jsxs("h4",{className:"text-sm font-semibold text-amber-600 mb-3 flex items-center gap-1.5",children:[e.jsx(ze,{size:16})," Verbesserungspotenzial"]}),e.jsx("ul",{className:"m-0 pl-5",children:S.feedback.improvements.map((d,f)=>e.jsx("li",{className:"text-[13px] text-slate-600 mb-2 leading-snug",children:d},f))})]}),S.feedback.summary&&e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-2.5",children:"Zusammenfassung"}),e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed m-0",children:S.feedback.summary})]})]}),F&&!S?.feedback&&e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6 text-center",children:[e.jsx(ve,{size:32,className:"text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-500 m-0",children:"Keine Analyse verfügbar für dieses Gespräch."})]})]})]})]}),e.jsx(ia,{isOpen:A,onClose:()=>o(!1),onConfirm:se,isDeleting:C})]})},Te=({title:t,onSave:n,className:r="",inputClassName:m="",placeholder:u="Titel eingeben..."})=>{const[c,g]=l.useState(!1),[x,w]=l.useState(t||""),[k,i]=l.useState(!1),j=l.useRef(null);l.useEffect(()=>{c&&j.current&&(j.current.focus(),j.current.select())},[c]),l.useEffect(()=>{c||w(t||"")},[t,c]);const N=o=>{o.stopPropagation(),g(!0)},v=o=>{o.stopPropagation(),w(t||""),g(!1)},I=async o=>{o.stopPropagation();const C=x.trim();if(!C||C===t){g(!1),w(t||"");return}i(!0);try{await n(C),g(!1)}catch(L){console.error("Error saving title:",L)}finally{i(!1)}},O=o=>{o.key==="Enter"?I(o):o.key==="Escape"&&v(o)},A=o=>{o.stopPropagation()};return c?e.jsxs("div",{className:"flex items-center gap-2",onClick:o=>o.stopPropagation(),children:[e.jsx("input",{ref:j,type:"text",value:x,onChange:o=>w(o.target.value),onKeyDown:O,onClick:A,placeholder:u,disabled:k,className:`flex-1 px-2 py-1 rounded-lg border border-slate-300 text-sm font-semibold text-slate-900 focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary ${m}`,style:{minWidth:"150px"}}),e.jsx("button",{onClick:I,disabled:k,className:"p-1.5 rounded-lg border-none bg-green-500 text-white cursor-pointer flex items-center justify-center hover:bg-green-600 transition-colors disabled:opacity-50",title:"Speichern",children:k?e.jsx(Y,{size:14,className:"animate-spin"}):e.jsx(bs,{size:14})}),e.jsx("button",{onClick:v,disabled:k,className:"p-1.5 rounded-lg border-none bg-slate-200 text-slate-600 cursor-pointer flex items-center justify-center hover:bg-slate-300 transition-colors disabled:opacity-50",title:"Abbrechen",children:e.jsx(ys,{size:14})})]}):e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx("span",{className:r,children:t||u}),e.jsx("button",{onClick:N,className:"p-1 rounded-md border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center opacity-0 group-hover:opacity-100 hover:text-slate-600 hover:bg-slate-100 transition-all",title:"Umbenennen",children:e.jsx(Ns,{size:14})})]})},ca=({briefing:t,onClick:n,onDelete:r,onRename:m,headerGradient:u,headerText:c,primaryAccent:g})=>{const[x,w]=l.useState(!1),[k,i]=l.useState(!1),[j,N]=l.useState(t.title),v=Pe(900),I=Ks(t.template_icon),O=async C=>{m&&(await m(t.id,C),N(C))},A=C=>{C.stopPropagation(),i(!0)},o=async()=>{w(!0);try{await r(t.id),i(!1)}catch(C){console.error("Error deleting briefing:",C)}finally{w(!1)}};return v?e.jsxs(R.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileTap:{scale:.98},children:[e.jsxs("div",{onClick:n,className:"bg-white rounded-2xl p-4 cursor-pointer border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(I,{className:"w-[22px] h-[22px] text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[m?e.jsx(Te,{title:j||"Briefing",onSave:O,className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",placeholder:"Briefing"}):e.jsx("h3",{className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",children:j||"Briefing"}),e.jsx("div",{className:"text-[13px] text-slate-500",children:ue(t.created_at)})]}),e.jsx("button",{onClick:A,disabled:x,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center shrink-0 hover:text-slate-600",title:"Löschen",children:x?e.jsx(Y,{size:18,className:"animate-spin"}):e.jsx(X,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-3 border-t border-slate-100",children:[e.jsx("span",{className:"bg-primary/10 text-primary px-2.5 py-1 rounded-[10px] text-xs font-medium max-w-[70%] overflow-hidden text-ellipsis whitespace-nowrap",children:t.template_title}),e.jsx(oe,{size:22,className:"text-slate-400 shrink-0"})]})]}),e.jsx(pe,{isOpen:k,onClose:()=>i(!1),onConfirm:o,title:"Briefing löschen",description:"Möchtest du dieses Briefing wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:x})]}):e.jsxs(R.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("div",{onClick:n,className:"bg-white rounded-2xl p-5 cursor-pointer border border-slate-200 shadow-sm hover:shadow-lg hover:border-slate-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(I,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[m?e.jsx(Te,{title:j||"Briefing",onSave:O,className:"text-base font-semibold text-slate-900 mb-1 whitespace-nowrap overflow-hidden text-ellipsis",placeholder:"Briefing"}):e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1 whitespace-nowrap overflow-hidden text-ellipsis",children:j||"Briefing"}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap text-[13px] text-slate-500",children:[e.jsx("span",{className:"bg-primary/10 text-primary px-2 py-0.5 rounded-[10px] text-xs font-medium",children:t.template_title}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Me,{size:14}),ue(t.created_at)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("button",{onClick:A,disabled:x,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center hover:text-red-500 transition-colors",title:"Löschen",children:x?e.jsx(Y,{size:18,className:"animate-spin"}):e.jsx(X,{size:18})}),e.jsx(oe,{size:20,className:"text-slate-400"})]})]})}),e.jsx(pe,{isOpen:k,onClose:()=>i(!1),onConfirm:o,title:"Briefing löschen",description:"Möchtest du dieses Briefing wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:x})]})},le={SIMULATOR:"simulator",ROLEPLAY:"roleplay",VIDEO:"video"},oa=({session:t,type:n,scenario:r,onClick:m,onContinueSession:u,onDeleteSession:c,onRename:g,headerGradient:x,headerText:w,primaryAccent:k})=>{const[i,j]=l.useState(!1),[N,v]=l.useState(!1),I=Pe(900),O=()=>t.custom_title||r?.title||t.scenario_title||`Session #${t.id}`,[A,o]=l.useState(O());l.useEffect(()=>{o(O())},[t.custom_title,r?.title,t.scenario_title,t.id]);const C=async E=>{if(g){o(E);try{await g(t,n,E)}catch($){throw o(O()),$}}},L=()=>{let E=null;if(n===le.SIMULATOR)E=t.overall_score||t.average_score;else if(n===le.VIDEO)E=t.overall_score;else if(t.feedback_json)try{let $=t.feedback_json;if(typeof $=="string"){let M=$.trim();M.startsWith("```json")?M=M.replace(/```json\s*/g,"").replace(/```\s*$/g,""):M.startsWith("```")&&(M=M.replace(/```\s*/g,"").replace(/```\s*$/g,"")),$=JSON.parse(M)}E=$.rating?.overall||null}catch{E=null}return E==null||isNaN(E)||E===0?null:E},z=()=>n===le.SIMULATOR||n===le.VIDEO?t.status:t.feedback_json?"completed":"pending",y=L(),Ie=z()==="completed",Z=t.total_questions>0&&(t.completed_questions||0)<t.total_questions,J=n===le.SIMULATOR&&Z,V=()=>{if(!J)return null;const E=t.completed_questions||0,$=t.total_questions||0;return`${E}/${$} Fragen`},q=E=>{E.stopPropagation(),u&&u(t,r)},F=E=>{E.stopPropagation(),v(!0)},ne=async()=>{j(!0);try{await c(t,n),v(!1)}catch(E){console.error("Error deleting session:",E)}finally{j(!1)}},se=(()=>{if(y==null||isNaN(y))return null;if(n===le.SIMULATOR||n===le.ROLEPLAY){const E=y<=10?y*10:y;return isNaN(E)?null:E}return isNaN(y)?null:y})(),ge=E=>{if(!E&&E!==0)return{background:B.slate[100],color:B.slate[500]};const $=parseFloat(E);return $>=80?{background:B.green[100],color:B.green[800]}:$>=60?{background:B.amber[100],color:B.amber[800]}:{background:B.red[100],color:B.red[800]}},fe=(()=>{switch(n){case le.SIMULATOR:return nt;case le.VIDEO:return Ke;default:return ke}})();return I?e.jsxs(R.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileTap:{scale:.98},children:[e.jsxs("div",{onClick:m,className:"bg-white rounded-2xl p-4 cursor-pointer border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center shrink-0",style:{background:x},children:e.jsx(fe,{className:"w-[22px] h-[22px]",style:{color:w}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[g?e.jsx(Te,{title:A,onSave:C,className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3]"}):e.jsx("h3",{className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3]",children:A}),e.jsx("div",{className:"text-[13px] text-slate-500",children:ue(t.created_at)})]}),c&&e.jsx("button",{onClick:F,disabled:i,className:"p-3 rounded-xl border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center shrink-0 hover:text-slate-600 hover:bg-slate-100 transition-colors min-w-[44px] min-h-[44px]",title:"Löschen",children:i?e.jsx(Y,{size:18,className:"animate-spin"}):e.jsx(X,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[!Ie&&!J&&e.jsxs("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-medium",children:[e.jsx(Re,{size:12}),"In Bearbeitung"]}),e.jsxs("span",{className:"flex items-center gap-1 px-2.5 py-1.5 rounded-full text-[13px] font-semibold",style:ge(se),children:[e.jsx(we,{size:13}),se!==null?`${Math.round(se)}%`:"-- %"]}),(t.duration||t.video_duration_seconds)&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(Re,{size:12}),Se(t.duration||t.video_duration_seconds)]}),J&&e.jsx("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full bg-blue-100 text-blue-800 text-xs font-medium",children:V()})]}),J&&u?e.jsxs("button",{onClick:q,className:"flex items-center gap-1.5 px-4 py-2.5 rounded-[10px] border-none bg-primary text-white text-[13px] font-semibold cursor-pointer shadow-md hover:shadow-lg transition-shadow shrink-0",children:[e.jsx(Ge,{size:14}),"Fortsetzen"]}):e.jsx(oe,{size:22,className:"text-slate-400 shrink-0"})]})]}),e.jsx(pe,{isOpen:N,onClose:()=>v(!1),onConfirm:ne,title:"Session löschen",description:"Möchtest du diese Session wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:i})]}):e.jsxs(R.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("div",{onClick:m,className:"bg-white rounded-2xl p-5 cursor-pointer border border-slate-200 shadow-sm hover:shadow-lg hover:border-slate-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shrink-0",style:{background:x},children:e.jsx(fe,{className:"w-6 h-6",style:{color:w}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[g?e.jsx(Te,{title:A,onSave:C,className:"text-base font-semibold text-slate-900 mb-1 whitespace-nowrap overflow-hidden text-ellipsis"}):e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1 whitespace-nowrap overflow-hidden text-ellipsis",children:A}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap text-[13px] text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Me,{size:14}),ue(t.created_at)]}),t.duration||t.video_duration_seconds?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Re,{size:14}),Se(t.duration||t.video_duration_seconds)]}):null]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[J&&u&&e.jsxs("button",{onClick:q,className:"flex items-center gap-1.5 px-3.5 py-2 rounded-[10px] border-none bg-primary text-white text-[13px] font-semibold cursor-pointer shadow-md hover:scale-105 hover:shadow-lg transition-all",children:[e.jsx(Ge,{size:14}),"Fortsetzen"]}),J&&e.jsx("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full bg-blue-100 text-blue-800 text-xs font-medium",children:V()}),!Ie&&!J&&e.jsxs("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-medium",children:[e.jsx(Re,{size:12}),"In Bearbeitung"]}),e.jsxs("span",{className:"flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-semibold",style:ge(se),children:[e.jsx(we,{size:14}),se!==null?`${Math.round(se)}%`:"-- %"]}),c&&e.jsx("button",{onClick:F,disabled:i,className:"p-3 rounded-xl border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center hover:text-red-500 hover:bg-red-50 transition-colors min-w-[44px] min-h-[44px]",title:"Löschen",children:i?e.jsx(Y,{size:18,className:"animate-spin"}):e.jsx(X,{size:18})}),e.jsx(oe,{size:20,className:"text-slate-400"})]})]})}),e.jsx(pe,{isOpen:N,onClose:()=>v(!1),onConfirm:ne,title:"Session löschen",description:"Möchtest du diese Session wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:i})]})},Lt=({proScore:t,contraScore:n})=>{const r=t+n,m=r>0?Math.round(t/r*100):50;return e.jsxs("div",{className:"h-1.5 rounded-[3px] overflow-hidden flex bg-slate-100 w-full max-w-[120px]",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-full",style:{width:`${m}%`}}),e.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 h-full",style:{width:`${100-m}%`}})]})},da=({decision:t,onClick:n,onDelete:r,onRename:m,headerGradient:u,headerText:c,primaryAccent:g})=>{const[x,w]=l.useState(!1),[k,i]=l.useState(!1),[j,N]=l.useState(t.topic),v=Pe(900),I=async y=>{m&&(await m(t.id,y),N(y))},O=(t.pros||[]).reduce((y,S)=>y+(S.text?.trim()?S.weight||5:0),0),A=(t.cons||[]).reduce((y,S)=>y+(S.text?.trim()?S.weight||5:0),0),o=(t.pros||[]).filter(y=>y.text?.trim()).length,C=(t.cons||[]).filter(y=>y.text?.trim()).length,L=y=>{y.stopPropagation(),i(!0)},z=async()=>{w(!0);try{await r(t.id),i(!1)}catch(y){console.error("Error deleting decision:",y)}finally{w(!1)}};return v?e.jsxs(R.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileTap:{scale:.98},children:[e.jsxs("div",{onClick:n,className:"bg-white rounded-2xl p-4 cursor-pointer border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-purple-500/10 flex items-center justify-center shrink-0",children:e.jsx(Ue,{className:"w-[22px] h-[22px] text-purple-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[m?e.jsx(Te,{title:j||"Entscheidung",onSave:I,className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",placeholder:"Entscheidung"}):e.jsx("h3",{className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",children:j||"Entscheidung"}),e.jsx("div",{className:"text-[13px] text-slate-500",children:ue(t.created_at)})]}),e.jsx("button",{onClick:L,disabled:x,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center shrink-0 hover:text-slate-600",title:"Löschen",children:x?e.jsx(Y,{size:18,className:"animate-spin"}):e.jsx(X,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Dt,{size:14,className:"text-green-600"}),e.jsx("span",{className:"text-[13px] font-medium text-green-600",children:o})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ct,{size:14,className:"text-red-600"}),e.jsx("span",{className:"text-[13px] font-medium text-red-600",children:C})]}),e.jsx(Lt,{proScore:O,contraScore:A})]}),e.jsx(oe,{size:22,className:"text-slate-400 shrink-0"})]})]}),e.jsx(pe,{isOpen:k,onClose:()=>i(!1),onConfirm:z,title:"Entscheidung löschen",description:"Möchtest du diese Entscheidung wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:x})]}):e.jsxs(R.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("div",{onClick:n,className:"bg-white rounded-2xl p-5 cursor-pointer border border-slate-200 shadow-sm hover:shadow-lg hover:border-slate-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/10 flex items-center justify-center shrink-0",children:e.jsx(Ue,{className:"w-6 h-6 text-purple-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[m?e.jsx(Te,{title:j||"Entscheidung",onSave:I,className:"text-base font-semibold text-slate-900 mb-1.5 whitespace-nowrap overflow-hidden text-ellipsis",placeholder:"Entscheidung"}):e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1.5 whitespace-nowrap overflow-hidden text-ellipsis",children:j||"Entscheidung"}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap text-[13px] text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Dt,{size:14,className:"text-green-600"}),e.jsxs("span",{className:"font-medium text-green-600",children:[o," Pro"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ct,{size:14,className:"text-red-600"}),e.jsxs("span",{className:"font-medium text-red-600",children:[C," Contra"]})]})]}),e.jsx(Lt,{proScore:O,contraScore:A}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Me,{size:14}),ue(t.created_at)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("button",{onClick:L,disabled:x,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center hover:text-red-500 transition-colors",title:"Löschen",children:x?e.jsx(Y,{size:18,className:"animate-spin"}):e.jsx(X,{size:18})}),e.jsx(oe,{size:20,className:"text-slate-400"})]})]})}),e.jsx(pe,{isOpen:k,onClose:()=>i(!1),onConfirm:z,title:"Entscheidung löschen",description:"Möchtest du diese Entscheidung wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:x})]})},xa={love:{icon:Ss,color:H.love.color,label:"Liebe"},talent:{icon:we,color:H.talent.color,label:"Talent"},need:{icon:ws,color:H.need.color,label:"Welt"},market:{icon:vs,color:H.market.color,label:"Markt"}},Tt=({dimensions:t})=>e.jsx("div",{className:"flex gap-1.5 flex-wrap",children:Object.entries(xa).map(([n,r])=>{const m=t?.[n]||[],u=m.length>0,c=r.icon;return e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded-xl text-xs font-medium",style:{backgroundColor:u?`${r.color}15`:B.slate[100],color:u?r.color:B.slate[400],border:u?`1px solid ${r.color}30`:`1px solid ${B.slate[200]}`},children:[e.jsx(c,{size:12}),e.jsx("span",{children:m.length})]},n)})}),ma=({ikigai:t,onDelete:n,onNavigate:r,headerGradient:m,headerText:u,primaryAccent:c})=>{const[g,x]=l.useState(!1),[w,k]=l.useState(!1),i=Pe(900),j={love:t.love_tags||[],talent:t.talent_tags||[],need:t.need_tags||[],market:t.market_tags||[]},N=Object.values(j).filter(o=>o.length>0).length,v=t.status==="completed",I=t.paths?.[0]?.role_title||(v?"Ikigai-Analyse abgeschlossen":"Ikigai-Analyse"),O=o=>{o.stopPropagation(),k(!0)},A=async()=>{x(!0);try{await n(t.id),k(!1)}catch(o){console.error("Error deleting ikigai:",o)}finally{x(!1)}};return i?e.jsxs(R.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileTap:{scale:.98},children:[e.jsxs("div",{onClick:r,className:"bg-white rounded-2xl p-4 cursor-pointer border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center shrink-0",style:{background:v?`linear-gradient(135deg, ${H.love.color}, ${H.talent.color}, ${H.need.color}, ${H.market.color})`:`linear-gradient(135deg, ${B.indigo[500]}15, ${B.indigo[500]}30)`},children:e.jsx(We,{className:`w-[22px] h-[22px] ${v?"text-white":"text-indigo-500"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-[15px] font-semibold text-slate-900 mb-1 leading-[1.3] line-clamp-2",children:I}),e.jsx("div",{className:"text-[13px] text-slate-500",children:ue(t.created_at)})]}),e.jsx("button",{onClick:O,disabled:g,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center shrink-0 hover:text-slate-600",title:"Löschen",children:g?e.jsx(Y,{size:18,className:"animate-spin"}):e.jsx(X,{size:18})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 pt-3 border-t border-slate-100",children:[e.jsx(Tt,{dimensions:j}),e.jsx(oe,{size:22,className:"text-slate-400 shrink-0"})]})]}),e.jsx(pe,{isOpen:w,onClose:()=>k(!1),onConfirm:A,title:"Ikigai-Analyse löschen",description:"Möchtest du diese Ikigai-Analyse wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:g})]}):e.jsxs(R.div,{variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{scale:1.01},whileTap:{scale:.99},children:[e.jsx("div",{onClick:r,className:"bg-white rounded-2xl p-5 cursor-pointer border border-slate-200 shadow-sm hover:shadow-lg hover:border-slate-300 transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shrink-0",style:{background:v?`linear-gradient(135deg, ${H.love.color}, ${H.talent.color}, ${H.need.color}, ${H.market.color})`:`linear-gradient(135deg, ${B.indigo[500]}15, ${B.indigo[500]}30)`},children:e.jsx(We,{className:`w-6 h-6 ${v?"text-white":"text-indigo-500"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900 whitespace-nowrap overflow-hidden text-ellipsis",children:I}),v&&e.jsx("span",{className:"px-2 py-0.5 rounded-[10px] text-[11px] font-semibold bg-gradient-to-r from-green-500 to-green-600 text-white",children:"Abgeschlossen"}),!v&&N>0&&e.jsxs("span",{className:"px-2 py-0.5 rounded-[10px] text-[11px] font-semibold bg-amber-500/10 text-amber-500",children:[N,"/4 Dimensionen"]})]}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap text-[13px] text-slate-500",children:[e.jsx(Tt,{dimensions:j}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Me,{size:14}),ue(t.created_at)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx("button",{onClick:O,disabled:g,className:"p-2 rounded-lg border-none bg-transparent text-slate-400 cursor-pointer flex items-center justify-center hover:text-red-500 transition-colors",title:"Löschen",children:g?e.jsx(Y,{size:18,className:"animate-spin"}):e.jsx(X,{size:18})}),e.jsx(oe,{size:20,className:"text-slate-400"})]})]})}),e.jsx(pe,{isOpen:w,onClose:()=>k(!1),onConfirm:A,title:"Ikigai-Analyse löschen",description:"Möchtest du diese Ikigai-Analyse wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",isDeleting:g})]})},ha=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",ua=t=>t>=90?"Ausgezeichnet!":t>=80?"Sehr gut!":t>=70?"Gut!":t>=60?"Solide Leistung":t>=50?"Ausbaufähig":"In Arbeit",Mt={ikigai:{label:"Ikigai-Kompass",icon:We},decision:{label:"Entscheidungs-Board",icon:Ue},briefing:{label:"Smart Briefing",icon:gt},simulator:{label:"Szenario-Training",icon:nt},video:{label:"Wirkungs-Analyse",icon:Ke},roleplay:{label:"Live-Simulation",icon:ke}},pa=({score:t,size:n=80})=>{const r=Math.min(100,Math.max(0,t||0)),m=(n-10)/2,u=m*2*Math.PI,c=u-r/100*u;return e.jsxs("div",{className:"relative",style:{width:n,height:n},children:[e.jsxs("svg",{width:n,height:n,className:"-rotate-90",children:[e.jsx("circle",{cx:n/2,cy:n/2,r:m,fill:"none",stroke:"rgba(255,255,255,0.25)",strokeWidth:8}),e.jsx(R.circle,{cx:n/2,cy:n/2,r:m,fill:"none",stroke:"#fff",strokeWidth:8,strokeLinecap:"round",strokeDasharray:u,initial:{strokeDashoffset:u},animate:{strokeDashoffset:c},transition:{duration:1.2,ease:"easeOut"}})]}),e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:e.jsx(R.span,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.4},className:"font-bold text-white leading-none",style:{fontSize:n/3},children:Math.round(t)})})]})},Pt=({type:t,title:n,subtitle:r,score:m,status:u,createdAt:c,duration:g,onBack:x,onDelete:w,onDownload:k,isDeleting:i=!1,isDownloading:j=!1,extraActions:N})=>{const v=Pe(768),I=Mt[t]||Mt.simulator,O=I.icon,A=m!=null&&m>0;return e.jsx("div",{className:"sticky top-0 z-40 bg-brand-gradient",style:{padding:v?"20px 16px":"24px 32px"},children:e.jsxs("div",{className:"max-w-[1400px] mx-auto",children:[x&&e.jsxs("button",{onClick:x,className:"flex items-center gap-1.5 bg-white/15 border-none rounded-lg px-3 py-2 cursor-pointer text-white text-[13px] mb-4 hover:bg-white/25 transition-colors",children:[e.jsx($t,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{className:"flex items-center gap-6",children:[!v&&A&&e.jsx(pa,{score:m,size:80}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap mb-2",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-[11px] font-semibold uppercase tracking-wider px-2.5 py-1 rounded-full bg-white/20 text-white",children:[e.jsx(O,{size:14}),I.label]}),A&&e.jsx("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-white/90",style:{color:te(m)},children:ua(m)}),u==="in_progress"&&e.jsx("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-white/90 text-amber-600",children:"In Bearbeitung"})]}),e.jsx("h1",{className:"font-bold text-white m-0 truncate",style:{fontSize:v?"20px":"24px",marginBottom:r?"4px":"8px"},children:n}),r&&e.jsx("p",{className:"text-sm text-white/80 m-0 mb-2",children:r}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[c&&e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(Me,{size:14}),ha(c)]}),g&&e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(Re,{size:14}),Math.floor(g/60),":",String(g%60).padStart(2,"0")," Min."]})]})]}),e.jsxs("div",{className:"flex gap-3 flex-shrink-0",children:[k&&e.jsxs("button",{onClick:k,disabled:j,title:"Als PDF herunterladen",className:"flex items-center justify-center gap-1.5 bg-white/15 border-none rounded-lg text-white text-[13px] font-medium hover:bg-white/25 transition-colors disabled:opacity-70",style:{padding:v?"10px":"10px 16px",cursor:j?"wait":"pointer"},children:[e.jsx(Bt,{size:16}),!v&&"PDF"]}),N,w&&e.jsxs("button",{onClick:w,disabled:i,title:"Löschen",className:"flex items-center justify-center gap-1.5 bg-red-500/20 border border-red-500/40 rounded-lg text-white text-[13px] font-medium hover:bg-red-500/30 transition-colors disabled:opacity-70",style:{padding:v?"10px":"10px 16px",cursor:i?"wait":"pointer"},children:[e.jsx(X,{size:16}),!v&&"Löschen"]})]})]})]})})},Ft={love:{key:"love",label:"Liebe",icon:"❤️",color:H.love.color,question:"Vergiss mal Geld und Karriere. Bei welchen Tätigkeiten vergisst du die Zeit?",placeholder:"Erzähle mir, was du wirklich liebst zu tun...",description:"Was du liebst"},talent:{key:"talent",label:"Talent",icon:"⭐",color:H.talent.color,question:"Worin bist du richtig gut? Was fällt dir leicht, während andere damit kämpfen?",placeholder:"Beschreibe deine Stärken und Fähigkeiten...",description:"Worin du gut bist"},need:{key:"need",label:"Welt",icon:"🌍",color:H.need.color,question:"Welche Probleme der Welt würdest du gerne lösen? Wo siehst du Bedarf?",placeholder:"Welchen Beitrag möchtest du leisten...",description:"Was die Welt braucht"},market:{key:"market",label:"Markt",icon:"💰",color:H.market.color,question:"Wofür werden Menschen in deinem Bereich bezahlt? Was ist gefragt?",placeholder:"Welche Berufe oder Märkte interessieren dich...",description:"Wofür du bezahlt wirst"}},a={PROGRESS:"progress",SIMULATOR:"simulator",ROLEPLAY:"roleplay",VIDEO:"video",BRIEFINGS:"briefings",DECISIONS:"decisions",IKIGAI:"ikigai",RHETORIK:"rhetorik"},mt=[{id:a.PROGRESS,label:"Fortschritt",icon:ks},{id:a.BRIEFINGS,label:"Smart Briefings",icon:gt},{id:a.DECISIONS,label:"Entscheidungs-Kompass",icon:Ue},{id:a.IKIGAI,label:"Ikigai-Kompass",icon:We},{id:a.SIMULATOR,label:"Szenario-Training",icon:nt},{id:a.VIDEO,label:"Wirkungs-Analyse",icon:Ke},{id:a.ROLEPLAY,label:"Live-Simulationen",icon:ke},{id:a.RHETORIK,label:"Rhetorik-Gym",icon:Le}],Fa=a,Be=15,st=({currentPage:t,totalPages:n,onPageChange:r,totalItems:m})=>{if(n<=1)return null;const u=(t-1)*Be+1,c=Math.min(t*Be,m);return e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-slate-200",children:[e.jsxs("span",{className:"text-sm text-slate-500",children:[u,"–",c," von ",m]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>r(t-1),disabled:t===1,className:"p-2 rounded-lg border border-slate-200 bg-white text-slate-600 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-slate-50 transition-colors",children:e.jsx(Es,{size:18})}),e.jsxs("span",{className:"text-sm font-medium text-slate-700 min-w-[80px] text-center",children:["Seite ",t," / ",n]}),e.jsx("button",{onClick:()=>r(t+1),disabled:t===n,className:"p-2 rounded-lg border border-slate-200 bg-white text-slate-600 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-slate-50 transition-colors",children:e.jsx(oe,{size:18})})]})]})},$a=({onBack:t,onSelectSession:n,isAuthenticated:r,onLoginClick:m,onContinueSession:u,onRepeatSession:c,initialTab:g,onNavigateToModule:x})=>{const{branding:w,demoCode:k}=Cs(),[i,j]=l.useState(g||a.PROGRESS);l.useEffect(()=>{g&&j(g)},[g]);const[N,v]=l.useState(null),[I,O]=l.useState(null);l.useEffect(()=>{window.scrollTo(0,0)},[i,N]);const[A,o]=l.useState([]),[C,L]=l.useState([]),[z,y]=l.useState([]),[S,Ie]=l.useState([]),[Z,J]=l.useState([]),[V,q]=l.useState([]),[F,ne]=l.useState([]),[Ee,se]=l.useState([]),[ge,Ve]=l.useState([]),[fe,E]=l.useState([]),[$,M]=l.useState({[a.PROGRESS]:1,[a.BRIEFINGS]:1,[a.DECISIONS]:1,[a.IKIGAI]:1,[a.SIMULATOR]:1,[a.VIDEO]:1,[a.ROLEPLAY]:1,[a.RHETORIK]:1}),[je,De]=l.useState(null),[U,Ce]=l.useState(null),[Fe,$e]=l.useState(null),[W,d]=l.useState(null),[f,P]=l.useState({love:{input:"",tags:[]},talent:{input:"",tags:[]},need:{input:"",tags:[]},market:{input:"",tags:[]}}),[Ae,de]=l.useState(null),[it,He]=l.useState(!1),[xe,ie]=l.useState(!0),[be,ft]=l.useState(null);l.useEffect(()=>{r?qe():ie(!1)},[r]);const qe=async()=>{ie(!0),ft(null);try{const s=Oe(),h=k?`&demo_code=${encodeURIComponent(k)}`:"",[p,b,D,T,ee,re,ye,hs,us,ps]=await Promise.all([Gs({limit:500,...k&&{demo_code:k}}).catch(()=>({data:[]})),fetch(`${s}/simulator/sessions?limit=500${h}`,{headers:{"X-WP-Nonce":ce()}}).then(_=>_.json()).catch(()=>({data:[]})),fetch(`${s}/video-training/sessions?limit=500${h}`,{headers:{"X-WP-Nonce":ce()}}).then(_=>_.json()).catch(()=>({data:[]})),fetch(`${s}/game/sessions?limit=500${h}`,{headers:{"X-WP-Nonce":ce()}}).then(_=>_.json()).catch(()=>({data:[]})),K.request(`/smartbriefing/briefings?limit=500${k?`&demo_code=${encodeURIComponent(k)}`:""}`,{method:"GET"}).catch(()=>({success:!1,data:{briefings:[]}})),K.getDecisions().catch(()=>({success:!1,data:{decisions:[]}})),K.getIkigais().catch(()=>({success:!1,data:{ikigais:[]}})),Us().catch(()=>[]),fetch(`${s}/simulator/scenarios`,{headers:{"X-WP-Nonce":ce()}}).then(_=>_.json()).catch(()=>({data:[]})),fetch(`${s}/video-training/scenarios`,{headers:{"X-WP-Nonce":ce()}}).then(_=>_.json()).catch(()=>({data:[]}))]),Ze=(_,Ne="sessions")=>{let ae=[];Array.isArray(_?.data)?ae=_.data:Array.isArray(_?.data?.[Ne])?ae=_.data[Ne]:Array.isArray(_?.[Ne])?ae=_[Ne]:Array.isArray(_)&&(ae=_);const _e=new Set,me=ae.filter(et=>et?.id?_e.has(et.id)?(console.warn("[SessionHistory] Duplicate session ID found:",et.id),!1):(_e.add(et.id),!0):!0);return me.length!==ae.length&&console.warn("[SessionHistory] Removed",ae.length-me.length,"duplicate sessions"),me},ot=_=>Array.isArray(_?.data?.scenarios)?_.data.scenarios:Array.isArray(_?.data)?_.data:Array.isArray(_)?_:[],dt=(_,Ne)=>{if(!Array.isArray(_))return[];const ae=new Set,_e=_.filter(me=>me?.id?ae.has(me.id)?(console.warn(`[SessionHistory] Duplicate ${Ne} ID found:`,me.id),!1):(ae.add(me.id),!0):!0);return _e.length!==_.length&&console.warn(`[SessionHistory] Removed ${_.length-_e.length} duplicate ${Ne}`),_e};o(Ze(p)),L(Ze(b)),y(Ze(D)),Ie(Ze(T,"games")),J(dt(ee?.data?.briefings||[],"briefing")),q(dt(re?.data?.decisions||[],"decision")),ne(dt(ye?.data?.ikigais||[],"ikigai")),se(ot(hs)),Ve(ot(us)),E(ot(ps))}catch(s){console.error("Failed to load sessions:",s),ft(s.message||"Fehler beim Laden der Daten")}finally{ie(!1)}},jt=l.useMemo(()=>{const s={};return Ee.forEach(h=>{s[h.id]=h}),s},[Ee]),bt=l.useMemo(()=>{const s={};return ge.forEach(h=>{s[h.id]=h}),s},[ge]),yt=l.useMemo(()=>{const s={};return fe.forEach(h=>{s[h.id]=h}),s},[fe]),Jt=()=>{switch(i){case a.SIMULATOR:return C;case a.VIDEO:return z;case a.BRIEFINGS:return Z;case a.DECISIONS:return V;case a.IKIGAI:return F;case a.RHETORIK:return S;case a.PROGRESS:return[];default:return A}},Xt=()=>{switch(i){case a.SIMULATOR:return bt;case a.VIDEO:return yt;default:return jt}},Nt=A.length+C.length+z.length+S.length+Z.length+V.length+F.length,Ye=s=>{M(h=>({...h,[i]:s})),window.scrollTo({top:200,behavior:"smooth"})};l.useEffect(()=>{M(s=>({...s,[i]:1}))},[i]);const Je=s=>{const p=(($[i]||1)-1)*Be;return s.slice(p,p+Be)},Xe=s=>Math.ceil(s.length/Be),vt=async s=>{(await K.request(`/smartbriefing/briefings/${s}`,{method:"DELETE"})).success&&J(p=>p.filter(b=>b.id!==s))},Qt=async(s,h)=>{const p=await K.updateBriefing(s.id,{title:h});return J(b=>b.map(D=>D.id===s.id?{...D,title:h}:D)),p},Zt=s=>{De(s)},es=()=>{De(null)},wt=async s=>{(await K.deleteDecision(s)).success&&q(p=>p.filter(b=>b.id!==s))},ts=async(s,h)=>{const p=await K.updateDecision(s.id,{topic:h});return q(b=>b.map(D=>D.id===s.id?{...D,topic:h}:D)),p},St=async s=>{await K.deleteIkigai(s)&&ne(p=>p.filter(b=>b.id!==s))},ss=s=>{Ce(s)},kt=()=>{Ce(null),$e(null)},as=s=>{d(s),P({love:{input:s.love_input||"",tags:s.love_tags||[]},talent:{input:s.talent_input||"",tags:s.talent_tags||[]},need:{input:s.need_input||"",tags:s.need_tags||[]},market:{input:s.market_input||"",tags:s.market_tags||[]}}),s.status==="completed"&&s.paths?de({summary:s.summary,paths:s.paths}):de(null)},rt=()=>{d(null),P({love:{input:"",tags:[]},talent:{input:"",tags:[]},need:{input:"",tags:[]},market:{input:"",tags:[]}}),de(null)},ns=async(s,h,p)=>{if(P(b=>({...b,[s]:{input:h,tags:p}})),W?.id)try{await K.updateIkigai(W.id,{[`${s}_input`]:h,[`${s}_tags`]:p})}catch(b){console.error("[Ikigai] Failed to save dimension:",b)}},is=async(s,h)=>{try{return(await K.extractIkigaiKeywords(s,h))?.keywords||[]}catch(p){return console.error("[Ikigai] Failed to extract keywords:",p),[]}},rs=(s,h)=>{P(p=>{const b=p[s].tags.filter(D=>D!==h);return{...p,[s]:{...p[s],tags:b}}})},ls=async()=>{if(Object.values(f).every(h=>h.tags&&h.tags.length>0)){He(!0);try{const h=await K.synthesizeIkigaiPaths({love_tags:f.love.tags,talent_tags:f.talent.tags,need_tags:f.need.tags,market_tags:f.market.tags});h&&(de(h),W?.id&&(await K.updateIkigai(W.id,{summary:h.summary,paths:h.paths,status:"completed"}),ne(p=>p.map(b=>b.id===W.id?{...b,summary:h.summary,paths:h.paths,status:"completed"}:b))))}catch(h){console.error("[Ikigai] Failed to synthesize paths:",h)}finally{He(!1)}}},cs=Object.values(f).every(s=>s.tags&&s.tags.length>0),os=s=>{q(h=>h.map(p=>p.id===s.id?s:p)),Ce(s)},ds=s=>{v(s),O(i)},lt=()=>{v(null),O(null)},ct=async(s,h)=>{const p=Oe();try{let b,D;switch(h){case a.SIMULATOR:b=`${p}/simulator/sessions/${s.id}`,D=()=>L(re=>re.filter(ye=>ye.id!==s.id));break;case a.ROLEPLAY:b=`${p}/roleplays/sessions/${s.id}`,D=()=>o(re=>re.filter(ye=>ye.id!==s.id));break;case a.VIDEO:b=`${p}/video-training/sessions/${s.id}`,D=()=>y(re=>re.filter(ye=>ye.id!==s.id));break;default:throw new Error("Unknown session type")}const ee=await(await fetch(b,{method:"DELETE",headers:{"X-WP-Nonce":ce()}})).json();if(ee.success)D(),N&&lt();else throw new Error(ee.message||"Delete failed")}catch(b){throw console.error("Failed to delete session:",b),b}},xs=async(s,h,p)=>{try{let b;switch(h){case a.SIMULATOR:await K.updateSimulatorSession(s.id,{custom_title:p}),b=D=>D.map(T=>T.id===s.id?{...T,custom_title:p}:T),L(b);break;case a.ROLEPLAY:await K.updateSession(s.id,{custom_title:p}),b=D=>D.map(T=>T.id===s.id?{...T,custom_title:p}:T),o(b);break;case a.VIDEO:await K.updateVideoTraining(s.id,{custom_title:p}),b=D=>D.map(T=>T.id===s.id?{...T,custom_title:p}:T),y(b);break;default:throw new Error("Unknown session type")}}catch(b){throw console.error("Failed to rename session:",b),b}},It=(s,h)=>(h===a.SIMULATOR?bt:h===a.VIDEO?yt:jt)[s?.scenario_id];if(je)return e.jsx(Vs,{briefing:je,onBack:es,onDelete:vt});if(U){const s={topic:U.topic||"",context:U.context||"",pros:U.pros||[],cons:U.cons||[],proScore:U.pro_score||0,contraScore:U.contra_score||0},h=async(D,T)=>{try{const ee={topic:D.topic,context:D.context||null,pros:D.pros,cons:D.cons,pro_score:D.proScore,contra_score:D.contraScore,analysis:T,status:"completed"};await K.updateDecision(U.id,ee);const re={...U,...ee};os(re),$e({data:D,result:T})}catch(ee){console.error("[SessionHistory] Failed to update decision:",ee)}},p=async D=>U.id,b=async(D,T)=>{try{await K.updateDecision(D,{topic:T.topic,context:T.context||null,pros:T.pros,cons:T.cons,pro_score:T.proScore,contra_score:T.contraScore,status:T.status||"draft"})}catch(ee){console.error("[SessionHistory] Failed to update decision:",ee)}};return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(Pt,{type:"decision",title:U.topic||"Entscheidung",status:U.status,createdAt:U.created_at,onBack:kt,onDelete:()=>{window.confirm("Möchtest du diese Entscheidungs-Analyse wirklich löschen?")&&(wt(U.id),kt())}}),e.jsx("div",{className:"p-6 max-w-[900px] mx-auto",children:Fe?e.jsx(Hs,{decisionData:Fe.data,analysisResult:Fe.result,onStartNew:()=>{$e(null),Ce(null)},onEditDecision:()=>{$e(null)}}):e.jsx(qs,{initialData:s,onAnalysisComplete:h,isAuthenticated:r,savedDecisionId:U.id,onSaveDraft:p,onUpdateSession:b,onDecisionIdChange:()=>{}})})]})}if(W)return e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx(Pt,{type:"ikigai",title:"Ikigai-Analyse",subtitle:W.status==="completed"?"Berufliche Orientierung":"In Bearbeitung",status:W.status,createdAt:W.created_at,onBack:rt,onDelete:()=>{window.confirm("Möchtest du diese Ikigai-Analyse wirklich löschen?")&&(St(W.id),rt())}}),e.jsx("div",{className:"p-6 max-w-[900px] mx-auto",children:Ae?e.jsx(Ys,{dimensions:f,synthesisResult:Ae,onStartNew:rt,onEdit:()=>de(null),DIMENSIONS:Ft}):e.jsx(Js,{dimensions:f,DIMENSIONS:Ft,onExtractKeywords:is,onUpdateDimension:ns,onRemoveTag:rs,allDimensionsFilled:cs,onSynthesize:ls,isSynthesizing:it})})]});if(N){if(I===a.ROLEPLAY){const p=It(N,I);return e.jsx(Ws,{session:N,scenario:p,onBack:lt,onRepeat:()=>c?.(N,p,"roleplay"),onDelete:b=>ct(b,a.ROLEPLAY)})}const h={[a.SIMULATOR]:"simulator",[a.VIDEO]:"video"}[I]||"simulator";return e.jsx(la,{session:N,type:I,scenario:It(N,I),onBack:lt,onContinueSession:u,onRepeatSession:(p,b)=>c?.(p,b,h),onDeleteSession:ct})}if(!r)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:e.jsx(At,{className:"w-7 h-7 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-slate-900",children:"Meine Sessions"})]}),e.jsx("p",{className:"text-lg text-slate-500 max-w-[600px] mx-auto",children:"Hier findest du deine gespeicherten Übungen und Fortschritte"})]}),e.jsxs(G,{className:"max-w-[500px] mx-auto mt-16 p-10 text-center rounded-2xl shadow-card",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center mx-auto mb-5",children:e.jsx(_t,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-3",children:"Anmeldung erforderlich"}),e.jsx("p",{className:"text-slate-500 mb-6 leading-relaxed",children:"Um deine gespeicherten Sessions zu sehen, musst du dich zuerst anmelden."}),e.jsx(Q,{onClick:m,size:"lg",icon:e.jsx(_t,{className:"w-5 h-5"}),children:"Jetzt anmelden"})]})]});if(xe)return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 mb-3",children:[e.jsx(tt,{className:"w-12 h-12 rounded-2xl"}),e.jsx(tt,{className:"h-10 w-48"})]}),e.jsx(tt,{className:"h-5 w-32 mx-auto"})]}),e.jsx("div",{className:"flex justify-center gap-2 mb-8",children:[1,2,3,4,5,6].map(s=>e.jsx(tt,{className:"h-12 w-28 rounded-xl"},s))}),e.jsx("div",{className:"space-y-3 max-w-4xl mx-auto",children:[1,2,3,4,5].map(s=>e.jsx(Ds,{},s))})]});if(be)return e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-[400px] p-6",children:[e.jsx(ve,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-slate-500 mb-6",children:be}),e.jsx(Q,{onClick:qe,children:"Erneut versuchen"})]})});const Qe=Jt(),ms=Xt();return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8 text-center relative",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center",children:e.jsx(At,{className:"w-7 h-7 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-slate-900",children:"Meine Sessions"})]}),e.jsxs("p",{className:"text-lg text-slate-500 max-w-[600px] mx-auto",children:[Nt," ",Nt===1?"Übung":"Übungen"," gespeichert"]}),e.jsx("button",{onClick:qe,disabled:xe,className:"absolute top-0 right-0 p-2.5 rounded-xl border border-slate-200 bg-white text-slate-500 shadow-sm flex items-center justify-center md:hidden disabled:opacity-50 hover:shadow-md transition-shadow",children:e.jsx(Rt,{className:`w-5 h-5 ${xe?"animate-spin":""}`})})]}),e.jsx("div",{className:"hidden lg:flex flex-wrap gap-2 mx-6 mb-6 bg-slate-100 p-1.5 rounded-2xl",children:mt.map(s=>{const h=s.icon,p=i===s.id,b=s.id===a.PROGRESS?null:s.id===a.SIMULATOR?C.length:s.id===a.VIDEO?z.length:s.id===a.BRIEFINGS?Z.length:s.id===a.DECISIONS?V.length:s.id===a.IKIGAI?F.length:s.id===a.RHETORIK?S.length:A.length;return e.jsxs("button",{onClick:()=>j(s.id),className:`flex-1 min-w-fit py-3 px-4 rounded-xl border-none text-sm cursor-pointer flex items-center justify-center gap-2 transition-all ${p?"bg-white text-slate-900 font-semibold shadow-md":"bg-transparent text-slate-500 font-medium hover:bg-white/50"}`,children:[e.jsx(h,{size:18}),e.jsx("span",{children:s.label}),b!==null&&e.jsx("span",{className:`py-0.5 px-2 rounded-xl text-xs font-semibold min-w-[24px] text-center ${p?"bg-indigo-500 text-white":"bg-slate-200 text-slate-500"}`,children:b})]},s.id)})}),e.jsxs("div",{className:"lg:hidden mx-4 mb-4",children:[e.jsx("div",{className:"flex gap-2 justify-center mb-3 flex-wrap",children:mt.map(s=>{const h=s.icon,p=i===s.id,b=s.id===a.PROGRESS?null:s.id===a.SIMULATOR?C.length:s.id===a.VIDEO?z.length:s.id===a.BRIEFINGS?Z.length:s.id===a.DECISIONS?V.length:s.id===a.IKIGAI?F.length:s.id===a.RHETORIK?S.length:A.length;return e.jsxs("button",{onClick:()=>j(s.id),className:`flex-1 max-w-[60px] py-3 px-2 rounded-xl border-2 cursor-pointer flex flex-col items-center justify-center gap-1 transition-all ${p?"bg-white shadow-md border-indigo-500":"bg-slate-100 border-transparent hover:bg-white/60"}`,children:[e.jsx(h,{size:18,className:p?"text-indigo-500":"text-slate-500"}),b!==null?e.jsx("span",{className:`py-0.5 px-1.5 rounded-lg text-[11px] font-semibold min-w-[20px] text-center ${p?"bg-indigo-500 text-white":"bg-slate-200 text-slate-500"}`,children:b}):e.jsx("span",{className:`py-0.5 px-1.5 rounded-lg text-[11px] font-semibold ${p?"text-indigo-500":"text-slate-400"}`,children:"📈"})]},s.id)})}),e.jsx("div",{className:"text-center text-[15px] font-semibold text-slate-900 py-2 px-4 bg-white rounded-xl shadow-sm",children:mt.find(s=>s.id===i)?.label})]}),i!==a.PROGRESS&&e.jsxs("div",{className:"hidden sm:flex justify-center lg:justify-end flex-wrap gap-3 mx-6 mb-6",children:[e.jsx(Q,{variant:"outline",onClick:qe,disabled:xe,title:"Aktualisieren",children:e.jsx(Rt,{className:`w-4 h-4 ${xe?"animate-spin":""}`})}),x&&e.jsxs(Q,{onClick:()=>{const s={[a.BRIEFINGS]:"smart_briefing",[a.DECISIONS]:"decision_board",[a.IKIGAI]:"ikigai",[a.SIMULATOR]:"simulator",[a.VIDEO]:"video_training",[a.ROLEPLAY]:"dashboard",[a.RHETORIK]:"rhetorik_gym"};x(s[i]||"overview")},children:[e.jsx(Is,{className:"w-4 h-4 mr-2"}),i===a.BRIEFINGS?"Neues Briefing":i===a.DECISIONS?"Neue Entscheidungs-Analyse":i===a.IKIGAI?"Neue Ikigai-Analyse":i===a.SIMULATOR?"Neues Szenario-Training":i===a.VIDEO?"Neue Wirkungs-Analyse":i===a.RHETORIK?"Neue Rhetorik-Session":"Neue Live-Simulation"]})]}),e.jsx("div",{className:"mx-4 sm:mx-6",children:i===a.PROGRESS?e.jsx(Xs,{simulatorSessions:C,videoSessions:z,roleplaySessions:A,gameSessions:S}):Qe.length===0?e.jsxs(G,{className:"text-center py-16 px-6 rounded-2xl shadow-card",children:[i===a.SIMULATOR&&e.jsx(nt,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),i===a.ROLEPLAY&&e.jsx(ke,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),i===a.VIDEO&&e.jsx(Ke,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),i===a.BRIEFINGS&&e.jsx(gt,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),i===a.DECISIONS&&e.jsx(Ue,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),i===a.IKIGAI&&e.jsx(We,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),i===a.RHETORIK&&e.jsx(Le,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsxs("h3",{className:"text-xl font-semibold text-slate-600 mb-2",children:["Noch keine ",i===a.SIMULATOR?"Szenario-Trainings":i===a.VIDEO?"Wirkungs-Analysen":i===a.BRIEFINGS?"Smart Briefings":i===a.DECISIONS?"Entscheidungs-Analysen":i===a.IKIGAI?"Ikigai-Analysen":i===a.RHETORIK?"Rhetorik-Sessions":"Live-Simulationen"]}),e.jsx("p",{className:"text-slate-500 mb-6",children:i===a.BRIEFINGS?"Erstelle dein erstes Briefing, um dich optimal vorzubereiten.":i===a.DECISIONS?"Nutze den Entscheidungs-Kompass, um deine erste Entscheidung zu analysieren.":i===a.IKIGAI?"Entdecke deinen idealen Karrierepfad mit dem Ikigai-Kompass.":i===a.RHETORIK?"Trainiere deine Rhetorik und reduziere Füllwörter.":"Starte dein erstes Training, um hier deine Fortschritte zu sehen."}),e.jsxs(Q,{onClick:()=>{if(x){const s={[a.BRIEFINGS]:"smart_briefing",[a.DECISIONS]:"decision_board",[a.IKIGAI]:"ikigai",[a.SIMULATOR]:"simulator",[a.VIDEO]:"video_training",[a.ROLEPLAY]:"dashboard",[a.RHETORIK]:"rhetorik_gym"};x(s[i]||"overview")}else t?.()},children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),i===a.BRIEFINGS?"Briefing erstellen":i===a.DECISIONS?"Entscheidung analysieren":i===a.IKIGAI?"Ikigai entdecken":i===a.RHETORIK?"Rhetorik trainieren":"Training starten"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(R.div,{className:"flex flex-col gap-3",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},children:i===a.BRIEFINGS?Je(Z).map(s=>e.jsx(ca,{briefing:s,onClick:()=>Zt(s),onDelete:vt,onRename:Qt},s.id)):i===a.DECISIONS?Je(V).map(s=>e.jsx(da,{decision:s,onClick:()=>ss(s),onDelete:wt,onRename:ts},s.id)):i===a.IKIGAI?Je(F).map(s=>e.jsx(ma,{ikigai:s,onDelete:St,onNavigate:()=>as(s)},s.id)):Je(Qe).map(s=>{const h=ms[s.scenario_id];return e.jsx(oa,{session:s,type:i,scenario:h,onClick:()=>ds(s),onContinueSession:u,onDeleteSession:ct,onRename:xs},s.id)})}),i===a.BRIEFINGS?e.jsx(st,{currentPage:$[i]||1,totalPages:Xe(Z),totalItems:Z.length,onPageChange:Ye}):i===a.DECISIONS?e.jsx(st,{currentPage:$[i]||1,totalPages:Xe(V),totalItems:V.length,onPageChange:Ye}):i===a.IKIGAI?e.jsx(st,{currentPage:$[i]||1,totalPages:Xe(F),totalItems:F.length,onPageChange:Ye}):e.jsx(st,{currentPage:$[i]||1,totalPages:Xe(Qe),totalItems:Qe.length,onPageChange:Ye})]})})]})};export{Fa as SESSION_TABS,$a as default};
