<<<<<<< Updated upstream
import{c as A,w as O,r as l,i as Y,j as e,C as ee,U as re,e as te,f as ie,B as w,h as U,l as ae,A as oe,S as le,T as ce,L as de,k as me,H as ue,n as ge}from"./wordpress-api-BnKMaWph.js";const se=A("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const Z=A("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const q=A("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const xe=A("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const ne=A("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const J=A("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function he({onComplete:u}){const g=O.isWordPress()?O.getCurrentUser():null,R=g?.id&&g.id>0&&(g?.firstName||g?.name)||"",[i,v]=l.useState(1),[d,C]=l.useState({name:R,position:"",company:"",experience_level:"professional"}),[p,j]=l.useState([]),[N,a]=l.useState([]),[t,c]=l.useState({}),[b,S]=l.useState(!1),[f,z]=l.useState(null),[D,T]=l.useState({video:"",audio:""}),[B,E]=l.useState({video:[],audio:[]}),k=(s,n)=>{C(r=>({...r,[s]:n})),t[s]&&c(r=>({...r,[s]:""}))},L=s=>{const n={};return s===1&&(d.position.trim()||(n.position="Bitte gib die Position ein")),c(n),Object.keys(n).length===0},W=async()=>{S(!0),c({});try{const s=await O.generateQuestions({position:d.position,company:d.company,experience_level:d.experience_level});if(s.success&&s.data.questions){const n=s.data.questions;j(n),a(n.map(r=>r.id)),v(2)}else c({generate:"Fehler beim Generieren der Fragen"})}catch(s){console.error("Error generating questions:",s),c({generate:s.message||"Fehler beim Generieren der Fragen"})}finally{S(!1)}},H=s=>{a(n=>n.includes(s)?n.filter(r=>r!==s):[...n,s])},_=async()=>{console.log("üé• Initializing devices..."),c({});try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("MediaDevices API not available in this browser");console.log("üì± Checking available devices...");const s=await navigator.mediaDevices.enumerateDevices();console.log("üì± Initial devices check:",s);const n=s.some(m=>m.kind==="videoinput"),r=s.some(m=>m.kind==="audioinput");if(console.log("üìπ Has video devices:",n),console.log("üé§ Has audio devices:",r),!n&&!r)throw new Error("Keine Kamera oder Mikrofon gefunden. Bitte stelle sicher, dass Ger√§te angeschlossen sind.");console.log("üé• Requesting camera and microphone access..."),console.log("‚ö†Ô∏è Please allow camera and microphone access in your browser!");let o=null;try{o=await navigator.mediaDevices.getUserMedia({video:n,audio:r}),console.log("‚úÖ Got both camera and microphone")}catch(m){if(console.warn("‚ö†Ô∏è Could not get both devices, trying individually...",m),n)try{const y=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});console.log("‚úÖ Got camera only"),o=y}catch(y){console.error("‚ùå Could not get camera:",y)}if(!o&&r)try{const y=await navigator.mediaDevices.getUserMedia({video:!1,audio:!0});console.log("‚úÖ Got microphone only"),o=y}catch(y){console.error("‚ùå Could not get microphone:",y)}if(!o)throw m}console.log("‚úÖ Media access granted"),console.log("üìπ Video tracks:",o.getVideoTracks().length),console.log("üé§ Audio tracks:",o.getAudioTracks().length),z(o);const I=await navigator.mediaDevices.enumerateDevices();console.log("üì± All devices (with labels):",I);const x=I.filter(m=>m.kind==="videoinput"),F=I.filter(m=>m.kind==="audioinput");console.log("üìπ Video devices found:",x.length,x),console.log("üé§ Audio devices found:",F.length,F),E({video:x,audio:F});const V=o.getVideoTracks()[0],G=o.getAudioTracks()[0];if(V){const m=V.getSettings();console.log("üìπ Active video device:",m.deviceId),T(y=>({...y,video:m.deviceId||x[0]?.deviceId||""}))}if(G){const m=G.getSettings();console.log("üé§ Active audio device:",m.deviceId),T(y=>({...y,audio:m.deviceId||F[0]?.deviceId||""}))}if(x.length===0||F.length===0){const m=[];x.length===0&&m.push("Kamera"),F.length===0&&m.push("Mikrofon"),c({devices:`‚ö†Ô∏è ${m.join(" und ")} nicht gefunden. Du kannst trotzdem fortfahren, aber die Aufnahmequalit√§t k√∂nnte eingeschr√§nkt sein.`,showRetry:!1})}console.log("‚úÖ Device initialization complete")}catch(s){console.error("‚ùå Error accessing devices:",s),console.error("Error name:",s.name),console.error("Error message:",s.message);let n="Fehler beim Zugriff auf Kamera oder Mikrofon",r=!0;s.name==="NotAllowedError"||s.name==="PermissionDeniedError"?n='Zugriff auf Kamera/Mikrofon wurde verweigert. Bitte klicke auf "Zulassen" im Browser-Dialog und versuche es erneut.':s.name==="NotFoundError"?n=`Keine Kamera oder Mikrofon gefunden. M√∂gliche Gr√ºnde:

‚Ä¢ Kein Ger√§t ist angeschlossen
‚Ä¢ Das Ger√§t wird von einer anderen Anwendung verwendet
‚Ä¢ Der Browser hat keinen Zugriff auf das Ger√§t

Bitte √ºberpr√ºfe deine Ger√§te und Browser-Einstellungen.`:s.name==="NotReadableError"||s.name==="OverconstrainedError"?n="Kamera/Mikrofon wird bereits von einer anderen Anwendung verwendet oder ist nicht verf√ºgbar. Bitte schlie√üe andere Apps, die auf die Kamera/Mikrofon zugreifen (z.B. Zoom, Teams, Skype).":n=`Fehler beim Zugriff auf Kamera/Mikrofon: ${s.message}`,c({devices:n,showRetry:r})}},P=async()=>{if(L(i)){if(i===1)await W();else if(i===2){if(N.length===0){c({questions:"Bitte w√§hle mindestens eine Frage aus"});return}v(3),await _()}}},K=()=>{i>1&&(v(i-1),i===3&&f&&(f.getTracks().forEach(s=>s.stop()),z(null)))},Q=()=>{const s=p.filter(n=>N.includes(n.id));u({...d,questions:s,cameraStream:f,selectedDevices:D})},$=async(s,n)=>{if(!n||n===""){console.warn("Invalid deviceId, skipping change");return}if(T(r=>({...r,[s]:n})),f){f.getTracks().forEach(x=>x.stop());const r=s==="video"?n:D.video,o=s==="audio"?n:D.audio,I={video:r&&r!==""?{deviceId:{exact:r}}:!0,audio:o&&o!==""?{deviceId:{exact:o}}:!0};try{const x=await navigator.mediaDevices.getUserMedia(I);z(x)}catch(x){console.error("Error changing device:",x),c({devices:"Fehler beim Wechseln des Ger√§ts: "+x.message})}}};return Y.useEffect(()=>{if(f&&i===3){const s=document.getElementById("camera-preview");s&&(s.srcObject=f)}},[f,i]),e.jsxs("div",{className:"w-full max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${i>=s?"bg-ocean-600 text-white":"bg-gray-200 text-gray-500"}`,children:i>s?e.jsx(ee,{className:"w-6 h-6"}):s}),s<3&&e.jsx("div",{className:`flex-1 h-1 mx-2 ${i>s?"bg-ocean-600":"bg-gray-200"}`})]},s))}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Pers√∂nliche Daten"}),e.jsx("span",{children:"Fragen generieren"}),e.jsx("span",{children:"Kamera & Mikrofon"})]})]}),i===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Pers√∂nliche Parameter"}),e.jsx("p",{className:"text-gray-600",children:"Gib deine Informationen ein, um personalisierte Interviewfragen zu generieren."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(re,{className:"inline w-4 h-4 mr-2"}),"Name (optional)"]}),e.jsx("input",{type:"text",value:d.name,onChange:s=>k("name",s.target.value),placeholder:"Dein Name",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500 focus:border-ocean-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(te,{className:"inline w-4 h-4 mr-2"}),"Zielposition *"]}),e.jsx("input",{type:"text",value:d.position,onChange:s=>k("position",s.target.value),placeholder:"z.B. Junior Product Manager",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-ocean-500 focus:border-ocean-500 ${t.position?"border-red-500":"border-gray-300"}`}),t.position&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.position})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ie,{className:"inline w-4 h-4 mr-2"}),"Firma / Wunschfirma (optional)"]}),e.jsx("input",{type:"text",value:d.company,onChange:s=>k("company",s.target.value),placeholder:"z.B. BMW",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500 focus:border-ocean-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Erfahrungslevel"}),e.jsxs("select",{value:d.experience_level,onChange:s=>k("experience_level",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500 focus:border-ocean-500",children:[e.jsx("option",{value:"student",children:"Sch√ºler"}),e.jsx("option",{value:"entry",children:"Berufseinsteiger"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"senior",children:"Senior / F√ºhrungskraft"})]})]})]}),t.generate&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:t.generate}),e.jsx("div",{className:"flex justify-end",children:e.jsx(w,{onClick:P,disabled:b,className:"bg-ocean-600 hover:bg-ocean-700 text-white px-6 py-3 flex items-center",children:b?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"w-5 h-5 mr-2 animate-spin"}),e.jsx("span",{children:"Fragen werden generiert..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Fragen generieren"}),e.jsx(U,{className:"w-5 h-5 ml-2"})]})})})]}),i===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Deine Interviewfragen"}),e.jsxs("p",{className:"text-gray-600",children:["KarriereHeld hat ",p.length," Fragen f√ºr dich erstellt. Alle Fragen sind bereits ausgew√§hlt. Du kannst Fragen abw√§hlen, wenn du m√∂chtest (mindestens 1 Frage muss ausgew√§hlt bleiben)."]}),e.jsx("div",{className:"p-4 bg-ocean-50 border border-ocean-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-ocean-800",children:[e.jsx("strong",{children:N.length})," von ",e.jsx("strong",{children:p.length})," Fragen ausgew√§hlt"]})}),e.jsx("div",{className:"space-y-3",children:p.map((s,n)=>e.jsx("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${N.includes(s.id)?"border-ocean-500 bg-ocean-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>H(s.id),children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:`w-6 h-6 rounded border-2 flex items-center justify-center mr-3 mt-0.5 flex-shrink-0 transition-colors ${N.includes(s.id)?"border-ocean-500 bg-ocean-500":"border-gray-400 bg-white"}`,children:N.includes(s.id)&&e.jsx(se,{className:"w-5 h-5 text-white stroke-[4] font-bold",strokeWidth:4})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-800",children:[n+1,". ",s.question]}),s.category&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:s.category})]})]})},s.id))}),t.questions&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:t.questions}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(w,{onClick:K,variant:"outline",className:"px-6 py-3 flex items-center",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:"Zur√ºck"})]}),e.jsxs(w,{onClick:P,className:"bg-ocean-600 hover:bg-ocean-700 text-white px-6 py-3 flex items-center",children:[e.jsx("span",{children:"Weiter"}),e.jsx(U,{className:"w-5 h-5 ml-2"})]})]})]}),i===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Kamera & Mikrofon Check"}),e.jsx("p",{className:"text-gray-600",children:"Stelle sicher, dass deine Kamera und dein Mikrofon richtig funktionieren. Das gesamte Interview wird in einem durchgehenden Video aufgezeichnet."}),!f&&!t.devices&&e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"‚ö†Ô∏è Wichtig:"})," Bitte erlaube den Zugriff auf Kamera und Mikrofon im Browser-Dialog, wenn dieser erscheint."]})}),e.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:e.jsx("video",{id:"camera-preview",autoPlay:!0,playsInline:!0,muted:!0,className:"w-full aspect-video"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(J,{className:"inline w-4 h-4 mr-2"}),"Kamera"]}),e.jsx("select",{value:D.video,onChange:s=>$("video",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500",children:B.video.map(s=>e.jsx("option",{value:s.deviceId,children:s.label||`Kamera ${s.deviceId.slice(0,8)}`},s.deviceId))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ae,{className:"inline w-4 h-4 mr-2"}),"Mikrofon"]}),e.jsx("select",{value:D.audio,onChange:s=>$("audio",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500",children:B.audio.map(s=>e.jsx("option",{value:s.deviceId,children:s.label||`Mikrofon ${s.deviceId.slice(0,8)}`},s.deviceId))})]})]}),t.devices&&e.jsxs("div",{className:`p-4 border rounded-lg ${t.showRetry?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:[e.jsx("p",{className:`mb-3 whitespace-pre-line ${t.showRetry?"text-red-700":"text-yellow-800"}`,children:t.devices}),t.showRetry&&e.jsx(w,{onClick:_,className:"bg-red-600 hover:bg-red-700 text-white",children:"Erneut versuchen"})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Hinweis:"})," Das gesamte Interview wird in einem durchgehenden Video aufgezeichnet. Du kannst zwischen den Fragen hin- und herspringen."]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(w,{onClick:K,variant:"outline",className:"px-6 py-3 flex items-center",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:"Zur√ºck"})]}),e.jsxs(w,{onClick:Q,className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 text-lg font-semibold flex items-center",children:[e.jsx(J,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:"Aufnahme starten"})]})]})]})]})}function fe({questions:u,cameraStream:h,trainingData:g,onComplete:M,onCancel:R}){const[i,v]=l.useState(0),[d,C]=l.useState(!1),[p,j]=l.useState(0),[N,a]=l.useState([]),[t,c]=l.useState(!1),[b,S]=l.useState(0),f=l.useRef(null),z=l.useRef([]),D=l.useRef(null),T=l.useRef(null),B=l.useRef(0),E=u[i],k=u.length;l.useEffect(()=>(D.current&&h&&(D.current.srcObject=h),()=>{T.current&&clearInterval(T.current)}),[h]);const L=()=>{if(!h){console.error("No camera stream available");return}try{const s={mimeType:"video/webm;codecs=vp9"};MediaRecorder.isTypeSupported(s.mimeType)||(s.mimeType="video/webm;codecs=vp8");const n=new MediaRecorder(h,s);f.current=n,z.current=[],n.ondataavailable=r=>{r.data&&r.data.size>0&&z.current.push(r.data)},n.onstop=H,n.start(1e3),C(!0),B.current=0,T.current=setInterval(()=>{j(r=>r+1)},1e3),a([{question_index:0,question_id:E.id,start_time:0}])}catch(s){console.error("Error starting recording:",s),alert("Fehler beim Starten der Aufnahme: "+s.message)}},W=()=>{f.current&&d&&(f.current.stop(),C(!1),T.current&&clearInterval(T.current),a(s=>{const n=[...s];return n.length>0&&(n[n.length-1].end_time=p),n}))},H=async()=>{const s=new Blob(z.current,{type:"video/webm"});await _(s)},_=async s=>{c(!0),S(0);try{const n=new File([s],`interview-${Date.now()}.webm`,{type:"video/webm"}),r=await fetch("/wp-json/bewerbungstrainer/v1/video-training",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:g.name,position:g.position,company:g.company,experience_level:g.experience_level,questions:u})});if(!r.ok)throw new Error("Failed to create training session");const I=(await r.json()).data.id,x=new FormData;if(x.append("video",n),x.append("timeline",JSON.stringify(N)),!(await fetch(`/wp-json/bewerbungstrainer/v1/video-training/${I}/upload`,{method:"POST",body:x})).ok)throw new Error("Failed to upload video");S(100);const V=await fetch(`/wp-json/bewerbungstrainer/v1/video-training/${I}/analyze`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!V.ok)throw new Error("Failed to start analysis");const G=await V.json();M(G.data)}catch(n){console.error("Error uploading video:",n),alert("Fehler beim Hochladen des Videos: "+n.message),c(!1)}},P=()=>{if(i<k-1){const s=p;a(r=>{const o=[...r];return o.length>0&&(o[o.length-1].end_time=s),o});const n=i+1;v(n),a(r=>[...r,{question_index:n,question_id:u[n].id,start_time:s}])}},K=()=>{if(i>0){const s=p;a(r=>{const o=[...r];return o.length>0&&(o[o.length-1].end_time=s),o});const n=i-1;v(n),a(r=>[...r,{question_index:n,question_id:u[n].id,start_time:s}])}},Q=s=>{const n=Math.floor(s/60),r=s%60;return`${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`},$=()=>{window.confirm("M√∂chtest du das Interview beenden und die Aufnahme hochladen?")&&W()};return e.jsxs("div",{className:"w-full max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"KarriereHeld Coach"}),e.jsxs("p",{className:"text-gray-600",children:["Video-Interview Training f√ºr ",g.position]})]}),d&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"w-4 h-4 text-red-600 fill-current animate-pulse"}),e.jsx("span",{className:"text-red-600 font-semibold",children:"REC"})]}),e.jsx("span",{className:"text-2xl font-mono font-bold text-gray-800",children:Q(p)})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-black rounded-lg overflow-hidden shadow-2xl",children:e.jsx("video",{ref:D,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full aspect-video"})}),e.jsxs("div",{className:"p-6 bg-ocean-50 border-2 border-ocean-200 rounded-lg flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"text-sm font-semibold text-ocean-600",children:["Frage ",i+1," von ",k]}),E.category&&e.jsx("span",{className:"px-3 py-1 text-xs rounded-full bg-ocean-100 text-ocean-700",children:E.category})]}),e.jsx("p",{className:"text-xl font-medium text-gray-800 leading-relaxed",children:E.question})]})]}),!d&&!t&&e.jsx("div",{className:"flex justify-center",children:e.jsxs(w,{onClick:L,className:"bg-red-600 hover:bg-red-700 text-white px-8 py-4 text-lg font-semibold",size:"lg",children:[e.jsx(q,{className:"w-6 h-6 mr-2 fill-current"}),"Aufnahme starten"]})}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(w,{onClick:K,disabled:i===0,variant:"outline",className:"px-6 py-3",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),"Vorherige Frage"]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["Frage ",i+1," / ",k]}),e.jsx("div",{className:"w-64 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-ocean-600 transition-all duration-300",style:{width:`${(i+1)/k*100}%`}})})]}),e.jsxs(w,{onClick:P,disabled:i===k-1,variant:"outline",className:"px-6 py-3",children:["N√§chste Frage",e.jsx(U,{className:"w-5 h-5 ml-2"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(w,{onClick:$,className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 text-lg font-semibold",children:[e.jsx(se,{className:"w-5 h-5 mr-2"}),"Interview beenden"]})})]}),t&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-6 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(ne,{className:"w-8 h-8 text-blue-600 animate-spin mr-3"}),e.jsx("p",{className:"text-lg font-semibold text-blue-800",children:"Video wird hochgeladen und analysiert..."})]}),b>0&&e.jsx("div",{className:"w-full bg-blue-100 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"bg-blue-600 h-full transition-all duration-300",style:{width:`${b}%`}})}),e.jsx("p",{className:"text-sm text-blue-700 text-center mt-4",children:"Die KI analysiert jetzt dein Video. Das kann einen Moment dauern..."})]})}),!d&&!t&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tipps f√ºr dein Video-Interview:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Achte auf gute Beleuchtung und einen ruhigen Hintergrund"}),e.jsx("li",{children:"Sprich klar und deutlich, halte Blickkontakt zur Kamera"}),e.jsx("li",{children:"Nimm dir Zeit f√ºr deine Antworten, aber bleibe fokussiert"}),e.jsx("li",{children:"Du kannst jederzeit zwischen den Fragen navigieren"}),e.jsx("li",{children:"Die Aufnahme l√§uft durchgehend, aber du bestimmst das Tempo"})]})]})]})}function pe({analysis:u,trainingData:h,onStartNew:g,onGoHome:M}){if(!u)return e.jsx("div",{className:"w-full max-w-4xl mx-auto p-6",children:e.jsx("div",{className:"p-8 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:e.jsx("p",{className:"text-yellow-800",children:"Keine Analysedaten verf√ºgbar."})})});const{overall_score:R,categories:i,staerken_und_positive_ueberraschungen:v,kurzfeedback_fuer_user:d}=u,C=a=>a>=80?"text-green-600":a>=60?"text-yellow-600":"text-red-600",p=a=>a>=80?"bg-green-100 border-green-300":a>=60?"bg-yellow-100 border-yellow-300":"bg-red-100 border-red-300",j=({score:a,size:t="large"})=>{const c=t==="large",b=c?70:45,S=2*Math.PI*b,f=a/100*S;return e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:c?"w-40 h-40":"w-24 h-24",viewBox:"0 0 160 160",children:[e.jsx("circle",{cx:"80",cy:"80",r:b,fill:"none",stroke:"#e5e7eb",strokeWidth:c?"12":"8"}),e.jsx("circle",{cx:"80",cy:"80",r:b,fill:"none",stroke:a>=80?"#10b981":a>=60?"#f59e0b":"#ef4444",strokeWidth:c?"12":"8",strokeDasharray:S,strokeDashoffset:S-f,strokeLinecap:"round",transform:"rotate(-90 80 80)",className:"transition-all duration-1000"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:`font-bold ${c?"text-4xl":"text-2xl"} ${C(a)}`,children:Math.round(a)})})]})},N={auftreten:"Auftreten",selbstbewusstsein:"Selbstbewusstsein",koerpersprache:"K√∂rpersprache",kommunikation:"Kommunikation",professionalitaet:"Professionalit√§t",persoenliche_wirkung:"Pers√∂nliche Wirkung"};return e.jsxs("div",{className:"w-full max-w-6xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(oe,{className:"w-12 h-12 text-ocean-600 mr-3"}),e.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"Dein Video-Interview Feedback"})]}),e.jsxs("p",{className:"text-xl text-gray-600",children:["Analyse f√ºr: ",h.position,h.company&&` bei ${h.company}`]})]}),e.jsx("div",{className:"p-8 bg-gradient-to-br from-ocean-50 to-blue-50 border-2 border-ocean-200 rounded-2xl shadow-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8",children:[e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Gesamtbewertung"}),d&&e.jsx("p",{className:"text-lg text-gray-700 leading-relaxed",children:d})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(j,{score:R||0,size:"large"})})]})}),v&&v.length>0&&e.jsxs("div",{className:"p-6 bg-green-50 border-2 border-green-200 rounded-xl",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(le,{className:"w-6 h-6 text-green-600 mr-3"}),e.jsx("h3",{className:"text-2xl font-bold text-green-900",children:"Deine St√§rken & positive √úberraschungen"})]}),e.jsx("ul",{className:"space-y-2",children:v.map((a,t)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(ee,{className:"w-5 h-5 text-green-600 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-800",children:a})]},t))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Detaillierte Bewertung nach Kategorien"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i&&Object.entries(i).map(([a,t])=>e.jsxs("div",{className:`p-6 border-2 rounded-xl ${p(t.score||0)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:N[a]||a}),e.jsx(j,{score:t.score||0,size:"small"})]}),t.einschaetzung&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Einsch√§tzung:"}),e.jsx("p",{className:"text-gray-800",children:t.einschaetzung})]}),t.verbesserungspotenziale&&t.verbesserungspotenziale.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(ce,{className:"w-4 h-4 text-orange-600 mr-2"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Verbesserungspotenziale:"})]}),e.jsx("ul",{className:"space-y-1 text-sm",children:t.verbesserungspotenziale.map((c,b)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-orange-600 mr-2",children:"‚Ä¢"}),e.jsx("span",{className:"text-gray-700",children:c})]},b))})]}),t.praktische_tipps&&t.praktische_tipps.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(de,{className:"w-4 h-4 text-blue-600 mr-2"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Praktische Tipps:"})]}),e.jsx("ul",{className:"space-y-1 text-sm",children:t.praktische_tipps.map((c,b)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"‚Üí"}),e.jsx("span",{className:"text-gray-700",children:c})]},b))})]})]},a))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center pt-8 border-t-2 border-gray-200",children:[e.jsxs(w,{onClick:g,className:"bg-ocean-600 hover:bg-ocean-700 text-white px-8 py-3 text-lg",children:[e.jsx(me,{className:"w-5 h-5 mr-2"}),"Neues Video-Training starten"]}),e.jsxs(w,{onClick:M,variant:"outline",className:"px-8 py-3 text-lg",children:[e.jsx(xe,{className:"w-5 h-5 mr-2"}),"Zur Startseite"]})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Tipp:"})," Speichere dieses Feedback und arbeite gezielt an den genannten Punkten. Mit jedem Training wirst du besser!"]})})]})}function be(){const[u,h]=l.useState("wizard"),[g,M]=l.useState(null),[R,i]=l.useState(null),v=j=>{console.log("Wizard completed with data:",j),M(j),h("recording")},d=j=>{console.log("Recording completed with results:",j),i(j),h("feedback")},C=()=>{M(null),i(null),h("wizard")},p=()=>{window.location.href="/"};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-ocean-50",children:[u==="wizard"&&e.jsx(ue,{}),e.jsxs("div",{className:"container mx-auto py-8",children:[u==="wizard"&&e.jsx(he,{onComplete:v}),u==="recording"&&g&&e.jsx(fe,{questions:g.questions,cameraStream:g.cameraStream,trainingData:g,onComplete:d,onCancel:C}),u==="feedback"&&R&&e.jsx(pe,{analysis:R.analysis,trainingData:g,onStartNew:C,onGoHome:p})]})]})}console.log("üìπ Video Training App initializing...");window.bewerbungstrainerVideoTraining&&!window.bewerbungstrainerConfig?(console.log("üìπ Config from bewerbungstrainerVideoTraining:",window.bewerbungstrainerVideoTraining),window.bewerbungstrainerConfig=window.bewerbungstrainerVideoTraining):window.bewerbungstrainerConfig?console.log("üìπ Config from bewerbungstrainerConfig:",window.bewerbungstrainerConfig):console.error("üìπ No configuration found! Neither bewerbungstrainerVideoTraining nor bewerbungstrainerConfig is defined.");const X=()=>{const u=document.getElementById("bewerbungstrainer-video-training-app");u?(console.log("üìπ Mounting Video Training App to DOM"),ge.createRoot(u).render(e.jsx(Y.StrictMode,{children:e.jsx(be,{})}))):console.warn("üìπ Video Training container not found - waiting for shortcode")};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",X):X();
=======
import{c as A,w as Q,r as l,i as q,j as e,C as J,U as se,e as ne,f as re,B as j,h as O,l as te,A as ie,S as ae,T as le,L as oe,k as ce,H as de,n as me}from"./wordpress-api-BhIXeI2M.js";const X=A("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const H=A("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const U=A("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const xe=A("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const Y=A("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const Z=A("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function ue({onComplete:m}){const x=Q.isWordPress()?Q.getCurrentUser():null,D=x?.id&&x.id>0&&(x?.firstName||x?.name)||"",[t,b]=l.useState(1),[d,k]=l.useState({name:D,position:"",company:"",experience_level:"professional"}),[h,v]=l.useState([]),[w,a]=l.useState([]),[i,o]=l.useState({}),[f,C]=l.useState(!1),[g,R]=l.useState(null),[S,T]=l.useState({video:"",audio:""}),[E,F]=l.useState({video:[],audio:[]}),N=(s,n)=>{k(r=>({...r,[s]:n})),i[s]&&o(r=>({...r,[s]:""}))},K=s=>{const n={};return s===1&&(d.position.trim()||(n.position="Bitte gib die Position ein")),o(n),Object.keys(n).length===0},$=async()=>{C(!0),o({});try{const s=await Q.generateQuestions({position:d.position,company:d.company,experience_level:d.experience_level});if(s.success&&s.data.questions){const n=s.data.questions;v(n),a(n.map(r=>r.id)),b(2)}else o({generate:"Fehler beim Generieren der Fragen"})}catch(s){console.error("Error generating questions:",s),o({generate:s.message||"Fehler beim Generieren der Fragen"})}finally{C(!1)}},L=s=>{a(n=>n.includes(s)?n.filter(r=>r!==s):[...n,s])},V=async()=>{console.log("üé• Initializing devices..."),o({});try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("MediaDevices API not available in this browser");console.log("üé• Requesting camera and microphone access..."),console.log("‚ö†Ô∏è Please allow camera and microphone access in your browser!");const s=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});console.log("‚úÖ Camera and microphone access granted"),console.log("üìπ Video tracks:",s.getVideoTracks().length),console.log("üé§ Audio tracks:",s.getAudioTracks().length),R(s);const n=await navigator.mediaDevices.enumerateDevices();console.log("üì± All devices:",n);const r=n.filter(y=>y.kind==="videoinput"),c=n.filter(y=>y.kind==="audioinput");console.log("üìπ Video devices found:",r.length,r),console.log("üé§ Audio devices found:",c.length,c),(r.length===0||c.length===0)&&console.warn("‚ö†Ô∏è Not all devices found - video:",r.length,"audio:",c.length),F({video:r,audio:c});const z=s.getVideoTracks()[0],p=s.getAudioTracks()[0];if(z){const y=z.getSettings();console.log("üìπ Active video device:",y.deviceId),T(M=>({...M,video:y.deviceId||r[0]?.deviceId||""}))}if(p){const y=p.getSettings();console.log("üé§ Active audio device:",y.deviceId),T(M=>({...M,audio:y.deviceId||c[0]?.deviceId||""}))}console.log("‚úÖ Device initialization complete")}catch(s){console.error("‚ùå Error accessing devices:",s),console.error("Error name:",s.name),console.error("Error message:",s.message);let n="Fehler beim Zugriff auf Kamera oder Mikrofon",r=!0;s.name==="NotAllowedError"||s.name==="PermissionDeniedError"?n='Zugriff auf Kamera/Mikrofon wurde verweigert. Bitte klicke auf "Zulassen" im Browser-Dialog und versuche es erneut.':s.name==="NotFoundError"?n="Keine Kamera oder Mikrofon gefunden. Bitte stelle sicher, dass ein Ger√§t angeschlossen ist und nicht von einer anderen Anwendung verwendet wird.":s.name==="NotReadableError"||s.name==="OverconstrainedError"?n="Kamera/Mikrofon wird bereits von einer anderen Anwendung verwendet oder ist nicht verf√ºgbar. Bitte schlie√üe andere Apps, die auf die Kamera/Mikrofon zugreifen.":n=`Fehler beim Zugriff auf Kamera/Mikrofon: ${s.message}`,o({devices:n,showRetry:r})}},_=async()=>{if(K(t)){if(t===1)await $();else if(t===2){if(w.length===0){o({questions:"Bitte w√§hle mindestens eine Frage aus"});return}b(3),await V()}}},P=()=>{t>1&&(b(t-1),t===3&&g&&(g.getTracks().forEach(s=>s.stop()),R(null)))},W=()=>{const s=h.filter(n=>w.includes(n.id));m({...d,questions:s,cameraStream:g,selectedDevices:S})},B=async(s,n)=>{if(!n||n===""){console.warn("Invalid deviceId, skipping change");return}if(T(r=>({...r,[s]:n})),g){g.getTracks().forEach(p=>p.stop());const r=s==="video"?n:S.video,c=s==="audio"?n:S.audio,z={video:r&&r!==""?{deviceId:{exact:r}}:!0,audio:c&&c!==""?{deviceId:{exact:c}}:!0};try{const p=await navigator.mediaDevices.getUserMedia(z);R(p)}catch(p){console.error("Error changing device:",p),o({devices:"Fehler beim Wechseln des Ger√§ts: "+p.message})}}};return q.useEffect(()=>{if(g&&t===3){const s=document.getElementById("camera-preview");s&&(s.srcObject=g)}},[g,t]),e.jsxs("div",{className:"w-full max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:[1,2,3].map(s=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${t>=s?"bg-ocean-600 text-white":"bg-gray-200 text-gray-500"}`,children:t>s?e.jsx(J,{className:"w-6 h-6"}):s}),s<3&&e.jsx("div",{className:`flex-1 h-1 mx-2 ${t>s?"bg-ocean-600":"bg-gray-200"}`})]},s))}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Pers√∂nliche Daten"}),e.jsx("span",{children:"Fragen generieren"}),e.jsx("span",{children:"Kamera & Mikrofon"})]})]}),t===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Pers√∂nliche Parameter"}),e.jsx("p",{className:"text-gray-600",children:"Gib deine Informationen ein, um personalisierte Interviewfragen zu generieren."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(se,{className:"inline w-4 h-4 mr-2"}),"Name (optional)"]}),e.jsx("input",{type:"text",value:d.name,onChange:s=>N("name",s.target.value),placeholder:"Dein Name",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500 focus:border-ocean-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ne,{className:"inline w-4 h-4 mr-2"}),"Zielposition *"]}),e.jsx("input",{type:"text",value:d.position,onChange:s=>N("position",s.target.value),placeholder:"z.B. Junior Product Manager",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-ocean-500 focus:border-ocean-500 ${i.position?"border-red-500":"border-gray-300"}`}),i.position&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.position})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(re,{className:"inline w-4 h-4 mr-2"}),"Firma / Wunschfirma (optional)"]}),e.jsx("input",{type:"text",value:d.company,onChange:s=>N("company",s.target.value),placeholder:"z.B. BMW",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500 focus:border-ocean-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Erfahrungslevel"}),e.jsxs("select",{value:d.experience_level,onChange:s=>N("experience_level",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500 focus:border-ocean-500",children:[e.jsx("option",{value:"student",children:"Sch√ºler"}),e.jsx("option",{value:"entry",children:"Berufseinsteiger"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"senior",children:"Senior / F√ºhrungskraft"})]})]})]}),i.generate&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:i.generate}),e.jsx("div",{className:"flex justify-end",children:e.jsx(j,{onClick:_,disabled:f,className:"bg-ocean-600 hover:bg-ocean-700 text-white px-6 py-3 flex items-center",children:f?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-5 h-5 mr-2 animate-spin"}),e.jsx("span",{children:"Fragen werden generiert..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Fragen generieren"}),e.jsx(O,{className:"w-5 h-5 ml-2"})]})})})]}),t===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Deine Interviewfragen"}),e.jsxs("p",{className:"text-gray-600",children:["KarriereHeld hat ",h.length," Fragen f√ºr dich erstellt. Alle Fragen sind bereits ausgew√§hlt. Du kannst Fragen abw√§hlen, wenn du m√∂chtest (mindestens 1 Frage muss ausgew√§hlt bleiben)."]}),e.jsx("div",{className:"p-4 bg-ocean-50 border border-ocean-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-ocean-800",children:[e.jsx("strong",{children:w.length})," von ",e.jsx("strong",{children:h.length})," Fragen ausgew√§hlt"]})}),e.jsx("div",{className:"space-y-3",children:h.map((s,n)=>e.jsx("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${w.includes(s.id)?"border-ocean-500 bg-ocean-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>L(s.id),children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:`w-6 h-6 rounded border-2 flex items-center justify-center mr-3 mt-0.5 flex-shrink-0 transition-colors ${w.includes(s.id)?"border-ocean-500 bg-ocean-500":"border-gray-400 bg-white"}`,children:w.includes(s.id)&&e.jsx(X,{className:"w-5 h-5 text-white stroke-[4] font-bold",strokeWidth:4})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-800",children:[n+1,". ",s.question]}),s.category&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:s.category})]})]})},s.id))}),i.questions&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:i.questions}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(j,{onClick:P,variant:"outline",className:"px-6 py-3 flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:"Zur√ºck"})]}),e.jsxs(j,{onClick:_,className:"bg-ocean-600 hover:bg-ocean-700 text-white px-6 py-3 flex items-center",children:[e.jsx("span",{children:"Weiter"}),e.jsx(O,{className:"w-5 h-5 ml-2"})]})]})]}),t===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Kamera & Mikrofon Check"}),e.jsx("p",{className:"text-gray-600",children:"Stelle sicher, dass deine Kamera und dein Mikrofon richtig funktionieren. Das gesamte Interview wird in einem durchgehenden Video aufgezeichnet."}),!g&&!i.devices&&e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"‚ö†Ô∏è Wichtig:"})," Bitte erlaube den Zugriff auf Kamera und Mikrofon im Browser-Dialog, wenn dieser erscheint."]})}),e.jsx("div",{className:"bg-black rounded-lg overflow-hidden",children:e.jsx("video",{id:"camera-preview",autoPlay:!0,playsInline:!0,muted:!0,className:"w-full aspect-video"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Z,{className:"inline w-4 h-4 mr-2"}),"Kamera"]}),e.jsx("select",{value:S.video,onChange:s=>B("video",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500",children:E.video.map(s=>e.jsx("option",{value:s.deviceId,children:s.label||`Kamera ${s.deviceId.slice(0,8)}`},s.deviceId))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(te,{className:"inline w-4 h-4 mr-2"}),"Mikrofon"]}),e.jsx("select",{value:S.audio,onChange:s=>B("audio",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ocean-500",children:E.audio.map(s=>e.jsx("option",{value:s.deviceId,children:s.label||`Mikrofon ${s.deviceId.slice(0,8)}`},s.deviceId))})]})]}),i.devices&&e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("p",{className:"text-red-700 mb-3",children:i.devices}),i.showRetry&&e.jsx(j,{onClick:V,className:"bg-red-600 hover:bg-red-700 text-white",children:"Erneut versuchen"})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Hinweis:"})," Das gesamte Interview wird in einem durchgehenden Video aufgezeichnet. Du kannst zwischen den Fragen hin- und herspringen."]})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(j,{onClick:P,variant:"outline",className:"px-6 py-3 flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:"Zur√ºck"})]}),e.jsxs(j,{onClick:W,className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 text-lg font-semibold flex items-center",children:[e.jsx(Z,{className:"w-5 h-5 mr-2"}),e.jsx("span",{children:"Aufnahme starten"})]})]})]})]})}function ge({questions:m,cameraStream:u,trainingData:x,onComplete:I,onCancel:D}){const[t,b]=l.useState(0),[d,k]=l.useState(!1),[h,v]=l.useState(0),[w,a]=l.useState([]),[i,o]=l.useState(!1),[f,C]=l.useState(0),g=l.useRef(null),R=l.useRef([]),S=l.useRef(null),T=l.useRef(null),E=l.useRef(0),F=m[t],N=m.length;l.useEffect(()=>(S.current&&u&&(S.current.srcObject=u),()=>{T.current&&clearInterval(T.current)}),[u]);const K=()=>{if(!u){console.error("No camera stream available");return}try{const s={mimeType:"video/webm;codecs=vp9"};MediaRecorder.isTypeSupported(s.mimeType)||(s.mimeType="video/webm;codecs=vp8");const n=new MediaRecorder(u,s);g.current=n,R.current=[],n.ondataavailable=r=>{r.data&&r.data.size>0&&R.current.push(r.data)},n.onstop=L,n.start(1e3),k(!0),E.current=0,T.current=setInterval(()=>{v(r=>r+1)},1e3),a([{question_index:0,question_id:F.id,start_time:0}])}catch(s){console.error("Error starting recording:",s),alert("Fehler beim Starten der Aufnahme: "+s.message)}},$=()=>{g.current&&d&&(g.current.stop(),k(!1),T.current&&clearInterval(T.current),a(s=>{const n=[...s];return n.length>0&&(n[n.length-1].end_time=h),n}))},L=async()=>{const s=new Blob(R.current,{type:"video/webm"});await V(s)},V=async s=>{o(!0),C(0);try{const n=new File([s],`interview-${Date.now()}.webm`,{type:"video/webm"}),r=await fetch("/wp-json/bewerbungstrainer/v1/video-training",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:x.name,position:x.position,company:x.company,experience_level:x.experience_level,questions:m})});if(!r.ok)throw new Error("Failed to create training session");const z=(await r.json()).data.id,p=new FormData;if(p.append("video",n),p.append("timeline",JSON.stringify(w)),!(await fetch(`/wp-json/bewerbungstrainer/v1/video-training/${z}/upload`,{method:"POST",body:p})).ok)throw new Error("Failed to upload video");C(100);const M=await fetch(`/wp-json/bewerbungstrainer/v1/video-training/${z}/analyze`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!M.ok)throw new Error("Failed to start analysis");const ee=await M.json();I(ee.data)}catch(n){console.error("Error uploading video:",n),alert("Fehler beim Hochladen des Videos: "+n.message),o(!1)}},_=()=>{if(t<N-1){const s=h;a(r=>{const c=[...r];return c.length>0&&(c[c.length-1].end_time=s),c});const n=t+1;b(n),a(r=>[...r,{question_index:n,question_id:m[n].id,start_time:s}])}},P=()=>{if(t>0){const s=h;a(r=>{const c=[...r];return c.length>0&&(c[c.length-1].end_time=s),c});const n=t-1;b(n),a(r=>[...r,{question_index:n,question_id:m[n].id,start_time:s}])}},W=s=>{const n=Math.floor(s/60),r=s%60;return`${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`},B=()=>{window.confirm("M√∂chtest du das Interview beenden und die Aufnahme hochladen?")&&$()};return e.jsxs("div",{className:"w-full max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"KarriereHeld Coach"}),e.jsxs("p",{className:"text-gray-600",children:["Video-Interview Training f√ºr ",x.position]})]}),d&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"w-4 h-4 text-red-600 fill-current animate-pulse"}),e.jsx("span",{className:"text-red-600 font-semibold",children:"REC"})]}),e.jsx("span",{className:"text-2xl font-mono font-bold text-gray-800",children:W(h)})]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"bg-black rounded-lg overflow-hidden shadow-2xl",children:e.jsx("video",{ref:S,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full aspect-video"})}),e.jsxs("div",{className:"p-6 bg-ocean-50 border-2 border-ocean-200 rounded-lg flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"text-sm font-semibold text-ocean-600",children:["Frage ",t+1," von ",N]}),F.category&&e.jsx("span",{className:"px-3 py-1 text-xs rounded-full bg-ocean-100 text-ocean-700",children:F.category})]}),e.jsx("p",{className:"text-xl font-medium text-gray-800 leading-relaxed",children:F.question})]})]}),!d&&!i&&e.jsx("div",{className:"flex justify-center",children:e.jsxs(j,{onClick:K,className:"bg-red-600 hover:bg-red-700 text-white px-8 py-4 text-lg font-semibold",size:"lg",children:[e.jsx(U,{className:"w-6 h-6 mr-2 fill-current"}),"Aufnahme starten"]})}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(j,{onClick:P,disabled:t===0,variant:"outline",className:"px-6 py-3",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Vorherige Frage"]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["Frage ",t+1," / ",N]}),e.jsx("div",{className:"w-64 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-ocean-600 transition-all duration-300",style:{width:`${(t+1)/N*100}%`}})})]}),e.jsxs(j,{onClick:_,disabled:t===N-1,variant:"outline",className:"px-6 py-3",children:["N√§chste Frage",e.jsx(O,{className:"w-5 h-5 ml-2"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(j,{onClick:B,className:"bg-green-600 hover:bg-green-700 text-white px-8 py-3 text-lg font-semibold",children:[e.jsx(X,{className:"w-5 h-5 mr-2"}),"Interview beenden"]})})]}),i&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"p-6 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(Y,{className:"w-8 h-8 text-blue-600 animate-spin mr-3"}),e.jsx("p",{className:"text-lg font-semibold text-blue-800",children:"Video wird hochgeladen und analysiert..."})]}),f>0&&e.jsx("div",{className:"w-full bg-blue-100 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"bg-blue-600 h-full transition-all duration-300",style:{width:`${f}%`}})}),e.jsx("p",{className:"text-sm text-blue-700 text-center mt-4",children:"Die KI analysiert jetzt dein Video. Das kann einen Moment dauern..."})]})}),!d&&!i&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Tipps f√ºr dein Video-Interview:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Achte auf gute Beleuchtung und einen ruhigen Hintergrund"}),e.jsx("li",{children:"Sprich klar und deutlich, halte Blickkontakt zur Kamera"}),e.jsx("li",{children:"Nimm dir Zeit f√ºr deine Antworten, aber bleibe fokussiert"}),e.jsx("li",{children:"Du kannst jederzeit zwischen den Fragen navigieren"}),e.jsx("li",{children:"Die Aufnahme l√§uft durchgehend, aber du bestimmst das Tempo"})]})]})]})}function he({analysis:m,trainingData:u,onStartNew:x,onGoHome:I}){if(!m)return e.jsx("div",{className:"w-full max-w-4xl mx-auto p-6",children:e.jsx("div",{className:"p-8 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:e.jsx("p",{className:"text-yellow-800",children:"Keine Analysedaten verf√ºgbar."})})});const{overall_score:D,categories:t,staerken_und_positive_ueberraschungen:b,kurzfeedback_fuer_user:d}=m,k=a=>a>=80?"text-green-600":a>=60?"text-yellow-600":"text-red-600",h=a=>a>=80?"bg-green-100 border-green-300":a>=60?"bg-yellow-100 border-yellow-300":"bg-red-100 border-red-300",v=({score:a,size:i="large"})=>{const o=i==="large",f=o?70:45,C=2*Math.PI*f,g=a/100*C;return e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:o?"w-40 h-40":"w-24 h-24",viewBox:"0 0 160 160",children:[e.jsx("circle",{cx:"80",cy:"80",r:f,fill:"none",stroke:"#e5e7eb",strokeWidth:o?"12":"8"}),e.jsx("circle",{cx:"80",cy:"80",r:f,fill:"none",stroke:a>=80?"#10b981":a>=60?"#f59e0b":"#ef4444",strokeWidth:o?"12":"8",strokeDasharray:C,strokeDashoffset:C-g,strokeLinecap:"round",transform:"rotate(-90 80 80)",className:"transition-all duration-1000"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:`font-bold ${o?"text-4xl":"text-2xl"} ${k(a)}`,children:Math.round(a)})})]})},w={auftreten:"Auftreten",selbstbewusstsein:"Selbstbewusstsein",koerpersprache:"K√∂rpersprache",kommunikation:"Kommunikation",professionalitaet:"Professionalit√§t",persoenliche_wirkung:"Pers√∂nliche Wirkung"};return e.jsxs("div",{className:"w-full max-w-6xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(ie,{className:"w-12 h-12 text-ocean-600 mr-3"}),e.jsx("h1",{className:"text-4xl font-bold text-gray-800",children:"Dein Video-Interview Feedback"})]}),e.jsxs("p",{className:"text-xl text-gray-600",children:["Analyse f√ºr: ",u.position,u.company&&` bei ${u.company}`]})]}),e.jsx("div",{className:"p-8 bg-gradient-to-br from-ocean-50 to-blue-50 border-2 border-ocean-200 rounded-2xl shadow-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8",children:[e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Gesamtbewertung"}),d&&e.jsx("p",{className:"text-lg text-gray-700 leading-relaxed",children:d})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(v,{score:D||0,size:"large"})})]})}),b&&b.length>0&&e.jsxs("div",{className:"p-6 bg-green-50 border-2 border-green-200 rounded-xl",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ae,{className:"w-6 h-6 text-green-600 mr-3"}),e.jsx("h3",{className:"text-2xl font-bold text-green-900",children:"Deine St√§rken & positive √úberraschungen"})]}),e.jsx("ul",{className:"space-y-2",children:b.map((a,i)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(J,{className:"w-5 h-5 text-green-600 mr-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-gray-800",children:a})]},i))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Detaillierte Bewertung nach Kategorien"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t&&Object.entries(t).map(([a,i])=>e.jsxs("div",{className:`p-6 border-2 rounded-xl ${h(i.score||0)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:w[a]||a}),e.jsx(v,{score:i.score||0,size:"small"})]}),i.einschaetzung&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Einsch√§tzung:"}),e.jsx("p",{className:"text-gray-800",children:i.einschaetzung})]}),i.verbesserungspotenziale&&i.verbesserungspotenziale.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(le,{className:"w-4 h-4 text-orange-600 mr-2"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Verbesserungspotenziale:"})]}),e.jsx("ul",{className:"space-y-1 text-sm",children:i.verbesserungspotenziale.map((o,f)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-orange-600 mr-2",children:"‚Ä¢"}),e.jsx("span",{className:"text-gray-700",children:o})]},f))})]}),i.praktische_tipps&&i.praktische_tipps.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(oe,{className:"w-4 h-4 text-blue-600 mr-2"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Praktische Tipps:"})]}),e.jsx("ul",{className:"space-y-1 text-sm",children:i.praktische_tipps.map((o,f)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"‚Üí"}),e.jsx("span",{className:"text-gray-700",children:o})]},f))})]})]},a))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center pt-8 border-t-2 border-gray-200",children:[e.jsxs(j,{onClick:x,className:"bg-ocean-600 hover:bg-ocean-700 text-white px-8 py-3 text-lg",children:[e.jsx(ce,{className:"w-5 h-5 mr-2"}),"Neues Video-Training starten"]}),e.jsxs(j,{onClick:I,variant:"outline",className:"px-8 py-3 text-lg",children:[e.jsx(xe,{className:"w-5 h-5 mr-2"}),"Zur Startseite"]})]}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Tipp:"})," Speichere dieses Feedback und arbeite gezielt an den genannten Punkten. Mit jedem Training wirst du besser!"]})})]})}function fe(){const[m,u]=l.useState("wizard"),[x,I]=l.useState(null),[D,t]=l.useState(null),b=v=>{console.log("Wizard completed with data:",v),I(v),u("recording")},d=v=>{console.log("Recording completed with results:",v),t(v),u("feedback")},k=()=>{I(null),t(null),u("wizard")},h=()=>{window.location.href="/"};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-ocean-50",children:[m==="wizard"&&e.jsx(de,{}),e.jsxs("div",{className:"container mx-auto py-8",children:[m==="wizard"&&e.jsx(ue,{onComplete:b}),m==="recording"&&x&&e.jsx(ge,{questions:x.questions,cameraStream:x.cameraStream,trainingData:x,onComplete:d,onCancel:k}),m==="feedback"&&D&&e.jsx(he,{analysis:D.analysis,trainingData:x,onStartNew:k,onGoHome:h})]})]})}console.log("üìπ Video Training App initializing...");window.bewerbungstrainerVideoTraining&&!window.bewerbungstrainerConfig?(console.log("üìπ Config from bewerbungstrainerVideoTraining:",window.bewerbungstrainerVideoTraining),window.bewerbungstrainerConfig=window.bewerbungstrainerVideoTraining):window.bewerbungstrainerConfig?console.log("üìπ Config from bewerbungstrainerConfig:",window.bewerbungstrainerConfig):console.error("üìπ No configuration found! Neither bewerbungstrainerVideoTraining nor bewerbungstrainerConfig is defined.");const G=()=>{const m=document.getElementById("bewerbungstrainer-video-training-app");m?(console.log("üìπ Mounting Video Training App to DOM"),me.createRoot(m).render(e.jsx(q.StrictMode,{children:e.jsx(fe,{})}))):console.warn("üìπ Video Training container not found - waiting for shortcode")};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",G):G();
>>>>>>> Stashed changes
