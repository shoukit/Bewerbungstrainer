import{j as s,v as I,a as P,I as V,w as _,g as S,f as F}from"./ui-vendor-BPmrRjpn.js";import{a as o,d as N}from"./react-vendor-uDOJF2jQ.js";import{D as G}from"./DynamicFormField-Ct_QUFM4.js";import"./FeatureInfoButton-C-pllNNf.js";const D=({scenario:a,onBack:k,onNext:x,primaryAccent:E,headerGradient:u,buttonGradient:M})=>{const[m,f]=o.useState({}),[l,g]=o.useState({}),[v,j]=o.useState({}),i=N.useMemo(()=>{const e=[],t=a?.interviewer_profile?.editable_fields||{},r=a?.interviewer_profile||{};return t.name&&e.push({key:"interviewer_name",label:"Name des Gesprächspartners",value:r.name||""}),t.role&&e.push({key:"interviewer_role",label:"Rolle/Position",value:r.role||""}),t.image&&e.push({key:"interviewer_image",label:"Profilbild URL",value:r.image_url||"",type:"url"}),t.properties&&e.push({key:"interviewer_properties",label:"Eigenschaften",value:r.properties||"",type:"textarea"}),t.objections&&e.push({key:"interviewer_objections",label:"Typische Einwände",value:r.typical_objections||"",type:"textarea"}),t.questions&&e.push({key:"interviewer_questions",label:"Wichtige Fragen",value:r.important_questions||"",type:"textarea"}),e},[a?.interviewer_profile]);o.useEffect(()=>{if(i.length>0){const e={};i.forEach(t=>{e[t.key]=t.value}),g(e)}},[i]);const n=()=>{const e=a?.interviewer_profile||{};return{name:l.interviewer_name??e.name,role:l.interviewer_role??e.role,image_url:l.interviewer_image??e.image_url,properties:l.interviewer_properties??e.properties,typical_objections:l.interviewer_objections??e.typical_objections,important_questions:l.interviewer_questions??e.important_questions}},w=e=>{if(!e)return e;let t=e;Object.entries(m).forEach(([h,d])=>{const b=new RegExp(`\\{\\{${h}\\}\\}`,"g");t=t.replace(b,d||"")});const r=n(),p={interviewer_name:r.name,interviewer_role:r.role,interviewer_properties:r.properties,interviewer_objections:r.typical_objections,interviewer_questions:r.important_questions};return Object.entries(p).forEach(([h,d])=>{if(d){const b=new RegExp(`\\{\\{${h}\\}\\}`,"g");t=t.replace(b,d)}}),t},c=N.useMemo(()=>a?.variables_schema?a.variables_schema.filter(e=>e.user_input!==!1):[],[a?.variables_schema]);o.useEffect(()=>{if(a?.variables_schema){const e={};a.variables_schema.forEach(t=>{t.default&&(e[t.key]=t.default)}),f(e)}},[a?.variables_schema]);const q=(e,t)=>{f(r=>({...r,[e]:t})),v[e]&&j(r=>{const p={...r};return delete p[e],p})},y=(e,t)=>{g(r=>({...r,[e]:t}))},C=()=>{const e={};return c.forEach(t=>{const r=m[t.key];t.required&&(!r||r.toString().trim()==="")&&(e[t.key]=`${t.label} ist ein Pflichtfeld`)}),j(e),Object.keys(e).length===0},R=e=>{if(e.preventDefault(),!C())return;const t={...m,...l};x(t)};return o.useEffect(()=>{if(c.length===0&&i.length===0){const e={};a?.variables_schema?.forEach(t=>{t.default&&(e[t.key]=t.default)}),x(e)}},[c,i,a,x]),c.length===0&&i.length===0?null:s.jsxs("div",{className:"p-6 pb-[200px] max-w-[640px] mx-auto",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("button",{onClick:k,className:"inline-flex items-center gap-2 px-3 py-2 mb-4 border-none bg-transparent text-slate-600 text-sm cursor-pointer rounded-md transition-colors hover:bg-slate-100",children:[s.jsx(I,{className:"w-[18px] h-[18px]"}),"Zurück zur Übersicht"]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center",style:{background:u},children:s.jsx(P,{className:"w-7 h-7 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-slate-900 m-0",children:a.title}),s.jsx("p",{className:"text-sm text-slate-600 mt-1 mb-0",children:"Personalisiere dein Rollenspiel"})]})]})]}),a.long_description&&s.jsx("div",{className:"p-5 px-6 rounded-xl bg-white border border-slate-200 mb-6",children:s.jsxs("div",{className:"flex items-start gap-3.5",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:u},children:s.jsx(V,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-base font-semibold text-slate-900 m-0 mb-2",children:"Deine Aufgabe"}),s.jsx("p",{className:"text-sm leading-relaxed text-slate-700 m-0 whitespace-pre-wrap",children:w(a.long_description?.replace(/\/n/g,`
`))})]})]})}),!a.long_description&&a.description&&s.jsx("div",{className:"p-4 px-5 rounded-lg bg-slate-100 mb-6",children:s.jsx("p",{className:"text-sm text-slate-700 m-0 leading-relaxed",children:w(a.description)})}),a.interviewer_profile&&i.length===0&&s.jsxs("div",{className:"p-4 px-5 rounded-lg border border-slate-200 mb-6 flex items-center gap-4",children:[n().image_url?s.jsx("img",{src:n().image_url,alt:n().name,className:"w-12 h-12 rounded-full object-cover"}):s.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center bg-primary/10",children:s.jsx(_,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm font-semibold text-slate-900 m-0",children:["Dein Gesprächspartner: ",n().name]}),n().role&&s.jsx("p",{className:"text-sm text-slate-600 mt-0.5 mb-0",children:n().role})]})]}),s.jsxs("form",{onSubmit:R,children:[c.map(e=>s.jsx(G,{field:e,value:m[e.key],onChange:q,error:v[e.key],focusColor:E},e.key)),i.length>0&&s.jsxs("div",{className:"mt-6 p-5 rounded-xl border border-slate-200 bg-slate-50",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{background:u},children:s.jsx(_,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-base font-semibold text-slate-900 m-0",children:"KI-Gesprächspartner anpassen"}),s.jsx("p",{className:"text-sm text-slate-600 m-0",children:"Passe die Eigenschaften deines Gesprächspartners an"})]})]}),i.map(e=>s.jsxs("div",{className:"mb-4 last:mb-0",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:e.label}),e.type==="textarea"?s.jsx("textarea",{value:l[e.key]||"",onChange:t=>y(e.key,t.target.value),rows:3,className:`w-full px-3 py-2.5 border border-slate-300 rounded-lg text-sm
                               focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary
                               transition-colors bg-white`,placeholder:e.value}):s.jsx("input",{type:e.type||"text",value:l[e.key]||"",onChange:t=>y(e.key,t.target.value),className:`w-full px-3 py-2.5 border border-slate-300 rounded-lg text-sm
                               focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary
                               transition-colors bg-white`,placeholder:e.value})]},e.key))]}),s.jsxs("div",{className:"p-4 px-5 rounded-lg bg-primary/10 mt-6 mb-6 flex gap-5 flex-wrap",children:[s.jsxs("div",{children:[s.jsxs("span",{className:"text-xs text-slate-500 block",children:[s.jsx(S,{className:"w-3 h-3 inline mr-1"}),"Dauer"]}),s.jsx("span",{className:"text-base font-semibold text-slate-900",children:"ca. 10 Min"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-xs text-slate-500 block",children:"Typ"}),s.jsx("span",{className:"text-base font-semibold text-slate-900",children:"Live-Gespräch"})]})]}),s.jsxs("button",{type:"submit",className:"w-full px-6 py-4 rounded-xl border-none text-white text-base font-semibold cursor-pointer flex items-center justify-center gap-2.5 transition-all duration-200 hover:-translate-y-0.5 hover:shadow-lg bg-gradient-to-r from-indigo-500 to-violet-500 shadow-primary",children:["Weiter",s.jsx(F,{className:"w-5 h-5"})]})]})]})};export{D as default};
