import{j as i,E as G,X as L,z as M,t as B,p as k,n as w,V as $}from"./ui-vendor-B9DEMv6g.js";import{a as d}from"./react-vendor-uDOJF2jQ.js";import{C as s}from"./FeatureInfoButton-DsfjgKw4.js";import{M as P}from"./DeviceSetupPage-DrPY-0u7.js";import{u as K}from"./useBranding-CjHnMPMs.js";const X=({isOpen:f,onClose:c,mode:p="audio",selectedMicrophoneId:u,onMicrophoneChange:A,selectedCameraId:g,onCameraChange:D})=>{const[C,R]=d.useState([]),[y,E]=d.useState([]),[b,j]=d.useState(!0),[m,h]=d.useState(null),[n,v]=d.useState(u),[a,S]=d.useState(g),e=K();d.useEffect(()=>{f&&(I(),v(u),S(g))},[f,u,g]);const I=async()=>{j(!0),h(null);try{const t=p==="audio-video"?{audio:!0,video:!0}:{audio:!0};(await navigator.mediaDevices.getUserMedia(t)).getTracks().forEach(l=>l.stop());const x=await navigator.mediaDevices.enumerateDevices(),r=x.filter(l=>l.kind==="audioinput"),T=x.filter(l=>l.kind==="videoinput");R(r),p==="audio-video"&&E(T)}catch(t){console.error("Error loading devices:",t),t.name==="NotAllowedError"||t.name==="PermissionDeniedError"?h("Zugriff auf Ger채te verweigert"):h("Fehler beim Laden der Ger채te")}finally{j(!1)}},W=()=>{n!==u&&A?.(n),p==="audio-video"&&a!==g&&D?.(a),c()},z=(t,o,x)=>{if(t.label){let r=t.label;return r=r.replace(/^Default - /,""),r=r.replace(/^Kommunikation - /,""),r=r.replace(/^Standard - /,""),r.length>40&&(r=r.substring(0,37)+"..."),r}return x==="audio"?`Mikrofon ${o+1}`:`Kamera ${o+1}`};return f?i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:c,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e3}}),i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",borderRadius:e.radius.xl,width:"90%",maxWidth:"480px",maxHeight:"80vh",overflow:"hidden",boxShadow:e.shadow.xl,zIndex:1001},onClick:t=>t.stopPropagation(),children:[i.jsxs("div",{style:{background:e.headerGradient,padding:`${e.space[4]} ${e.space[5]}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:e.space["2.5"],color:"white"},children:[i.jsx(G,{size:20}),i.jsx("h3",{style:{margin:0,fontSize:e.fontSize.base,fontWeight:600},children:"Ger채te-Einstellungen"})]}),i.jsx("button",{onClick:c,style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:e.radius.md,padding:e.space["1.5"],cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(L,{size:18,color:"white"})})]}),i.jsx("div",{style:{padding:e.space[5],maxHeight:"calc(80vh - 140px)",overflowY:"auto"},children:b?i.jsxs("div",{style:{textAlign:"center",padding:e.space[8]},children:[i.jsx("div",{style:{width:"40px",height:"40px",border:`3px solid ${s.slate[200]}`,borderTopColor:e.primaryAccent,borderRadius:"50%",animation:"spin 1s linear infinite",margin:`0 auto ${e.space[3]}`}}),i.jsx("p",{style:{color:s.slate[500],fontSize:e.fontSize.sm},children:"Ger채te werden geladen..."}),i.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]}):m?i.jsxs("div",{style:{textAlign:"center",padding:e.space[6]},children:[i.jsx(M,{size:40,color:s.red[500],style:{marginBottom:e.space[3]}}),i.jsx("p",{style:{color:s.red[600],fontWeight:500},children:m}),i.jsxs("button",{onClick:I,style:{marginTop:e.space[4],display:"inline-flex",alignItems:"center",gap:e.space[2],padding:`${e.space["2.5"]} ${e.space[4]}`,borderRadius:e.radius.md,border:`1px solid ${s.slate[300]}`,background:"white",cursor:"pointer",fontSize:e.fontSize.sm,color:s.slate[700]},children:[i.jsx(B,{size:16}),"Erneut versuchen"]})]}):i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:e.space[5]},children:[i.jsxs("div",{children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:e.space[2],fontSize:e.fontSize.sm,fontWeight:600,color:s.slate[700],marginBottom:e.space["2.5"]},children:[i.jsx(k,{size:18,color:e.primaryAccent}),"Mikrofon"]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:e.space["1.5"]},children:C.map((t,o)=>i.jsxs("button",{onClick:()=>v(t.deviceId),style:{display:"flex",alignItems:"center",gap:e.space[3],padding:`${e.space[3]} ${e.space["3.5"]}`,borderRadius:e.radius.md,border:n===t.deviceId?`2px solid ${e.primaryAccent}`:`1px solid ${s.slate[200]}`,background:n===t.deviceId?`${e.primaryAccent}10`:"white",cursor:"pointer",textAlign:"left",width:"100%",transition:e.transition.normal},children:[i.jsx("div",{style:{width:"32px",height:"32px",borderRadius:e.radius.md,background:n===t.deviceId?e.primaryAccent:s.slate[100],display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:i.jsx(k,{size:16,color:n===t.deviceId?"white":s.slate[500]})}),i.jsx("span",{style:{flex:1,fontSize:e.fontSize.sm,color:n===t.deviceId?e.primaryAccent:s.slate[700],fontWeight:n===t.deviceId?500:400},children:z(t,o,"audio")}),n===t.deviceId&&i.jsx(w,{size:18,color:e.primaryAccent})]},t.deviceId||o))}),n&&i.jsx("div",{style:{marginTop:e.space[3]},children:i.jsx(P,{deviceId:n,branding:e})})]}),p==="audio-video"&&y.length>0&&i.jsxs("div",{children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:e.space[2],fontSize:e.fontSize.sm,fontWeight:600,color:s.slate[700],marginBottom:e.space["2.5"]},children:[i.jsx($,{size:18,color:e.primaryAccent}),"Kamera"]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:e.space["1.5"]},children:y.map((t,o)=>i.jsxs("button",{onClick:()=>S(t.deviceId),style:{display:"flex",alignItems:"center",gap:e.space[3],padding:`${e.space[3]} ${e.space["3.5"]}`,borderRadius:e.radius.md,border:a===t.deviceId?`2px solid ${e.primaryAccent}`:`1px solid ${s.slate[200]}`,background:a===t.deviceId?`${e.primaryAccent}10`:"white",cursor:"pointer",textAlign:"left",width:"100%",transition:e.transition.normal},children:[i.jsx("div",{style:{width:"32px",height:"32px",borderRadius:e.radius.md,background:a===t.deviceId?e.primaryAccent:s.slate[100],display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:i.jsx($,{size:16,color:a===t.deviceId?"white":s.slate[500]})}),i.jsx("span",{style:{flex:1,fontSize:e.fontSize.sm,color:a===t.deviceId?e.primaryAccent:s.slate[700],fontWeight:a===t.deviceId?500:400},children:z(t,o,"video")}),a===t.deviceId&&i.jsx(w,{size:18,color:e.primaryAccent})]},t.deviceId||o))})]})]})}),!b&&!m&&i.jsxs("div",{style:{padding:`${e.space[4]} ${e.space[5]}`,borderTop:`1px solid ${s.slate[200]}`,display:"flex",gap:e.space[3],justifyContent:"flex-end"},children:[i.jsx("button",{onClick:c,style:{padding:`${e.space["2.5"]} ${e.space[5]}`,borderRadius:e.radius.md,border:`1px solid ${s.slate[300]}`,background:"white",color:s.slate[600],fontSize:e.fontSize.sm,fontWeight:500,cursor:"pointer"},children:"Abbrechen"}),i.jsx("button",{onClick:W,style:{padding:`${e.space["2.5"]} ${e.space[5]}`,borderRadius:e.radius.md,border:"none",background:e.primaryAccent,color:"white",fontSize:e.fontSize.sm,fontWeight:600,cursor:"pointer"},children:"Speichern"})]})]})]}):null};export{X as D};
