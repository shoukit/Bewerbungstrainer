import{j as e,d as b,m as h,ac as W,ad as $,B as Y,z as J,e as Q,ag as X,f as Z,H as q,h as z,l as ee,a as se,g as te}from"./ui-vendor-5MgJaMcm.js";import{a}from"./react-vendor-uDOJF2jQ.js";import{B as O}from"./select-native-DIQ3pQYe.js";import{w as j,k as ne,q as H,C as c}from"./FeatureInfoButton-DEmjGvDG.js";import"./dialog-DvONxC4-.js";import{C as ae}from"./card-BlNGBu8O.js";import{F}from"./FeatureAppHeader-BnKXyabD.js";import{M as ie,a as oe}from"./MicrophoneTestDialog-B63PlJ2Y.js";import{a as re,D as le}from"./DecisionBoardResult-D7-udEid.js";import{u as ce}from"./useScrollToTop-PegBaEbR.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";import"./input-LtgvZG8q.js";import"./textarea-DSWqnr_E.js";import"./index.js";import"./AudioRecorder-BvqY6rQg.js";import"./button-D7V6b1EZ.js";const de=[{icon:W,color:c.emerald[500],title:"Pro-Argumente",description:"Sammle alle Vorteile mit Gewichtung"},{icon:$,color:c.rose[500],title:"Contra-Argumente",description:"Erfasse Nachteile und Risiken"},{icon:Y,color:c.violet[500],title:"KI-Analyse",description:"Objektive Auswertung deiner Argumente"},{icon:J,color:c.amber[500],title:"Coaching-Impulse",description:"Neue Perspektiven für deine Entscheidung"}],me=({onStartNew:g,onContinueSession:N,onNavigateToHistory:w,isAuthenticated:d,requireAuth:f,setPendingAction:o,selectedMicrophoneId:D,onMicrophoneChange:y,onTestMicrophone:B})=>{const[l,m]=a.useState([]),[p,E]=a.useState(!1),S=H(c.teal[500],c.teal[400]);a.useEffect(()=>{d&&u()},[d]);const u=async()=>{E(!0);try{const t=await j.getDecisions();if(t?.data?.decisions){const x=t.data.decisions.sort((C,R)=>new Date(R.created_at)-new Date(C.created_at)).slice(0,5);m(x)}}catch(t){console.error("[DecisionDashboard] Failed to load sessions:",t)}finally{E(!1)}},v=a.useCallback(()=>{if(!d){o&&o({type:"decision_start"}),f&&f(()=>{g()});return}g()},[d,f,o,g]),I=t=>new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}),k=t=>t.status==="completed"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700",children:[e.jsx(se,{className:"w-3 h-3"}),"Abgeschlossen"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-700",children:[e.jsx(te,{className:"w-3 h-3"}),"Entwurf"]});return e.jsxs(e.Fragment,{children:[e.jsx(ne,{featureId:"decisionboard",showOnMount:!0}),e.jsxs("div",{className:"min-h-full",children:[e.jsx(F,{featureId:"decisionboard",icon:b,title:"Entscheidungs-Board",subtitle:"Strukturierte Entscheidungsfindung",gradient:S,historyLabel:"Meine Entscheidungen",onNavigateToHistory:w,showHistoryButton:d&&l.length>0}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl mx-auto mb-6 flex items-center justify-center",style:{background:S},children:e.jsx(b,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Fundierte Entscheidungen treffen"}),e.jsx("p",{className:"text-slate-600 max-w-2xl mx-auto leading-relaxed",children:"Stehst du vor einer wichtigen Entscheidung? Das Entscheidungs-Board hilft dir, Pro- und Contra-Argumente systematisch zu sammeln, zu gewichten und mit KI-Unterstützung die richtige Wahl zu treffen."})]}),e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-10",children:de.map((t,x)=>e.jsxs(h.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1+x*.05},className:"bg-white rounded-xl p-4 border border-slate-200 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl mx-auto mb-3 flex items-center justify-center",style:{backgroundColor:`${t.color}15`},children:e.jsx(t.icon,{className:"w-6 h-6",style:{color:t.color}})}),e.jsx("h3",{className:"font-semibold text-slate-800 text-sm mb-1",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500",children:t.description})]},t.title))}),e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25},className:"mb-8",children:e.jsxs(ae,{className:"p-5 bg-white border border-slate-200 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2.5 mb-4",children:[e.jsx(Q,{className:"w-[22px] h-[22px] text-teal-500"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Mikrofon testen"})]}),e.jsx(ie,{selectedDeviceId:D,onDeviceChange:y,onTestClick:B})]})}),e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-center mb-12 px-4",children:[e.jsxs(O,{onClick:v,size:"lg",className:"w-full sm:w-auto px-6 sm:px-8 py-4 text-base sm:text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all",style:{background:S,color:"white"},children:[e.jsx(X,{className:"w-5 h-5 mr-2 shrink-0"}),e.jsx("span",{className:"truncate",children:"Neue Entscheidung starten"}),e.jsx(Z,{className:"w-5 h-5 ml-2 shrink-0"})]}),!d&&e.jsx("p",{className:"text-sm text-slate-500 mt-3",children:"Anmeldung erforderlich zum Starten"})]}),d&&l.length>0&&e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-slate-400"}),"Letzte Entscheidungen"]}),l.length>=5&&e.jsxs(O,{variant:"ghost",size:"sm",onClick:w,className:"text-slate-600 hover:text-slate-800",children:["Alle anzeigen",e.jsx(z,{className:"w-4 h-4 ml-1"})]})]}),e.jsx("div",{className:"space-y-3",children:l.map((t,x)=>e.jsx(h.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5+x*.05},className:"bg-white rounded-xl p-4 border border-slate-200 hover:border-teal-300 hover:shadow-md transition-all cursor-pointer group",onClick:()=>N(t),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center shrink-0",style:{background:`${c.teal[500]}15`},children:e.jsx(b,{className:"w-5 h-5",style:{color:c.teal[500]}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-0.5",children:k(t)}),e.jsx("p",{className:"font-medium text-slate-800 truncate",children:t.topic||"Entscheidungsanalyse"}),e.jsx("p",{className:"text-sm text-slate-500",children:I(t.created_at)})]}),e.jsx(z,{className:"w-5 h-5 text-slate-400 group-hover:text-teal-500 transition-colors shrink-0"})]})},t.id))})]}),e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"mt-12 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-2xl p-6 border border-teal-100",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-teal-500"}),"So funktioniert's"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Fragestellung eingeben"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Beschreibe deine Entscheidung oder Frage"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Argumente sammeln"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Füge Pro- und Contra-Punkte mit Gewichtung hinzu"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"KI-Analyse erhalten"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Erhalte eine fundierte Empfehlung und neue Perspektiven"})]})]})]})]})]})]})]})},U="karriereheld_selected_microphone",r={DASHBOARD:"dashboard",INPUT:"input",RESULT:"result"},Ee=({isAuthenticated:g,requireAuth:N,setPendingAction:w,onNavigateToHistory:d})=>{const[f,o]=a.useState(r.DASHBOARD),[D,y]=a.useState(null),[B,l]=a.useState(null),[m,p]=a.useState(null),[E,S]=a.useState(!1),[u,v]=a.useState(()=>{try{return localStorage.getItem(U)||null}catch{return null}}),[I,k]=a.useState(!1);a.useEffect(()=>{if(u)try{localStorage.setItem(U,u),console.log("[DecisionBoard] Microphone saved to localStorage:",u)}catch{}},[u]);const t=a.useRef(!1),x=H(c.teal[500],c.teal[400]);ce({dependencies:[f]});const C=a.useCallback(()=>{y(null),l(null),p(null),t.current=!1,o(r.INPUT)},[]),R=a.useCallback(async s=>{try{p(s.id),t.current=!0;const n={topic:s.topic||"",context:s.context||"",pros:s.pros||[],cons:s.cons||[],proScore:s.pro_score||0,contraScore:s.contra_score||0};y(n),s.status==="completed"&&s.analysis?(l(s.analysis),o(r.RESULT)):o(r.INPUT)}catch(n){console.error("[DecisionBoard] Failed to load session:",n)}},[]),M=a.useCallback(()=>{o(r.DASHBOARD)},[]),L=a.useCallback(async s=>{if(t.current||!s.topic?.trim())return null;try{const n={topic:s.topic,context:s.context||null,pros:s.pros||[],cons:s.cons||[],pro_score:s.proScore||0,contra_score:s.contraScore||0,status:"draft"},i=await j.createDecision(n);if(i?.id)return t.current=!0,p(i.id),console.log("[DecisionBoard] Draft session saved with ID:",i.id),i.id}catch(n){console.error("[DecisionBoard] Failed to save draft session:",n)}return null},[]),T=a.useCallback(async(s,n)=>{if(s)try{const i={topic:n.topic,context:n.context||null,pros:n.pros||[],cons:n.cons||[],pro_score:n.proScore||0,contra_score:n.contraScore||0,analysis:n.analysis||null,status:n.status||"completed"};await j.updateDecision(s,i),console.log("[DecisionBoard] Session updated:",s)}catch(i){console.error("[DecisionBoard] Failed to update session:",i)}},[]),_=a.useCallback(async s=>{if(s)try{await j.deleteDecision(s),console.log("[DecisionBoard] Session deleted:",s)}catch(n){console.error("[DecisionBoard] Failed to delete session:",n)}},[]),P=a.useCallback(async(s,n)=>{y(s),l(n),o(r.RESULT);try{if(m)await T(m,{...s,analysis:n,status:"completed"});else{const i={topic:s.topic,context:s.context||null,pros:s.pros,cons:s.cons,pro_score:s.proScore,contra_score:s.contraScore,analysis:n,status:"completed"},A=await j.createDecision(i);A?.id&&(p(A.id),t.current=!0,console.log("[DecisionBoard] Decision saved with ID:",A.id))}}catch(i){console.error("[DecisionBoard] Failed to save decision:",i)}},[m,T]),G=a.useCallback(()=>{l(null),o(r.INPUT)},[]),K=a.useCallback(async()=>{m&&await _(m),y(null),l(null),p(null),t.current=!1,o(r.DASHBOARD)},[m,_]),V=()=>{switch(f){case r.DASHBOARD:return e.jsx(me,{onStartNew:C,onContinueSession:R,onNavigateToHistory:d,isAuthenticated:g,requireAuth:N,setPendingAction:w,selectedMicrophoneId:u,onMicrophoneChange:v,onTestMicrophone:()=>k(!0)});case r.RESULT:return e.jsxs(e.Fragment,{children:[e.jsx(F,{featureId:"decisionboard",icon:b,title:"Entscheidungs-Board",subtitle:"Deine Analyse",gradient:x,showBackButton:!0,onBack:M}),e.jsx(le,{decisionData:D,analysisResult:B,onStartNew:C,onEditDecision:G})]});case r.INPUT:default:return e.jsxs(e.Fragment,{children:[e.jsx(F,{featureId:"decisionboard",icon:b,title:"Entscheidungs-Board",subtitle:"Strukturierte Entscheidungsfindung",gradient:x,showBackButton:!0,onBack:M}),e.jsx(re,{initialData:D,onAnalysisComplete:P,onCancel:K,isAuthenticated:g,requireAuth:N,savedDecisionId:m,onSaveDraft:L,onUpdateSession:T,onDecisionIdChange:p,selectedMicrophoneId:u,onMicrophoneChange:v})]})}};return e.jsxs("div",{className:"min-h-full",children:[V(),e.jsx(oe,{isOpen:I,onClose:()=>k(!1),deviceId:u})]})};export{Ee as DecisionBoardApp,re as DecisionBoardInput,le as DecisionBoardResult};
