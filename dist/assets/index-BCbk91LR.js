import{c as ke,u as G,D as se,a as l,w as O,j as e,C as fe,T as Se,U as N,S as he,L as le}from"./colors-uXoD1ofg.js";import{S as Ce,F as we,a as de}from"./ScenarioDashboard-CgDY-I3W.js";import{T as V}from"./trash-2-5YY_ZL8K.js";import{F,R as q,d as Z,e as J,T as Y,b as ue,m as be,X as ze,c as ve}from"./index.js";import{L as K}from"./lightbulb-DN4XDJmu.js";import{P as _}from"./plus-Ccuv5nNX.js";import{P as Be}from"./pencil-uVLlUdS0.js";import{H as Ie}from"./heart-D4AsWeKi.js";import{S as X}from"./star-fNCV08Od.js";import{C as Q,a as ee,b as Re,c as Te,S as Ee,B as De}from"./BriefingWorkbook-k5Ls6axJ.js";import{A as te}from"./award-fyGeNNIF.js";import{M as re}from"./message-circle-NTuaj3B3.js";import{U as ne}from"./user-C299kFlx.js";import{B as ie}from"./banknote-CMumu_xL.js";import{B as oe}from"./briefcase-BjD3fN49.js";import{F as We}from"./fullscreen-loader-CykX670n.js";import{A as me}from"./arrow-left-CtCRDCiU.js";import{C as ye}from"./chevron-up-CxNv2zJD.js";import{C as ae}from"./circle-alert-EMpUppYH.js";import{u as $e}from"./useBranding-Cxdgj0iN.js";import{u as Le}from"./useMobile-CWVpMrbN.js";import{C as je}from"./calendar-D_hT1Fz4.js";import{C as ce}from"./check-DLiwtlrf.js";import{C as pe}from"./copy-BhgwKtUT.js";import{D as xe}from"./download-770bHVxi.js";import{R as Ae}from"./refresh-cw-CISYsOw3.js";import"./ScenarioCard-DsuhckwG.js";import"./dialog-CY6-yJYz.js";import"./utils-BEHD0UYf.js";import"./search-OidDqMnQ.js";import"./filter-D3xqDZaW.js";import"./formatting-B67Bmjxp.js";import"./bot-Dk2VNoZg.js";import"./pen-line-DaHgV8u4.js";import"./server-BdkxEoE-.js";import"./globe-CYsFAgb8.js";import"./phone-D2BOQ9gC.js";import"./thumbs-up-ZbV5M-HB.js";import"./house-D_2jZgMG.js";import"./settings-D2vnp0Xs.js";import"./circle-check-big-i8yN9nVa.js";import"./play-q3i8YB9n.js";import"./rotate-ccw-B_Qota01.js";import"./designTokens-DbcSlXo4.js";const Fe=ke("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),Oe={"file-text":F,briefcase:oe,banknote:ie,users:N,user:ne,"message-circle":re,target:Y,award:te,book:ee,clipboard:Q,star:X,lightbulb:K,shield:J,compass:Z,rocket:q,heart:Ie,folder:we,"trending-up":Se},_e=({onSelectTemplate:t,onShowList:x,onCreateTemplate:h,onEditTemplate:d,isAuthenticated:j,requireAuth:c,setPendingAction:o,demoCode:r})=>{const{branding:f}=G(),i=f?.["--primary-accent"]||se["--primary-accent"],[u,g]=l.useState(null),[p,b]=l.useState(0),k=l.useCallback(async()=>{const y=new URLSearchParams;r&&y.append("demo_code",r);const a=await O.request(`/smartbriefing/templates?${y.toString()}`,{method:"GET"});if(a.success&&a.data?.templates)return a.data.templates;throw new Error("Unerwartete API-Antwort")},[r,p]),C=()=>{if(!j&&!r){c&&(o(()=>h),c());return}h?.()},m=(y,a)=>{y.stopPropagation(),d?.(a)},w=(y,a)=>{y.stopPropagation(),g(a)},s=async()=>{if(u)try{const y=new URLSearchParams;r&&y.append("demo_code",r),(await O.request(`/smartbriefing/templates/${u.id}?${y.toString()}`,{method:"DELETE"})).success&&b(v=>v+1)}catch(y){console.error("[SmartBriefing] Error deleting template:",y)}finally{g(null)}},z=y=>Oe[y.icon]||F,I=y=>{const a=y.variables_schema?.length||0;return[{text:`${a} Eingabefeld${a!==1?"er":""}`}]},D=y=>y.is_custom?e.jsxs("div",{style:{display:"flex",gap:"4px"},children:[e.jsx("button",{onClick:a=>m(a,y),style:{padding:"6px",borderRadius:"6px",border:"none",backgroundColor:"transparent",color:"#64748b",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="#f1f5f9",a.currentTarget.style.color=i},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent",a.currentTarget.style.color="#64748b"},title:"Template bearbeiten",children:e.jsx(Be,{size:16})}),e.jsx("button",{onClick:a=>w(a,y),style:{padding:"6px",borderRadius:"6px",border:"none",backgroundColor:"transparent",color:"#64748b",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="#fef2f2",a.currentTarget.style.color="#ef4444"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent",a.currentTarget.style.color="#64748b"},title:"Template löschen",children:e.jsx(V,{size:16})})]}):null,W=(j||r)&&h?e.jsxs("button",{onClick:C,style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",borderRadius:"10px",border:"2px dashed #cbd5e1",backgroundColor:"white",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:y=>{y.currentTarget.style.borderColor=i,y.currentTarget.style.color=i},onMouseLeave:y=>{y.currentTarget.style.borderColor="#cbd5e1",y.currentTarget.style.color="#64748b"},children:[e.jsx(_,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"persönliches Template"}),e.jsx("span",{className:"sm:hidden",children:"Template"})]}):null,$=()=>e.jsx("div",{style:{marginTop:"48px",padding:"20px 24px",backgroundColor:`${i}08`,borderRadius:"12px",border:`1px solid ${i}20`},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(K,{size:20,style:{color:i,flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 4px 0",color:"#0f172a",fontSize:"14px",fontWeight:600},children:"So funktioniert Smart Briefing"}),e.jsx("p",{style:{margin:0,color:"#64748b",fontSize:"13px",lineHeight:1.6},children:"Wahle ein Template aus, gib deine spezifischen Informationen ein (z.B. Unternehmen, Position), und erhalte ein massgeschneidertes Briefing mit Insider-Wissen, Fachbegriffen und cleveren Ruckfragen."})]})]})}),M=u&&e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:"16px"},onClick:()=>g(null),children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"100%",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:"#fef2f2",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(V,{size:24,style:{color:"#ef4444"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:600,color:"#0f172a"},children:"Template löschen?"}),e.jsx("p",{style:{margin:0,fontSize:"14px",color:"#64748b"},children:"Diese Aktion kann nicht rückgängig gemacht werden."})]})]}),e.jsx("div",{style:{backgroundColor:"#f8fafc",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:e.jsx("p",{style:{margin:0,fontSize:"14px",color:"#475569"},children:e.jsx("strong",{children:u.title})})}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>g(null),style:{padding:"10px 20px",borderRadius:"8px",border:"1px solid #e2e8f0",backgroundColor:"white",color:"#475569",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:s,style:{padding:"10px 20px",borderRadius:"8px",border:"none",backgroundColor:"#ef4444",color:"white",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Löschen"})]})]})});return e.jsx(Ce,{title:"Smart Briefing",subtitle:"Dein KI-gestützter Vorbereitungs-Assistent",headerIcon:F,fetchScenarios:k,moduleKey:"briefings",historyButtonLabel:"Meine Briefings",onNavigateToHistory:x,onSelectScenario:t,renderCardMeta:I,getIconForScenario:z,getCardCustomActions:D,cardActionLabel:"Briefing erstellen",cardActionIcon:fe,categoryField:"category",emptyStateIcon:F,emptyStateTitle:"Keine Templates gefunden",emptyStateMessage:"Es wurden noch keine Briefing-Templates erstellt.",searchPlaceholder:"Briefings durchsuchen...",filterActions:W,renderInfoBox:$,extraContent:M,isAuthenticated:j,requireAuth:c,setPendingAction:o,demoCode:r,loadingMessage:"Templates werden geladen..."},p)},Me=({field:t,value:x,onChange:h,error:d,primaryAccent:j})=>{const c={width:"100%",padding:"14px 16px",borderRadius:"12px",border:`2px solid ${d?"#ef4444":"#e2e8f0"}`,fontSize:"16px",color:"#0f172a",backgroundColor:"white",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",boxSizing:"border-box"},o=i=>{i.target.style.borderColor=j,i.target.style.boxShadow=`0 0 0 3px ${j}1a`},r=i=>{i.target.style.borderColor=d?"#ef4444":"#e2e8f0",i.target.style.boxShadow="none"},f=()=>{switch(t.type){case"textarea":return e.jsx("textarea",{value:x||"",onChange:i=>h(t.key,i.target.value),placeholder:t.placeholder||"",rows:4,style:{...c,minHeight:"120px",resize:"vertical"},onFocus:o,onBlur:r});case"select":return e.jsxs("select",{value:x||t.default||"",onChange:i=>h(t.key,i.target.value),style:{...c,cursor:"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center",backgroundSize:"20px",paddingRight:"44px"},onFocus:o,onBlur:r,children:[e.jsx("option",{value:"",children:"Bitte wahlen..."}),t.options?.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))]});case"text":default:return e.jsx("input",{type:"text",value:x||"",onChange:i=>h(t.key,i.target.value),placeholder:t.placeholder||"",style:c,onFocus:o,onBlur:r})}};return e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#374151",marginBottom:"8px"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"4px"},children:"*"})]}),f(),d&&e.jsx("p",{style:{color:"#ef4444",fontSize:"13px",marginTop:"6px",margin:"6px 0 0 0"},children:d})]})},Pe=({variable:t,index:x,onChange:h,onDelete:d,primaryAccent:j})=>e.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"12px",marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsx("input",{type:"text",value:t.key||"",onChange:c=>h(x,"key",c.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")),placeholder:"variable_name",style:{padding:"8px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",backgroundColor:"#f8fafc",flex:1,marginRight:"8px"}}),e.jsx("button",{type:"button",onClick:()=>d(x),style:{padding:"8px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(V,{size:18})})]}),e.jsx("textarea",{value:t.value||"",onChange:c=>h(x,"value",c.target.value),placeholder:"Wert eingeben... (mehrzeilig möglich)",rows:3,style:{width:"100%",padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",resize:"vertical",minHeight:"80px",boxSizing:"border-box"}})]}),Ve=({template:t,onBack:x,onBriefingGenerated:h,isAuthenticated:d})=>{const{branding:j}=G(),[c,o]=l.useState({}),[r,f]=l.useState({}),[i,u]=l.useState(!1),[g,p]=l.useState(null),[b,k]=l.useState([]),[C,m]=l.useState(!1),w=j?.["--primary-accent"]||se["--primary-accent"],s=j?.["--button-gradient"]||se["--button-gradient"],z=Re(t?.icon);l.useEffect(()=>{if(t?.variables_schema){const a={};t.variables_schema.forEach(v=>{v.default&&(a[v.key]=v.default)}),o(a)}k([]),m(!1)},[t]);const I=()=>{k([...b,{key:"",value:""}])},D=(a,v,B)=>{const L=[...b];L[a][v]=B,k(L)},W=a=>{k(b.filter((v,B)=>B!==a))},$=(a,v)=>{o(B=>({...B,[a]:v})),r[a]&&f(B=>{const L={...B};return delete L[a],L})},M=()=>{const a={};return t?.variables_schema?.forEach(v=>{v.required&&!c[v.key]&&(a[v.key]="Dieses Feld ist erforderlich")}),a},y=async a=>{a.preventDefault();const v=M();if(Object.keys(v).length>0){f(v);return}u(!0),p(null);try{const B={};b.forEach(n=>{n.key&&n.value&&(B[n.key]=n.value)});const L={template_id:t.id,variables:c};Object.keys(B).length>0&&(L.custom_variables=B);const P=await O.request("/smartbriefing/generate",{method:"POST",body:JSON.stringify(L)});if(P.success&&P.data?.briefing)h(P.data.briefing);else throw new Error("Unerwartete API-Antwort")}catch(B){console.error("[SmartBriefing] Error generating briefing:",B),p(B.message||"Fehler beim Generieren des Briefings")}finally{u(!1)}};return t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{padding:"24px",paddingTop:"32px",maxWidth:"700px",margin:"0 auto"},children:[e.jsxs("button",{onClick:x,disabled:i,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 0",border:"none",background:"none",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:i?"not-allowed":"pointer",marginBottom:"24px",opacity:i?.5:1},children:[e.jsx(me,{size:18}),e.jsx("span",{style:{lineHeight:"1.4"},children:"Zurück zur Übersicht"})]}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"12px",background:`linear-gradient(135deg, ${w}15, ${w}25)`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(z,{size:28,style:{color:w}})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"22px",fontWeight:700,color:"#0f172a",margin:"0 0 4px 0"},children:t.title}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:t.description})]})]})}),e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h2",{style:{fontSize:"16px",fontWeight:600,color:"#0f172a",margin:"0 0 20px 0",paddingBottom:"16px",borderBottom:"1px solid #f1f5f9"},children:"Deine Angaben"}),e.jsxs("form",{onSubmit:y,children:[t.variables_schema?.map(a=>e.jsx(Me,{field:a,value:c[a.key],onChange:$,error:r[a.key],primaryAccent:w},a.key)),t.allow_custom_variables&&e.jsxs("div",{style:{marginTop:"24px",marginBottom:"20px",paddingTop:"20px",borderTop:"1px solid #f1f5f9"},children:[e.jsxs("button",{type:"button",onClick:()=>m(!C),style:{display:"flex",alignItems:"flex-start",gap:"8px",padding:"0",border:"none",background:"none",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",marginBottom:C?"16px":"0",textAlign:"left"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0},children:[C?e.jsx(ye,{size:18}):e.jsx(ue,{size:18}),e.jsx(_,{size:16})]}),e.jsx("span",{style:{lineHeight:"1.4"},children:"Zusätzliche Variablen hinzufügen (optional)"})]}),C&&e.jsxs("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",padding:"16px"},children:[e.jsx("p",{style:{fontSize:"13px",color:"#64748b",margin:"0 0 12px 0"},children:"Füge eigene Variablen hinzu, die in die Briefing-Generierung einfließen sollen."}),b.length>0&&e.jsx("div",{style:{marginBottom:"12px"},children:b.map((a,v)=>e.jsx(Pe,{variable:a,index:v,onChange:D,onDelete:W,primaryAccent:w},v))}),e.jsxs("button",{type:"button",onClick:I,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",border:"1px dashed #cbd5e1",borderRadius:"8px",backgroundColor:"white",color:"#64748b",fontSize:"13px",cursor:"pointer"},children:[e.jsx(_,{size:14}),"Variable hinzufügen"]})]})]}),g&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"16px",marginBottom:"20px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(ae,{size:20,style:{color:"#ef4444",flexShrink:0}}),e.jsx("div",{children:e.jsx("p",{style:{margin:0,color:"#991b1b",fontSize:"14px"},children:g})})]}),e.jsxs("button",{type:"submit",disabled:i,style:{width:"100%",padding:"16px 24px",borderRadius:"12px",border:"none",background:s,color:"white",fontSize:"16px",fontWeight:600,cursor:i?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",transition:"all 0.2s",boxShadow:`0 4px 14px ${w}40`,opacity:i?.7:1},children:[e.jsx(he,{size:20}),"Briefing generieren"]})]})]})]}),e.jsx(We,{isLoading:i,message:"Smart Briefing wird erstellt...",subMessage:"Die KI analysiert deine Angaben und erstellt ein maßgeschneidertes Briefing."})]}):null},Ke={"file-text":F,briefcase:oe,banknote:ie,users:N,user:ne,"message-circle":re,target:Y,award:te,book:ee,clipboard:Q,star:X,lightbulb:K,shield:J,compass:Z,rocket:q},He=({content:t,primaryAccent:x})=>{if(!t)return null;const h=j=>{const c=j.split(`
`),o=[];let r=[],f=null;const i=()=>{r.length>0&&(o.push(e.jsx("ul",{style:{margin:"12px 0",paddingLeft:"24px",listStyle:"none"},children:r.map((u,g)=>e.jsxs("li",{style:{marginBottom:"8px",fontSize:"15px",lineHeight:1.6,color:"#374151",position:"relative",paddingLeft:"20px"},children:[e.jsx("span",{style:{position:"absolute",left:0,color:x,fontWeight:"bold"},children:f==="number"?`${g+1}.`:""}),d(u)]},g))},`list-${o.length}`)),r=[],f=null)};return c.forEach((u,g)=>{const p=u.trim();if(!p){i();return}if(p.startsWith("### ")){i(),o.push(e.jsx("h3",{style:{fontSize:"18px",fontWeight:700,color:"#0f172a",margin:"24px 0 12px 0",paddingTop:"16px",borderTop:g>0?"1px solid #f1f5f9":"none",display:"flex",alignItems:"center",gap:"8px"},children:d(p.substring(4))},`h3-${g}`));return}if(p.startsWith("## ")){i(),o.push(e.jsx("h2",{style:{fontSize:"20px",fontWeight:700,color:"#0f172a",margin:"28px 0 14px 0"},children:d(p.substring(3))},`h2-${g}`));return}if(p.startsWith("# ")){i(),o.push(e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:"#0f172a",margin:"32px 0 16px 0"},children:d(p.substring(2))},`h1-${g}`));return}if(p.startsWith("- ")||p.startsWith("* ")){f!=="bullet"&&(i(),f="bullet"),r.push(p.substring(2));return}const b=p.match(/^(\d+)\.\s/);if(b){f!=="number"&&(i(),f="number"),r.push(p.substring(b[0].length));return}i(),o.push(e.jsx("p",{style:{margin:"12px 0",fontSize:"15px",lineHeight:1.7,color:"#374151"},children:d(p)},`p-${g}`))}),i(),o},d=j=>{const c=[];let o=j,r=0;for(;o.length>0;){const f=o.match(/\*\*(.+?)\*\*/),i=o.match(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)|_([^_]+)_")),u=o.match(/`([^`]+)`/),g=[{match:f,type:"bold"},{match:i,type:"italic"},{match:u,type:"code"}].filter(b=>b.match);if(g.length===0){c.push(o);break}const p=g.reduce((b,k)=>(b.match?.index??1/0)<(k.match?.index??1/0)?b:k);switch(p.match.index>0&&c.push(o.substring(0,p.match.index)),p.type){case"bold":c.push(e.jsx("strong",{style:{fontWeight:600,color:"#0f172a"},children:p.match[1]},r++));break;case"italic":c.push(e.jsx("em",{style:{fontStyle:"italic"},children:p.match[1]||p.match[2]},r++));break;case"code":c.push(e.jsx("code",{style:{backgroundColor:"#f1f5f9",padding:"2px 6px",borderRadius:"4px",fontSize:"13px",fontFamily:"monospace",color:x},children:p.match[1]},r++));break}o=o.substring(p.match.index+p.match[0].length)}return c};return e.jsx("div",{children:h(t)})},Ue=({briefing:t,template:x,onBack:h,onCreateNew:d,onGenerateAnother:j})=>{const c=$e(),o=Le(),[r,f]=l.useState(!1),i=l.useRef(null),u=c.primaryAccent,g=c.headerGradient,p=Ke[x?.icon||t?.template_icon]||F,b=m=>m?new Date(m).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",k=async()=>{try{await navigator.clipboard.writeText(t.content_markdown),f(!0),setTimeout(()=>f(!1),2e3)}catch(m){console.error("[SmartBriefing] Failed to copy:",m)}},C=()=>{const m=`${x?.title||t?.template_title}
${"=".repeat(50)}

Erstellt am: ${b(t.created_at)}

${t.content_markdown}`,w=new Blob([m],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(w),z=document.createElement("a");z.href=s,z.download=`briefing-${t.id}.txt`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(s)};return t?e.jsxs("div",{style:{minHeight:"100vh",background:c.pageBg},children:[e.jsx("div",{style:{background:g,padding:o?"20px 16px":"24px 32px",position:"sticky",top:0,zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[h&&e.jsxs("button",{onClick:h,style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",color:"#fff",fontSize:"13px",marginBottom:"16px"},children:[e.jsx(me,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{style:{display:"flex",alignItems:o?"flex-start":"center",gap:o?"16px":"24px",flexDirection:o?"column":"row"},children:[e.jsx("div",{style:{width:o?70:90,height:o?70:90,borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(p,{size:o?32:40,color:"#fff"})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.2)",color:"#fff"},children:"Smart Briefing"}),e.jsxs("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.9)",color:u,display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(he,{size:12}),"Fertig!"]})]}),e.jsx("h1",{style:{fontSize:o?"20px":"24px",fontWeight:700,color:"#fff",margin:0,marginBottom:"8px"},children:x?.title||t?.template_title}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(je,{size:14}),b(t.created_at)]})})]}),!o&&e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("button",{onClick:k,style:{display:"flex",alignItems:"center",gap:"8px",background:r?"rgba(34,197,94,0.3)":"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[r?e.jsx(ce,{size:16}):e.jsx(pe,{size:16}),r?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:C,style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[e.jsx(xe,{size:16}),"Speichern"]})]})]})]})}),e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:o?"16px":"24px 32px"},children:[o&&e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[e.jsxs("button",{onClick:k,style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"12px",borderRadius:"10px",border:`1px solid ${c.borderColor}`,backgroundColor:r?"#dcfce7":"white",color:r?"#16a34a":c.textSecondary,fontSize:"13px",fontWeight:500,cursor:"pointer"},children:[r?e.jsx(ce,{size:16}):e.jsx(pe,{size:16}),r?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:C,style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"12px",borderRadius:"10px",border:`1px solid ${c.borderColor}`,backgroundColor:"white",color:c.textSecondary,fontSize:"13px",fontWeight:500,cursor:"pointer"},children:[e.jsx(xe,{size:16}),"Speichern"]})]}),e.jsx("div",{ref:i,style:{backgroundColor:"white",borderRadius:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden",border:`1px solid ${c.borderColor}`},children:e.jsx("div",{style:{padding:o?"20px":"32px"},children:e.jsx(He,{content:t.content_markdown,primaryAccent:u})})}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"24px",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:j,style:{flex:1,minWidth:"200px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:`2px solid ${u}`,backgroundColor:"white",color:u,fontSize:"15px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(Ae,{size:18}),"Mit anderen Angaben neu generieren"]}),e.jsxs("button",{onClick:d,style:{flex:1,minWidth:"200px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${u}, ${u}dd)`,color:"white",fontSize:"15px",fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:`0 4px 14px ${u}40`},children:[e.jsx(_,{size:18}),"Neues Briefing erstellen"]})]})]})]}):null},Ge={"file-text":F,briefcase:oe,banknote:ie,users:N,user:ne,"message-circle":re,target:Y,award:te,book:ee,clipboard:Q,star:X,lightbulb:K,shield:J,compass:Z,rocket:q},Ne=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",qe=({briefing:t,onOpen:x,onDelete:h,primaryAccent:d,isDeleting:j})=>{const[c,o]=l.useState(!1),[r,f]=l.useState(!1),i=Ge[t.template_icon]||F,u=g=>{g.stopPropagation(),r?(h(t.id),f(!1)):(f(!0),setTimeout(()=>f(!1),3e3))};return e.jsxs("div",{onClick:()=>x(t),onMouseEnter:()=>o(!0),onMouseLeave:()=>{o(!1),f(!1)},style:{backgroundColor:"white",borderRadius:"16px",padding:"20px",border:`2px solid ${c?d:"#e2e8f0"}`,boxShadow:c?`0 10px 25px -5px rgba(0,0,0,0.1), 0 0 0 1px ${d}20`:"0 1px 3px rgba(0,0,0,0.1)",cursor:"pointer",transition:"all 0.3s ease",transform:c?"translateY(-2px)":"translateY(0)",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"10px",background:`linear-gradient(135deg, ${d}15, ${d}25)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(i,{size:22,style:{color:d}})}),e.jsx("button",{onClick:u,disabled:j,style:{padding:"8px",borderRadius:"8px",border:"none",backgroundColor:r?"#fef2f2":c?"#f1f5f9":"transparent",color:r?"#ef4444":"#94a3b8",cursor:j?"not-allowed":"pointer",transition:"all 0.2s",opacity:c||r?1:0},children:j?e.jsx(le,{size:18,style:{animation:"spin 1s linear infinite"}}):e.jsx(V,{size:18})})]}),e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#0f172a",margin:"0 0 4px 0",lineHeight:1.3,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.title||"Unbenanntes Briefing"}),e.jsx("p",{style:{fontSize:"13px",color:"#64748b",margin:"0 0 12px 0"},children:t.template_title}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"12px",borderTop:"1px solid #f1f5f9"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#94a3b8",fontSize:"12px"},children:[e.jsx(je,{size:14}),Ne(t.created_at)]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:d,fontSize:"13px",fontWeight:500},children:["Offnen",e.jsx(fe,{size:16})]})]}),r&&e.jsx("div",{style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"8px 12px",fontSize:"12px",color:"#dc2626",fontWeight:500,zIndex:10},onClick:g=>g.stopPropagation(),children:"Nochmal klicken zum Loschen"}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})},Ze=({onOpenBriefing:t,onCreateNew:x,isAuthenticated:h})=>{const{config:d}=G(),[j,c]=l.useState([]),[o,r]=l.useState(!0),[f,i]=l.useState(null),[u,g]=l.useState(null),p=d?.buttonGradientStart||"#3A7FA7";l.useEffect(()=>{(async()=>{if(!h){r(!1);return}try{r(!0),i(null);const C=await O.request("/smartbriefing/briefings",{method:"GET"});if(C.success&&C.data?.briefings){const m=C.data.briefings.filter(w=>w.status==="completed");c(m)}else throw new Error("Unerwartete API-Antwort")}catch(C){console.error("[SmartBriefing] Error fetching briefings:",C),i(C.message||"Fehler beim Laden der Briefings")}finally{r(!1)}})()},[h]);const b=async k=>{try{if(g(k),(await O.request(`/smartbriefing/briefings/${k}`,{method:"DELETE"})).success)c(m=>m.filter(w=>w.id!==k));else throw new Error("Fehler beim Loschen")}catch(C){console.error("[SmartBriefing] Error deleting briefing:",C),i(C.message||"Fehler beim Loschen des Briefings")}finally{g(null)}};return h?e.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:"#0f172a",margin:"0 0 4px 0"},children:"Meine Briefings"}),e.jsxs("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:[j.length," gespeicherte Briefings"]})]}),e.jsxs("button",{onClick:x,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${p}, ${p}dd)`,color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer",boxShadow:`0 4px 14px ${p}40`},children:[e.jsx(_,{size:18}),"Neues Briefing"]})]}),o&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"64px 24px"},children:[e.jsx(le,{size:40,style:{color:p,animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{marginTop:"16px",color:"#64748b"},children:"Briefings werden geladen..."})]}),f&&!o&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"24px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(ae,{size:24,style:{color:"#ef4444",flexShrink:0}}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px 0",color:"#dc2626",fontSize:"16px"},children:"Fehler beim Laden"}),e.jsx("p",{style:{margin:0,color:"#991b1b",fontSize:"14px"},children:f})]})]}),!o&&!f&&e.jsx(e.Fragment,{children:j.length===0?e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"48px 24px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx(de,{size:48,style:{color:"#cbd5e1",marginBottom:"16px"}}),e.jsx("h2",{style:{color:"#64748b",margin:"0 0 8px 0",fontSize:"18px"},children:"Noch keine Briefings"}),e.jsx("p",{style:{color:"#94a3b8",margin:"0 0 24px 0",fontSize:"14px"},children:"Erstelle dein erstes Briefing, um loszulegen."}),e.jsxs("button",{onClick:x,style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${p}, ${p}dd)`,color:"white",fontSize:"15px",fontWeight:600,cursor:"pointer",boxShadow:`0 4px 14px ${p}40`},children:[e.jsx(_,{size:18}),"Briefing erstellen"]})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:j.map(k=>e.jsx(qe,{briefing:k,onOpen:t,onDelete:b,primaryAccent:p,isDeleting:u===k.id},k.id))})})]}):e.jsx("div",{style:{padding:"24px",maxWidth:"800px",margin:"0 auto"},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"48px 24px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx(de,{size:48,style:{color:"#cbd5e1",marginBottom:"16px"}}),e.jsx("h2",{style:{color:"#64748b",margin:"0 0 8px 0",fontSize:"18px"},children:"Anmeldung erforderlich"}),e.jsx("p",{style:{color:"#94a3b8",margin:"0 0 24px 0",fontSize:"14px"},children:"Melde dich an, um deine gespeicherten Briefings zu sehen."})]})})},Je=[{key:"file-text",icon:F,label:"Dokument"},{key:"briefcase",icon:oe,label:"Koffer"},{key:"banknote",icon:ie,label:"Geld"},{key:"users",icon:N,label:"Team"},{key:"user",icon:ne,label:"Person"},{key:"target",icon:Y,label:"Ziel"},{key:"lightbulb",icon:K,label:"Idee"},{key:"star",icon:X,label:"Stern"},{key:"shield",icon:J,label:"Schutz"},{key:"compass",icon:Z,label:"Kompass"},{key:"rocket",icon:q,label:"Rakete"},{key:"message-circle",icon:re,label:"Nachricht"},{key:"award",icon:te,label:"Auszeichnung"},{key:"book",icon:ee,label:"Buch"},{key:"clipboard",icon:Q,label:"Checkliste"}],ge=[{value:"text",label:"Einzeiliges Textfeld"},{value:"textarea",label:"Mehrzeiliges Textfeld"},{value:"select",label:"Dropdown-Auswahl"}],U=()=>`var_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Ye=()=>({id:U(),key:"",label:"",type:"text",required:!0,placeholder:"",options:[]}),Xe=()=>({id:U(),value:"",label:""}),Qe=({variable:t,index:x,total:h,onChange:d,onDelete:j,onMoveUp:c,onMoveDown:o,primaryAccent:r})=>{const[f,i]=l.useState(!0),[u,g]=l.useState(t.label);l.useEffect(()=>{g(t.label)},[t.label]);const p=(s,z)=>{d({...t,[s]:z})},b=()=>{const s=[...t.options||[],Xe()];d({...t,options:s})},k=(s,z,I)=>{const D=t.options.map(W=>W.id===s?{...W,[z]:I}:W);d({...t,options:D})},C=s=>{const z=t.options.filter(I=>I.id!==s);d({...t,options:z})},m=s=>s.toLowerCase().replace(/[äöüß]/g,z=>({ä:"ae",ö:"oe",ü:"ue",ß:"ss"})[z]).replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),w=()=>{if(u!==t.label){const s={label:u};(!t.key||t.key===m(t.label))&&(s.key=m(u)),d({...t,...s})}};return e.jsxs("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0",marginBottom:"12px",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",backgroundColor:"white",borderBottom:f?"1px solid #e2e8f0":"none",cursor:"pointer"},onClick:()=>i(!f),children:[e.jsx(Fe,{size:16,style:{color:"#94a3b8",cursor:"grab"}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("span",{style:{fontWeight:600,color:"#0f172a",fontSize:"14px"},children:t.label||`Variable ${x+1}`}),t.key&&e.jsxs("span",{style:{marginLeft:"8px",color:"#64748b",fontSize:"12px"},children:["$","{","$",t.key,"}"]})]}),e.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:500,backgroundColor:`${r}15`,color:r},children:ge.find(s=>s.value===t.type)?.label||t.type}),e.jsxs("div",{style:{display:"flex",gap:"2px"},children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),c()},disabled:x===0,style:{padding:"4px",border:"none",backgroundColor:"transparent",cursor:x===0?"not-allowed":"pointer",opacity:x===0?.3:1},children:e.jsx(ye,{size:16,style:{color:"#64748b"}})}),e.jsx("button",{onClick:s=>{s.stopPropagation(),o()},disabled:x===h-1,style:{padding:"4px",border:"none",backgroundColor:"transparent",cursor:x===h-1?"not-allowed":"pointer",opacity:x===h-1?.3:1},children:e.jsx(ue,{size:16,style:{color:"#64748b"}})})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),j()},style:{padding:"6px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444"},title:"Variable löschen",children:e.jsx(V,{size:16})})]}),e.jsx(ve,{children:f&&e.jsx(be.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Feldbezeichnung *"}),e.jsx("input",{type:"text",value:u,onChange:s=>g(s.target.value),onBlur:w,placeholder:"z.B. Unternehmen",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Variablenname *"}),e.jsx("input",{type:"text",value:t.key,onChange:s=>p("key",s.target.value),placeholder:"z.B. unternehmen",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Feldtyp"}),e.jsx("select",{value:t.type,onChange:s=>p("type",s.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",backgroundColor:"white"},children:ge.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 0",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:t.required,onChange:s=>p("required",s.target.checked),style:{width:"16px",height:"16px",accentColor:r}}),e.jsx("span",{style:{fontSize:"14px",color:"#475569"},children:"Pflichtfeld"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Platzhalter-Text (optional)"}),e.jsx("input",{type:"text",value:t.placeholder,onChange:s=>p("placeholder",s.target.value),placeholder:"z.B. BMW AG, Siemens, etc.",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"}})]}),t.type==="select"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"8px"},children:"Auswahloptionen"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(t.options||[]).map((s,z)=>e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx("input",{type:"text",value:s.value,onChange:I=>k(s.id,"value",I.target.value),placeholder:"Wert",style:{flex:1,padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px",fontFamily:"monospace"}}),e.jsx("input",{type:"text",value:s.label,onChange:I=>k(s.id,"label",I.target.value),placeholder:"Anzeigename",style:{flex:2,padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px"}}),e.jsx("button",{onClick:()=>C(s.id),style:{padding:"6px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444"},children:e.jsx(V,{size:14})})]},s.id)),e.jsxs("button",{onClick:b,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",border:"1px dashed #cbd5e1",borderRadius:"6px",backgroundColor:"transparent",color:"#64748b",fontSize:"13px",cursor:"pointer",marginTop:"4px"},children:[e.jsx(_,{size:14}),"Option hinzufügen"]})]})]})]})})})]})},et=({selectedIcon:t,onSelect:x,primaryAccent:h})=>e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px"},children:Je.map(({key:d,icon:j,label:c})=>{const o=t===d;return e.jsx("button",{onClick:()=>x(d),title:c,style:{width:"60px",height:"60px",borderRadius:"12px",border:`2px solid ${o?h:"#e2e8f0"}`,backgroundColor:o?`${h}15`:"white",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},children:e.jsx(j,{size:28,style:{color:o?h:"#64748b"}})},d)})}),tt=({isOpen:t,onClose:x,onSave:h,editTemplate:d=null,demoCode:j})=>{const{branding:c,config:o}=G(),r=c?.["--primary-accent"]||o?.buttonGradientStart||"#3A7FA7",[f,i]=l.useState(""),[u,g]=l.useState(""),[p,b]=l.useState("file-text"),[k,C]=l.useState(""),[m,w]=l.useState([]),[s,z]=l.useState(!1),[I,D]=l.useState(null),[W,$]=l.useState("basics");l.useEffect(()=>{d?(i(d.title||""),g(d.description||""),b(d.icon||"file-text"),C(d.system_prompt||""),w((d.variables_schema||[]).map(n=>({...n,id:n.id||U(),options:(n.options||[]).map(S=>({...S,id:S.id||U()}))})))):(i(""),g(""),b("file-text"),C(""),w([])),$("basics"),D(null)},[d,t]);const M=()=>{w([...m,Ye()])},y=(n,S)=>{const R=[...m];R[n]=S,w(R)},a=n=>{w(m.filter((S,R)=>R!==n))},v=n=>{if(n===0)return;const S=[...m];[S[n-1],S[n]]=[S[n],S[n-1]],w(S)},B=n=>{if(n===m.length-1)return;const S=[...m];[S[n],S[n+1]]=[S[n+1],S[n]],w(S)},L=()=>{if(!f.trim())return D("Bitte gib einen Titel ein."),$("basics"),!1;if(!k.trim())return D("Bitte gib einen System-Prompt ein."),$("prompt"),!1;for(const n of m){if(!n.key.trim()||!n.label.trim())return D("Alle Variablen benötigen einen Namen und eine Bezeichnung."),$("variables"),!1;if(n.type==="select"&&(!n.options||n.options.length===0))return D(`Variable "${n.label}" benötigt mindestens eine Auswahloption.`),$("variables"),!1}return!0},P=async()=>{if(D(null),!!L()){z(!0);try{const n=m.map(A=>({key:A.key,label:A.label,type:A.type,required:A.required,placeholder:A.placeholder,...A.type==="select"?{options:A.options.map(T=>({value:T.value,label:T.label}))}:{}})),S={title:f.trim(),description:u.trim(),icon:p,system_prompt:k,variables_schema:n,...j?{demo_code:j}:{}};let R;if(d?R=await O.request(`/smartbriefing/templates/${d.id}`,{method:"PUT",body:JSON.stringify(S)}):R=await O.request("/smartbriefing/templates",{method:"POST",body:JSON.stringify(S)}),R.success)h?.(R.data.template),x();else throw new Error(R.message||"Fehler beim Speichern")}catch(n){console.error("[CreateTemplateDialog] Save error:",n),D(n.message||"Fehler beim Speichern des Templates")}finally{z(!1)}}};return t?e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:"16px"},children:e.jsxs(be.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{backgroundColor:"white",borderRadius:"20px",width:"100%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden"},onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:700,color:"#0f172a"},children:d?"Template bearbeiten":"Neues Template erstellen"}),e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"#64748b"},children:"Erstelle ein persönliches Briefing-Template"})]}),e.jsx("button",{onClick:x,style:{padding:"8px",border:"none",backgroundColor:"#f1f5f9",borderRadius:"8px",cursor:"pointer"},children:e.jsx(ze,{size:20,style:{color:"#64748b"}})})]}),e.jsx("div",{style:{display:"flex",borderBottom:"1px solid #e2e8f0",padding:"0 24px"},children:[{key:"basics",label:"Grundlagen"},{key:"variables",label:"Eingabefelder"},{key:"prompt",label:"KI-Anweisung"}].map(n=>e.jsx("button",{onClick:()=>$(n.key),style:{padding:"12px 20px",border:"none",backgroundColor:"transparent",fontSize:"14px",fontWeight:600,cursor:"pointer",color:W===n.key?r:"#64748b",borderBottom:`3px solid ${W===n.key?r:"transparent"}`,marginBottom:"-1px",transition:"all 0.2s"},children:n.label},n.key))}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:"24px"},children:[I&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"12px 16px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ae,{size:18,style:{color:"#ef4444",flexShrink:0}}),e.jsx("span",{style:{color:"#dc2626",fontSize:"14px"},children:I})]}),W==="basics"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"Titel *"}),e.jsx("input",{type:"text",value:f,onChange:n=>i(n.target.value),placeholder:"z.B. Projektpräsentation Vorbereitung",style:{width:"100%",padding:"12px 14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"15px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"Beschreibung"}),e.jsx("textarea",{value:u,onChange:n=>g(n.target.value),placeholder:"Kurze Beschreibung, wofür dieses Template verwendet wird...",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"14px",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"8px"},children:"Symbol"}),e.jsx(et,{selectedIcon:p,onSelect:b,primaryAccent:r})]})]}),W==="variables"&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(Te,{size:16,style:{color:"#64748b"}}),e.jsx("span",{style:{fontSize:"13px",color:"#64748b"},children:"Definiere die Eingabefelder, die der Nutzer beim Erstellen eines Briefings ausfüllen soll."})]})}),m.map((n,S)=>e.jsx(Qe,{variable:n,index:S,total:m.length,onChange:R=>y(S,R),onDelete:()=>a(S),onMoveUp:()=>v(S),onMoveDown:()=>B(S),primaryAccent:r},n.id)),e.jsxs("button",{onClick:M,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"14px",borderRadius:"10px",border:"2px dashed #cbd5e1",backgroundColor:"white",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:n=>{n.currentTarget.style.borderColor=r,n.currentTarget.style.color=r},onMouseLeave:n=>{n.currentTarget.style.borderColor="#cbd5e1",n.currentTarget.style.color="#64748b"},children:[e.jsx(_,{size:18}),"Eingabefeld hinzufügen"]}),m.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"32px",color:"#94a3b8",fontSize:"14px"},children:"Noch keine Eingabefelder definiert."})]}),W==="prompt"&&e.jsxs("div",{children:[e.jsx("div",{style:{backgroundColor:"#f0f9ff",borderRadius:"10px",padding:"16px",marginBottom:"16px",border:"1px solid #bae6fd"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px"},children:[e.jsx(K,{size:18,style:{color:"#0284c7",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 6px 0",fontSize:"14px",fontWeight:600,color:"#0369a1"},children:"Tipps für effektive Prompts"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"13px",color:"#0369a1",lineHeight:1.6},children:[e.jsxs("li",{children:["Verwende ",e.jsxs("code",{style:{backgroundColor:"#e0f2fe",padding:"1px 4px",borderRadius:"3px"},children:["$","{variablenname}"]})," um auf Eingabefelder zu verweisen"]}),e.jsx("li",{children:'Beschreibe die Rolle der KI (z.B. "Du bist ein erfahrener Karriere-Coach...")'}),e.jsx("li",{children:"Definiere die Struktur des gewünschten Outputs"}),e.jsx("li",{children:"Gib Beispiele für den Ton und Stil"})]})]})]})}),m.length>0&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("span",{style:{fontSize:"12px",color:"#64748b"},children:"Verfügbare Variablen: "}),m.map(n=>e.jsxs("code",{style:{display:"inline-block",padding:"2px 6px",marginRight:"6px",marginBottom:"4px",backgroundColor:"#f1f5f9",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace",color:"#475569",cursor:"pointer"},onClick:()=>{const S=`\${${n.key}}`;C(R=>R+S)},title:"Klicken zum Einfügen",children:["$","{"+n.key+"}"]},n.id))]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"System-Prompt *"}),e.jsx("textarea",{value:k,onChange:n=>C(n.target.value),placeholder:`Du bist ein erfahrener Experte für...

Erstelle ein strukturiertes Briefing für den Nutzer basierend auf folgenden Informationen:
- Position: \${position}
- Unternehmen: \${unternehmen}

Das Briefing soll folgende Abschnitte enthalten:
1. ...
2. ...

Formatiere jeden Abschnitt mit einem Titel und 5-8 konkreten Bullet Points.`,rows:15,style:{width:"100%",padding:"14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",resize:"vertical",lineHeight:1.5}})]})]})]}),e.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[e.jsx("button",{onClick:x,style:{padding:"12px 24px",borderRadius:"10px",border:"1px solid #e2e8f0",backgroundColor:"white",color:"#475569",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:P,disabled:s,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 24px",borderRadius:"10px",border:"none",background:`linear-gradient(135deg, ${r} 0%, ${r}dd 100%)`,color:"white",fontSize:"14px",fontWeight:600,cursor:s?"not-allowed":"pointer",opacity:s?.7:1},children:s?e.jsxs(e.Fragment,{children:[e.jsx(le,{size:18,style:{animation:"spin 1s linear infinite"}}),"Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{size:18}),d?"Speichern":"Template erstellen"]})})]}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}):null},E={DASHBOARD:"dashboard",FORM:"form",RESULT:"result",LIST:"list",WORKBOOK:"workbook"},Gt=({isAuthenticated:t,requireAuth:x,setPendingAction:h,onNavigateToSimulator:d,onNavigateToHistory:j,demoCode:c})=>{const[o,r]=l.useState(E.DASHBOARD),[f,i]=l.useState(null),[u,g]=l.useState(null),[p,b]=l.useState(null),[k,C]=l.useState(null),[m,w]=l.useState(!1),[s,z]=l.useState(null),[I,D]=l.useState(0);l.useEffect(()=>{k&&t&&(i(k),r(E.FORM),C(null))},[k,t]),l.useEffect(()=>{window.scrollTo(0,0)},[o]);const W=l.useCallback(T=>{i(T),r(E.FORM)},[]),$=l.useCallback(()=>{i(null),g(null),b(null),r(E.DASHBOARD)},[]),M=l.useCallback(T=>{g(T),b(T),r(E.WORKBOOK)},[]),y=l.useCallback(()=>{g(null),b(null),i(null),r(E.DASHBOARD)},[]),a=l.useCallback(()=>{g(null),b(null),r(E.FORM)},[]);l.useCallback(()=>{r(E.LIST)},[]);const v=l.useCallback(T=>{b(T),r(E.WORKBOOK)},[]);l.useCallback(()=>{b(null),r(E.LIST)},[]);const B=l.useCallback(T=>{d&&d(T)},[d]),L=l.useCallback(async T=>{try{if((await O.request(`/smartbriefing/briefings/${T.id}`,{method:"DELETE"})).success)b(null),r(E.DASHBOARD);else throw new Error("Fehler beim Löschen")}catch(H){throw console.error("[SmartBriefing] Error deleting briefing:",H),H}},[]),P=l.useCallback(()=>{z(null),w(!0)},[]),n=l.useCallback(T=>{z(T),w(!0)},[]),S=l.useCallback(()=>{w(!1),z(null)},[]),R=l.useCallback(T=>{D(H=>H+1)},[]),A=()=>{switch(o){case E.FORM:return e.jsx(Ve,{template:f,onBack:$,onBriefingGenerated:M,isAuthenticated:t});case E.RESULT:return e.jsx(Ue,{briefing:u,template:f,onBack:$,onCreateNew:y,onGenerateAnother:a});case E.LIST:return e.jsx(Ze,{onOpenBriefing:v,onCreateNew:y,isAuthenticated:t});case E.WORKBOOK:return e.jsx(De,{briefing:p,onBack:$,onDelete:L,onStartSimulation:d?B:null});case E.DASHBOARD:default:return e.jsx(_e,{onSelectTemplate:W,onShowList:j,onCreateTemplate:P,onEditTemplate:n,isAuthenticated:t,requireAuth:x,setPendingAction:h,demoCode:c},I)}};return e.jsxs("div",{style:{minHeight:"100%"},children:[A(),e.jsx(tt,{isOpen:m,onClose:S,onSave:R,editTemplate:s,demoCode:c})]})};export{Ze as BriefingList,Ue as BriefingResult,De as BriefingWorkbook,Gt as SmartBriefingApp,_e as SmartBriefingDashboard,Ve as SmartBriefingForm};
