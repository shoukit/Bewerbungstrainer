import{j as e,O as G,F,au as Ne,h as Te,y as Q,ae as L,av as rt,aw as ie,i as nt,ad as at,R as Y,c as oe,S as ce,a0 as de,ax as me,ay as xe,a8 as ue,l as X,as as ee,w as he,U as pe,aj as te,B as se,v as Ie,x as ke,C as be,z as q,a as we,Q as Ve,b as Ee,Y as Ae,t as it,az as De,L as ve,m as le,X as lt,aA as $e,a1 as ot,aB as ct,aC as dt,A as Se,aD as Fe}from"./ui-vendor-D1haG8Wg.js";import{a}from"./react-vendor-uDOJF2jQ.js";import{w as U,k as mt,F as xt,C as ut}from"./FeatureInfoButton-B9HJ96gM.js";import{S as ht}from"./ScenarioDashboard-DVPjIMXk.js";import{B as Z,C as J}from"./select-native-H9kET7Rx.js";import"./dialog-rRv3ipx9.js";import{F as pt}from"./fullscreen-loader-jpRijLZh.js";import{D as bt}from"./DynamicFormField-BkkchkbI.js";import{a as gt,B as ft}from"./BriefingWorkbook-CLlWC2dk.js";import{u as jt}from"./useMobile-YxjH166V.js";import"./ScenarioCard-B1uh-Kwr.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";const yt={"file-text":F,briefcase:se,banknote:te,users:pe,user:he,"message-circle":ee,target:X,award:ue,book:xe,clipboard:me,star:de,lightbulb:Q,shield:ce,compass:oe,rocket:Y,heart:at,folder:Ne,"trending-up":nt},V={key:"MEINE",label:"Meine Templates",shortLabel:"Meine",color:"#7C3AED",bgColor:"#EDE9FE",icon:Ne},Nt=({onSelectTemplate:s,onShowList:g,onCreateTemplate:f,onEditTemplate:o,onCopyTemplate:u,isAuthenticated:i,requireAuth:m,setPendingAction:x,demoCode:p})=>{const[y,h]=a.useState(null),[n,d]=a.useState(0),c=a.useCallback(async()=>{const b=new URLSearchParams;p&&b.append("demo_code",p);const k=await U.request(`/smartbriefing/templates?${b.toString()}`,{method:"GET"});if(k.success&&k.data?.templates)return k.data.templates;throw new Error("Unerwartete API-Antwort")},[p,n]),S=()=>{if(!i&&!p){m&&(x(()=>f),m());return}f?.()},j=(b,k)=>{b.stopPropagation(),o?.(k)},C=(b,k)=>{b.stopPropagation(),h(k)},l=(b,k)=>{if(b.stopPropagation(),!i&&!p){m&&(x(()=>()=>u?.({...k,title:`${k.title} (Kopie)`,id:null,is_custom:!0})),m());return}u?.({...k,title:`${k.title} (Kopie)`,id:null,is_custom:!0})},z=async()=>{if(y)try{const b=new URLSearchParams;p&&b.append("demo_code",p),(await U.request(`/smartbriefing/templates/${y.id}?${b.toString()}`,{method:"DELETE"})).success&&d($=>$+1)}catch(b){console.error("[SmartBriefing] Error deleting template:",b)}finally{h(null)}},R=b=>yt[b.icon]||F,I=b=>{const k=b.variables_schema?.length||0;return[{text:`${k} Eingabefeld${k!==1?"er":""}`}]},T=(b,k)=>{const $=b.category&&b.category!=="MEINE"?k(b.category):null;return e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[b.is_custom&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:V.bgColor,color:V.color},children:[e.jsx(Ne,{style:{width:"12px",height:"12px"}}),V.shortLabel]}),$&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:$.bgColor,color:$.color},children:[$.IconComponent&&e.jsx($.IconComponent,{style:{width:"12px",height:"12px"}}),$.shortLabel]})]})},O=b=>b.is_custom?"ring-2 ring-violet-200 bg-violet-50/30":"",v=b=>b.is_custom?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:k=>j(k,b),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-slate-100 hover:text-primary",title:"Template bearbeiten",children:e.jsx(rt,{size:16})}),e.jsx("button",{onClick:k=>C(k,b),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-red-50 hover:text-red-500",title:"Template lÃ¶schen",children:e.jsx(G,{size:16})})]}):u?e.jsx("div",{className:"flex gap-1",children:e.jsx("button",{onClick:k=>l(k,b),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-indigo-50 hover:text-indigo-600",title:"Als eigenes Template kopieren",children:e.jsx(ie,{size:16})})}):null,N=(i||p)&&f?e.jsxs("button",{onClick:S,className:"flex items-center gap-2 py-2.5 px-4 rounded-xl border-2 border-dashed border-indigo-200 bg-white text-indigo-500 text-sm font-medium cursor-pointer transition-all whitespace-nowrap hover:border-indigo-400 hover:bg-indigo-50 hover:shadow-sm",children:[e.jsx(L,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"persÃ¶nliches Template"}),e.jsx("span",{className:"sm:hidden",children:"Template"})]}):null,B=()=>e.jsx("div",{className:"mt-12 py-5 px-6 bg-indigo-50 rounded-2xl border border-indigo-100",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Q,{size:20,className:"text-indigo-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-1",children:"So funktioniert Smart Briefing"}),e.jsx("p",{className:"text-[13px] text-slate-600 leading-relaxed",children:"WÃ¤hle ein Template aus, gib deine spezifischen Informationen ein (z.B. Unternehmen, Position), und erhalte ein maÃŸgeschneidertes Briefing mit Insider-Wissen, Fachbegriffen und cleveren RÃ¼ckfragen."})]})]})}),E=y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>h(null),children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-[400px] w-full shadow-2xl transform transition-all",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-red-50 flex items-center justify-center",children:e.jsx(G,{size:24,className:"text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Template lÃ¶schen?"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Diese Aktion kann nicht rÃ¼ckgÃ¤ngig gemacht werden."})]})]}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-3 mb-5",children:e.jsx("p",{className:"text-sm text-slate-700",children:e.jsx("strong",{children:y.title})})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(Z,{variant:"secondary",onClick:()=>h(null),children:"Abbrechen"}),e.jsx(Z,{variant:"danger",onClick:z,children:"LÃ¶schen"})]})]})});return e.jsxs(e.Fragment,{children:[e.jsx(mt,{featureId:"smartbriefing",showOnMount:!0}),e.jsx(ht,{title:"Smart Briefing",subtitle:"Dein KI-gestÃ¼tzter Vorbereitungs-Assistent",headerIcon:F,headerActions:e.jsx(xt,{featureId:"smartbriefing",size:"sm"}),fetchScenarios:c,moduleKey:"briefings",historyButtonLabel:"Meine Briefings",onNavigateToHistory:g,onSelectScenario:s,renderCardMeta:I,renderCategoryBadge:T,getIconForScenario:R,getCardCustomActions:v,getCardClassName:O,cardActionLabel:"Briefing erstellen",cardActionIcon:Te,categoryField:"category",additionalCategories:[{key:V.key,label:V.label,shortLabel:V.shortLabel,color:V.color,bgColor:V.bgColor,icon:V.icon,IconComponent:V.icon,filterFn:b=>b.is_custom===!0}],emptyStateIcon:F,emptyStateTitle:"Keine Templates gefunden",emptyStateMessage:"Es wurden noch keine Briefing-Templates erstellt.",searchPlaceholder:"Briefings durchsuchen...",filterActions:N,renderInfoBox:B,extraContent:E,isAuthenticated:i,requireAuth:m,setPendingAction:x,demoCode:p,loadingMessage:"Templates werden geladen..."},n)]})},kt=({variable:s,index:g,onChange:f,onDelete:o})=>e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("input",{type:"text",value:s.key||"",onChange:u=>f(g,"key",u.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")),placeholder:"variable_name",className:"flex-1 py-2 px-3 rounded-md border border-slate-200 text-sm font-mono bg-slate-50 mr-2 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10"}),e.jsx("button",{type:"button",onClick:()=>o(g),className:"p-2 border-none bg-transparent cursor-pointer text-red-500 flex items-center justify-center hover:bg-red-50 rounded-md transition-colors",children:e.jsx(G,{size:18})})]}),e.jsx("textarea",{value:s.value||"",onChange:u=>f(g,"value",u.target.value),placeholder:"Wert eingeben... (mehrzeilig mÃ¶glich)",rows:3,className:"w-full py-2.5 px-3 rounded-md border border-slate-200 text-sm resize-y min-h-[80px] box-border outline-none focus:border-primary focus:ring-2 focus:ring-primary/10"})]}),wt=({template:s,onBack:g,onBriefingGenerated:f,isAuthenticated:o})=>{const[u,i]=a.useState({}),[m,x]=a.useState({}),[p,y]=a.useState(!1),[h,n]=a.useState(null),[d,c]=a.useState([]),[S,j]=a.useState(!1),C=gt(s?.icon);a.useEffect(()=>{if(s?.variables_schema){const v={};s.variables_schema.forEach(N=>{N.default&&(v[N.key]=N.default)}),i(v)}c([]),j(!1)},[s]);const l=()=>{c([...d,{key:"",value:""}])},z=(v,N,B)=>{const E=[...d];E[v][N]=B,c(E)},R=v=>{c(d.filter((N,B)=>B!==v))},I=(v,N)=>{i(B=>({...B,[v]:N})),m[v]&&x(B=>{const E={...B};return delete E[v],E})},T=()=>{const v={};return s?.variables_schema?.forEach(N=>{N.required&&!u[N.key]&&(v[N.key]="Dieses Feld ist erforderlich")}),v},O=async v=>{v.preventDefault();const N=T();if(Object.keys(N).length>0){x(N);return}y(!0),n(null);try{const B={};d.forEach(k=>{k.key&&k.value&&(B[k.key]=k.value)});const E={template_id:s.id,variables:u};Object.keys(B).length>0&&(E.custom_variables=B);const b=await U.request("/smartbriefing/generate",{method:"POST",body:JSON.stringify(E)});if(b.success&&b.data?.briefing)f(b.data.briefing);else throw new Error("Unerwartete API-Antwort")}catch(B){console.error("[SmartBriefing] Error generating briefing:",B),n(B.message||"Fehler beim Generieren des Briefings")}finally{y(!1)}};return s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 pt-8 max-w-[700px] mx-auto",children:[e.jsxs("button",{onClick:g,disabled:p,className:`flex items-center gap-2 py-2 border-none bg-transparent text-slate-500 text-sm font-medium cursor-pointer mb-6 transition-opacity ${p?"opacity-50 cursor-not-allowed":"hover:text-slate-700"}`,children:[e.jsx(Ie,{size:18}),e.jsx("span",{className:"leading-relaxed",children:"ZurÃ¼ck zur Ãœbersicht"})]}),e.jsx(J,{className:"p-6 mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(C,{size:28,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[22px] font-bold text-slate-900 mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-slate-500",children:s.description})]})]})}),e.jsxs(J,{className:"p-6",children:[e.jsx("h2",{className:"text-base font-semibold text-slate-900 mb-5 pb-4 border-b border-slate-100",children:"Deine Angaben"}),e.jsxs("form",{onSubmit:O,children:[s.variables_schema?.map(v=>e.jsx(bt,{field:v,value:u[v.key],onChange:I,error:m[v.key]},v.key)),s.allow_custom_variables&&e.jsxs("div",{className:"mt-6 mb-5 pt-5 border-t border-slate-100",children:[e.jsxs("button",{type:"button",onClick:()=>j(!S),className:`flex items-start gap-2 p-0 border-none bg-transparent text-slate-500 text-sm font-medium cursor-pointer text-left ${S?"mb-4":""}`,children:[e.jsxs("span",{className:"flex items-center gap-2 flex-shrink-0",children:[S?e.jsx(ke,{size:18}):e.jsx(be,{size:18}),e.jsx(L,{size:16})]}),e.jsx("span",{className:"leading-relaxed",children:"ZusÃ¤tzliche Variablen hinzufÃ¼gen (optional)"})]}),S&&e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4",children:[e.jsx("p",{className:"text-[13px] text-slate-500 mb-3",children:"FÃ¼ge eigene Variablen hinzu, die in die Briefing-Generierung einflieÃŸen sollen."}),d.length>0&&e.jsx("div",{className:"mb-3",children:d.map((v,N)=>e.jsx(kt,{variable:v,index:N,onChange:z,onDelete:R},N))}),e.jsxs("button",{type:"button",onClick:l,className:"flex items-center gap-1.5 py-2 px-3 border border-dashed border-slate-300 rounded-lg bg-white text-slate-500 text-[13px] cursor-pointer w-full justify-center hover:border-primary hover:text-primary transition-colors",children:[e.jsx(L,{size:14}),"Variable hinzufÃ¼gen"]})]})]}),h&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-5 flex items-start gap-3",children:[e.jsx(q,{size:20,className:"text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:h})]}),e.jsx(Z,{type:"submit",disabled:p,size:"lg",fullWidth:!0,icon:e.jsx(we,{size:20}),children:"Briefing generieren"})]})]})]}),e.jsx(pt,{isLoading:p,message:"Smart Briefing wird erstellt...",subMessage:"Die KI analysiert deine Angaben und erstellt ein maÃŸgeschneidertes Briefing."})]}):null},vt={"file-text":F,briefcase:se,banknote:te,users:pe,user:he,"message-circle":ee,target:X,award:ue,book:xe,clipboard:me,star:de,lightbulb:Q,shield:ce,compass:oe,rocket:Y},St=({content:s})=>{if(!s)return null;const g=o=>{const u=o.split(`
`),i=[];let m=[],x=null;const p=()=>{m.length>0&&(i.push(e.jsx("ul",{className:"my-3 pl-6 list-none",children:m.map((y,h)=>e.jsxs("li",{className:"mb-2 text-[15px] leading-relaxed text-gray-700 relative pl-5",children:[e.jsx("span",{className:"absolute left-0 text-primary font-bold",children:x==="number"?`${h+1}.`:"â€¢"}),f(y)]},h))},`list-${i.length}`)),m=[],x=null)};return u.forEach((y,h)=>{const n=y.trim();if(!n){p();return}if(n.startsWith("### ")){p(),i.push(e.jsx("h3",{className:`text-lg font-bold text-slate-900 my-6 mb-3 pt-4 flex items-center gap-2 ${h>0?"border-t border-slate-100":""}`,children:f(n.substring(4))},`h3-${h}`));return}if(n.startsWith("## ")){p(),i.push(e.jsx("h2",{className:"text-xl font-bold text-slate-900 my-7 mb-3.5",children:f(n.substring(3))},`h2-${h}`));return}if(n.startsWith("# ")){p(),i.push(e.jsx("h1",{className:"text-2xl font-bold text-slate-900 my-8 mb-4",children:f(n.substring(2))},`h1-${h}`));return}if(n.startsWith("- ")||n.startsWith("* ")){x!=="bullet"&&(p(),x="bullet"),m.push(n.substring(2));return}const d=n.match(/^(\d+)\.\s/);if(d){x!=="number"&&(p(),x="number"),m.push(n.substring(d[0].length));return}p(),i.push(e.jsx("p",{className:"my-3 text-[15px] leading-relaxed text-gray-700",children:f(n)},`p-${h}`))}),p(),i},f=o=>{const u=[];let i=o,m=0;for(;i.length>0;){const x=i.match(/\*\*(.+?)\*\*/),p=i.match(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)|_([^_]+)_")),y=i.match(/`([^`]+)`/),h=[{match:x,type:"bold"},{match:p,type:"italic"},{match:y,type:"code"}].filter(d=>d.match);if(h.length===0){u.push(i);break}const n=h.reduce((d,c)=>(d.match?.index??1/0)<(c.match?.index??1/0)?d:c);switch(n.match.index>0&&u.push(i.substring(0,n.match.index)),n.type){case"bold":u.push(e.jsx("strong",{className:"font-semibold text-slate-900",children:n.match[1]},m++));break;case"italic":u.push(e.jsx("em",{className:"italic",children:n.match[1]||n.match[2]},m++));break;case"code":u.push(e.jsx("code",{className:"bg-slate-100 px-1.5 py-0.5 rounded text-[13px] font-mono text-primary",children:n.match[1]},m++));break}i=i.substring(n.match.index+n.match[0].length)}return u};return e.jsx("div",{children:g(s)})},Ct=({briefing:s,template:g,onBack:f,onCreateNew:o,onGenerateAnother:u})=>{const i=jt(),[m,x]=a.useState(!1),p=a.useRef(null),y=vt[g?.icon||s?.template_icon]||F,h=c=>c?new Date(c).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",n=async()=>{try{await navigator.clipboard.writeText(s.content_markdown),x(!0),setTimeout(()=>x(!1),2e3)}catch(c){console.error("[SmartBriefing] Failed to copy:",c)}},d=()=>{const c=`${g?.title||s?.template_title}
${"=".repeat(50)}

Erstellt am: ${h(s.created_at)}

${s.content_markdown}`,S=new Blob([c],{type:"text/plain;charset=utf-8"}),j=URL.createObjectURL(S),C=document.createElement("a");C.href=j,C.download=`briefing-${s.id}.txt`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(j)};return s?e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("div",{className:`bg-brand-gradient sticky top-0 z-40 ${i?"px-4 py-5":"px-8 py-6"}`,children:e.jsxs("div",{className:"max-w-[1400px] mx-auto",children:[f&&e.jsxs("button",{onClick:f,className:"flex items-center gap-1.5 bg-white/15 border-none rounded-lg px-3 py-2 cursor-pointer text-white text-[13px] mb-4 hover:bg-white/25 transition-colors",children:[e.jsx(Ie,{size:16}),"ZurÃ¼ck zur Ãœbersicht"]}),e.jsxs("div",{className:`flex items-center gap-6 ${i?"flex-col items-start gap-4":""}`,children:[e.jsx("div",{className:`rounded-full bg-white/20 flex items-center justify-center flex-shrink-0 ${i?"w-[70px] h-[70px]":"w-[90px] h-[90px]"}`,children:e.jsx(y,{size:i?32:40,color:ut.white})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap mb-2",children:[e.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wide px-2.5 py-1 rounded-full bg-white/20 text-white",children:"Smart Briefing"}),e.jsxs("span",{className:"text-xs font-medium px-2.5 py-1 rounded-full bg-white/90 text-primary flex items-center gap-1",children:[e.jsx(we,{size:12}),"Fertig!"]})]}),e.jsx("h1",{className:`font-bold text-white m-0 mb-2 ${i?"text-xl":"text-2xl"}`,children:g?.title||s?.template_title}),e.jsx("div",{className:"flex items-center gap-4 flex-wrap",children:e.jsxs("span",{className:"flex items-center gap-1.5 text-[13px] text-white/80",children:[e.jsx(Ve,{size:14}),h(s.created_at)]})})]}),!i&&e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:n,className:`flex items-center gap-2 rounded-xl px-5 py-2.5 cursor-pointer text-white text-sm font-medium border border-white/30 transition-colors ${m?"bg-green-500/30":"bg-white/20 hover:bg-white/30"}`,children:[m?e.jsx(Ee,{size:16}):e.jsx(ie,{size:16}),m?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:d,className:"flex items-center gap-2 bg-white/20 border border-white/30 rounded-xl px-5 py-2.5 cursor-pointer text-white text-sm font-medium hover:bg-white/30 transition-colors",children:[e.jsx(Ae,{size:16}),"Speichern"]})]})]})]})}),e.jsxs("div",{className:`max-w-[900px] mx-auto ${i?"p-4":"px-8 py-6"}`,children:[i&&e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("button",{onClick:n,className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-3 rounded-xl border text-[13px] font-medium cursor-pointer transition-colors ${m?"bg-green-50 border-green-200 text-green-700":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"}`,children:[m?e.jsx(Ee,{size:16}):e.jsx(ie,{size:16}),m?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:d,className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 text-[13px] font-medium cursor-pointer hover:bg-slate-50 transition-colors",children:[e.jsx(Ae,{size:16}),"Speichern"]})]}),e.jsx("div",{ref:p,className:"bg-white rounded-2xl shadow-sm overflow-hidden border border-slate-200",children:e.jsx("div",{className:i?"p-5":"p-8",children:e.jsx(St,{content:s.content_markdown})})}),e.jsxs("div",{className:"flex gap-3 mt-6 flex-wrap",children:[e.jsxs("button",{onClick:u,className:"flex-1 min-w-[200px] flex items-center justify-center gap-2 px-6 py-3.5 rounded-xl border-2 border-primary bg-white text-primary text-[15px] font-semibold cursor-pointer transition-all hover:bg-primary/5",children:[e.jsx(it,{size:18}),"Mit anderen Angaben neu generieren"]}),e.jsxs("button",{onClick:o,className:"flex-1 min-w-[200px] flex items-center justify-center gap-2 px-6 py-3.5 rounded-xl border-none bg-brand-gradient text-white text-[15px] font-semibold cursor-pointer transition-all shadow-primary/40 shadow-lg hover:shadow-xl",children:[e.jsx(L,{size:18}),"Neues Briefing erstellen"]})]})]})]}):null},zt={"file-text":F,briefcase:se,banknote:te,users:pe,user:he,"message-circle":ee,target:X,award:ue,book:xe,clipboard:me,star:de,lightbulb:Q,shield:ce,compass:oe,rocket:Y},Bt=s=>s?new Date(s).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",Et=({briefing:s,onOpen:g,onDelete:f,isDeleting:o})=>{const[u,i]=a.useState(!1),[m,x]=a.useState(!1),p=zt[s.template_icon]||F,y=h=>{h.stopPropagation(),m?(f(s.id),x(!1)):(x(!0),setTimeout(()=>x(!1),3e3))};return e.jsxs(J,{onClick:()=>g(s),onMouseEnter:()=>i(!0),onMouseLeave:()=>{i(!1),x(!1)},className:`p-5 cursor-pointer transition-all duration-300 relative ${u?"border-primary shadow-lg -translate-y-0.5":"border-slate-200 hover:border-slate-300"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-[10px] bg-primary/10 flex items-center justify-center",children:e.jsx(p,{size:22,className:"text-primary"})}),e.jsx("button",{onClick:y,disabled:o,className:`p-2 rounded-lg border-none cursor-pointer transition-all ${m?"bg-red-50 text-red-500":u?"bg-slate-100 text-slate-400":"bg-transparent text-slate-400"} ${u||m?"opacity-100":"opacity-0"} ${o?"cursor-not-allowed":""}`,children:o?e.jsx(ve,{size:18,className:"animate-spin"}):e.jsx(G,{size:18})})]}),e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1 leading-tight truncate",children:s.title||"Unbenanntes Briefing"}),e.jsx("p",{className:"text-[13px] text-slate-500 mb-3",children:s.template_title}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-xs",children:[e.jsx(Ve,{size:14}),Bt(s.created_at)]}),e.jsxs("div",{className:"flex items-center gap-1 text-primary text-[13px] font-medium",children:["Ã–ffnen",e.jsx(Te,{size:16})]})]}),m&&e.jsx("div",{className:"absolute top-2 right-2 bg-red-50 border border-red-200 rounded-lg py-2 px-3 text-xs text-red-600 font-medium z-10",onClick:h=>h.stopPropagation(),children:"Nochmal klicken zum LÃ¶schen"})]})},At=({onOpenBriefing:s,onCreateNew:g,isAuthenticated:f})=>{const[o,u]=a.useState([]),[i,m]=a.useState(!0),[x,p]=a.useState(null),[y,h]=a.useState(null);a.useEffect(()=>{(async()=>{if(!f){m(!1);return}try{m(!0),p(null);const c=await U.request("/smartbriefing/briefings",{method:"GET"});if(c.success&&c.data?.briefings){const S=c.data.briefings.filter(j=>j.status==="completed");u(S)}else throw new Error("Unerwartete API-Antwort")}catch(c){console.error("[SmartBriefing] Error fetching briefings:",c),p(c.message||"Fehler beim Laden der Briefings")}finally{m(!1)}})()},[f]);const n=async d=>{try{if(h(d),(await U.request(`/smartbriefing/briefings/${d}`,{method:"DELETE"})).success)u(S=>S.filter(j=>j.id!==d));else throw new Error("Fehler beim LÃ¶schen")}catch(c){console.error("[SmartBriefing] Error deleting briefing:",c),p(c.message||"Fehler beim LÃ¶schen des Briefings")}finally{h(null)}};return f?e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Meine Briefings"}),e.jsxs("p",{className:"text-sm text-slate-500",children:[o.length," gespeicherte Briefings"]})]}),e.jsx(Z,{onClick:g,icon:e.jsx(L,{size:18}),children:"Neues Briefing"})]}),i&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(ve,{size:40,className:"text-primary animate-spin"}),e.jsx("p",{className:"mt-4 text-slate-500",children:"Briefings werden geladen..."})]}),x&&!i&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 flex items-start gap-3",children:[e.jsx(q,{size:24,className:"text-red-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base text-red-600 font-medium mb-1",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-sm text-red-700",children:x})]})]}),!i&&!x&&e.jsx(e.Fragment,{children:o.length===0?e.jsxs(J,{className:"py-12 px-6 text-center",children:[e.jsx(De,{size:48,className:"text-slate-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg text-slate-500 mb-2",children:"Noch keine Briefings"}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Erstelle dein erstes Briefing, um loszulegen."}),e.jsx(Z,{onClick:g,icon:e.jsx(L,{size:18}),children:"Briefing erstellen"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:o.map(d=>e.jsx(Et,{briefing:d,onOpen:s,onDelete:n,isDeleting:y===d.id},d.id))})})]}):e.jsx("div",{className:"p-6 max-w-[800px] mx-auto",children:e.jsxs(J,{className:"py-12 px-6 text-center",children:[e.jsx(De,{size:48,className:"text-slate-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg text-slate-500 mb-2",children:"Anmeldung erforderlich"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Melde dich an, um deine gespeicherten Briefings zu sehen."})]})})},Le=[{key:"file-text",icon:F,label:"Dokument"},{key:"briefcase",icon:se,label:"Koffer"},{key:"banknote",icon:te,label:"Geld"},{key:"users",icon:pe,label:"Team"},{key:"user",icon:he,label:"Person"},{key:"target",icon:X,label:"Ziel"},{key:"lightbulb",icon:Q,label:"Idee"},{key:"star",icon:de,label:"Stern"},{key:"shield",icon:ce,label:"Schutz"},{key:"compass",icon:oe,label:"Kompass"},{key:"rocket",icon:Y,label:"Rakete"},{key:"message-circle",icon:ee,label:"Nachricht"},{key:"award",icon:ue,label:"Auszeichnung"},{key:"book",icon:xe,label:"Buch"},{key:"clipboard",icon:me,label:"Checkliste"}],_e=[{value:"text",label:"Einzeiliges Textfeld"},{value:"textarea",label:"Mehrzeiliges Textfeld"},{value:"select",label:"Dropdown-Auswahl"}],Re=[{key:"empty",label:"--- Vorlage wÃ¤hlen ---",icon:F,aiRole:"",sections:[],aiBehavior:"",variables:[]},{key:"sales",label:"ðŸŽ¯ Sales / KundengesprÃ¤ch",icon:X,aiRole:"Du bist ein erfahrener Sales-Coach und Vertriebsexperte mit 15+ Jahren Erfahrung im B2B-Vertrieb.",sections:[{id:"hook",title:"The Hook ðŸª",instruction:"Erstelle einen packenden GesprÃ¤chseinstieg fÃ¼r ${customer_type} Kunden"},{id:"discovery",title:"Discovery Questions ðŸ”",instruction:"Formuliere 5-7 offene Fragen um Bedarf zu wecken und Pain Points zu identifizieren"},{id:"value",title:"Value Proposition ðŸ’Ž",instruction:"Beschreibe den Mehrwert basierend auf ${product_service}"},{id:"objections",title:"Einwandbehandlung ðŸ›¡ï¸",instruction:"Liste typische EinwÃ¤nde und passende Antworten"},{id:"closing",title:"Closing Path ðŸŽ¯",instruction:"Entwickle einen Weg zum Ziel: ${meeting_goal}"}],aiBehavior:"Schreibe praxisnah und actionable. Jeder Punkt soll direkt umsetzbar sein. Vermeide Theorie - fokussiere auf konkrete Formulierungen und Techniken.",variables:[{key:"customer_type",label:"Kundentyp",type:"text",placeholder:"z.B. Enterprise, KMU, Startup"},{key:"product_service",label:"Produkt/Service",type:"text",placeholder:"Was verkaufst du?"},{key:"meeting_goal",label:"Ziel des GesprÃ¤chs",type:"text",placeholder:"z.B. Demo-Termin, Angebot"}]},{key:"career",label:"ðŸ’¼ Karriere / VorstellungsgesprÃ¤ch",icon:se,aiRole:"Du bist ein erfahrener Karriere-Coach und HR-Experte mit umfassender Erfahrung in Bewerbungsprozessen.",sections:[{id:"company",title:"Unternehmens-Insights ðŸ¢",instruction:"Recherchiere wichtige Fakten Ã¼ber ${unternehmen} die im GesprÃ¤ch relevant sind"},{id:"position",title:"Positions-Analyse ðŸ“‹",instruction:"Analysiere die Anforderungen fÃ¼r ${position} und wie der Kandidat diese erfÃ¼llt"},{id:"questions",title:"Typische Fragen â“",instruction:"Liste die 10 wahrscheinlichsten Interviewfragen mit Antwortstrategien"},{id:"stories",title:"STAR-Stories â­",instruction:"Entwickle 3-5 Erfolgsgeschichten nach der STAR-Methode"},{id:"questions_to_ask",title:"Eigene Fragen ðŸ™‹",instruction:"Formuliere 5-7 kluge RÃ¼ckfragen an den Interviewer"}],aiBehavior:"Sei konkret und praxisorientiert. Gib FormulierungsvorschlÃ¤ge die direkt verwendet werden kÃ¶nnen. BerÃ¼cksichtige deutsche GeschÃ¤ftskultur.",variables:[{key:"unternehmen",label:"Unternehmen",type:"text",placeholder:"Name des Unternehmens"},{key:"position",label:"Position",type:"text",placeholder:"Stelle, auf die du dich bewirbst"}]},{key:"negotiation",label:"ðŸ’° Gehaltsverhandlung",icon:te,aiRole:"Du bist ein Experte fÃ¼r Gehaltsverhandlungen und Karriereentwicklung.",sections:[{id:"market",title:"Marktanalyse ðŸ“Š",instruction:"Analysiere Gehaltsspannen fÃ¼r ${position} in ${branche} und ${region}"},{id:"arguments",title:"Argumente ðŸ’ª",instruction:"Entwickle 5-7 Ã¼berzeugende Argumente fÃ¼r eine GehaltserhÃ¶hung basierend auf ${erfolge}"},{id:"counter",title:"Konterstrategien ðŸ›¡ï¸",instruction:"Bereite Antworten auf typische Gegenargumente des Arbeitgebers vor"},{id:"tactics",title:"Verhandlungstaktiken ðŸŽ¯",instruction:"Beschreibe bewÃ¤hrte Taktiken fÃ¼r die Gehaltsverhandlung"},{id:"alternatives",title:"Alternativen ðŸ”„",instruction:"Liste nicht-monetÃ¤re Benefits die verhandelbar sind"}],aiBehavior:"Fokussiere auf konkrete Zahlen und Formulierungen. Sei selbstbewusst aber nicht arrogant im Ton.",variables:[{key:"position",label:"Position",type:"text",placeholder:"Deine aktuelle/angestrebte Position"},{key:"branche",label:"Branche",type:"text",placeholder:"z.B. IT, Finanzen, Marketing"},{key:"region",label:"Region",type:"text",placeholder:"z.B. MÃ¼nchen, Berlin, Remote"},{key:"erfolge",label:"Deine Erfolge",type:"textarea",placeholder:"Beschreibe deine wichtigsten Leistungen"}]},{key:"presentation",label:"ðŸŽ¤ PrÃ¤sentation / Pitch",icon:Y,aiRole:"Du bist ein PrÃ¤sentations-Coach und Storytelling-Experte.",sections:[{id:"hook",title:"ErÃ¶ffnung ðŸŽ¬",instruction:"Erstelle einen aufmerksamkeitsstarken Einstieg fÃ¼r ${thema}"},{id:"problem",title:"Problem/Herausforderung âš¡",instruction:"Beschreibe das Problem das ${zielgruppe} hat"},{id:"solution",title:"LÃ¶sung/Angebot ðŸ’¡",instruction:"PrÃ¤sentiere die LÃ¶sung klar und Ã¼berzeugend"},{id:"proof",title:"Beweise/Beispiele ðŸ“ˆ",instruction:"Liste Erfolgsbeispiele, Zahlen und Social Proof"},{id:"cta",title:"Call-to-Action ðŸŽ¯",instruction:"Formuliere einen klaren nÃ¤chsten Schritt"}],aiBehavior:"Schreibe in aktivem, energetischem Stil. Jeder Abschnitt soll eine klare Botschaft haben. Nutze Storytelling-Elemente.",variables:[{key:"thema",label:"Thema der PrÃ¤sentation",type:"text",placeholder:"WorÃ¼ber prÃ¤sentierst du?"},{key:"zielgruppe",label:"Zielgruppe",type:"text",placeholder:"Wer ist dein Publikum?"}]},{key:"feedback",label:"ðŸ’¬ Feedback-GesprÃ¤ch",icon:ee,aiRole:"Du bist ein erfahrener Leadership-Coach und Experte fÃ¼r MitarbeiterfÃ¼hrung.",sections:[{id:"context",title:"GesprÃ¤chsrahmen ðŸ“‹",instruction:"Bereite den Rahmen fÃ¼r das Feedback-GesprÃ¤ch mit ${mitarbeiter_name} vor"},{id:"positive",title:"StÃ¤rken & Erfolge â­",instruction:"Liste konkrete positive Beobachtungen und Erfolge"},{id:"development",title:"Entwicklungsfelder ðŸŒ±",instruction:"Beschreibe Verbesserungspotenziale konstruktiv"},{id:"goals",title:"Zielvereinbarung ðŸŽ¯",instruction:"Formuliere SMART-Ziele fÃ¼r die nÃ¤chste Periode"},{id:"support",title:"UnterstÃ¼tzungsangebote ðŸ¤",instruction:"Liste mÃ¶gliche UnterstÃ¼tzungsmaÃŸnahmen"}],aiBehavior:"Schreibe wertschÃ¤tzend und konstruktiv. Fokussiere auf Verhalten, nicht auf PersÃ¶nlichkeit. Nutze die SBI-Methode (Situation-Behavior-Impact).",variables:[{key:"mitarbeiter_name",label:"Name des Mitarbeiters",type:"text",placeholder:'Vorname oder "der Mitarbeiter"'}]}],P=()=>`var_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Dt=()=>({id:P(),key:"",label:"",type:"text",required:!0,placeholder:"",options:[]}),$t=()=>({id:P(),value:"",label:""}),_t=()=>({id:P(),title:"",instruction:""}),Rt=({variable:s,index:g,total:f,onChange:o,onDelete:u,onMoveUp:i,onMoveDown:m})=>{const[x,p]=a.useState(!0),[y,h]=a.useState(s.label);a.useEffect(()=>{h(s.label)},[s.label]);const n=(l,z)=>{o({...s,[l]:z})},d=()=>{const l=[...s.options||[],$t()];o({...s,options:l})},c=(l,z,R)=>{const I=s.options.map(T=>T.id===l?{...T,[z]:R}:T);o({...s,options:I})},S=l=>{const z=s.options.filter(R=>R.id!==l);o({...s,options:z})},j=l=>l.toLowerCase().replace(/[Ã¤Ã¶Ã¼ÃŸ]/g,z=>({Ã¤:"ae",Ã¶:"oe",Ã¼:"ue",ÃŸ:"ss"})[z]).replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),C=()=>{if(y!==s.label){const l={label:y};(!s.key||s.key===j(s.label))&&(l.key=j(y)),o({...s,...l})}};return e.jsxs("div",{className:"bg-slate-50 rounded-xl border border-slate-200 mb-3 overflow-hidden",children:[e.jsxs("div",{className:`flex items-center gap-2 px-4 py-3 bg-white cursor-pointer ${x?"border-b border-slate-200":""}`,onClick:()=>p(!x),children:[e.jsx(Fe,{size:16,className:"text-slate-400 cursor-grab"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"font-semibold text-slate-900 text-sm",children:s.label||`Variable ${g+1}`}),s.key&&e.jsxs("span",{className:"ml-2 text-slate-500 text-xs",children:["$","{","$",s.key,"}"]})]}),e.jsx("span",{className:"px-2 py-0.5 rounded text-[11px] font-medium bg-primary/10 text-primary",children:_e.find(l=>l.value===s.type)?.label||s.type}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),i()},disabled:g===0,className:`p-1 border-none bg-transparent ${g===0?"cursor-not-allowed opacity-30":"cursor-pointer"}`,children:e.jsx(ke,{size:16,className:"text-slate-500"})}),e.jsx("button",{onClick:l=>{l.stopPropagation(),m()},disabled:g===f-1,className:`p-1 border-none bg-transparent ${g===f-1?"cursor-not-allowed opacity-30":"cursor-pointer"}`,children:e.jsx(be,{size:16,className:"text-slate-500"})})]}),e.jsx("button",{onClick:l=>{l.stopPropagation(),u()},className:"p-1.5 border-none bg-transparent cursor-pointer text-red-500",children:e.jsx(G,{size:16})})]}),e.jsx(Se,{children:x&&e.jsx(le.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs("div",{className:"p-4 flex flex-col gap-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Feldbezeichnung *"}),e.jsx("input",{type:"text",value:y,onChange:l=>h(l.target.value),onBlur:C,placeholder:"z.B. Unternehmen",className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Variablenname *"}),e.jsx("input",{type:"text",value:s.key,onChange:l=>n("key",l.target.value),placeholder:"z.B. unternehmen",className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm font-mono"})]})]}),e.jsxs("div",{className:"grid grid-cols-[1fr_auto] gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Feldtyp"}),e.jsx("select",{value:s.type,onChange:l=>n("type",l.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm bg-white",children:_e.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("label",{className:"flex items-center gap-2 py-2.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.required,onChange:l=>n("required",l.target.checked),className:"w-4 h-4 accent-primary"}),e.jsx("span",{className:"text-sm text-slate-600",children:"Pflichtfeld"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-1",children:"Platzhalter-Text (optional)"}),e.jsx("input",{type:"text",value:s.placeholder,onChange:l=>n("placeholder",l.target.value),placeholder:"z.B. BMW AG, Siemens, etc.",className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm"})]}),s.type==="select"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-600 mb-2",children:"Auswahloptionen"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[(s.options||[]).map(l=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"text",value:l.value,onChange:z=>c(l.id,"value",z.target.value),placeholder:"Wert",className:"flex-1 px-2.5 py-2 rounded-md border border-slate-200 text-[13px] font-mono"}),e.jsx("input",{type:"text",value:l.label,onChange:z=>c(l.id,"label",z.target.value),placeholder:"Anzeigename",className:"flex-[2] px-2.5 py-2 rounded-md border border-slate-200 text-[13px]"}),e.jsx("button",{onClick:()=>S(l.id),className:"p-1.5 border-none bg-transparent cursor-pointer text-red-500",children:e.jsx(G,{size:14})})]},l.id)),e.jsxs("button",{onClick:d,className:"flex items-center gap-1.5 px-3 py-2 border border-dashed border-slate-300 rounded-md bg-transparent text-slate-500 text-[13px] cursor-pointer mt-1 hover:bg-slate-50",children:[e.jsx(L,{size:14}),"Option hinzufÃ¼gen"]})]})]})]})})})]})},Tt=({section:s,index:g,total:f,variables:o,onChange:u,onDelete:i,onMoveUp:m,onMoveDown:x,onInsertVariable:p})=>{const y=a.useRef(null),h=(d,c)=>{u({...s,[d]:c})},n=d=>{const c=y.current;if(c){const S=c.selectionStart,j=c.selectionEnd,C=s.instruction,l=`\${${d}}`,z=C.substring(0,S)+l+C.substring(j);h("instruction",z),setTimeout(()=>{c.focus(),c.setSelectionRange(S+l.length,S+l.length)},0)}else h("instruction",s.instruction+`\${${d}}`)};return e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 mb-3 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-gradient-to-r from-indigo-50 to-violet-50 border-b border-slate-200",children:[e.jsx(Fe,{size:16,className:"text-slate-400 cursor-grab"}),e.jsx("span",{className:"w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 text-xs font-bold flex items-center justify-center",children:g+1}),e.jsx("input",{type:"text",value:s.title,onChange:d=>h("title",d.target.value),placeholder:"Abschnittstitel (z.B. 'Discovery Questions ðŸ”')",className:"flex-1 px-2 py-1 rounded border-0 bg-transparent text-sm font-semibold text-slate-800 placeholder:text-slate-400"}),e.jsxs("div",{className:"flex gap-0.5",children:[e.jsx("button",{onClick:m,disabled:g===0,className:`p-1 border-none bg-transparent ${g===0?"opacity-30":"cursor-pointer"}`,children:e.jsx(ke,{size:16,className:"text-slate-500"})}),e.jsx("button",{onClick:x,disabled:g===f-1,className:`p-1 border-none bg-transparent ${g===f-1?"opacity-30":"cursor-pointer"}`,children:e.jsx(be,{size:16,className:"text-slate-500"})})]}),e.jsx("button",{onClick:i,className:"p-1.5 border-none bg-transparent cursor-pointer text-red-500 hover:bg-red-50 rounded",children:e.jsx(G,{size:16})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-600",children:"Anweisung fÃ¼r diesen Abschnitt"}),o.length>0&&e.jsx(ye,{variables:o,onSelect:n})]}),e.jsx("textarea",{ref:y,value:s.instruction,onChange:d=>h("instruction",d.target.value),placeholder:"z.B. 'Erstelle 5-7 offene Fragen um Bedarf zu wecken basierend auf ${customer_type}'",rows:2,className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 text-sm resize-y"})]})]})},ye=({variables:s,onSelect:g})=>{const[f,o]=a.useState(!1),u=a.useRef(null);return a.useEffect(()=>{const i=m=>{u.current&&!u.current.contains(m.target)&&o(!1)};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]),s.length===0?null:e.jsxs("div",{className:"relative",ref:u,children:[e.jsxs("button",{onClick:()=>o(!f),className:"flex items-center gap-1.5 px-2.5 py-1.5 rounded-md bg-indigo-50 text-indigo-600 text-xs font-medium border-none cursor-pointer hover:bg-indigo-100 transition-colors",children:[e.jsx(L,{size:14}),"Variable einfÃ¼gen",e.jsx(be,{size:14,className:`transition-transform ${f?"rotate-180":""}`})]}),e.jsx(Se,{children:f&&e.jsx(le.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"absolute right-0 top-full mt-1 bg-white rounded-lg shadow-lg border border-slate-200 z-50 min-w-[180px] py-1",children:s.map(i=>e.jsxs("button",{onClick:()=>{g(i.key),o(!1)},className:"w-full px-3 py-2.5 text-left text-sm hover:bg-indigo-50 border-none bg-transparent cursor-pointer flex items-center justify-between gap-3",children:[e.jsx("span",{className:"text-slate-800 font-medium",children:i.label}),e.jsxs("code",{className:"text-xs text-indigo-700 bg-indigo-100 px-2 py-1 rounded font-mono font-semibold whitespace-nowrap",children:["$","{","$",i.key,"}"]})]},i.id))})})]})},It=({selectedIcon:s,onSelect:g})=>e.jsx("div",{className:"flex flex-wrap gap-3",children:Le.map(({key:f,icon:o,label:u})=>{const i=s===f;return e.jsx("button",{onClick:()=>g(f),title:u,className:`w-[60px] h-[60px] rounded-xl border-2 flex items-center justify-center cursor-pointer transition-all ${i?"border-primary bg-primary/10":"border-slate-200 bg-white hover:border-primary/40"}`,children:e.jsx(o,{size:28,className:i?"text-primary":"text-slate-500"})},f)})}),Vt=({isOpen:s,onClose:g,onSave:f,editTemplate:o=null,demoCode:u})=>{const[i,m]=a.useState(""),[x,p]=a.useState(""),[y,h]=a.useState("file-text"),[n,d]=a.useState([]),[c,S]=a.useState(""),[j,C]=a.useState([]),[l,z]=a.useState(""),[R,I]=a.useState("empty"),[T,O]=a.useState(!1),[v,N]=a.useState(null),[B,E]=a.useState("basics"),[b,k]=a.useState(null),[$,W]=a.useState(null),[re,H]=a.useState(!1),ne=a.useRef(null),ae=a.useRef(null);a.useEffect(()=>{if(o){if(m(o.title||""),p(o.description||""),h(o.icon||"file-text"),d((o.variables_schema||[]).map(t=>({...t,id:t.id||P(),options:(t.options||[]).map(r=>({...r,id:r.id||P()}))}))),o.ai_role?S(o.ai_role):o.system_prompt&&S(o.system_prompt),o.ai_task)try{const t=JSON.parse(o.ai_task);Array.isArray(t)&&C(t.map(r=>({...r,id:r.id||P()})))}catch{C([{id:P(),title:"Hauptabschnitt",instruction:o.ai_task}])}z(o.ai_behavior||""),H(o.allow_user_variables||!1),I("empty")}else m(""),p(""),h("file-text"),d([]),S(""),C([]),z(""),H(!1),I("empty");E("basics"),N(null),W(null)},[o,s]);const ge=()=>c.trim()||j.length>0||l.trim()||n.length>0,D=t=>{const r=Re.find(w=>w.key===t);if(!r||t==="empty"){I("empty");return}ge()?k(r):M(r)},M=t=>{I(t.key),S(t.aiRole),C(t.sections.map(r=>({...r,id:P()}))),z(t.aiBehavior),h(Le.find(r=>r.icon===t.icon)?.key||"file-text"),t.variables&&t.variables.length>0&&d(t.variables.map(r=>({...r,id:P(),required:!0,options:[]}))),k(null)},Pe=()=>{k(null)},Oe=()=>{d([...n,Dt()])},Me=(t,r)=>{const w=[...n];w[t]=r,d(w)},Ke=t=>{d(n.filter((r,w)=>w!==t))},Ue=t=>{if(t===0)return;const r=[...n];[r[t-1],r[t]]=[r[t],r[t-1]],d(r)},Ge=t=>{if(t===n.length-1)return;const r=[...n];[r[t],r[t+1]]=[r[t+1],r[t]],d(r)},We=()=>{C([...j,_t()])},He=(t,r)=>{const w=[...j];w[t]=r,C(w)},qe=t=>{C(j.filter((r,w)=>w!==t))},Ze=t=>{if(t===0)return;const r=[...j];[r[t-1],r[t]]=[r[t],r[t-1]],C(r)},Je=t=>{if(t===j.length-1)return;const r=[...j];[r[t],r[t+1]]=[r[t+1],r[t]],C(r)},Ce=(t,r,w,A)=>{const K=t.current;if(K){const fe=K.selectionStart,tt=K.selectionEnd,je=`\${${A}}`,st=w.substring(0,fe)+je+w.substring(tt);r(st),setTimeout(()=>{K.focus(),K.setSelectionRange(fe+je.length,fe+je.length)},0)}else r(w+`\${${A}}`)},ze=()=>{let t=c+`

`;return j.length>0&&(t+=`Erstelle ein strukturiertes Briefing mit folgenden Abschnitten:

`,j.forEach((r,w)=>{t+=`### ${w+1}. ${r.title}
${r.instruction}

`})),l&&(t+=`
WICHTIG: ${l}`),t},Qe=()=>{const t=ze(),r=/\$\{(\w+)\}/g,w=[];let A;for(;(A=r.exec(t))!==null;)w.includes(A[1])||w.push(A[1]);return w},Be=()=>{const t=Qe(),r=n.map(A=>A.key).filter(A=>A.trim()),w=t.filter(A=>!r.includes(A));return{success:w.length===0,undefinedVars:w,usedVariables:t,definedKeys:r}},Ye=()=>{const t=Be();return W(t),t.success?N(null):(N(`Undefinierte Variablen im Prompt gefunden: ${t.undefinedVars.map(r=>"${"+r+"}").join(", ")}`),E("prompt")),t.success},Xe=()=>{if(!i.trim())return N("Bitte gib einen Titel ein."),E("basics"),!1;if(!c.trim())return N("Bitte definiere eine KI-Rolle."),E("prompt"),!1;if(j.length===0)return N("Bitte fÃ¼ge mindestens einen Abschnitt hinzu."),E("prompt"),!1;for(const r of j)if(!r.title.trim())return N("Alle Abschnitte benÃ¶tigen einen Titel."),E("prompt"),!1;for(const r of n){if(!r.key.trim()||!r.label.trim())return N("Alle Variablen benÃ¶tigen einen Namen und eine Bezeichnung."),E("variables"),!1;if(r.type==="select"&&(!r.options||r.options.length===0))return N(`Variable "${r.label}" benÃ¶tigt mindestens eine Auswahloption.`),E("variables"),!1}const t=Be();return W(t),t.success?!0:(N(`Undefinierte Variablen im Prompt: ${t.undefinedVars.map(r=>"${"+r+"}").join(", ")}. Bitte definiere diese Variablen unter "Eingabefelder".`),E("prompt"),!1)},et=async()=>{if(N(null),!!Xe()){O(!0);try{const t=n.map(A=>({key:A.key,label:A.label,type:A.type,required:A.required,placeholder:A.placeholder,...A.type==="select"?{options:A.options.map(K=>({value:K.value,label:K.label}))}:{}})),r={title:i.trim(),description:x.trim(),icon:y,ai_role:c,ai_task:JSON.stringify(j.map(A=>({title:A.title,instruction:A.instruction}))),ai_behavior:l,system_prompt:ze(),variables_schema:t,allow_user_variables:re,...u?{demo_code:u}:{}};let w;if(o?w=await U.request(`/smartbriefing/templates/${o.id}`,{method:"PUT",body:JSON.stringify(r)}):w=await U.request("/smartbriefing/templates",{method:"POST",body:JSON.stringify(r)}),w.success)f?.(w.data.template),g();else throw new Error(w.message||"Fehler beim Speichern")}catch(t){console.error("[CreateTemplateDialog] Save error:",t),N(t.message||"Fehler beim Speichern des Templates")}finally{O(!1)}}};return s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl w-full max-w-[750px] max-h-[90vh] flex flex-col shadow-2xl overflow-hidden",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-5 border-b border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"m-0 text-xl font-bold text-slate-900",children:o?"Template bearbeiten":"Neues Template erstellen"}),e.jsx("p",{className:"mt-1 mb-0 text-sm text-slate-500",children:"Erstelle ein persÃ¶nliches Briefing-Template"})]}),e.jsx("button",{onClick:g,className:"p-2 border-none bg-slate-100 rounded-lg cursor-pointer hover:bg-slate-200 transition-colors",children:e.jsx(lt,{size:20,className:"text-slate-500"})})]}),e.jsx("div",{className:"flex border-b border-slate-200 px-6",children:[{key:"basics",label:"1. Grundlagen"},{key:"variables",label:"2. Eingabefelder"},{key:"prompt",label:"3. KI-Anweisung"}].map(t=>e.jsx("button",{onClick:()=>E(t.key),className:`px-5 py-3 border-none bg-transparent text-sm font-semibold cursor-pointer -mb-px transition-all ${B===t.key?"text-primary border-b-[3px] border-primary":"text-slate-500 border-b-[3px] border-transparent hover:text-slate-700"}`,children:t.label},t.key))}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[v&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg px-4 py-3 mb-4 flex items-center gap-2",children:[e.jsx(q,{size:18,className:"text-red-500 flex-shrink-0"}),e.jsx("span",{className:"text-red-700 text-sm",children:v})]}),B==="basics"&&e.jsxs("div",{className:"flex flex-col gap-5",children:[!o&&e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-violet-50 rounded-xl p-4 border border-indigo-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(we,{size:18,className:"text-indigo-600"}),e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"Schnellstart mit Vorlage"})]}),e.jsx("select",{value:R,onChange:t=>D(t.target.value),className:"w-full px-3.5 py-3 rounded-xl border border-indigo-200 text-sm bg-white cursor-pointer",children:Re.map(t=>e.jsx("option",{value:t.key,children:t.label},t.key))}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Eine Vorlage fÃ¼llt Eingabefelder und KI-Anweisungen automatisch aus."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-1.5",children:"Titel *"}),e.jsx("input",{type:"text",value:i,onChange:t=>m(t.target.value),placeholder:"z.B. Sales Discovery Call Prep",className:"w-full px-3.5 py-3 rounded-xl border border-slate-200 text-[15px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-1.5",children:"Beschreibung"}),e.jsx("textarea",{value:x,onChange:t=>p(t.target.value),placeholder:"Kurze Beschreibung, wofÃ¼r dieses Template verwendet wird...",rows:3,className:"w-full px-3.5 py-3 rounded-xl border border-slate-200 text-sm resize-y"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-2",children:"Symbol"}),e.jsx(It,{selectedIcon:y,onSelect:h})]})]}),B==="variables"&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx($e,{size:16,className:"text-slate-500"}),e.jsxs("span",{className:"text-[13px] text-slate-500",children:["Definiere die Eingabefelder, die der Nutzer beim Erstellen eines Briefings ausfÃ¼llen soll. Diese kÃ¶nnen dann im Prompt als $","{variablenname}"," verwendet werden."]})]})}),n.map((t,r)=>e.jsx(Rt,{variable:t,index:r,total:n.length,onChange:w=>Me(r,w),onDelete:()=>Ke(r),onMoveUp:()=>Ue(r),onMoveDown:()=>Ge(r)},t.id)),e.jsxs("button",{onClick:Oe,className:"flex items-center justify-center gap-2 w-full px-3.5 py-3.5 rounded-xl border-2 border-dashed border-slate-300 bg-white text-slate-500 text-sm font-medium cursor-pointer transition-all hover:border-primary hover:text-primary",children:[e.jsx(L,{size:18}),"Eingabefeld hinzufÃ¼gen"]}),n.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"Noch keine Eingabefelder definiert."}),e.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:re,onChange:t=>H(t.target.checked),className:"w-5 h-5 accent-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:"Nutzer darf eigene Variablen hinzufÃ¼gen"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Wenn aktiviert, kann der Nutzer beim Erstellen eines Briefings eigene zusÃ¤tzliche Eingabefelder definieren."})]})]})})]}),B==="prompt"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"KI-Rolle *"}),n.length>0&&e.jsx(ye,{variables:n,onSelect:t=>Ce(ne,S,c,t)})]}),e.jsx("textarea",{ref:ne,value:c,onChange:t=>S(t.target.value),placeholder:"z.B. 'Du bist ein erfahrener Sales-Coach mit 15+ Jahren B2B-Vertriebserfahrung...'",rows:3,className:"w-full px-3.5 py-3 rounded-xl border border-slate-200 text-sm resize-y"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"Briefing-Abschnitte *"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[j.length," Abschnitt",j.length!==1?"e":""]})]}),j.map((t,r)=>e.jsx(Tt,{section:t,index:r,total:j.length,variables:n,onChange:w=>He(r,w),onDelete:()=>qe(r),onMoveUp:()=>Ze(r),onMoveDown:()=>Je(r)},t.id)),e.jsxs("button",{onClick:We,className:"flex items-center justify-center gap-2 w-full px-3.5 py-3 rounded-xl border-2 border-dashed border-indigo-300 bg-indigo-50/50 text-indigo-600 text-sm font-medium cursor-pointer transition-all hover:bg-indigo-100",children:[e.jsx(L,{size:18}),"Abschnitt hinzufÃ¼gen"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-semibold text-slate-900",children:"Verhalten & Stil (optional)"}),n.length>0&&e.jsx(ye,{variables:n,onSelect:t=>Ce(ae,z,l,t)})]}),e.jsx("textarea",{ref:ae,value:l,onChange:t=>z(t.target.value),placeholder:"z.B. 'Schreibe praxisnah und actionable. Vermeide Theorie - fokussiere auf konkrete Formulierungen.'",rows:2,className:"w-full px-3.5 py-3 rounded-xl border border-slate-200 text-sm resize-y"})]}),n.length>0&&e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx($e,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-semibold text-slate-500",children:"VerfÃ¼gbare Variablen (klicken zum Kopieren)"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(t=>e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(`\${${t.key}}`)},className:"inline-flex items-center gap-1.5 px-2.5 py-1.5 bg-white rounded-lg border border-slate-200 text-xs cursor-pointer hover:border-indigo-300 hover:bg-indigo-50 transition-colors",children:[e.jsx("span",{className:"text-slate-600",children:t.label}),e.jsxs("code",{className:"font-mono text-indigo-600",children:["$","{","$",t.key,"}"]}),e.jsx(ie,{size:12,className:"text-slate-400"})]},t.id))})]})]})]}),$&&e.jsx("div",{className:`px-6 py-3 border-t ${$.success?"bg-green-50 border-green-200":"bg-amber-50 border-amber-200"}`,children:e.jsx("div",{className:"flex items-center gap-2",children:$.success?e.jsxs(e.Fragment,{children:[e.jsx(ot,{size:18,className:"text-green-600"}),e.jsxs("span",{className:"text-green-700 text-sm font-medium",children:["Syntax OK - Alle ",$.usedVariables.length," Variablen sind definiert."]})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{size:18,className:"text-amber-600"}),e.jsxs("span",{className:"text-amber-700 text-sm",children:[e.jsx("strong",{children:"Undefinierte Variablen:"})," ",$.undefinedVars.map(t=>"${"+t+"}").join(", ")]})]})})}),e.jsxs("div",{className:"px-6 py-4 border-t border-slate-200 flex justify-between items-center gap-3",children:[e.jsx("button",{onClick:g,className:"px-6 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-50 transition-colors",children:"Abbrechen"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Ye,className:"flex items-center gap-2 px-4 py-3 rounded-xl border border-slate-200 bg-white text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-50 transition-colors",children:[e.jsx(ct,{size:16}),"Syntax prÃ¼fen"]}),e.jsx("button",{onClick:et,disabled:T,className:`flex items-center gap-2 px-6 py-3 rounded-xl border-none bg-brand-gradient text-white text-sm font-semibold transition-all ${T?"cursor-not-allowed opacity-70":"cursor-pointer"}`,children:T?e.jsxs(e.Fragment,{children:[e.jsx(ve,{size:18,className:"animate-spin"}),"Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(dt,{size:18}),o?"Speichern":"Template erstellen"]})})]})]})]})}),e.jsx(Se,{children:b&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[70] p-4",children:e.jsxs(le.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl w-full max-w-[420px] shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-amber-50",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(q,{size:24,className:"text-amber-600"}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Daten Ã¼berschreiben?"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:"text-slate-600 text-sm mb-4",children:["Du hast bereits Eingabefelder oder KI-Anweisungen definiert. Wenn du die Vorlage ",e.jsxs("strong",{children:['"',b.label,'"']})," anwendest, werden diese Daten Ã¼berschrieben."]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 mb-4",children:[e.jsx("p",{className:"text-xs text-slate-500 font-medium mb-1",children:"Was wird Ã¼berschrieben:"}),e.jsxs("ul",{className:"text-sm text-slate-600 space-y-1",children:[n.length>0&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),n.length," Eingabefeld",n.length!==1?"er":""]}),c&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),"KI-Rolle"]}),j.length>0&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),j.length," Briefing-Abschnitt",j.length!==1?"e":""]}),l&&e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full"}),"Verhalten & Stil"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Pe,className:"flex-1 px-4 py-2.5 rounded-xl border border-slate-200 bg-white text-slate-700 font-medium text-sm cursor-pointer hover:bg-slate-50 transition-colors",children:"Abbrechen"}),e.jsx("button",{onClick:()=>M(b),className:"flex-1 px-4 py-2.5 rounded-xl border-none bg-amber-500 text-white font-medium text-sm cursor-pointer hover:bg-amber-600 transition-colors",children:"Ãœberschreiben"})]})]})]})})})]}):null},_={DASHBOARD:"dashboard",FORM:"form",RESULT:"result",LIST:"list",WORKBOOK:"workbook"},Qt=({isAuthenticated:s,requireAuth:g,setPendingAction:f,onNavigateToSimulator:o,onNavigateToHistory:u,demoCode:i})=>{const[m,x]=a.useState(_.DASHBOARD),[p,y]=a.useState(null),[h,n]=a.useState(null),[d,c]=a.useState(null),[S,j]=a.useState(null),[C,l]=a.useState(!1),[z,R]=a.useState(null),[I,T]=a.useState(0);a.useEffect(()=>{S&&s&&(y(S),x(_.FORM),j(null))},[S,s]),a.useEffect(()=>{window.scrollTo(0,0)},[m]);const O=a.useCallback(D=>{y(D),x(_.FORM)},[]),v=a.useCallback(()=>{y(null),n(null),c(null),x(_.DASHBOARD)},[]),N=a.useCallback(D=>{n(D),c(D),x(_.WORKBOOK)},[]),B=a.useCallback(()=>{n(null),c(null),y(null),x(_.DASHBOARD)},[]),E=a.useCallback(()=>{n(null),c(null),x(_.FORM)},[]);a.useCallback(()=>{x(_.LIST)},[]);const b=a.useCallback(D=>{c(D),x(_.WORKBOOK)},[]);a.useCallback(()=>{c(null),x(_.LIST)},[]);const k=a.useCallback(D=>{o&&o(D)},[o]),$=a.useCallback(async D=>{try{if((await U.request(`/smartbriefing/briefings/${D.id}`,{method:"DELETE"})).success)c(null),x(_.DASHBOARD);else throw new Error("Fehler beim LÃ¶schen")}catch(M){throw console.error("[SmartBriefing] Error deleting briefing:",M),M}},[]),W=a.useCallback(()=>{R(null),l(!0)},[]),re=a.useCallback(D=>{R(D),l(!0)},[]),H=a.useCallback(D=>{R(D),l(!0)},[]),ne=a.useCallback(()=>{l(!1),R(null)},[]),ae=a.useCallback(D=>{T(M=>M+1)},[]),ge=()=>{switch(m){case _.FORM:return e.jsx(wt,{template:p,onBack:v,onBriefingGenerated:N,isAuthenticated:s});case _.RESULT:return e.jsx(Ct,{briefing:h,template:p,onBack:v,onCreateNew:B,onGenerateAnother:E});case _.LIST:return e.jsx(At,{onOpenBriefing:b,onCreateNew:B,isAuthenticated:s});case _.WORKBOOK:return e.jsx(ft,{briefing:d,onBack:v,onDelete:$,onStartSimulation:o?k:null});case _.DASHBOARD:default:return e.jsx(Nt,{onSelectTemplate:O,onShowList:u,onCreateTemplate:W,onEditTemplate:re,onCopyTemplate:H,isAuthenticated:s,requireAuth:g,setPendingAction:f,demoCode:i},I)}};return e.jsxs("div",{className:"min-h-full",children:[ge(),e.jsx(Vt,{isOpen:C,onClose:ne,onSave:ae,editTemplate:z,demoCode:i})]})};export{At as BriefingList,Ct as BriefingResult,ft as BriefingWorkbook,Qt as SmartBriefingApp,Nt as SmartBriefingDashboard,wt as SmartBriefingForm};
