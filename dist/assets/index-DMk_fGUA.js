import{j as e,O as M,F as L,h as fe,y as V,ae as _,au as Se,q as we,av as Ce,ad as ve,R as H,C as G,c as q,a0 as Y,aw as Z,ax as J,a8 as Q,T as X,as as ee,w as te,U as ne,aj as re,B as se,v as ue,x as be,e as me,z as ie,a as ye,Q as je,n as ae,ay as de,Y as ce,t as ze,az as pe,l as oe,m as ke,X as Be,aA as Ie,aB as Re,aC as Te,A as Ee}from"./ui-vendor-B9DEMv6g.js";import{a as l}from"./react-vendor-uDOJF2jQ.js";import{w as N,h as De,F as We,u as le,D as xe}from"./FeatureInfoButton-DsfjgKw4.js";import{S as $e}from"./ScenarioDashboard-Db_QZFbt.js";import{B as ge}from"./Button-BHvYxNT_.js";import"./select-native-BMh_kGEB.js";import"./dialog-Dg1K-ctH.js";import{F as Ae}from"./fullscreen-loader-CGHRnDJu.js";import{a as Fe,B as Le}from"./BriefingWorkbook-CWOSsrO3.js";import{u as Oe}from"./useBranding-CjHnMPMs.js";import{u as _e}from"./useMobile-YxjH166V.js";import"./ScenarioCard-OpqbSsPm.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";const Ne={"file-text":L,briefcase:se,banknote:re,users:ne,user:te,"message-circle":ee,target:X,award:Q,book:J,clipboard:Z,star:Y,lightbulb:V,shield:q,compass:G,rocket:H,heart:ve,folder:Ce,"trending-up":we},Pe=({onSelectTemplate:t,onShowList:x,onCreateTemplate:h,onEditTemplate:a,isAuthenticated:m,requireAuth:d,setPendingAction:i,demoCode:n})=>{const[p,s]=l.useState(null),[y,g]=l.useState(0),c=l.useCallback(async()=>{const b=new URLSearchParams;n&&b.append("demo_code",n);const B=await N.request(`/smartbriefing/templates?${b.toString()}`,{method:"GET"});if(B.success&&B.data?.templates)return B.data.templates;throw new Error("Unerwartete API-Antwort")},[n,y]),f=()=>{if(!m&&!n){d&&(i(()=>h),d());return}h?.()},j=(b,B)=>{b.stopPropagation(),a?.(B)},S=(b,B)=>{b.stopPropagation(),s(B)},u=async()=>{if(p)try{const b=new URLSearchParams;n&&b.append("demo_code",n),(await N.request(`/smartbriefing/templates/${p.id}?${b.toString()}`,{method:"DELETE"})).success&&g(O=>O+1)}catch(b){console.error("[SmartBriefing] Error deleting template:",b)}finally{s(null)}},w=b=>Ne[b.icon]||L,o=b=>{const B=b.variables_schema?.length||0;return[{text:`${B} Eingabefeld${B!==1?"er":""}`}]},v=b=>b.is_custom?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:B=>j(B,b),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-slate-100 hover:text-primary",title:"Template bearbeiten",children:e.jsx(Se,{size:16})}),e.jsx("button",{onClick:B=>S(B,b),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-red-50 hover:text-red-500",title:"Template löschen",children:e.jsx(M,{size:16})})]}):null,R=(m||n)&&h?e.jsxs("button",{onClick:f,className:"flex items-center gap-2 py-2.5 px-4 rounded-[10px] border-2 border-dashed border-slate-300 bg-white text-slate-500 text-sm font-medium cursor-pointer transition-all whitespace-nowrap hover:border-primary hover:text-primary",children:[e.jsx(_,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"persönliches Template"}),e.jsx("span",{className:"sm:hidden",children:"Template"})]}):null,W=()=>e.jsx("div",{className:"mt-12 py-5 px-6 bg-primary/5 rounded-xl border border-primary/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{size:20,className:"text-primary flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-1",children:"So funktioniert Smart Briefing"}),e.jsx("p",{className:"text-[13px] text-slate-500 leading-relaxed",children:"Wähle ein Template aus, gib deine spezifischen Informationen ein (z.B. Unternehmen, Position), und erhalte ein maßgeschneidertes Briefing mit Insider-Wissen, Fachbegriffen und cleveren Rückfragen."})]})]})}),$=p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>s(null),children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-[400px] w-full shadow-2xl",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-50 flex items-center justify-center",children:e.jsx(M,{size:24,className:"text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Template löschen?"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Diese Aktion kann nicht rückgängig gemacht werden."})]})]}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-3 mb-5",children:e.jsx("p",{className:"text-sm text-slate-600",children:e.jsx("strong",{children:p.title})})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(ge,{variant:"secondary",onClick:()=>s(null),children:"Abbrechen"}),e.jsx(ge,{variant:"danger",onClick:u,children:"Löschen"})]})]})});return e.jsxs(e.Fragment,{children:[e.jsx(De,{featureId:"smartbriefing",showOnMount:!0}),e.jsx($e,{title:"Smart Briefing",subtitle:"Dein KI-gestützter Vorbereitungs-Assistent",headerIcon:L,headerActions:e.jsx(We,{featureId:"smartbriefing",size:"sm"}),fetchScenarios:c,moduleKey:"briefings",historyButtonLabel:"Meine Briefings",onNavigateToHistory:x,onSelectScenario:t,renderCardMeta:o,getIconForScenario:w,getCardCustomActions:v,cardActionLabel:"Briefing erstellen",cardActionIcon:fe,categoryField:"category",emptyStateIcon:L,emptyStateTitle:"Keine Templates gefunden",emptyStateMessage:"Es wurden noch keine Briefing-Templates erstellt.",searchPlaceholder:"Briefings durchsuchen...",filterActions:R,renderInfoBox:W,extraContent:$,isAuthenticated:m,requireAuth:d,setPendingAction:i,demoCode:n,loadingMessage:"Templates werden geladen..."},y)]})},Me=({field:t,value:x,onChange:h,error:a,primaryAccent:m})=>{const d={width:"100%",padding:"14px 16px",borderRadius:"12px",border:`2px solid ${a?"#ef4444":"#e2e8f0"}`,fontSize:"16px",color:"#0f172a",backgroundColor:"white",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",boxSizing:"border-box"},i=s=>{s.target.style.borderColor=m,s.target.style.boxShadow=`0 0 0 3px ${m}1a`},n=s=>{s.target.style.borderColor=a?"#ef4444":"#e2e8f0",s.target.style.boxShadow="none"},p=()=>{switch(t.type){case"textarea":return e.jsx("textarea",{value:x||"",onChange:s=>h(t.key,s.target.value),placeholder:t.placeholder||"",rows:4,style:{...d,minHeight:"120px",resize:"vertical"},onFocus:i,onBlur:n});case"select":return e.jsxs("select",{value:x||t.default||"",onChange:s=>h(t.key,s.target.value),style:{...d,cursor:"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center",backgroundSize:"20px",paddingRight:"44px"},onFocus:i,onBlur:n,children:[e.jsx("option",{value:"",children:"Bitte wahlen..."}),t.options?.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]});case"text":default:return e.jsx("input",{type:"text",value:x||"",onChange:s=>h(t.key,s.target.value),placeholder:t.placeholder||"",style:d,onFocus:i,onBlur:n})}};return e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#374151",marginBottom:"8px"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"4px"},children:"*"})]}),p(),a&&e.jsx("p",{style:{color:"#ef4444",fontSize:"13px",marginTop:"6px",margin:"6px 0 0 0"},children:a})]})},Ve=({variable:t,index:x,onChange:h,onDelete:a,primaryAccent:m})=>e.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"12px",marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsx("input",{type:"text",value:t.key||"",onChange:d=>h(x,"key",d.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")),placeholder:"variable_name",style:{padding:"8px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",backgroundColor:"#f8fafc",flex:1,marginRight:"8px"}}),e.jsx("button",{type:"button",onClick:()=>a(x),style:{padding:"8px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(M,{size:18})})]}),e.jsx("textarea",{value:t.value||"",onChange:d=>h(x,"value",d.target.value),placeholder:"Wert eingeben... (mehrzeilig möglich)",rows:3,style:{width:"100%",padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",resize:"vertical",minHeight:"80px",boxSizing:"border-box"}})]}),Ke=({template:t,onBack:x,onBriefingGenerated:h,isAuthenticated:a})=>{const{branding:m}=le(),[d,i]=l.useState({}),[n,p]=l.useState({}),[s,y]=l.useState(!1),[g,c]=l.useState(null),[f,j]=l.useState([]),[S,u]=l.useState(!1),w=m?.["--primary-accent"]||xe["--primary-accent"],o=m?.["--button-gradient"]||xe["--button-gradient"],v=Fe(t?.icon);l.useEffect(()=>{if(t?.variables_schema){const C={};t.variables_schema.forEach(z=>{z.default&&(C[z.key]=z.default)}),i(C)}j([]),u(!1)},[t]);const R=()=>{j([...f,{key:"",value:""}])},W=(C,z,I)=>{const A=[...f];A[C][z]=I,j(A)},$=C=>{j(f.filter((z,I)=>I!==C))},b=(C,z)=>{i(I=>({...I,[C]:z})),n[C]&&p(I=>{const A={...I};return delete A[C],A})},B=()=>{const C={};return t?.variables_schema?.forEach(z=>{z.required&&!d[z.key]&&(C[z.key]="Dieses Feld ist erforderlich")}),C},O=async C=>{C.preventDefault();const z=B();if(Object.keys(z).length>0){p(z);return}y(!0),c(null);try{const I={};f.forEach(r=>{r.key&&r.value&&(I[r.key]=r.value)});const A={template_id:t.id,variables:d};Object.keys(I).length>0&&(A.custom_variables=I);const P=await N.request("/smartbriefing/generate",{method:"POST",body:JSON.stringify(A)});if(P.success&&P.data?.briefing)h(P.data.briefing);else throw new Error("Unerwartete API-Antwort")}catch(I){console.error("[SmartBriefing] Error generating briefing:",I),c(I.message||"Fehler beim Generieren des Briefings")}finally{y(!1)}};return t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{padding:"24px",paddingTop:"32px",maxWidth:"700px",margin:"0 auto"},children:[e.jsxs("button",{onClick:x,disabled:s,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 0",border:"none",background:"none",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:s?"not-allowed":"pointer",marginBottom:"24px",opacity:s?.5:1},children:[e.jsx(ue,{size:18}),e.jsx("span",{style:{lineHeight:"1.4"},children:"Zurück zur Übersicht"})]}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"12px",background:`linear-gradient(135deg, ${w}15, ${w}25)`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(v,{size:28,style:{color:w}})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"22px",fontWeight:700,color:"#0f172a",margin:"0 0 4px 0"},children:t.title}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:t.description})]})]})}),e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h2",{style:{fontSize:"16px",fontWeight:600,color:"#0f172a",margin:"0 0 20px 0",paddingBottom:"16px",borderBottom:"1px solid #f1f5f9"},children:"Deine Angaben"}),e.jsxs("form",{onSubmit:O,children:[t.variables_schema?.map(C=>e.jsx(Me,{field:C,value:d[C.key],onChange:b,error:n[C.key],primaryAccent:w},C.key)),t.allow_custom_variables&&e.jsxs("div",{style:{marginTop:"24px",marginBottom:"20px",paddingTop:"20px",borderTop:"1px solid #f1f5f9"},children:[e.jsxs("button",{type:"button",onClick:()=>u(!S),style:{display:"flex",alignItems:"flex-start",gap:"8px",padding:"0",border:"none",background:"none",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",marginBottom:S?"16px":"0",textAlign:"left"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0},children:[S?e.jsx(be,{size:18}):e.jsx(me,{size:18}),e.jsx(_,{size:16})]}),e.jsx("span",{style:{lineHeight:"1.4"},children:"Zusätzliche Variablen hinzufügen (optional)"})]}),S&&e.jsxs("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",padding:"16px"},children:[e.jsx("p",{style:{fontSize:"13px",color:"#64748b",margin:"0 0 12px 0"},children:"Füge eigene Variablen hinzu, die in die Briefing-Generierung einfließen sollen."}),f.length>0&&e.jsx("div",{style:{marginBottom:"12px"},children:f.map((C,z)=>e.jsx(Ve,{variable:C,index:z,onChange:W,onDelete:$,primaryAccent:w},z))}),e.jsxs("button",{type:"button",onClick:R,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",border:"1px dashed #cbd5e1",borderRadius:"8px",backgroundColor:"white",color:"#64748b",fontSize:"13px",cursor:"pointer"},children:[e.jsx(_,{size:14}),"Variable hinzufügen"]})]})]}),g&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"16px",marginBottom:"20px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(ie,{size:20,style:{color:"#ef4444",flexShrink:0}}),e.jsx("div",{children:e.jsx("p",{style:{margin:0,color:"#991b1b",fontSize:"14px"},children:g})})]}),e.jsxs("button",{type:"submit",disabled:s,style:{width:"100%",padding:"16px 24px",borderRadius:"12px",border:"none",background:o,color:"white",fontSize:"16px",fontWeight:600,cursor:s?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",transition:"all 0.2s",boxShadow:`0 4px 14px ${w}40`,opacity:s?.7:1},children:[e.jsx(ye,{size:20}),"Briefing generieren"]})]})]})]}),e.jsx(Ae,{isLoading:s,message:"Smart Briefing wird erstellt...",subMessage:"Die KI analysiert deine Angaben und erstellt ein maßgeschneidertes Briefing."})]}):null},Ue={"file-text":L,briefcase:se,banknote:re,users:ne,user:te,"message-circle":ee,target:X,award:Q,book:J,clipboard:Z,star:Y,lightbulb:V,shield:q,compass:G,rocket:H},He=({content:t,primaryAccent:x})=>{if(!t)return null;const h=m=>{const d=m.split(`
`),i=[];let n=[],p=null;const s=()=>{n.length>0&&(i.push(e.jsx("ul",{style:{margin:"12px 0",paddingLeft:"24px",listStyle:"none"},children:n.map((y,g)=>e.jsxs("li",{style:{marginBottom:"8px",fontSize:"15px",lineHeight:1.6,color:"#374151",position:"relative",paddingLeft:"20px"},children:[e.jsx("span",{style:{position:"absolute",left:0,color:x,fontWeight:"bold"},children:p==="number"?`${g+1}.`:""}),a(y)]},g))},`list-${i.length}`)),n=[],p=null)};return d.forEach((y,g)=>{const c=y.trim();if(!c){s();return}if(c.startsWith("### ")){s(),i.push(e.jsx("h3",{style:{fontSize:"18px",fontWeight:700,color:"#0f172a",margin:"24px 0 12px 0",paddingTop:"16px",borderTop:g>0?"1px solid #f1f5f9":"none",display:"flex",alignItems:"center",gap:"8px"},children:a(c.substring(4))},`h3-${g}`));return}if(c.startsWith("## ")){s(),i.push(e.jsx("h2",{style:{fontSize:"20px",fontWeight:700,color:"#0f172a",margin:"28px 0 14px 0"},children:a(c.substring(3))},`h2-${g}`));return}if(c.startsWith("# ")){s(),i.push(e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:"#0f172a",margin:"32px 0 16px 0"},children:a(c.substring(2))},`h1-${g}`));return}if(c.startsWith("- ")||c.startsWith("* ")){p!=="bullet"&&(s(),p="bullet"),n.push(c.substring(2));return}const f=c.match(/^(\d+)\.\s/);if(f){p!=="number"&&(s(),p="number"),n.push(c.substring(f[0].length));return}s(),i.push(e.jsx("p",{style:{margin:"12px 0",fontSize:"15px",lineHeight:1.7,color:"#374151"},children:a(c)},`p-${g}`))}),s(),i},a=m=>{const d=[];let i=m,n=0;for(;i.length>0;){const p=i.match(/\*\*(.+?)\*\*/),s=i.match(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)|_([^_]+)_")),y=i.match(/`([^`]+)`/),g=[{match:p,type:"bold"},{match:s,type:"italic"},{match:y,type:"code"}].filter(f=>f.match);if(g.length===0){d.push(i);break}const c=g.reduce((f,j)=>(f.match?.index??1/0)<(j.match?.index??1/0)?f:j);switch(c.match.index>0&&d.push(i.substring(0,c.match.index)),c.type){case"bold":d.push(e.jsx("strong",{style:{fontWeight:600,color:"#0f172a"},children:c.match[1]},n++));break;case"italic":d.push(e.jsx("em",{style:{fontStyle:"italic"},children:c.match[1]||c.match[2]},n++));break;case"code":d.push(e.jsx("code",{style:{backgroundColor:"#f1f5f9",padding:"2px 6px",borderRadius:"4px",fontSize:"13px",fontFamily:"monospace",color:x},children:c.match[1]},n++));break}i=i.substring(c.match.index+c.match[0].length)}return d};return e.jsx("div",{children:h(t)})},Ge=({briefing:t,template:x,onBack:h,onCreateNew:a,onGenerateAnother:m})=>{const d=Oe(),i=_e(),[n,p]=l.useState(!1),s=l.useRef(null),y=d.primaryAccent,g=d.headerGradient,c=Ue[x?.icon||t?.template_icon]||L,f=u=>u?new Date(u).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",j=async()=>{try{await navigator.clipboard.writeText(t.content_markdown),p(!0),setTimeout(()=>p(!1),2e3)}catch(u){console.error("[SmartBriefing] Failed to copy:",u)}},S=()=>{const u=`${x?.title||t?.template_title}
${"=".repeat(50)}

Erstellt am: ${f(t.created_at)}

${t.content_markdown}`,w=new Blob([u],{type:"text/plain;charset=utf-8"}),o=URL.createObjectURL(w),v=document.createElement("a");v.href=o,v.download=`briefing-${t.id}.txt`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(o)};return t?e.jsxs("div",{style:{minHeight:"100vh",background:d.pageBg},children:[e.jsx("div",{style:{background:g,padding:i?"20px 16px":"24px 32px",position:"sticky",top:0,zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[h&&e.jsxs("button",{onClick:h,style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",color:"#fff",fontSize:"13px",marginBottom:"16px"},children:[e.jsx(ue,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{style:{display:"flex",alignItems:i?"flex-start":"center",gap:i?"16px":"24px",flexDirection:i?"column":"row"},children:[e.jsx("div",{style:{width:i?70:90,height:i?70:90,borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(c,{size:i?32:40,color:"#fff"})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.2)",color:"#fff"},children:"Smart Briefing"}),e.jsxs("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.9)",color:y,display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(ye,{size:12}),"Fertig!"]})]}),e.jsx("h1",{style:{fontSize:i?"20px":"24px",fontWeight:700,color:"#fff",margin:0,marginBottom:"8px"},children:x?.title||t?.template_title}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(je,{size:14}),f(t.created_at)]})})]}),!i&&e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("button",{onClick:j,style:{display:"flex",alignItems:"center",gap:"8px",background:n?"rgba(34,197,94,0.3)":"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[n?e.jsx(ae,{size:16}):e.jsx(de,{size:16}),n?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:S,style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[e.jsx(ce,{size:16}),"Speichern"]})]})]})]})}),e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:i?"16px":"24px 32px"},children:[i&&e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[e.jsxs("button",{onClick:j,style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"12px",borderRadius:"10px",border:`1px solid ${d.borderColor}`,backgroundColor:n?"#dcfce7":"white",color:n?"#16a34a":d.textSecondary,fontSize:"13px",fontWeight:500,cursor:"pointer"},children:[n?e.jsx(ae,{size:16}):e.jsx(de,{size:16}),n?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:S,style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"12px",borderRadius:"10px",border:`1px solid ${d.borderColor}`,backgroundColor:"white",color:d.textSecondary,fontSize:"13px",fontWeight:500,cursor:"pointer"},children:[e.jsx(ce,{size:16}),"Speichern"]})]}),e.jsx("div",{ref:s,style:{backgroundColor:"white",borderRadius:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden",border:`1px solid ${d.borderColor}`},children:e.jsx("div",{style:{padding:i?"20px":"32px"},children:e.jsx(He,{content:t.content_markdown,primaryAccent:y})})}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"24px",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:m,style:{flex:1,minWidth:"200px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:`2px solid ${y}`,backgroundColor:"white",color:y,fontSize:"15px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(ze,{size:18}),"Mit anderen Angaben neu generieren"]}),e.jsxs("button",{onClick:a,style:{flex:1,minWidth:"200px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${y}, ${y}dd)`,color:"white",fontSize:"15px",fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:`0 4px 14px ${y}40`},children:[e.jsx(_,{size:18}),"Neues Briefing erstellen"]})]})]})]}):null},qe={"file-text":L,briefcase:se,banknote:re,users:ne,user:te,"message-circle":ee,target:X,award:Q,book:J,clipboard:Z,star:Y,lightbulb:V,shield:q,compass:G,rocket:H},Ye=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",Ze=({briefing:t,onOpen:x,onDelete:h,primaryAccent:a,isDeleting:m})=>{const[d,i]=l.useState(!1),[n,p]=l.useState(!1),s=qe[t.template_icon]||L,y=g=>{g.stopPropagation(),n?(h(t.id),p(!1)):(p(!0),setTimeout(()=>p(!1),3e3))};return e.jsxs("div",{onClick:()=>x(t),onMouseEnter:()=>i(!0),onMouseLeave:()=>{i(!1),p(!1)},style:{backgroundColor:"white",borderRadius:"16px",padding:"20px",border:`2px solid ${d?a:"#e2e8f0"}`,boxShadow:d?`0 10px 25px -5px rgba(0,0,0,0.1), 0 0 0 1px ${a}20`:"0 1px 3px rgba(0,0,0,0.1)",cursor:"pointer",transition:"all 0.3s ease",transform:d?"translateY(-2px)":"translateY(0)",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"10px",background:`linear-gradient(135deg, ${a}15, ${a}25)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(s,{size:22,style:{color:a}})}),e.jsx("button",{onClick:y,disabled:m,style:{padding:"8px",borderRadius:"8px",border:"none",backgroundColor:n?"#fef2f2":d?"#f1f5f9":"transparent",color:n?"#ef4444":"#94a3b8",cursor:m?"not-allowed":"pointer",transition:"all 0.2s",opacity:d||n?1:0},children:m?e.jsx(oe,{size:18,style:{animation:"spin 1s linear infinite"}}):e.jsx(M,{size:18})})]}),e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#0f172a",margin:"0 0 4px 0",lineHeight:1.3,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.title||"Unbenanntes Briefing"}),e.jsx("p",{style:{fontSize:"13px",color:"#64748b",margin:"0 0 12px 0"},children:t.template_title}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"12px",borderTop:"1px solid #f1f5f9"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#94a3b8",fontSize:"12px"},children:[e.jsx(je,{size:14}),Ye(t.created_at)]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:a,fontSize:"13px",fontWeight:500},children:["Offnen",e.jsx(fe,{size:16})]})]}),n&&e.jsx("div",{style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"8px 12px",fontSize:"12px",color:"#dc2626",fontWeight:500,zIndex:10},onClick:g=>g.stopPropagation(),children:"Nochmal klicken zum Loschen"}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})},Je=({onOpenBriefing:t,onCreateNew:x,isAuthenticated:h})=>{const{config:a}=le(),[m,d]=l.useState([]),[i,n]=l.useState(!0),[p,s]=l.useState(null),[y,g]=l.useState(null),c=a?.buttonGradientStart||"#3A7FA7";l.useEffect(()=>{(async()=>{if(!h){n(!1);return}try{n(!0),s(null);const S=await N.request("/smartbriefing/briefings",{method:"GET"});if(S.success&&S.data?.briefings){const u=S.data.briefings.filter(w=>w.status==="completed");d(u)}else throw new Error("Unerwartete API-Antwort")}catch(S){console.error("[SmartBriefing] Error fetching briefings:",S),s(S.message||"Fehler beim Laden der Briefings")}finally{n(!1)}})()},[h]);const f=async j=>{try{if(g(j),(await N.request(`/smartbriefing/briefings/${j}`,{method:"DELETE"})).success)d(u=>u.filter(w=>w.id!==j));else throw new Error("Fehler beim Loschen")}catch(S){console.error("[SmartBriefing] Error deleting briefing:",S),s(S.message||"Fehler beim Loschen des Briefings")}finally{g(null)}};return h?e.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:"#0f172a",margin:"0 0 4px 0"},children:"Meine Briefings"}),e.jsxs("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:[m.length," gespeicherte Briefings"]})]}),e.jsxs("button",{onClick:x,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${c}, ${c}dd)`,color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer",boxShadow:`0 4px 14px ${c}40`},children:[e.jsx(_,{size:18}),"Neues Briefing"]})]}),i&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"64px 24px"},children:[e.jsx(oe,{size:40,style:{color:c,animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{marginTop:"16px",color:"#64748b"},children:"Briefings werden geladen..."})]}),p&&!i&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"24px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(ie,{size:24,style:{color:"#ef4444",flexShrink:0}}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px 0",color:"#dc2626",fontSize:"16px"},children:"Fehler beim Laden"}),e.jsx("p",{style:{margin:0,color:"#991b1b",fontSize:"14px"},children:p})]})]}),!i&&!p&&e.jsx(e.Fragment,{children:m.length===0?e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"48px 24px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx(pe,{size:48,style:{color:"#cbd5e1",marginBottom:"16px"}}),e.jsx("h2",{style:{color:"#64748b",margin:"0 0 8px 0",fontSize:"18px"},children:"Noch keine Briefings"}),e.jsx("p",{style:{color:"#94a3b8",margin:"0 0 24px 0",fontSize:"14px"},children:"Erstelle dein erstes Briefing, um loszulegen."}),e.jsxs("button",{onClick:x,style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${c}, ${c}dd)`,color:"white",fontSize:"15px",fontWeight:600,cursor:"pointer",boxShadow:`0 4px 14px ${c}40`},children:[e.jsx(_,{size:18}),"Briefing erstellen"]})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:m.map(j=>e.jsx(Ze,{briefing:j,onOpen:t,onDelete:f,primaryAccent:c,isDeleting:y===j.id},j.id))})})]}):e.jsx("div",{style:{padding:"24px",maxWidth:"800px",margin:"0 auto"},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"48px 24px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx(pe,{size:48,style:{color:"#cbd5e1",marginBottom:"16px"}}),e.jsx("h2",{style:{color:"#64748b",margin:"0 0 8px 0",fontSize:"18px"},children:"Anmeldung erforderlich"}),e.jsx("p",{style:{color:"#94a3b8",margin:"0 0 24px 0",fontSize:"14px"},children:"Melde dich an, um deine gespeicherten Briefings zu sehen."})]})})},Qe=[{key:"file-text",icon:L,label:"Dokument"},{key:"briefcase",icon:se,label:"Koffer"},{key:"banknote",icon:re,label:"Geld"},{key:"users",icon:ne,label:"Team"},{key:"user",icon:te,label:"Person"},{key:"target",icon:X,label:"Ziel"},{key:"lightbulb",icon:V,label:"Idee"},{key:"star",icon:Y,label:"Stern"},{key:"shield",icon:q,label:"Schutz"},{key:"compass",icon:G,label:"Kompass"},{key:"rocket",icon:H,label:"Rakete"},{key:"message-circle",icon:ee,label:"Nachricht"},{key:"award",icon:Q,label:"Auszeichnung"},{key:"book",icon:J,label:"Buch"},{key:"clipboard",icon:Z,label:"Checkliste"}],he=[{value:"text",label:"Einzeiliges Textfeld"},{value:"textarea",label:"Mehrzeiliges Textfeld"},{value:"select",label:"Dropdown-Auswahl"}],U=()=>`var_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Xe=()=>({id:U(),key:"",label:"",type:"text",required:!0,placeholder:"",options:[]}),et=()=>({id:U(),value:"",label:""}),tt=({variable:t,index:x,total:h,onChange:a,onDelete:m,onMoveUp:d,onMoveDown:i,primaryAccent:n})=>{const[p,s]=l.useState(!0),[y,g]=l.useState(t.label);l.useEffect(()=>{g(t.label)},[t.label]);const c=(o,v)=>{a({...t,[o]:v})},f=()=>{const o=[...t.options||[],et()];a({...t,options:o})},j=(o,v,R)=>{const W=t.options.map($=>$.id===o?{...$,[v]:R}:$);a({...t,options:W})},S=o=>{const v=t.options.filter(R=>R.id!==o);a({...t,options:v})},u=o=>o.toLowerCase().replace(/[äöüß]/g,v=>({ä:"ae",ö:"oe",ü:"ue",ß:"ss"})[v]).replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),w=()=>{if(y!==t.label){const o={label:y};(!t.key||t.key===u(t.label))&&(o.key=u(y)),a({...t,...o})}};return e.jsxs("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0",marginBottom:"12px",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",backgroundColor:"white",borderBottom:p?"1px solid #e2e8f0":"none",cursor:"pointer"},onClick:()=>s(!p),children:[e.jsx(Te,{size:16,style:{color:"#94a3b8",cursor:"grab"}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("span",{style:{fontWeight:600,color:"#0f172a",fontSize:"14px"},children:t.label||`Variable ${x+1}`}),t.key&&e.jsxs("span",{style:{marginLeft:"8px",color:"#64748b",fontSize:"12px"},children:["$","{","$",t.key,"}"]})]}),e.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:500,backgroundColor:`${n}15`,color:n},children:he.find(o=>o.value===t.type)?.label||t.type}),e.jsxs("div",{style:{display:"flex",gap:"2px"},children:[e.jsx("button",{onClick:o=>{o.stopPropagation(),d()},disabled:x===0,style:{padding:"4px",border:"none",backgroundColor:"transparent",cursor:x===0?"not-allowed":"pointer",opacity:x===0?.3:1},children:e.jsx(be,{size:16,style:{color:"#64748b"}})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),i()},disabled:x===h-1,style:{padding:"4px",border:"none",backgroundColor:"transparent",cursor:x===h-1?"not-allowed":"pointer",opacity:x===h-1?.3:1},children:e.jsx(me,{size:16,style:{color:"#64748b"}})})]}),e.jsx("button",{onClick:o=>{o.stopPropagation(),m()},style:{padding:"6px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444"},title:"Variable löschen",children:e.jsx(M,{size:16})})]}),e.jsx(Ee,{children:p&&e.jsx(ke.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Feldbezeichnung *"}),e.jsx("input",{type:"text",value:y,onChange:o=>g(o.target.value),onBlur:w,placeholder:"z.B. Unternehmen",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Variablenname *"}),e.jsx("input",{type:"text",value:t.key,onChange:o=>c("key",o.target.value),placeholder:"z.B. unternehmen",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Feldtyp"}),e.jsx("select",{value:t.type,onChange:o=>c("type",o.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",backgroundColor:"white"},children:he.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 0",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:t.required,onChange:o=>c("required",o.target.checked),style:{width:"16px",height:"16px",accentColor:n}}),e.jsx("span",{style:{fontSize:"14px",color:"#475569"},children:"Pflichtfeld"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Platzhalter-Text (optional)"}),e.jsx("input",{type:"text",value:t.placeholder,onChange:o=>c("placeholder",o.target.value),placeholder:"z.B. BMW AG, Siemens, etc.",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"}})]}),t.type==="select"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"8px"},children:"Auswahloptionen"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(t.options||[]).map((o,v)=>e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx("input",{type:"text",value:o.value,onChange:R=>j(o.id,"value",R.target.value),placeholder:"Wert",style:{flex:1,padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px",fontFamily:"monospace"}}),e.jsx("input",{type:"text",value:o.label,onChange:R=>j(o.id,"label",R.target.value),placeholder:"Anzeigename",style:{flex:2,padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px"}}),e.jsx("button",{onClick:()=>S(o.id),style:{padding:"6px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444"},children:e.jsx(M,{size:14})})]},o.id)),e.jsxs("button",{onClick:f,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",border:"1px dashed #cbd5e1",borderRadius:"6px",backgroundColor:"transparent",color:"#64748b",fontSize:"13px",cursor:"pointer",marginTop:"4px"},children:[e.jsx(_,{size:14}),"Option hinzufügen"]})]})]})]})})})]})},nt=({selectedIcon:t,onSelect:x,primaryAccent:h})=>e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px"},children:Qe.map(({key:a,icon:m,label:d})=>{const i=t===a;return e.jsx("button",{onClick:()=>x(a),title:d,style:{width:"60px",height:"60px",borderRadius:"12px",border:`2px solid ${i?h:"#e2e8f0"}`,backgroundColor:i?`${h}15`:"white",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},children:e.jsx(m,{size:28,style:{color:i?h:"#64748b"}})},a)})}),rt=({isOpen:t,onClose:x,onSave:h,editTemplate:a=null,demoCode:m})=>{const{branding:d,config:i}=le(),n=d?.["--primary-accent"]||i?.buttonGradientStart||"#3A7FA7",[p,s]=l.useState(""),[y,g]=l.useState(""),[c,f]=l.useState("file-text"),[j,S]=l.useState(""),[u,w]=l.useState([]),[o,v]=l.useState(!1),[R,W]=l.useState(null),[$,b]=l.useState("basics");l.useEffect(()=>{a?(s(a.title||""),g(a.description||""),f(a.icon||"file-text"),S(a.system_prompt||""),w((a.variables_schema||[]).map(r=>({...r,id:r.id||U(),options:(r.options||[]).map(k=>({...k,id:k.id||U()}))})))):(s(""),g(""),f("file-text"),S(""),w([])),b("basics"),W(null)},[a,t]);const B=()=>{w([...u,Xe()])},O=(r,k)=>{const T=[...u];T[r]=k,w(T)},C=r=>{w(u.filter((k,T)=>T!==r))},z=r=>{if(r===0)return;const k=[...u];[k[r-1],k[r]]=[k[r],k[r-1]],w(k)},I=r=>{if(r===u.length-1)return;const k=[...u];[k[r],k[r+1]]=[k[r+1],k[r]],w(k)},A=()=>{if(!p.trim())return W("Bitte gib einen Titel ein."),b("basics"),!1;if(!j.trim())return W("Bitte gib einen System-Prompt ein."),b("prompt"),!1;for(const r of u){if(!r.key.trim()||!r.label.trim())return W("Alle Variablen benötigen einen Namen und eine Bezeichnung."),b("variables"),!1;if(r.type==="select"&&(!r.options||r.options.length===0))return W(`Variable "${r.label}" benötigt mindestens eine Auswahloption.`),b("variables"),!1}return!0},P=async()=>{if(W(null),!!A()){v(!0);try{const r=u.map(F=>({key:F.key,label:F.label,type:F.type,required:F.required,placeholder:F.placeholder,...F.type==="select"?{options:F.options.map(E=>({value:E.value,label:E.label}))}:{}})),k={title:p.trim(),description:y.trim(),icon:c,system_prompt:j,variables_schema:r,...m?{demo_code:m}:{}};let T;if(a?T=await N.request(`/smartbriefing/templates/${a.id}`,{method:"PUT",body:JSON.stringify(k)}):T=await N.request("/smartbriefing/templates",{method:"POST",body:JSON.stringify(k)}),T.success)h?.(T.data.template),x();else throw new Error(T.message||"Fehler beim Speichern")}catch(r){console.error("[CreateTemplateDialog] Save error:",r),W(r.message||"Fehler beim Speichern des Templates")}finally{v(!1)}}};return t?e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:"16px"},children:e.jsxs(ke.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{backgroundColor:"white",borderRadius:"20px",width:"100%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden"},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:700,color:"#0f172a"},children:a?"Template bearbeiten":"Neues Template erstellen"}),e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"#64748b"},children:"Erstelle ein persönliches Briefing-Template"})]}),e.jsx("button",{onClick:x,style:{padding:"8px",border:"none",backgroundColor:"#f1f5f9",borderRadius:"8px",cursor:"pointer"},children:e.jsx(Be,{size:20,style:{color:"#64748b"}})})]}),e.jsx("div",{style:{display:"flex",borderBottom:"1px solid #e2e8f0",padding:"0 24px"},children:[{key:"basics",label:"Grundlagen"},{key:"variables",label:"Eingabefelder"},{key:"prompt",label:"KI-Anweisung"}].map(r=>e.jsx("button",{onClick:()=>b(r.key),style:{padding:"12px 20px",border:"none",backgroundColor:"transparent",fontSize:"14px",fontWeight:600,cursor:"pointer",color:$===r.key?n:"#64748b",borderBottom:`3px solid ${$===r.key?n:"transparent"}`,marginBottom:"-1px",transition:"all 0.2s"},children:r.label},r.key))}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:"24px"},children:[R&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"12px 16px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ie,{size:18,style:{color:"#ef4444",flexShrink:0}}),e.jsx("span",{style:{color:"#dc2626",fontSize:"14px"},children:R})]}),$==="basics"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"Titel *"}),e.jsx("input",{type:"text",value:p,onChange:r=>s(r.target.value),placeholder:"z.B. Projektpräsentation Vorbereitung",style:{width:"100%",padding:"12px 14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"15px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"Beschreibung"}),e.jsx("textarea",{value:y,onChange:r=>g(r.target.value),placeholder:"Kurze Beschreibung, wofür dieses Template verwendet wird...",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"14px",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"8px"},children:"Symbol"}),e.jsx(nt,{selectedIcon:c,onSelect:f,primaryAccent:n})]})]}),$==="variables"&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(Ie,{size:16,style:{color:"#64748b"}}),e.jsx("span",{style:{fontSize:"13px",color:"#64748b"},children:"Definiere die Eingabefelder, die der Nutzer beim Erstellen eines Briefings ausfüllen soll."})]})}),u.map((r,k)=>e.jsx(tt,{variable:r,index:k,total:u.length,onChange:T=>O(k,T),onDelete:()=>C(k),onMoveUp:()=>z(k),onMoveDown:()=>I(k),primaryAccent:n},r.id)),e.jsxs("button",{onClick:B,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"14px",borderRadius:"10px",border:"2px dashed #cbd5e1",backgroundColor:"white",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:r=>{r.currentTarget.style.borderColor=n,r.currentTarget.style.color=n},onMouseLeave:r=>{r.currentTarget.style.borderColor="#cbd5e1",r.currentTarget.style.color="#64748b"},children:[e.jsx(_,{size:18}),"Eingabefeld hinzufügen"]}),u.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"32px",color:"#94a3b8",fontSize:"14px"},children:"Noch keine Eingabefelder definiert."})]}),$==="prompt"&&e.jsxs("div",{children:[e.jsx("div",{style:{backgroundColor:"#f0f9ff",borderRadius:"10px",padding:"16px",marginBottom:"16px",border:"1px solid #bae6fd"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px"},children:[e.jsx(V,{size:18,style:{color:"#0284c7",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 6px 0",fontSize:"14px",fontWeight:600,color:"#0369a1"},children:"Tipps für effektive Prompts"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"13px",color:"#0369a1",lineHeight:1.6},children:[e.jsxs("li",{children:["Verwende ",e.jsxs("code",{style:{backgroundColor:"#e0f2fe",padding:"1px 4px",borderRadius:"3px"},children:["$","{variablenname}"]})," um auf Eingabefelder zu verweisen"]}),e.jsx("li",{children:'Beschreibe die Rolle der KI (z.B. "Du bist ein erfahrener Karriere-Coach...")'}),e.jsx("li",{children:"Definiere die Struktur des gewünschten Outputs"}),e.jsx("li",{children:"Gib Beispiele für den Ton und Stil"})]})]})]})}),u.length>0&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("span",{style:{fontSize:"12px",color:"#64748b"},children:"Verfügbare Variablen: "}),u.map(r=>e.jsxs("code",{style:{display:"inline-block",padding:"2px 6px",marginRight:"6px",marginBottom:"4px",backgroundColor:"#f1f5f9",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace",color:"#475569",cursor:"pointer"},onClick:()=>{const k=`\${${r.key}}`;S(T=>T+k)},title:"Klicken zum Einfügen",children:["$","{"+r.key+"}"]},r.id))]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"System-Prompt *"}),e.jsx("textarea",{value:j,onChange:r=>S(r.target.value),placeholder:`Du bist ein erfahrener Experte für...

Erstelle ein strukturiertes Briefing für den Nutzer basierend auf folgenden Informationen:
- Position: \${position}
- Unternehmen: \${unternehmen}

Das Briefing soll folgende Abschnitte enthalten:
1. ...
2. ...

Formatiere jeden Abschnitt mit einem Titel und 5-8 konkreten Bullet Points.`,rows:15,style:{width:"100%",padding:"14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",resize:"vertical",lineHeight:1.5}})]})]})]}),e.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[e.jsx("button",{onClick:x,style:{padding:"12px 24px",borderRadius:"10px",border:"1px solid #e2e8f0",backgroundColor:"white",color:"#475569",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:P,disabled:o,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 24px",borderRadius:"10px",border:"none",background:`linear-gradient(135deg, ${n} 0%, ${n}dd 100%)`,color:"white",fontSize:"14px",fontWeight:600,cursor:o?"not-allowed":"pointer",opacity:o?.7:1},children:o?e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:18,style:{animation:"spin 1s linear infinite"}}),"Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:18}),a?"Speichern":"Template erstellen"]})})]}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}):null},D={DASHBOARD:"dashboard",FORM:"form",RESULT:"result",LIST:"list",WORKBOOK:"workbook"},mt=({isAuthenticated:t,requireAuth:x,setPendingAction:h,onNavigateToSimulator:a,onNavigateToHistory:m,demoCode:d})=>{const[i,n]=l.useState(D.DASHBOARD),[p,s]=l.useState(null),[y,g]=l.useState(null),[c,f]=l.useState(null),[j,S]=l.useState(null),[u,w]=l.useState(!1),[o,v]=l.useState(null),[R,W]=l.useState(0);l.useEffect(()=>{j&&t&&(s(j),n(D.FORM),S(null))},[j,t]),l.useEffect(()=>{window.scrollTo(0,0)},[i]);const $=l.useCallback(E=>{s(E),n(D.FORM)},[]),b=l.useCallback(()=>{s(null),g(null),f(null),n(D.DASHBOARD)},[]),B=l.useCallback(E=>{g(E),f(E),n(D.WORKBOOK)},[]),O=l.useCallback(()=>{g(null),f(null),s(null),n(D.DASHBOARD)},[]),C=l.useCallback(()=>{g(null),f(null),n(D.FORM)},[]);l.useCallback(()=>{n(D.LIST)},[]);const z=l.useCallback(E=>{f(E),n(D.WORKBOOK)},[]);l.useCallback(()=>{f(null),n(D.LIST)},[]);const I=l.useCallback(E=>{a&&a(E)},[a]),A=l.useCallback(async E=>{try{if((await N.request(`/smartbriefing/briefings/${E.id}`,{method:"DELETE"})).success)f(null),n(D.DASHBOARD);else throw new Error("Fehler beim Löschen")}catch(K){throw console.error("[SmartBriefing] Error deleting briefing:",K),K}},[]),P=l.useCallback(()=>{v(null),w(!0)},[]),r=l.useCallback(E=>{v(E),w(!0)},[]),k=l.useCallback(()=>{w(!1),v(null)},[]),T=l.useCallback(E=>{W(K=>K+1)},[]),F=()=>{switch(i){case D.FORM:return e.jsx(Ke,{template:p,onBack:b,onBriefingGenerated:B,isAuthenticated:t});case D.RESULT:return e.jsx(Ge,{briefing:y,template:p,onBack:b,onCreateNew:O,onGenerateAnother:C});case D.LIST:return e.jsx(Je,{onOpenBriefing:z,onCreateNew:O,isAuthenticated:t});case D.WORKBOOK:return e.jsx(Le,{briefing:c,onBack:b,onDelete:A,onStartSimulation:a?I:null});case D.DASHBOARD:default:return e.jsx(Pe,{onSelectTemplate:$,onShowList:m,onCreateTemplate:P,onEditTemplate:r,isAuthenticated:t,requireAuth:x,setPendingAction:h,demoCode:d},R)}};return e.jsxs("div",{style:{minHeight:"100%"},children:[F(),e.jsx(rt,{isOpen:u,onClose:k,onSave:T,editTemplate:o,demoCode:d})]})};export{Je as BriefingList,Ge as BriefingResult,Le as BriefingWorkbook,mt as SmartBriefingApp,Pe as SmartBriefingDashboard,Ke as SmartBriefingForm};
