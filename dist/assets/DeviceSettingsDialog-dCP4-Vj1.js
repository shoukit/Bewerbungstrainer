import{j as e,J as A,X as G,E as P,u as K,e as k,b as I,V as D}from"./ui-vendor-DSq21R2h.js";import{a as l}from"./react-vendor-uDOJF2jQ.js";import{M as R}from"./DeviceSetupPage-Dl4vecFl.js";import{C as b}from"./FeatureInfoButton-CFo_jWu4.js";const U=({isOpen:u,onClose:d,mode:o="audio",selectedMicrophoneId:c,onMicrophoneChange:z,selectedCameraId:m,onCameraChange:S})=>{const[E,C]=l.useState([]),[h,$]=l.useState([]),[g,j]=l.useState(!0),[p,f]=l.useState(null),[r,v]=l.useState(c),[a,N]=l.useState(m);l.useEffect(()=>{u&&(y(),v(c),N(m))},[u,c,m]);const y=async()=>{j(!0),f(null);try{const s=o==="audio-video"?{audio:!0,video:!0}:{audio:!0};(await navigator.mediaDevices.getUserMedia(s)).getTracks().forEach(n=>n.stop());const x=await navigator.mediaDevices.enumerateDevices(),t=x.filter(n=>n.kind==="audioinput"),M=x.filter(n=>n.kind==="videoinput");C(t),o==="audio-video"&&$(M)}catch(s){console.error("Error loading devices:",s),s.name==="NotAllowedError"||s.name==="PermissionDeniedError"?f("Zugriff auf Ger채te verweigert"):f("Fehler beim Laden der Ger채te")}finally{j(!1)}},L=()=>{r!==c&&z?.(r),o==="audio-video"&&a!==m&&S?.(a),d()},w=(s,i,x)=>{if(s.label){let t=s.label;return t=t.replace(/^Default - /,""),t=t.replace(/^Kommunikation - /,""),t=t.replace(/^Standard - /,""),t.length>40&&(t=t.substring(0,37)+"..."),t}return x==="audio"?`Mikrofon ${i+1}`:`Kamera ${i+1}`};return u?e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:d,className:"fixed inset-0 bg-black/50 z-[1000]"}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-xl w-[90%] max-w-[480px] max-h-[80vh] overflow-hidden shadow-xl z-[1001]",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"bg-brand-gradient px-5 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2.5 text-white",children:[e.jsx(A,{size:20}),e.jsx("h3",{className:"m-0 text-base font-semibold",children:"Ger채te-Einstellungen"})]}),e.jsx("button",{onClick:d,className:"bg-white/20 border-0 rounded-md p-1.5 cursor-pointer flex items-center justify-center",children:e.jsx(G,{size:18,color:"white"})})]}),e.jsx("div",{className:"p-5 max-h-[calc(80vh-140px)] overflow-y-auto",children:g?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-10 h-10 border-[3px] border-slate-200 border-t-primary rounded-full animate-spin mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Ger채te werden geladen..."})]}):p?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(P,{size:40,color:b.red[500],className:"mb-3 mx-auto"}),e.jsx("p",{className:"text-red-600 font-medium",children:p}),e.jsxs("button",{onClick:y,className:"mt-4 inline-flex items-center gap-2 px-4 py-2.5 rounded-md border border-slate-300 bg-white cursor-pointer text-sm text-slate-700",children:[e.jsx(K,{size:16}),"Erneut versuchen"]})]}):e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2.5",children:[e.jsx(k,{size:18,className:"text-primary"}),"Mikrofon"]}),e.jsx("div",{className:"flex flex-col gap-1.5",children:E.map((s,i)=>e.jsxs("button",{onClick:()=>v(s.deviceId),className:`flex items-center gap-3 px-3.5 py-3 rounded-md cursor-pointer text-left w-full transition-all duration-300 ${r===s.deviceId?"border-2 border-primary bg-primary/10":"border border-slate-200 bg-white"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-md flex items-center justify-center flex-shrink-0 ${r===s.deviceId?"bg-primary":"bg-slate-100"}`,children:e.jsx(k,{size:16,color:r===s.deviceId?"white":b.slate[500]})}),e.jsx("span",{className:`flex-1 text-sm ${r===s.deviceId?"text-primary font-medium":"text-slate-700"}`,children:w(s,i,"audio")}),r===s.deviceId&&e.jsx(I,{size:18,className:"text-primary"})]},s.deviceId||i))}),r&&e.jsx("div",{className:"mt-3",children:e.jsx(R,{deviceId:r})})]}),o==="audio-video"&&h.length>0&&e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2.5",children:[e.jsx(D,{size:18,className:"text-primary"}),"Kamera"]}),e.jsx("div",{className:"flex flex-col gap-1.5",children:h.map((s,i)=>e.jsxs("button",{onClick:()=>N(s.deviceId),className:`flex items-center gap-3 px-3.5 py-3 rounded-md cursor-pointer text-left w-full transition-all duration-300 ${a===s.deviceId?"border-2 border-primary bg-primary/10":"border border-slate-200 bg-white"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-md flex items-center justify-center flex-shrink-0 ${a===s.deviceId?"bg-primary":"bg-slate-100"}`,children:e.jsx(D,{size:16,color:a===s.deviceId?"white":b.slate[500]})}),e.jsx("span",{className:`flex-1 text-sm ${a===s.deviceId?"text-primary font-medium":"text-slate-700"}`,children:w(s,i,"video")}),a===s.deviceId&&e.jsx(I,{size:18,className:"text-primary"})]},s.deviceId||i))})]})]})}),!g&&!p&&e.jsxs("div",{className:"px-5 py-4 border-t border-slate-200 flex gap-3 justify-end",children:[e.jsx("button",{onClick:d,className:"px-5 py-2.5 rounded-md border border-slate-300 bg-white text-slate-600 text-sm font-medium cursor-pointer",children:"Abbrechen"}),e.jsx("button",{onClick:L,className:"px-5 py-2.5 rounded-md border-0 bg-primary text-white text-sm font-semibold cursor-pointer",children:"Speichern"})]})]})]}):null};export{U as D};
