import{c as y,L as M,T as ne,M as ie,V as ae,S as E,U as G,u as le,a as x,w as L,j as e}from"./colors-BQukwKjN.js";import{u as de}from"./useBranding-D1dNadPD.js";import{u as ce}from"./useMobile-B_LXavH3.js";import{a as pe}from"./formatting-B67Bmjxp.js";import{F as P,a as xe,I as he,X as fe,C as ge,M as ue,Z as me,R as ye,d as be,e as ke,T as je,b as q,c as Ce,m as N}from"./index.js";import{B as U}from"./bot-C6T1dW6N.js";import{P as H}from"./pen-line-CkFrlKhF.js";import{S as Se}from"./server-BBDQL0Dq.js";import{G as ve}from"./globe-CfR5dnas.js";import{R as ze}from"./refresh-cw-hxJHsysT.js";import{C as V}from"./check-DiBTcvJw.js";import{P as we}from"./plus-b6jIgRO0.js";import{T as B}from"./trash-2-u9VwVFZs.js";import{F as Me}from"./filter-BrCmX0LG.js";import{S as Be}from"./search-CwuLAEe2.js";import{P as Ie}from"./phone-Bc94pXzE.js";import{T as Re}from"./thumbs-up-Z0tZ72js.js";import{H as _e}from"./heart-DAOFFmWr.js";import{H as Pe}from"./house-ReKy_zi6.js";import{S as Te}from"./settings-CWRqWhjO.js";import{C as $e}from"./circle-alert-CNsSzecp.js";import{C as Le}from"./circle-check-big-BqWFsjNz.js";import{P as We}from"./play-0qnAUdHO.js";import{C as O}from"./calendar-McKWqfma.js";import{L as K}from"./lightbulb-DOBxo0V4.js";import{S as Ee}from"./star-BkTqDoWb.js";import{A as He}from"./award-CFWs-jAW.js";import{M as Ae}from"./message-circle-Dy8g8Sor.js";import{U as Fe}from"./user-xMpg0OVz.js";import{B as Z}from"./banknote-CevsS91q.js";import{B as J}from"./briefcase-DzdxhUru.js";import{A as Ne}from"./arrow-left-BSe0bpeL.js";import{D as De}from"./download-en76d-Sy.js";import{C as X}from"./chevron-up-DQD89_pB.js";import{R as Ge}from"./rotate-ccw-DfIQOANW.js";const qe=y("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const Ue=y("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const Ve=y("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const Oe=y("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);const Ke=y("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);const Ze=y("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);const Je=y("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Xe=y("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const Ye=y("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);const Qe=y("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);const et=y("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);const tt=y("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const st=y("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const rt=y("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);const ot=y("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const nt=y("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);const it=y("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),at={"file-text":P,briefcase:J,banknote:Z,users:G,user:Fe,"message-circle":Ae,target:je,award:He,book:Ve,clipboard:Xe,star:Ee,lightbulb:K,shield:ke,compass:be,rocket:ye,calendar:O,sparkles:E,video:ae,mic:ie,play:We,"check-circle":Le,"alert-circle":$e,"help-circle":Je,settings:Te,home:Pe,"trending-up":ne,"bar-chart":Ke,"pie-chart":Ze,activity:qe,zap:me,heart:_e,"thumbs-up":Re,"message-square":ue,mail:tt,phone:Ie,"map-pin":st,clock:ge,bell:Ue,search:Be,filter:Me,edit:nt,trash:B,plus:we,minus:rt,check:V,x:fe,info:he,warning:xe,refresh:ze,loader:M,globe:ve,link:et,bookmark:Oe,tag:it,code:Ye,database:Qe,server:Se,pen:H,bot:U},lt={"file-text":P,briefcase:J,banknote:Z,users:G},dt=(r,n=P)=>at[r]||n,Kt=r=>lt[r]||P,ct={role_name:"Position",position:"Position",target_company:"Unternehmen",company:"Unternehmen",interview_type:"Gesprächsart",karrierelevel:"Karrierelevel",experience_years:"Berufserfahrung",industry:"Branche",current_salary:"Aktuelles Gehalt",target_salary:"Zielgehalt",negotiation_context:"Verhandlungskontext",customer_name:"Kunde",meeting_goal:"Gesprächsziel",product_service:"Produkt/Service",user_name:"Name",skills:"Fähigkeiten",strengths:"Stärken",challenges:"Herausforderungen"},pt=r=>ct[r]||r.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),W=(r,n)=>{if(!r)return null;const l=[];let u=r,s=0;for(;u.length>0;){const m=u.match(/\*\*(.+?)\*\*/),t=u.match(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)|_([^_]+)_")),c=u.match(/`([^`]+)`/),h=[{match:m,type:"bold"},{match:t,type:"italic"},{match:c,type:"code"}].filter(f=>f.match);if(h.length===0){l.push(u);break}const d=h.reduce((f,p)=>(f.match?.index??1/0)<(p.match?.index??1/0)?f:p);switch(d.match.index>0&&l.push(u.substring(0,d.match.index)),d.type){case"bold":l.push(e.jsx("strong",{style:{fontWeight:600,color:"#0f172a"},children:d.match[1]},s++));break;case"italic":l.push(e.jsx("em",{style:{fontStyle:"italic"},children:d.match[1]||d.match[2]},s++));break;case"code":l.push(e.jsx("code",{style:{backgroundColor:"#f1f5f9",padding:"2px 6px",borderRadius:"4px",fontSize:"13px",fontFamily:"monospace",color:n},children:d.match[1]},s++));break}u=u.substring(d.match.index+d.match[0].length)}return l},Y=({content:r,primaryAccent:n})=>{if(!r)return null;const l=u=>{const s=u.split(`
`),m=[];let t=[],c=null;const h=()=>{t.length>0&&(m.push(e.jsx("ul",{style:{margin:"8px 0",paddingLeft:"20px",listStyle:"none"},children:t.map((d,f)=>e.jsxs("li",{style:{marginBottom:"6px",fontSize:"14px",lineHeight:1.6,color:"#374151",position:"relative",paddingLeft:"16px"},children:[e.jsx("span",{style:{position:"absolute",left:0,color:n,fontWeight:"bold"},children:c==="number"?`${f+1}.`:"•"}),W(d,n)]},f))},`list-${m.length}`)),t=[],c=null)};return s.forEach((d,f)=>{const p=d.trim();if(!p){h();return}if(p.startsWith("- ")||p.startsWith("* ")){c!=="bullet"&&(h(),c="bullet"),t.push(p.substring(2));return}const k=p.match(/^(\d+)\.\s/);if(k){c!=="number"&&(h(),c="number"),t.push(p.substring(k[0].length));return}h(),m.push(e.jsx("p",{style:{margin:"8px 0",fontSize:"14px",lineHeight:1.6,color:"#374151"},children:W(p,n)},`p-${f}`))}),h(),m};return e.jsx("div",{children:l(r)})},D=({item:r,sectionId:n,primaryAccent:l,onUpdateItem:u,branding:s})=>{const[m,t]=x.useState(r.user_note||""),[c,h]=x.useState(!1),[d,f]=x.useState(!1),[p,k]=x.useState(!1),[j,C]=x.useState(!!r.user_note);x.useEffect(()=>{k(m!==(r.user_note||""))},[m,r.user_note]);const v=async()=>{h(!0);try{await u(n,r.id,{user_note:m}),f(!0),k(!1),setTimeout(()=>f(!1),2e3)}catch(g){console.error("Error saving note:",g)}finally{h(!1)}},I=async()=>{try{await u(n,r.id,{deleted:!0})}catch(g){console.error("Error deleting item:",g)}},o=async()=>{try{await u(n,r.id,{deleted:!1})}catch(g){console.error("Error restoring item:",g)}};return r.deleted?e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:s.cardBgHover,borderRadius:"10px",marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"space-between",opacity:.6},children:[e.jsxs("span",{style:{fontSize:"14px",color:s.textMuted,fontStyle:"italic"},children:[e.jsx("s",{children:r.label})," - gelöscht"]}),e.jsxs("button",{onClick:o,style:{display:"flex",alignItems:"center",gap:"4px",padding:"6px 10px",borderRadius:"6px",border:"none",backgroundColor:s.borderColor,color:s.textMuted,fontSize:"12px",cursor:"pointer"},children:[e.jsx(Ge,{size:12}),"Wiederherstellen"]})]}):e.jsxs("div",{style:{backgroundColor:s.cardBg,borderRadius:"12px",border:`1px solid ${s.borderColor}`,marginBottom:"10px",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"14px 16px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[e.jsx("span",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:l,flexShrink:0}}),e.jsx("h4",{style:{fontSize:"14px",fontWeight:600,color:s.textMain,margin:0},children:r.label})]}),r.content&&e.jsx("p",{style:{fontSize:"13px",color:s.textMuted,margin:"0 0 0 14px",lineHeight:1.5},children:W(r.content,l)})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexShrink:0},children:[r.user_note&&!j&&e.jsx("span",{style:{fontSize:"11px",color:l,backgroundColor:`${l}15`,padding:"2px 6px",borderRadius:"4px"},children:"Notiz"}),e.jsx("button",{onClick:()=>C(!j),title:"Notiz hinzufügen",style:{padding:"6px",borderRadius:"6px",border:"none",backgroundColor:j?`${l}15`:"transparent",color:j?l:s.textMuted,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(H,{size:16})}),e.jsx("button",{onClick:I,title:"Löschen",style:{padding:"6px",borderRadius:"6px",border:"none",backgroundColor:"transparent",color:s.textMuted,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(B,{size:16})})]})]}),j&&e.jsxs("div",{style:{padding:"12px 16px",backgroundColor:s.cardBgHover,borderTop:`1px solid ${s.borderColor}`},children:[e.jsx("textarea",{value:m,onChange:g=>t(g.target.value),placeholder:"Deine Notiz zu diesem Punkt...",style:{width:"100%",minHeight:"60px",padding:"10px",borderRadius:"8px",border:`1px solid ${s.borderColor}`,fontSize:"13px",color:s.textSecondary,resize:"vertical",outline:"none",boxSizing:"border-box",transition:"border-color 0.2s"},onFocus:g=>{g.target.style.borderColor=l},onBlur:g=>{g.target.style.borderColor=s.borderColor}}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"8px",gap:"8px"},children:[e.jsx("button",{onClick:()=>{C(!1),t(r.user_note||"")},style:{padding:"6px 12px",borderRadius:"6px",border:`1px solid ${s.borderColor}`,backgroundColor:s.cardBg,color:s.textMuted,fontSize:"12px",cursor:"pointer"},children:"Abbrechen"}),e.jsxs("button",{onClick:v,disabled:c||!p,style:{display:"flex",alignItems:"center",gap:"4px",padding:"6px 12px",borderRadius:"6px",border:"none",backgroundColor:d?s.successLight:p?l:s.cardBgHover,color:d?s.success:p?"white":s.textMuted,fontSize:"12px",fontWeight:500,cursor:p&&!c?"pointer":"default"},children:[c?e.jsx(M,{size:12,style:{animation:"spin 1s linear infinite"}}):d?e.jsx(V,{size:12}):e.jsx(ot,{size:12}),d?"Gespeichert!":"Speichern"]})]})]}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})},xt=({section:r,primaryAccent:n,onUpdateItem:l,onGenerateMore:u,isExpanded:s,onToggle:m,branding:t})=>{const[c,h]=x.useState(!1),d=async()=>{h(!0);try{await u(r.id)}catch(o){console.error("Error generating more items:",o)}finally{h(!1)}},f=x.useCallback(()=>{if(!r.ai_content)return{type:"empty",items:[],content:""};try{const o=JSON.parse(r.ai_content);if(o&&Array.isArray(o.items))return{type:"items",items:o.items,content:""}}catch{}return{type:"markdown",items:[],content:r.ai_content}},[r.ai_content]),{type:p,items:k,content:j}=f(),C=k.filter(o=>!o.deleted),v=k.filter(o=>o.deleted),I=k.some(o=>o.user_note&&!o.deleted);return e.jsxs("div",{style:{backgroundColor:t.cardBgColor,borderRadius:t.radius.xl,boxShadow:t.shadow.xs,overflow:"hidden",marginBottom:t.space[4]},children:[e.jsxs("button",{onClick:m,style:{width:"100%",padding:`${t.space[4]} ${t.space[5]}`,display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:t.space[2],border:"none",background:"none",cursor:"pointer",borderBottom:s?`1px solid ${t.borderColorLight}`:"none"},children:[e.jsx("h3",{style:{fontSize:t.fontSize.lg,fontWeight:t.fontWeight.semibold,color:t.textMain,margin:0,textAlign:"left",flex:1,minWidth:0,wordBreak:"break-word",lineHeight:1.3},children:r.section_title}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:t.space[2],flexShrink:0,flexWrap:"wrap",justifyContent:"flex-end"},children:[p==="items"&&e.jsxs("span",{style:{fontSize:t.fontSize.xs,color:t.textMuted,backgroundColor:t.borderColorLight,padding:`${t.space[1]} ${t.space[2]}`,borderRadius:t.radius.lg},children:[C.length," Punkte"]}),I&&e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:t.space[1],fontSize:t.fontSize.xs,color:n,backgroundColor:`${n}15`,padding:`${t.space[1]} ${t.space[2]}`,borderRadius:t.radius.lg},children:[e.jsx(H,{size:t.iconSize.xs}),"Notizen"]}),s?e.jsx(X,{size:t.iconSize.lg,style:{color:t.textMuted}}):e.jsx(q,{size:t.iconSize.lg,style:{color:t.textMuted}})]})]}),s&&e.jsx("div",{style:{padding:`${t.space[4]} ${t.space[5]}`},children:p==="items"?e.jsxs(e.Fragment,{children:[C.map(o=>e.jsx(D,{item:o,sectionId:r.id,primaryAccent:n,onUpdateItem:l,branding:t},o.id)),u&&e.jsx("button",{onClick:d,disabled:c,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"12px 16px",marginTop:"12px",marginBottom:"8px",borderRadius:"10px",border:`1px dashed ${n}40`,backgroundColor:`${n}08`,color:n,fontSize:"13px",fontWeight:500,cursor:c?"wait":"pointer",transition:"all 0.2s"},onMouseEnter:o=>{c||(o.currentTarget.style.backgroundColor=`${n}15`,o.currentTarget.style.borderColor=`${n}60`)},onMouseLeave:o=>{o.currentTarget.style.backgroundColor=`${n}08`,o.currentTarget.style.borderColor=`${n}40`},children:c?e.jsxs(e.Fragment,{children:[e.jsx(M,{size:16,style:{animation:"spin 1s linear infinite"}}),"Generiere 5 weitere Punkte..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{size:16}),"5 weitere Punkte generieren"]})}),v.length>0&&e.jsxs("div",{style:{marginTop:"16px"},children:[e.jsxs("div",{style:{fontSize:"12px",color:"#94a3b8",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(B,{size:12}),v.length," gelöschte ",v.length===1?"Punkt":"Punkte"]}),v.map(o=>e.jsx(D,{item:o,sectionId:r.id,primaryAccent:n,onUpdateItem:l,branding:t},o.id))]})]}):p==="markdown"?e.jsxs("div",{style:{backgroundColor:"#f8fafc",padding:"16px",borderRadius:"10px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[e.jsx(U,{size:16,style:{color:n}}),e.jsx("span",{style:{fontSize:"12px",fontWeight:600,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.5px"},children:"KI-Empfehlung"})]}),e.jsx(Y,{content:j,primaryAccent:n})]}):e.jsx("p",{style:{color:"#94a3b8",fontStyle:"italic"},children:"Kein Inhalt verfügbar"})})]})},Zt=({briefing:r,onBack:n,onDelete:l})=>{const{config:u}=le(),s=de(),m=ce(),[t,c]=x.useState(r),[h,d]=x.useState(!r?.sections),[f,p]=x.useState(null),[k,j]=x.useState({}),[C,v]=x.useState(!1),[I,o]=x.useState(!1),[g,A]=x.useState(!1),[w,F]=x.useState(!1),z=s.primaryAccent,Q=s.headerGradient,ee=dt(t?.template_icon)||P;x.useEffect(()=>{const i=async()=>{if(t?.sections){const a={};t.sections.forEach(b=>{a[b.id]=!0}),j(a),d(!1);return}try{d(!0);const a=await L.request(`/smartbriefing/briefings/${t.id}`,{method:"GET"});if(a.success&&a.data?.briefing){c(a.data.briefing);const b={};a.data.briefing.sections?.forEach(S=>{b[S.id]=!0}),j(b)}else throw new Error("Fehler beim Laden des Briefings")}catch(a){console.error("[SmartBriefing] Error fetching briefing:",a),p(a.message)}finally{d(!1)}};t?.id&&i()},[t?.id]);const te=x.useCallback(i=>{j(a=>({...a,[i]:!a[i]}))},[]),se=x.useCallback(async(i,a,b)=>{const S=await L.request(`/smartbriefing/sections/${i}/items/${a}`,{method:"PATCH",body:JSON.stringify(b)});if(!S.success)throw new Error("Fehler beim Speichern");c(T=>({...T,sections:T.sections.map(R=>R.id===i?S.data.section:R)}))},[]),re=x.useCallback(async i=>{const a=await L.request(`/smartbriefing/sections/${i}/generate-more`,{method:"POST"});if(!a.success)throw new Error(a.message||"Fehler beim Generieren");return c(b=>({...b,sections:b.sections.map(S=>S.id===i?a.data.section:S)})),a.data.new_items_count},[]),oe=x.useCallback(async()=>{if(!(w||!t?.id)){F(!0);try{const i=await L.request(`/smartbriefing/briefings/${t.id}/pdf`,{method:"GET"});if(!i.success||!i.data?.pdf_base64)throw new Error(i.message||"PDF-Export fehlgeschlagen");const a=atob(i.data.pdf_base64),b=new Array(a.length);for(let $=0;$<a.length;$++)b[$]=a.charCodeAt($);const S=new Uint8Array(b),T=new Blob([S],{type:"application/pdf"}),R=window.URL.createObjectURL(T),_=document.createElement("a");_.href=R,_.download=i.data.filename||"Smart-Briefing.pdf",document.body.appendChild(_),_.click(),document.body.removeChild(_),window.URL.revokeObjectURL(R)}catch(i){console.error("[SmartBriefing] PDF download error:",i)}finally{F(!1)}}},[t?.id,w]);return t?e.jsxs("div",{style:{minHeight:"100vh",background:s.pageBg},children:[e.jsx("div",{style:{background:Q,padding:m?"20px 16px":"24px 32px",position:"sticky",top:0,zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[n&&e.jsxs("button",{onClick:n,style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",color:"#fff",fontSize:"13px",marginBottom:"16px"},children:[e.jsx(Ne,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px"},children:[!m&&e.jsx("div",{style:{width:90,height:90,borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(ee,{size:40,color:"#fff"})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.2)",color:"#fff"},children:"Smart Briefing"}),e.jsx("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.9)",color:z},children:t.template_title})]}),e.jsx("h1",{style:{fontSize:m?"20px":"24px",fontWeight:700,color:"#fff",margin:0,marginBottom:"8px"},children:t.title||"Briefing"}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(O,{size:14}),pe(t.created_at)]})})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",flexShrink:0},children:[e.jsx("button",{onClick:oe,disabled:w,title:"Als PDF herunterladen",style:{display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 12px",cursor:w?"not-allowed":"pointer",color:"#fff",opacity:w?.6:1,outline:"none",WebkitAppearance:"none"},children:w?e.jsx(M,{size:16,style:{animation:"spin 1s linear infinite"}}):e.jsx(De,{size:16})}),l&&e.jsx("button",{onClick:()=>o(!0),title:"Briefing loschen",style:{display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.4)",borderRadius:"10px",padding:"10px 12px",cursor:"pointer",color:"#fff",outline:"none",WebkitAppearance:"none"},children:e.jsx(B,{size:16})})]})]})]})}),e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:m?"16px":"24px 32px"},children:[t.variables&&Object.keys(t.variables).length>0&&e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"16px 20px",marginBottom:"20px",border:`1px solid ${s.borderColor}`},children:[e.jsxs("button",{onClick:()=>v(!C),style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"0",border:"none",background:"none",cursor:"pointer"},children:[e.jsxs("span",{style:{fontSize:"14px",fontWeight:600,color:s.textMain},children:["Deine Angaben (",Object.keys(t.variables).length,")"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:s.textMuted},children:[e.jsx("span",{style:{fontSize:"12px"},children:C?"Einklappen":"Ausklappen"}),C?e.jsx(X,{size:16}):e.jsx(q,{size:16})]})]}),C&&e.jsx("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:`1px solid ${s.borderColor}`,display:"flex",flexWrap:"wrap",gap:"8px"},children:Object.entries(t.variables).map(([i,a])=>e.jsxs("span",{style:{backgroundColor:s.cardBgHover,padding:"6px 12px",borderRadius:"20px",fontSize:"12px",color:s.textSecondary},children:[e.jsxs("strong",{style:{color:s.textMain},children:[pt(i),":"]})," ",a]},i))})]}),h&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"64px 24px"},children:[e.jsx(M,{size:40,style:{color:z,animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{marginTop:"16px",color:"#64748b"},children:"Briefing wird geladen..."})]}),f&&!h&&e.jsx("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"24px",textAlign:"center"},children:e.jsx("p",{style:{color:"#dc2626",margin:0},children:f})}),!h&&!f&&t.sections&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[e.jsx(E,{size:18,style:{color:z}}),e.jsx("h2",{style:{fontSize:"16px",fontWeight:600,color:"#0f172a",margin:0},children:"Briefing-Inhalte"}),e.jsxs("span",{style:{fontSize:"13px",color:"#94a3b8"},children:["(",t.sections.length," Abschnitte)"]})]}),t.sections.map(i=>e.jsx(xt,{section:i,primaryAccent:z,onUpdateItem:se,onGenerateMore:re,isExpanded:k[i.id],onToggle:()=>te(i.id),branding:s},i.id))]}),!h&&!f&&(!t.sections||t.sections.length===0)&&t.content_markdown&&e.jsx("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsx(Y,{content:t.content_markdown,primaryAccent:z})}),e.jsx("div",{style:{marginTop:"24px",padding:"16px 20px",backgroundColor:`${z}08`,borderRadius:"12px",border:`1px solid ${z}20`},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(K,{size:18,style:{color:z,flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 4px 0",color:"#0f172a",fontSize:"14px",fontWeight:600},children:"Tipp: Personalisiere dein Briefing"}),e.jsx("p",{style:{margin:0,color:"#64748b",fontSize:"13px",lineHeight:1.5},children:"Klicke auf das Stift-Icon bei jedem Punkt, um deine eigenen Notizen hinzuzufügen. Nicht relevante Punkte kannst du mit dem Papierkorb-Icon ausblenden."})]})]})})]}),e.jsx(Ce,{children:I&&e.jsxs(e.Fragment,{children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>o(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",zIndex:1e3}}),e.jsx(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",zIndex:1001,boxShadow:"0 20px 40px rgba(0,0,0,0.2)"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"50%",background:"rgba(239,68,68,0.1)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(B,{size:24,color:"#ef4444"})}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:600,color:s.textMain,marginBottom:"8px"},children:"Briefing löschen?"}),e.jsx("p",{style:{fontSize:"14px",color:s.textSecondary,marginBottom:"24px"},children:"Diese Aktion kann nicht rückgängig gemacht werden. Dein Briefing und alle Notizen werden dauerhaft gelöscht."}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{onClick:()=>o(!1),disabled:g,style:{flex:1,padding:"12px 16px",borderRadius:"10px",border:`1px solid ${s.borderColor}`,background:"#fff",color:s.textMain,fontSize:"14px",fontWeight:500,cursor:g?"not-allowed":"pointer",opacity:g?.5:1,outline:"none",WebkitAppearance:"none"},children:"Abbrechen"}),e.jsx("button",{onClick:async()=>{if(!(!l||!t?.id)){A(!0);try{await l(t)}catch(i){console.error("Failed to delete briefing:",i)}finally{A(!1),o(!1)}}},disabled:g,style:{flex:1,padding:"12px 16px",borderRadius:"10px",border:"none",background:"#ef4444",color:"#fff",fontSize:"14px",fontWeight:500,cursor:g?"not-allowed":"pointer",opacity:g?.7:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",outline:"none",WebkitAppearance:"none"},children:g?e.jsxs(e.Fragment,{children:[e.jsx(M,{size:16,style:{animation:"spin 1s linear infinite"}}),"Löschen..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{size:16}),"Löschen"]})})]})]})})]})}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]}):null};export{Zt as B,Xe as C,ot as S,Ve as a,dt as b,Je as c,Kt as g};
