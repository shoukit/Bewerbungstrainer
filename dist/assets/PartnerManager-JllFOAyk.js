import{j as e,a1 as te,z as V,X as ae,v as re,U as W,ae as ne,aM as le,L as w,ay as ie,au as ce,O as oe,F as de,a$ as xe,b0 as me,b1 as ue,b2 as he,b3 as be,b4 as pe,al as ge,a as fe,b5 as ye,b6 as je}from"./ui-vendor-BE38435C.js";import{a as o}from"./react-vendor-uDOJF2jQ.js";import{C as F,a as I}from"./card-BC2KFktb.js";import{B as c}from"./button-keEQQAag.js";import{I as P}from"./input-Dcd1fvcu.js";import{T as ve}from"./textarea-N-8N8EiH.js";import{D as H,a as R,b as O,c as M,d as z,e as $}from"./dialog-D3nE5LV1.js";import{F as Ne,a as C}from"./form-accordion-DjZFyfZ_.js";import{w as S}from"./FeatureInfoButton-DfHx39Vr.js";import"./index-CklPxmEV.js";import"./utils-BEHD0UYf.js";const ke=[{id:"overview",label:"Übersicht"},{id:"dashboard",label:"Dashboard"},{id:"roleplay",label:"Live-Simulation (Roleplay)"},{id:"simulator",label:"Szenario-Training (Simulator)"},{id:"video_training",label:"Wirkungs-Analyse"},{id:"gym",label:"Rhetorik-Gym (Game)"},{id:"history",label:"Verlauf / History"}],r={"--app-bg-start":"#f8fafc","--app-bg-mid":"#eff6ff","--app-bg-end":"#f0fdfa","--card-bg-color":"#ffffff","--sidebar-bg-color":"#ffffff","--sidebar-text-color":"#0f172a","--sidebar-text-muted":"#64748b","--sidebar-active-bg":"#eef2ff","--sidebar-active-text":"#4f46e5","--primary-accent":"#6366f1","--primary-accent-hover":"#4f46e5","--button-solid":"#6366f1","--button-text":"#ffffff","--header-gradient-start":"#6366f1","--header-gradient-end":"#8b5cf6","--header-text":"#ffffff","--icon-primary":"#6366f1","--icon-secondary":"#8b5cf6","--icon-muted":"#94a3b8","--text-main":"#0f172a","--text-secondary":"#475569","--text-muted":"#94a3b8","--border-color":"#e2e8f0","--border-color-light":"#f1f5f9","--focus-ring":"rgba(99, 102, 241, 0.3)"},we=[{id:"app",title:"App / Allgemein",subtitle:"Hintergrundfarben der Anwendung",accentColor:"blue",iconName:"Layout",fields:[{key:"--app-bg-start",label:"App Hintergrund (Start)",type:"color"},{key:"--app-bg-mid",label:"App Hintergrund (Mitte)",type:"color"},{key:"--app-bg-end",label:"App Hintergrund (Ende)",type:"color"},{key:"--card-bg-color",label:"Karten Hintergrund",type:"color"}]},{id:"sidebar",title:"Sidebar",subtitle:"Farben der Seitennavigation",accentColor:"teal",iconName:"PanelLeft",fields:[{key:"--sidebar-bg-color",label:"Sidebar Hintergrund",type:"color"},{key:"--sidebar-text-color",label:"Sidebar Text",type:"color"},{key:"--sidebar-text-muted",label:"Sidebar Text (gedämpft)",type:"color"},{key:"--sidebar-active-bg",label:"Sidebar Aktiv Hintergrund",type:"color"},{key:"--sidebar-active-text",label:"Sidebar Aktiv Text",type:"color"}]},{id:"accent",title:"Akzentfarben",subtitle:"Primäre Markenfarben",accentColor:"purple",iconName:"Sparkles",fields:[{key:"--primary-accent",label:"Primärfarbe",type:"color"},{key:"--primary-accent-hover",label:"Primärfarbe (Hover)",type:"color"}]},{id:"buttons",title:"Buttons",subtitle:"Schaltflächenfarben",accentColor:"green",iconName:"Square",fields:[{key:"--button-solid",label:"Button Farbe",type:"color"},{key:"--button-text",label:"Button Text",type:"color"}]},{id:"header",title:"Header",subtitle:"Kopfzeilenfarben",accentColor:"orange",iconName:"PanelTop",fields:[{key:"--header-gradient-start",label:"Header Gradient (Start)",type:"color"},{key:"--header-gradient-end",label:"Header Gradient (Ende)",type:"color"},{key:"--header-text",label:"Header Text",type:"color"}]},{id:"icons",title:"Icons",subtitle:"Symbolfarben",accentColor:"blue",iconName:"Shapes",fields:[{key:"--icon-primary",label:"Icon Primär",type:"color"},{key:"--icon-secondary",label:"Icon Sekundär",type:"color"},{key:"--icon-muted",label:"Icon (gedämpft)",type:"color"}]},{id:"text",title:"Text",subtitle:"Textfarben",accentColor:"teal",iconName:"Type",fields:[{key:"--text-main",label:"Text Hauptfarbe",type:"color"},{key:"--text-secondary",label:"Text Sekundär",type:"color"},{key:"--text-muted",label:"Text (gedämpft)",type:"color"}]},{id:"borders",title:"Rahmen & Focus",subtitle:"Rahmen- und Fokusfarben",accentColor:"purple",iconName:"Frame",fields:[{key:"--border-color",label:"Rahmenfarbe",type:"color"},{key:"--border-color-light",label:"Rahmenfarbe (hell)",type:"color"},{key:"--focus-ring",label:"Focus Ring",type:"color"}]}],Ce={Layout:je,PanelLeft:ye,Sparkles:fe,Square:ge,PanelTop:pe,Shapes:be,Type:he,Frame:ue};function ze({onBack:t}){const[n,m]=o.useState([]),[d,a]=o.useState(!0),[i,l]=o.useState(null),[u,A]=o.useState(""),[T,p]=o.useState(!1),[E,g]=o.useState(!1),[q,v]=o.useState(!1),[L,U]=o.useState(null),[f,y]=o.useState(!1),[h,N]=o.useState({name:"",slug:"",description:"",status:"draft",modules:[],branding:{...r}}),[k,B]=o.useState(null);o.useEffect(()=>{j()},[]);const j=async()=>{try{a(!0),l(null);const s=await S.adminGetPartners();if(s.success)m(s.data||[]);else throw new Error("Fehler beim Laden der Partner")}catch(s){l(s.message),x("error","Fehler beim Laden der Partner")}finally{a(!1)}},x=(s,b)=>{B({type:s,message:b}),setTimeout(()=>B(null),4e3)},G=()=>{N({name:"",slug:"",description:"",status:"draft",modules:[],branding:{...r}}),p(!0)},Q=s=>{U(s),N({name:s.name||"",slug:s.slug||"",description:s.description||"",status:s.status||"draft",modules:s.modules||[],branding:{...r,...s.branding}}),g(!0)},X=s=>{U(s),v(!0)},Z=async()=>{if(!h.name.trim()){x("error","Bitte geben Sie einen Namen ein");return}const s={...h,slug:h.slug||h.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")};try{if(y(!0),(await S.adminCreatePartner(s)).success)x("success","Partner erfolgreich erstellt"),p(!1),j();else throw new Error("Fehler beim Erstellen")}catch(b){x("error",b.message)}finally{y(!1)}},J=async()=>{if(!h.name.trim()){x("error","Bitte geben Sie einen Namen ein");return}try{if(y(!0),(await S.adminUpdatePartner(L.id,h)).success)x("success","Partner erfolgreich aktualisiert"),g(!1),j();else throw new Error("Fehler beim Aktualisieren")}catch(s){x("error",s.message)}finally{y(!1)}},Y=async()=>{try{if(y(!0),(await S.adminDeletePartner(L.id)).success)x("success","Partner erfolgreich gelöscht"),v(!1),j();else throw new Error("Fehler beim Löschen")}catch(s){x("error",s.message)}finally{y(!1)}},D=s=>{const b=`${window.location.origin}${window.location.pathname}?partner=${s}`;navigator.clipboard.writeText(b),x("success","URL in Zwischenablage kopiert")},K=n.filter(s=>s.name?.toLowerCase().includes(u.toLowerCase())||s.slug?.toLowerCase().includes(u.toLowerCase())),ee=s=>({publish:"Aktiv",draft:"Entwurf",pending:"Ausstehend"})[s]||s,se=s=>({publish:"bg-green-100 text-green-700",draft:"bg-gray-100 text-gray-700",pending:"bg-yellow-100 text-yellow-700"})[s]||"bg-gray-100 text-gray-700";return e.jsxs("div",{className:"space-y-6",children:[k&&e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center gap-2 px-4 py-3 rounded-lg shadow-lg ${k.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:[k.type==="success"?e.jsx(te,{className:"w-5 h-5"}):e.jsx(V,{className:"w-5 h-5"}),k.message,e.jsx("button",{onClick:()=>B(null),className:"ml-2 hover:opacity-80",children:e.jsx(ae,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c,{variant:"ghost",onClick:t,className:"p-2",children:e.jsx(re,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-100",children:e.jsx(W,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-[var(--text-main)]",children:"Partner-Branding"}),e.jsxs("p",{className:"text-sm text-[var(--text-secondary)]",children:[n.length," Partner"]})]})]})]}),e.jsxs(c,{onClick:G,className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Neuer Partner"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-[var(--text-muted)]"}),e.jsx(P,{placeholder:"Partner durchsuchen...",value:u,onChange:s=>A(s.target.value),className:"pl-10"})]}),d&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(w,{className:"w-8 h-8 animate-spin text-[var(--primary-accent)]"})}),i&&!d&&e.jsx(F,{className:"border-red-200 bg-red-50",children:e.jsx(I,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-red-700",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("p",{children:i}),e.jsx(c,{variant:"outline",size:"sm",onClick:j,children:"Erneut versuchen"})]})})}),!d&&!i&&e.jsx("div",{className:"space-y-3",children:K.length===0?e.jsx(F,{children:e.jsx(I,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(W,{className:"w-12 h-12 text-[var(--text-muted)] mx-auto mb-3"}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:u?"Keine Partner gefunden":"Noch keine Partner vorhanden"}),!u&&e.jsx(c,{onClick:G,className:"mt-4",children:"Ersten Partner erstellen"})]})})}):K.map(s=>e.jsx(F,{className:"hover:shadow-md transition-shadow",children:e.jsx(I,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg border shadow-sm",style:{background:s.branding?.["--primary-accent"]||r["--primary-accent"]}}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-main)]",children:s.name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${se(s.status)}`,children:ee(s.status)})]}),e.jsxs("p",{className:"text-sm text-[var(--text-muted)]",children:["Slug: ",s.slug]})]})]}),s.description&&e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mb-2 line-clamp-1",children:s.description}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-[var(--text-muted)]",children:s.modules?.length>0?e.jsxs("span",{children:[s.modules.length," Module aktiv"]}):e.jsx("span",{children:"Alle Module aktiv"})})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>D(s.slug),className:"text-[var(--text-secondary)] hover:text-[var(--primary-accent)]",title:"URL kopieren",children:e.jsx(ie,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>Q(s),className:"text-[var(--text-secondary)] hover:text-[var(--primary-accent)]",children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>X(s),className:"text-[var(--text-secondary)] hover:text-red-600",children:e.jsx(oe,{className:"w-4 h-4"})})]})]})})},s.id))}),e.jsx(H,{open:T,onOpenChange:p,children:e.jsxs(R,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(O,{children:[e.jsx(M,{children:"Neuen Partner erstellen"}),e.jsx(z,{children:"Erstellen Sie einen neuen White-Label Partner mit eigenem Branding."})]}),e.jsx(_,{formData:h,setFormData:N}),e.jsxs($,{children:[e.jsx(c,{variant:"outline",onClick:()=>p(!1),children:"Abbrechen"}),e.jsxs(c,{onClick:Z,disabled:f,children:[f&&e.jsx(w,{className:"w-4 h-4 mr-2 animate-spin"}),"Erstellen"]})]})]})}),e.jsx(H,{open:E,onOpenChange:g,children:e.jsxs(R,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(O,{children:[e.jsx(M,{children:"Partner bearbeiten"}),e.jsx(z,{children:"Bearbeiten Sie die Konfiguration des ausgewählten Partners."})]}),e.jsx(_,{formData:h,setFormData:N}),e.jsxs($,{children:[e.jsx(c,{variant:"outline",onClick:()=>g(!1),children:"Abbrechen"}),e.jsxs(c,{onClick:J,disabled:f,children:[f&&e.jsx(w,{className:"w-4 h-4 mr-2 animate-spin"}),"Speichern"]})]})]})}),e.jsx(H,{open:q,onOpenChange:v,children:e.jsxs(R,{children:[e.jsxs(O,{children:[e.jsx(M,{children:"Partner löschen"}),e.jsxs(z,{children:['Sind Sie sicher, dass Sie den Partner "',L?.name,'" löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.']})]}),e.jsxs($,{children:[e.jsx(c,{variant:"outline",onClick:()=>v(!1),children:"Abbrechen"}),e.jsxs(c,{variant:"destructive",onClick:Y,disabled:f,children:[f&&e.jsx(w,{className:"w-4 h-4 mr-2 animate-spin"}),"Löschen"]})]})]})})]})}function Se({label:t,value:n,defaultValue:m,onChange:d}){const i=n?.startsWith("rgba")||m?.startsWith("rgba")?"#4F46E5":n||m||"#000000";return e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1 text-slate-600",children:t}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:i,onChange:l=>d(l.target.value),className:"w-10 h-8 rounded border cursor-pointer"}),e.jsx(P,{value:n||"",onChange:l=>d(l.target.value),placeholder:m,className:"flex-1 text-xs"})]})]})}function Pe({branding:t}){const n=t?.["--app-bg-start"]||r["--app-bg-start"],m=t?.["--app-bg-mid"]||r["--app-bg-mid"],d=t?.["--app-bg-end"]||r["--app-bg-end"],a=t?.["--card-bg-color"]||r["--card-bg-color"],i=t?.["--header-gradient-start"]||r["--header-gradient-start"],l=t?.["--header-gradient-end"]||r["--header-gradient-end"],u=t?.["--header-text"]||r["--header-text"],A=t?.["--text-main"]||r["--text-main"],T=t?.["--text-secondary"]||r["--text-secondary"],p=t?.["--button-solid"]||r["--button-solid"],E=t?.["--button-text"]||r["--button-text"],g=t?.["--border-color"]||r["--border-color"];return e.jsxs("div",{className:"rounded-lg p-4 mb-4",style:{background:`linear-gradient(135deg, ${n} 0%, ${m} 50%, ${d} 100%)`},children:[e.jsx("div",{className:"rounded-t-lg px-3 py-2 mb-2",style:{background:`linear-gradient(135deg, ${i} 0%, ${l} 100%)`},children:e.jsx("span",{className:"text-xs font-medium",style:{color:u},children:"Header Vorschau"})}),e.jsxs("div",{className:"rounded-lg p-3",style:{backgroundColor:a,border:`1px solid ${g}`},children:[e.jsx("p",{className:"text-sm font-medium mb-1",style:{color:A},children:"Karten-Titel"}),e.jsx("p",{className:"text-xs mb-3",style:{color:T},children:"Sekundärer Text"}),e.jsx("button",{type:"button",className:"px-3 py-1.5 rounded text-xs font-medium",style:{backgroundColor:p,color:E},children:"Button"})]})]})}function _({formData:t,setFormData:n}){const m=a=>{const i=t.modules||[];i.includes(a)?n({...t,modules:i.filter(l=>l!==a)}):n({...t,modules:[...i,a]})},d=(a,i)=>{n({...t,branding:{...t.branding,[a]:i}})};return e.jsxs(Ne,{children:[e.jsx(C,{title:"Grundinformationen",subtitle:"Name, Slug und Status des Partners",icon:de,accentColor:"blue",defaultExpanded:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(P,{value:t.name,onChange:a=>n({...t,name:a.target.value}),placeholder:"z.B. Vertriebsakademie Müller"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Slug (URL-ID)"}),e.jsx(P,{value:t.slug,onChange:a=>n({...t,slug:a.target.value.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")}),placeholder:"z.B. vertriebsakademie-mueller"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Wird in der URL verwendet: ?partner=",t.slug||"ihr-slug"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Beschreibung"}),e.jsx(ve,{value:t.description,onChange:a=>n({...t,description:a.target.value}),placeholder:"Optionale Beschreibung des Partners...",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:t.status,onChange:a=>n({...t,status:a.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"draft",children:"Entwurf"}),e.jsx("option",{value:"publish",children:"Aktiv"}),e.jsx("option",{value:"pending",children:"Ausstehend"})]})]})]})}),e.jsx(C,{title:"Erlaubte Module",subtitle:"Welche Funktionen für diesen Partner verfügbar sind",icon:xe,accentColor:"green",badge:t.modules?.length>0?`${t.modules.length} ausgewählt`:"Alle",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Keine Auswahl = Alle Module sind erlaubt"}),e.jsx("div",{className:"space-y-2",children:ke.map(a=>e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:t.modules?.includes(a.id)||!1,onChange:()=>m(a.id),className:"rounded border-gray-300"}),e.jsx("span",{className:"text-sm",children:a.label})]},a.id))})]})}),e.jsxs(C,{title:"Branding Vorschau",subtitle:"Live-Vorschau der konfigurierten Farben",icon:me,accentColor:"orange",defaultExpanded:!0,children:[e.jsx(Pe,{branding:t.branding}),e.jsx("p",{className:"text-xs text-slate-500 text-center",children:"Ändern Sie die Farben in den Sektionen unten"})]}),we.map(a=>{const i=Ce[a.iconName];return e.jsx(C,{title:a.title,subtitle:a.subtitle,icon:i,accentColor:a.accentColor,children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.fields.map(l=>e.jsx(Se,{label:l.label,value:t.branding?.[l.key],defaultValue:r[l.key],onChange:u=>d(l.key,u)},l.key))})},a.id)})]})}export{ze as default};
