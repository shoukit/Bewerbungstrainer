import{av as _,T as ze,ad as Ae,c as $e,as as Re,q as De,U as Be,B as Te,j as e,aU as te,aM as be,aL as ne,aV as Me,l as We,z as Ue,az as Oe}from"./ui-vendor-B9DEMv6g.js";import{a as p}from"./react-vendor-uDOJF2jQ.js";import{w as _e,u as Fe,D as V,C as k}from"./FeatureInfoButton-DsfjgKw4.js";import{S as Ge,a as He}from"./ScenarioCard-OpqbSsPm.js";import{D as Ke,a as Ye,b as Ze,c as qe}from"./dialog-Dg1K-ctH.js";import{u as Je}from"./useMobile-YxjH166V.js";import{B as Qe}from"./Button-BHvYxNT_.js";import"./select-native-BMh_kGEB.js";const Xe={briefcase:Te,users:Be,"trending-up":De,"message-circle":Re,shield:$e,heart:Ae,target:ze,folder:_},N=_,j=n=>!n||typeof n!="string"?N:Xe[n.toLowerCase()]||N,D=n=>!n||typeof n!="string"?"":n.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/[^a-z0-9]/g,""),ee={career:"karriere",leadership:"fuehrung",sales:"vertrieb",communication:"kommunikation",service:"service",social:"social",karriere:"karriere",fuehrung:"fuehrung",vertrieb:"vertrieb",kommunikation:"kommunikation",meine:"meine",selfpresentation:"karriere",interview:"karriere",pitch:"vertrieb",negotiation:"vertrieb",vorstellungsgespraech:"karriere",gehaltsverhandlung:"vertrieb",fuehrungsgespraech:"fuehrung",praesentation:"kommunikation",selbstvorstellung:"karriere",training:"kommunikation"};let B=null,re=null;const Pe=300*1e3;function Ve(){const[n,d]=p.useState(B||[]),[c,u]=p.useState(!B),[h,y]=p.useState(null),g=p.useCallback(async()=>{if(B&&re&&Date.now()-re<Pe)return d(B),u(!1),B;try{u(!0),y(null);const l=await _e.getCategories();return B=l,re=Date.now(),d(l),l}catch(l){return console.error("[useCategories] Failed to fetch categories:",l),y(l.message||"Failed to fetch categories"),[]}finally{u(!1)}},[]);p.useEffect(()=>{g()},[g]);const f=p.useCallback(l=>{if(!l||!n.length)return null;const i=D(l),a=ee[i]||i,t=n.find(r=>D(r.slug)===a||D(r.name)===a);return t?{...t,IconComponent:j(t.icon),bgColor:`${t.color}15`}:null},[n]),b=p.useCallback(l=>{if(Array.isArray(l)){for(const t of l){if(typeof t!="string")continue;const r=f(t);if(r)return{key:r.slug,label:r.name,shortLabel:r.shortName||r.name,icon:j(r.icon),IconComponent:j(r.icon),color:r.color,bgColor:r.bgColor}}const a=l.find(t=>typeof t=="string")||"unknown";return{key:String(a),label:String(a),shortLabel:String(a),icon:N,IconComponent:N,color:"#64748b",bgColor:"#f1f5f9"}}if(typeof l!="string")return{key:"unknown",label:"Unbekannt",shortLabel:"Unbekannt",icon:N,IconComponent:N,color:"#64748b",bgColor:"#f1f5f9"};const i=f(l);return i?{key:i.slug,label:i.name,shortLabel:i.shortName||i.name,icon:j(i.icon),IconComponent:j(i.icon),color:i.color,bgColor:i.bgColor}:{key:l||"unknown",label:l||"Unbekannt",shortLabel:l||"Unbekannt",icon:N,IconComponent:N,color:"#64748b",bgColor:"#f1f5f9"}},[f]),w=p.useCallback((l=[])=>{if(!n.length)return[];if(!l.length)return n.map(a=>({key:a.slug,label:a.name,shortLabel:a.shortName||a.name,icon:j(a.icon),IconComponent:j(a.icon),color:a.color,bgColor:`${a.color}15`}));const i=new Map;return l.forEach(a=>{if(a){if(Array.isArray(a))a.forEach(t=>{if(!t||typeof t!="string"||!t.trim())return;const r=f(t);r&&!i.has(r.slug)&&i.set(r.slug,{key:r.slug,label:r.name,shortLabel:r.shortName||r.name,icon:j(r.icon),IconComponent:j(r.icon),color:r.color,bgColor:r.bgColor})});else if(typeof a=="string"&&a.trim()){const t=f(a);t&&!i.has(t.slug)&&i.set(t.slug,{key:t.slug,label:t.name,shortLabel:t.shortName||t.name,icon:j(t.icon),IconComponent:j(t.icon),color:t.color,bgColor:t.bgColor})}}}),Array.from(i.values())},[n,f]),v=p.useCallback((l,i)=>{if(!l||!i)return!1;const a=D(i);if(Array.isArray(l))return l.some(L=>{const z=D(L);return(ee[z]||z)===a});const t=D(l);return(ee[t]||t)===a},[]),I=p.useMemo(()=>{const l=new Map;return n.forEach(i=>{l.set(i.slug,{...i,IconComponent:j(i.icon),bgColor:`${i.color}15`})}),l},[n]);return{categories:n,categoriesMap:I,loading:c,error:h,refetch:g,getCategoryBySlug:f,getCategoryConfig:b,getCategoriesForFilter:w,matchesCategory:v}}const O=({label:n,icon:d,isSelected:c,onClick:u})=>e.jsxs("button",{onClick:u,className:`inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold
      border-2 cursor-pointer transition-all whitespace-nowrap
      ${c?"border-primary bg-primary/10 text-primary":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[d&&e.jsx(d,{className:"w-3.5 h-3.5"}),n]}),er=({count:n})=>n===0?null:e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-md bg-red-500 text-white text-xs font-semibold flex items-center justify-center",children:n}),rr=({value:n,onChange:d,placeholder:c,className:u=""})=>e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(be,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-[18px] h-[18px] text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:n,onChange:h=>d(h.target.value),className:"w-full py-3 pl-11 pr-4 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20"})]}),me=({value:n,onChange:d,options:c,className:u=""})=>e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(ne,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("select",{value:n,onChange:h=>d(h.target.value),className:"w-full py-3 pl-10 pr-10 rounded-lg border border-slate-200 text-base text-slate-900 bg-white cursor-pointer outline-none appearance-none bg-no-repeat",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundPosition:"right 12px center"},children:c.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]}),ge=({viewMode:n,onViewModeChange:d,compact:c=!1})=>e.jsxs("div",{className:`flex items-center gap-1 ${c?"p-[3px]":"p-1"} bg-slate-100 rounded-lg`,children:[e.jsx("button",{onClick:()=>d("grid"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${n==="grid"?"bg-white shadow-sm":"bg-transparent"}`,title:"Kachelansicht",children:e.jsx(te,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${n==="grid"?"text-primary":"text-slate-500"}`})}),e.jsx("button",{onClick:()=>d("list"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${n==="list"?"bg-white shadow-sm":"bg-transparent"}`,title:"Listenansicht",children:e.jsx(Me,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${n==="list"?"text-primary":"text-slate-500"}`})})]}),tr=({searchQuery:n,onSearchChange:d,searchPlaceholder:c="Durchsuchen...",showSearch:u=!0,categories:h=[],selectedCategory:y,onCategoryChange:g,showCategories:f=!0,difficultyOptions:b=[],selectedDifficulty:w,onDifficultyChange:v,showDifficulty:I=!1,viewMode:l,onViewModeChange:i,showViewToggle:a=!0,renderCustomFilters:t,customActions:r,children:L})=>{const[z,A]=p.useState(!1),F=Je(),$=[y?1:0,w&&w!=="all"?1:0,n?.trim()?1:0].reduce((m,T)=>m+T,0);return F?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[u&&e.jsxs("div",{className:"relative flex-1",children:[e.jsx(be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:n,onChange:m=>d(m.target.value),className:"w-full py-2 pl-9 pr-3 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none"})]}),e.jsxs("button",{onClick:()=>A(!0),className:`relative flex items-center justify-center w-11 h-11 rounded-lg border flex-shrink-0 cursor-pointer
            ${$>0?"border-primary bg-primary/10":"border-slate-200 bg-white"}`,children:[e.jsx(ne,{className:`w-[18px] h-[18px] ${$>0?"text-primary":"text-slate-500"}`}),e.jsx(er,{count:$})]}),a&&l&&e.jsx(ge,{viewMode:l,onViewModeChange:i,compact:!0})]}),r&&e.jsx("div",{className:"mt-2",children:r}),e.jsx(Ke,{open:z,onOpenChange:A,children:e.jsxs(Ye,{className:"fixed bottom-0 left-0 right-0 top-auto transform-none max-w-full w-full rounded-t-2xl max-h-[80vh] overflow-auto",children:[e.jsx(Ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(qe,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 text-primary"}),"Filter"]}),$>0&&e.jsx("button",{onClick:()=>{g?.(null),v?.("all"),d?.("")},className:"px-3 py-1 rounded-md border-none bg-slate-100 text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-200 transition-colors",children:"Zurücksetzen"})]})}),e.jsxs("div",{className:"flex flex-col gap-5 py-2",children:[I&&b.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Schwierigkeit"}),e.jsx(me,{value:w,onChange:v,options:b})]}),f&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Kategorie"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(O,{label:"Alle",icon:te,isSelected:!y,onClick:()=>g(null)}),h.map(m=>e.jsx(O,{label:m.label,icon:m.icon,isSelected:y===m.key,onClick:()=>g(m.key)},m.key))]})]}),t&&e.jsx("div",{children:t()})]}),e.jsx(Qe,{variant:"primary",size:"lg",onClick:()=>A(!1),fullWidth:!0,className:"mt-3",children:"Filter anwenden"})]})}),L]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[u&&e.jsx(rr,{value:n,onChange:d,placeholder:c,className:"flex-1 min-w-[200px]"}),I&&b.length>0&&e.jsx(me,{value:w,onChange:v,options:b,className:"min-w-[180px]"}),t&&t(),r,a&&l&&e.jsx(ge,{viewMode:l,onViewModeChange:i})]}),f&&h.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(O,{label:"Alle",icon:te,isSelected:!y,onClick:()=>g(null)}),h.map(m=>e.jsx(O,{label:m.label,icon:m.icon,isSelected:y===m.key,onClick:()=>g(m.key)},m.key))]}),L]})},fe=({category:n,getCategoryConfig:d})=>{const c=d(n);if(!c)return null;const u=c.IconComponent||c.icon||_;return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 10px",borderRadius:"16px",fontSize:"11px",fontWeight:600,backgroundColor:c.bgColor,color:c.color},children:[e.jsx(u,{style:{width:"12px",height:"12px"}}),c.shortLabel]})},nr=({category:n,getCategoryConfig:d})=>Array.isArray(n)?e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:n.map((c,u)=>e.jsx(fe,{category:c,getCategoryConfig:d},u))}):e.jsx(fe,{category:n,getCategoryConfig:d}),xr=({title:n,subtitle:d,headerIcon:c,fetchScenarios:u,moduleKey:h,historyButtonLabel:y="Meine Sessions",onNavigateToHistory:g,showHistoryButton:f=!0,onSelectScenario:b,renderCardMeta:w,renderCategoryBadge:v,getIconForScenario:I,cardActionLabel:l="Starten",cardActionIcon:i,getCardCustomActions:a,categoryField:t="category",customCategoryConfig:r,emptyStateIcon:L,emptyStateTitle:z="Keine Szenarien verfügbar",emptyStateMessage:A="Bitte kontaktieren Sie den Administrator.",searchPlaceholder:F="Durchsuchen...",headerActions:$,filterActions:m,renderInfoBox:T,extraContent:je,isAuthenticated:M,requireAuth:G,setPendingAction:H,setPendingScenario:K,demoCode:se,pendingScenario:Y,clearPendingScenario:Z,loadingMessage:ye="Szenarien werden geladen...",errorRetryLabel:ke="Erneut versuchen"})=>{const[le,we]=p.useState([]),[ve,oe]=p.useState(!0),[ie,ae]=p.useState(null),[E,ce]=p.useState(null),[q,Ce]=p.useState("grid"),[W,Se]=p.useState(""),{branding:J,filterScenariosBySetupAndPartner:pe}=Fe(),{getCategoryConfig:Q,getCategoriesForFilter:de,matchesCategory:U}=Ve(),Ne=J?.["--header-gradient"]||V["--header-gradient"],Ie=J?.["--header-text"]||V["--header-text"],R=J?.["--primary-accent"]||V["--primary-accent"],X=p.useCallback(async()=>{try{oe(!0),ae(null);const s=await u();we(s||[])}catch(s){console.error(`[${n}] Error loading scenarios:`,s),ae(s.message||"Fehler beim Laden")}finally{oe(!1)}},[u,n]);p.useEffect(()=>{X()},[X]);const xe=p.useRef(!1);p.useEffect(()=>{Y&&M&&!xe.current&&(xe.current=!0,Z&&Z(),b(Y))},[Y,M,Z,b]);const C=p.useMemo(()=>pe([...le],h),[le,pe,h]),P=p.useMemo(()=>{if(r){const o=new Set;return C.forEach(x=>{const S=x[t];S&&r[S]&&o.add(S)}),Array.from(o)}const s=C.flatMap(o=>{const x=o[t];return Array.isArray(x)?x.filter(S=>S&&typeof S=="string"&&S.trim()):x&&typeof x=="string"&&x.trim()?[x]:[]});return[...new Set(s)]},[C,t,r]),ue=p.useMemo(()=>r?P.filter(o=>C.some(x=>x[t]===o)).map(o=>({key:o,label:r[o]?.label||o,shortLabel:r[o]?.label||o,color:r[o]?.color,bgColor:r[o]?.bgColor,icon:r[o]?.icon,IconComponent:r[o]?.icon})):de(P).filter(o=>!o||!o.label||!o.label.trim()?!1:C.some(x=>U(x[t],o.key))),[P,r,de,C,t,U]),he=p.useMemo(()=>{let s=[...C];if(E&&(r?s=s.filter(o=>o[t]===E):s=s.filter(o=>U(o[t],E))),W.trim()){const o=W.toLowerCase();s=s.filter(x=>x.title?.toLowerCase().includes(o)||x.description?.toLowerCase().includes(o))}return s},[C,E,W,t,r,U]),Le=p.useCallback(s=>{if(!M&&!se){K?K(s):H&&H({type:"SELECT_SCENARIO",scenario:s}),G&&G(()=>{b(s)},{type:"SELECT_SCENARIO",scenario:s});return}b(s)},[M,se,K,H,G,b]),Ee=p.useCallback(s=>{const o=s[t];if(!o)return null;if(v)return v(s,Q);if(r&&r[o]){const x=r[o];return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"4px 10px",borderRadius:"16px",fontSize:"11px",fontWeight:600,backgroundColor:x.bgColor,color:x.color},children:[x.icon&&e.jsx(x.icon,{style:{width:"12px",height:"12px"}}),x.label]})}return e.jsx(nr,{category:o,getCategoryConfig:Q})},[t,v,r,Q]);return ve?e.jsxs("div",{style:{minHeight:"60vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",gap:"16px"},children:[e.jsx(We,{style:{width:"48px",height:"48px",color:R,animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{color:k.slate[600],fontSize:"16px"},children:ye}),e.jsx("style",{children:`
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `})]}):ie?e.jsxs("div",{style:{minHeight:"60vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",gap:"16px"},children:[e.jsx(Ue,{style:{width:"48px",height:"48px",color:k.red[500]}}),e.jsx("p",{style:{color:k.red[500],fontSize:"16px",textAlign:"center"},children:ie}),e.jsx("button",{onClick:X,style:{padding:"12px 24px",borderRadius:"12px",border:"none",background:R,color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:ke})]}):e.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{marginBottom:"32px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:Ne,display:"flex",alignItems:"center",justifyContent:"center"},children:c&&e.jsx(c,{style:{width:"24px",height:"24px",color:Ie}})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"28px",fontWeight:700,color:k.slate[900],margin:0},children:n}),e.jsx("p",{style:{fontSize:"14px",color:k.slate[600],margin:0},children:d})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[$,f&&g&&e.jsxs("button",{onClick:g,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",borderRadius:"12px",border:`2px solid ${R}`,backgroundColor:"white",color:R,fontSize:"14px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(Oe,{size:18}),y]})]})]}),e.jsx("div",{style:{marginTop:"24px"},children:e.jsx(tr,{searchQuery:W,onSearchChange:Se,searchPlaceholder:F,categories:ue.map(s=>({key:s.key,label:s.label,shortLabel:s.shortLabel||s.label,color:s.color,bgColor:s.bgColor,icon:s.IconComponent||s.icon})),selectedCategory:E,onCategoryChange:ce,showCategories:ue.length>0,showDifficulty:!1,viewMode:q,onViewModeChange:Ce,customActions:m})})]}),he.length>0?e.jsx(Ge,{minCardWidth:"340px",viewMode:q,children:he.map(s=>{const o=I?I(s):null,x=w?w(s):[],S=a?a(s):null;return e.jsx(He,{title:s.title,description:s.description,icon:o,categoryBadge:Ee(s),meta:x,action:i?{label:l,icon:i}:{label:l},onClick:()=>Le(s),viewMode:q,customActions:S},s.id)})}):e.jsxs("div",{style:{textAlign:"center",padding:"48px 24px",backgroundColor:"white",borderRadius:"16px",border:`1px solid ${k.slate[200]}`},children:[e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"16px"},children:L?e.jsx(L,{style:{width:"48px",height:"48px",color:k.slate[300]}}):e.jsx(_,{style:{width:"48px",height:"48px",color:k.slate[300]}})}),e.jsx("h3",{style:{color:k.slate[500],margin:"0 0 8px 0",fontWeight:500},children:z}),e.jsx("p",{style:{color:k.slate[400],margin:0,fontSize:"14px"},children:E?"In der ausgewählten Kategorie sind keine Szenarien verfügbar.":A}),E&&C.length>0&&e.jsx("button",{onClick:()=>ce(null),style:{marginTop:"16px",padding:"10px 20px",borderRadius:"20px",border:`2px solid ${R}`,backgroundColor:"white",color:R,fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Alle Szenarien anzeigen"})]}),T&&T(),je]})};export{xr as S};
