import{j as e,a6 as V,F,h as ue,x as K,aj as O,ax as ke,q as Se,ay as Ce,ai as we,R as G,C as N,c as q,w as Y,az as Z,aA as J,v as Q,T as X,E as ee,s as te,U as ne,ao as re,B as se,Q as fe,W as he,e as be,Y as le,a as me,a4 as ye,n as de,aB as ce,a5 as pe,O as ze,aC as xe,l as ae,m as je,X as ve,aD as Be,aE as Ie,aF as Re,A as Te}from"./ui-vendor-BAEfSb-X.js";import{a as l}from"./react-vendor-uDOJF2jQ.js";import{u as ie,D as oe,w as _}from"./designTokens-LSOQEIoP.js";import{S as Ee}from"./ScenarioDashboard-khg2dnvk.js";import{F as De,a as We}from"./index.js";import{F as $e}from"./fullscreen-loader-CDncfBzO.js";import{a as Ae,B as Le}from"./BriefingWorkbook-DD-984qs.js";import{u as Fe}from"./useBranding-CRmuKfX5.js";import{u as Oe}from"./useMobile-YxjH166V.js";import"./ScenarioCard-Da4NRxEW.js";import"./dialog-Bc6rUSl2.js";import"./utils-BEHD0UYf.js";const _e={"file-text":F,briefcase:se,banknote:re,users:ne,user:te,"message-circle":ee,target:X,award:Q,book:J,clipboard:Z,star:Y,lightbulb:K,shield:q,compass:N,rocket:G,heart:we,folder:Ce,"trending-up":Se},Me=({onSelectTemplate:t,onShowList:x,onCreateTemplate:f,onEditTemplate:d,isAuthenticated:j,requireAuth:c,setPendingAction:i,demoCode:n})=>{const{branding:u}=ie(),s=u?.["--primary-accent"]||oe["--primary-accent"],[h,g]=l.useState(null),[p,b]=l.useState(0),k=l.useCallback(async()=>{const y=new URLSearchParams;n&&y.append("demo_code",n);const a=await _.request(`/smartbriefing/templates?${y.toString()}`,{method:"GET"});if(a.success&&a.data?.templates)return a.data.templates;throw new Error("Unerwartete API-Antwort")},[n,p]),C=()=>{if(!j&&!n){c&&(i(()=>f),c());return}f?.()},m=(y,a)=>{y.stopPropagation(),d?.(a)},w=(y,a)=>{y.stopPropagation(),g(a)},o=async()=>{if(h)try{const y=new URLSearchParams;n&&y.append("demo_code",n),(await _.request(`/smartbriefing/templates/${h.id}?${y.toString()}`,{method:"DELETE"})).success&&b(v=>v+1)}catch(y){console.error("[SmartBriefing] Error deleting template:",y)}finally{g(null)}},z=y=>_e[y.icon]||F,I=y=>{const a=y.variables_schema?.length||0;return[{text:`${a} Eingabefeld${a!==1?"er":""}`}]},D=y=>y.is_custom?e.jsxs("div",{style:{display:"flex",gap:"4px"},children:[e.jsx("button",{onClick:a=>m(a,y),style:{padding:"6px",borderRadius:"6px",border:"none",backgroundColor:"transparent",color:"#64748b",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="#f1f5f9",a.currentTarget.style.color=s},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent",a.currentTarget.style.color="#64748b"},title:"Template bearbeiten",children:e.jsx(ke,{size:16})}),e.jsx("button",{onClick:a=>w(a,y),style:{padding:"6px",borderRadius:"6px",border:"none",backgroundColor:"transparent",color:"#64748b",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="#fef2f2",a.currentTarget.style.color="#ef4444"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="transparent",a.currentTarget.style.color="#64748b"},title:"Template löschen",children:e.jsx(V,{size:16})})]}):null,W=(j||n)&&f?e.jsxs("button",{onClick:C,style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",borderRadius:"10px",border:"2px dashed #cbd5e1",backgroundColor:"white",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:y=>{y.currentTarget.style.borderColor=s,y.currentTarget.style.color=s},onMouseLeave:y=>{y.currentTarget.style.borderColor="#cbd5e1",y.currentTarget.style.color="#64748b"},children:[e.jsx(O,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"persönliches Template"}),e.jsx("span",{className:"sm:hidden",children:"Template"})]}):null,$=()=>e.jsx("div",{style:{marginTop:"48px",padding:"20px 24px",backgroundColor:`${s}08`,borderRadius:"12px",border:`1px solid ${s}20`},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(K,{size:20,style:{color:s,flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 4px 0",color:"#0f172a",fontSize:"14px",fontWeight:600},children:"So funktioniert Smart Briefing"}),e.jsx("p",{style:{margin:0,color:"#64748b",fontSize:"13px",lineHeight:1.6},children:"Wahle ein Template aus, gib deine spezifischen Informationen ein (z.B. Unternehmen, Position), und erhalte ein massgeschneidertes Briefing mit Insider-Wissen, Fachbegriffen und cleveren Ruckfragen."})]})]})}),M=h&&e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:"16px"},onClick:()=>g(null),children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"100%",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[e.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:"#fef2f2",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(V,{size:24,style:{color:"#ef4444"}})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:600,color:"#0f172a"},children:"Template löschen?"}),e.jsx("p",{style:{margin:0,fontSize:"14px",color:"#64748b"},children:"Diese Aktion kann nicht rückgängig gemacht werden."})]})]}),e.jsx("div",{style:{backgroundColor:"#f8fafc",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:e.jsx("p",{style:{margin:0,fontSize:"14px",color:"#475569"},children:e.jsx("strong",{children:h.title})})}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>g(null),style:{padding:"10px 20px",borderRadius:"8px",border:"1px solid #e2e8f0",backgroundColor:"white",color:"#475569",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:o,style:{padding:"10px 20px",borderRadius:"8px",border:"none",backgroundColor:"#ef4444",color:"white",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Löschen"})]})]})});return e.jsxs(e.Fragment,{children:[e.jsx(De,{featureId:"smartbriefing",showOnMount:!0}),e.jsx(Ee,{title:"Smart Briefing",subtitle:"Dein KI-gestützter Vorbereitungs-Assistent",headerIcon:F,headerActions:e.jsx(We,{featureId:"smartbriefing",size:"sm"}),fetchScenarios:k,moduleKey:"briefings",historyButtonLabel:"Meine Briefings",onNavigateToHistory:x,onSelectScenario:t,renderCardMeta:I,getIconForScenario:z,getCardCustomActions:D,cardActionLabel:"Briefing erstellen",cardActionIcon:ue,categoryField:"category",emptyStateIcon:F,emptyStateTitle:"Keine Templates gefunden",emptyStateMessage:"Es wurden noch keine Briefing-Templates erstellt.",searchPlaceholder:"Briefings durchsuchen...",filterActions:W,renderInfoBox:$,extraContent:M,isAuthenticated:j,requireAuth:c,setPendingAction:i,demoCode:n,loadingMessage:"Templates werden geladen..."},p)]})},Pe=({field:t,value:x,onChange:f,error:d,primaryAccent:j})=>{const c={width:"100%",padding:"14px 16px",borderRadius:"12px",border:`2px solid ${d?"#ef4444":"#e2e8f0"}`,fontSize:"16px",color:"#0f172a",backgroundColor:"white",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",boxSizing:"border-box"},i=s=>{s.target.style.borderColor=j,s.target.style.boxShadow=`0 0 0 3px ${j}1a`},n=s=>{s.target.style.borderColor=d?"#ef4444":"#e2e8f0",s.target.style.boxShadow="none"},u=()=>{switch(t.type){case"textarea":return e.jsx("textarea",{value:x||"",onChange:s=>f(t.key,s.target.value),placeholder:t.placeholder||"",rows:4,style:{...c,minHeight:"120px",resize:"vertical"},onFocus:i,onBlur:n});case"select":return e.jsxs("select",{value:x||t.default||"",onChange:s=>f(t.key,s.target.value),style:{...c,cursor:"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 12px center",backgroundSize:"20px",paddingRight:"44px"},onFocus:i,onBlur:n,children:[e.jsx("option",{value:"",children:"Bitte wahlen..."}),t.options?.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]});case"text":default:return e.jsx("input",{type:"text",value:x||"",onChange:s=>f(t.key,s.target.value),placeholder:t.placeholder||"",style:c,onFocus:i,onBlur:n})}};return e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#374151",marginBottom:"8px"},children:[t.label,t.required&&e.jsx("span",{style:{color:"#ef4444",marginLeft:"4px"},children:"*"})]}),u(),d&&e.jsx("p",{style:{color:"#ef4444",fontSize:"13px",marginTop:"6px",margin:"6px 0 0 0"},children:d})]})},Ve=({variable:t,index:x,onChange:f,onDelete:d,primaryAccent:j})=>e.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"12px",marginBottom:"12px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[e.jsx("input",{type:"text",value:t.key||"",onChange:c=>f(x,"key",c.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")),placeholder:"variable_name",style:{padding:"8px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",backgroundColor:"#f8fafc",flex:1,marginRight:"8px"}}),e.jsx("button",{type:"button",onClick:()=>d(x),style:{padding:"8px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(V,{size:18})})]}),e.jsx("textarea",{value:t.value||"",onChange:c=>f(x,"value",c.target.value),placeholder:"Wert eingeben... (mehrzeilig möglich)",rows:3,style:{width:"100%",padding:"10px 12px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"14px",resize:"vertical",minHeight:"80px",boxSizing:"border-box"}})]}),Ke=({template:t,onBack:x,onBriefingGenerated:f,isAuthenticated:d})=>{const{branding:j}=ie(),[c,i]=l.useState({}),[n,u]=l.useState({}),[s,h]=l.useState(!1),[g,p]=l.useState(null),[b,k]=l.useState([]),[C,m]=l.useState(!1),w=j?.["--primary-accent"]||oe["--primary-accent"],o=j?.["--button-gradient"]||oe["--button-gradient"],z=Ae(t?.icon);l.useEffect(()=>{if(t?.variables_schema){const a={};t.variables_schema.forEach(v=>{v.default&&(a[v.key]=v.default)}),i(a)}k([]),m(!1)},[t]);const I=()=>{k([...b,{key:"",value:""}])},D=(a,v,B)=>{const A=[...b];A[a][v]=B,k(A)},W=a=>{k(b.filter((v,B)=>B!==a))},$=(a,v)=>{i(B=>({...B,[a]:v})),n[a]&&u(B=>{const A={...B};return delete A[a],A})},M=()=>{const a={};return t?.variables_schema?.forEach(v=>{v.required&&!c[v.key]&&(a[v.key]="Dieses Feld ist erforderlich")}),a},y=async a=>{a.preventDefault();const v=M();if(Object.keys(v).length>0){u(v);return}h(!0),p(null);try{const B={};b.forEach(r=>{r.key&&r.value&&(B[r.key]=r.value)});const A={template_id:t.id,variables:c};Object.keys(B).length>0&&(A.custom_variables=B);const P=await _.request("/smartbriefing/generate",{method:"POST",body:JSON.stringify(A)});if(P.success&&P.data?.briefing)f(P.data.briefing);else throw new Error("Unerwartete API-Antwort")}catch(B){console.error("[SmartBriefing] Error generating briefing:",B),p(B.message||"Fehler beim Generieren des Briefings")}finally{h(!1)}};return t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{padding:"24px",paddingTop:"32px",maxWidth:"700px",margin:"0 auto"},children:[e.jsxs("button",{onClick:x,disabled:s,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 0",border:"none",background:"none",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:s?"not-allowed":"pointer",marginBottom:"24px",opacity:s?.5:1},children:[e.jsx(fe,{size:18}),e.jsx("span",{style:{lineHeight:"1.4"},children:"Zurück zur Übersicht"})]}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",marginBottom:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"12px",background:`linear-gradient(135deg, ${w}15, ${w}25)`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(z,{size:28,style:{color:w}})}),e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"22px",fontWeight:700,color:"#0f172a",margin:"0 0 4px 0"},children:t.title}),e.jsx("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:t.description})]})]})}),e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx("h2",{style:{fontSize:"16px",fontWeight:600,color:"#0f172a",margin:"0 0 20px 0",paddingBottom:"16px",borderBottom:"1px solid #f1f5f9"},children:"Deine Angaben"}),e.jsxs("form",{onSubmit:y,children:[t.variables_schema?.map(a=>e.jsx(Pe,{field:a,value:c[a.key],onChange:$,error:n[a.key],primaryAccent:w},a.key)),t.allow_custom_variables&&e.jsxs("div",{style:{marginTop:"24px",marginBottom:"20px",paddingTop:"20px",borderTop:"1px solid #f1f5f9"},children:[e.jsxs("button",{type:"button",onClick:()=>m(!C),style:{display:"flex",alignItems:"flex-start",gap:"8px",padding:"0",border:"none",background:"none",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",marginBottom:C?"16px":"0",textAlign:"left"},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0},children:[C?e.jsx(he,{size:18}):e.jsx(be,{size:18}),e.jsx(O,{size:16})]}),e.jsx("span",{style:{lineHeight:"1.4"},children:"Zusätzliche Variablen hinzufügen (optional)"})]}),C&&e.jsxs("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",padding:"16px"},children:[e.jsx("p",{style:{fontSize:"13px",color:"#64748b",margin:"0 0 12px 0"},children:"Füge eigene Variablen hinzu, die in die Briefing-Generierung einfließen sollen."}),b.length>0&&e.jsx("div",{style:{marginBottom:"12px"},children:b.map((a,v)=>e.jsx(Ve,{variable:a,index:v,onChange:D,onDelete:W,primaryAccent:w},v))}),e.jsxs("button",{type:"button",onClick:I,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",border:"1px dashed #cbd5e1",borderRadius:"8px",backgroundColor:"white",color:"#64748b",fontSize:"13px",cursor:"pointer"},children:[e.jsx(O,{size:14}),"Variable hinzufügen"]})]})]}),g&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"16px",marginBottom:"20px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(le,{size:20,style:{color:"#ef4444",flexShrink:0}}),e.jsx("div",{children:e.jsx("p",{style:{margin:0,color:"#991b1b",fontSize:"14px"},children:g})})]}),e.jsxs("button",{type:"submit",disabled:s,style:{width:"100%",padding:"16px 24px",borderRadius:"12px",border:"none",background:o,color:"white",fontSize:"16px",fontWeight:600,cursor:s?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",transition:"all 0.2s",boxShadow:`0 4px 14px ${w}40`,opacity:s?.7:1},children:[e.jsx(me,{size:20}),"Briefing generieren"]})]})]})]}),e.jsx($e,{isLoading:s,message:"Smart Briefing wird erstellt...",subMessage:"Die KI analysiert deine Angaben und erstellt ein maßgeschneidertes Briefing."})]}):null},He={"file-text":F,briefcase:se,banknote:re,users:ne,user:te,"message-circle":ee,target:X,award:Q,book:J,clipboard:Z,star:Y,lightbulb:K,shield:q,compass:N,rocket:G},Ue=({content:t,primaryAccent:x})=>{if(!t)return null;const f=j=>{const c=j.split(`
`),i=[];let n=[],u=null;const s=()=>{n.length>0&&(i.push(e.jsx("ul",{style:{margin:"12px 0",paddingLeft:"24px",listStyle:"none"},children:n.map((h,g)=>e.jsxs("li",{style:{marginBottom:"8px",fontSize:"15px",lineHeight:1.6,color:"#374151",position:"relative",paddingLeft:"20px"},children:[e.jsx("span",{style:{position:"absolute",left:0,color:x,fontWeight:"bold"},children:u==="number"?`${g+1}.`:""}),d(h)]},g))},`list-${i.length}`)),n=[],u=null)};return c.forEach((h,g)=>{const p=h.trim();if(!p){s();return}if(p.startsWith("### ")){s(),i.push(e.jsx("h3",{style:{fontSize:"18px",fontWeight:700,color:"#0f172a",margin:"24px 0 12px 0",paddingTop:"16px",borderTop:g>0?"1px solid #f1f5f9":"none",display:"flex",alignItems:"center",gap:"8px"},children:d(p.substring(4))},`h3-${g}`));return}if(p.startsWith("## ")){s(),i.push(e.jsx("h2",{style:{fontSize:"20px",fontWeight:700,color:"#0f172a",margin:"28px 0 14px 0"},children:d(p.substring(3))},`h2-${g}`));return}if(p.startsWith("# ")){s(),i.push(e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:"#0f172a",margin:"32px 0 16px 0"},children:d(p.substring(2))},`h1-${g}`));return}if(p.startsWith("- ")||p.startsWith("* ")){u!=="bullet"&&(s(),u="bullet"),n.push(p.substring(2));return}const b=p.match(/^(\d+)\.\s/);if(b){u!=="number"&&(s(),u="number"),n.push(p.substring(b[0].length));return}s(),i.push(e.jsx("p",{style:{margin:"12px 0",fontSize:"15px",lineHeight:1.7,color:"#374151"},children:d(p)},`p-${g}`))}),s(),i},d=j=>{const c=[];let i=j,n=0;for(;i.length>0;){const u=i.match(/\*\*(.+?)\*\*/),s=i.match(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)|_([^_]+)_")),h=i.match(/`([^`]+)`/),g=[{match:u,type:"bold"},{match:s,type:"italic"},{match:h,type:"code"}].filter(b=>b.match);if(g.length===0){c.push(i);break}const p=g.reduce((b,k)=>(b.match?.index??1/0)<(k.match?.index??1/0)?b:k);switch(p.match.index>0&&c.push(i.substring(0,p.match.index)),p.type){case"bold":c.push(e.jsx("strong",{style:{fontWeight:600,color:"#0f172a"},children:p.match[1]},n++));break;case"italic":c.push(e.jsx("em",{style:{fontStyle:"italic"},children:p.match[1]||p.match[2]},n++));break;case"code":c.push(e.jsx("code",{style:{backgroundColor:"#f1f5f9",padding:"2px 6px",borderRadius:"4px",fontSize:"13px",fontFamily:"monospace",color:x},children:p.match[1]},n++));break}i=i.substring(p.match.index+p.match[0].length)}return c};return e.jsx("div",{children:f(t)})},Ge=({briefing:t,template:x,onBack:f,onCreateNew:d,onGenerateAnother:j})=>{const c=Fe(),i=Oe(),[n,u]=l.useState(!1),s=l.useRef(null),h=c.primaryAccent,g=c.headerGradient,p=He[x?.icon||t?.template_icon]||F,b=m=>m?new Date(m).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",k=async()=>{try{await navigator.clipboard.writeText(t.content_markdown),u(!0),setTimeout(()=>u(!1),2e3)}catch(m){console.error("[SmartBriefing] Failed to copy:",m)}},C=()=>{const m=`${x?.title||t?.template_title}
${"=".repeat(50)}

Erstellt am: ${b(t.created_at)}

${t.content_markdown}`,w=new Blob([m],{type:"text/plain;charset=utf-8"}),o=URL.createObjectURL(w),z=document.createElement("a");z.href=o,z.download=`briefing-${t.id}.txt`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(o)};return t?e.jsxs("div",{style:{minHeight:"100vh",background:c.pageBg},children:[e.jsx("div",{style:{background:g,padding:i?"20px 16px":"24px 32px",position:"sticky",top:0,zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[f&&e.jsxs("button",{onClick:f,style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",color:"#fff",fontSize:"13px",marginBottom:"16px"},children:[e.jsx(fe,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{style:{display:"flex",alignItems:i?"flex-start":"center",gap:i?"16px":"24px",flexDirection:i?"column":"row"},children:[e.jsx("div",{style:{width:i?70:90,height:i?70:90,borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(p,{size:i?32:40,color:"#fff"})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.2)",color:"#fff"},children:"Smart Briefing"}),e.jsxs("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.9)",color:h,display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(me,{size:12}),"Fertig!"]})]}),e.jsx("h1",{style:{fontSize:i?"20px":"24px",fontWeight:700,color:"#fff",margin:0,marginBottom:"8px"},children:x?.title||t?.template_title}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(ye,{size:14}),b(t.created_at)]})})]}),!i&&e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("button",{onClick:k,style:{display:"flex",alignItems:"center",gap:"8px",background:n?"rgba(34,197,94,0.3)":"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[n?e.jsx(de,{size:16}):e.jsx(ce,{size:16}),n?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:C,style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[e.jsx(pe,{size:16}),"Speichern"]})]})]})]})}),e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:i?"16px":"24px 32px"},children:[i&&e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[e.jsxs("button",{onClick:k,style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"12px",borderRadius:"10px",border:`1px solid ${c.borderColor}`,backgroundColor:n?"#dcfce7":"white",color:n?"#16a34a":c.textSecondary,fontSize:"13px",fontWeight:500,cursor:"pointer"},children:[n?e.jsx(de,{size:16}):e.jsx(ce,{size:16}),n?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:C,style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"12px",borderRadius:"10px",border:`1px solid ${c.borderColor}`,backgroundColor:"white",color:c.textSecondary,fontSize:"13px",fontWeight:500,cursor:"pointer"},children:[e.jsx(pe,{size:16}),"Speichern"]})]}),e.jsx("div",{ref:s,style:{backgroundColor:"white",borderRadius:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden",border:`1px solid ${c.borderColor}`},children:e.jsx("div",{style:{padding:i?"20px":"32px"},children:e.jsx(Ue,{content:t.content_markdown,primaryAccent:h})})}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"24px",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:j,style:{flex:1,minWidth:"200px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:`2px solid ${h}`,backgroundColor:"white",color:h,fontSize:"15px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(ze,{size:18}),"Mit anderen Angaben neu generieren"]}),e.jsxs("button",{onClick:d,style:{flex:1,minWidth:"200px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${h}, ${h}dd)`,color:"white",fontSize:"15px",fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:`0 4px 14px ${h}40`},children:[e.jsx(O,{size:18}),"Neues Briefing erstellen"]})]})]})]}):null},Ne={"file-text":F,briefcase:se,banknote:re,users:ne,user:te,"message-circle":ee,target:X,award:Q,book:J,clipboard:Z,star:Y,lightbulb:K,shield:q,compass:N,rocket:G},qe=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",Ye=({briefing:t,onOpen:x,onDelete:f,primaryAccent:d,isDeleting:j})=>{const[c,i]=l.useState(!1),[n,u]=l.useState(!1),s=Ne[t.template_icon]||F,h=g=>{g.stopPropagation(),n?(f(t.id),u(!1)):(u(!0),setTimeout(()=>u(!1),3e3))};return e.jsxs("div",{onClick:()=>x(t),onMouseEnter:()=>i(!0),onMouseLeave:()=>{i(!1),u(!1)},style:{backgroundColor:"white",borderRadius:"16px",padding:"20px",border:`2px solid ${c?d:"#e2e8f0"}`,boxShadow:c?`0 10px 25px -5px rgba(0,0,0,0.1), 0 0 0 1px ${d}20`:"0 1px 3px rgba(0,0,0,0.1)",cursor:"pointer",transition:"all 0.3s ease",transform:c?"translateY(-2px)":"translateY(0)",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[e.jsx("div",{style:{width:"44px",height:"44px",borderRadius:"10px",background:`linear-gradient(135deg, ${d}15, ${d}25)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(s,{size:22,style:{color:d}})}),e.jsx("button",{onClick:h,disabled:j,style:{padding:"8px",borderRadius:"8px",border:"none",backgroundColor:n?"#fef2f2":c?"#f1f5f9":"transparent",color:n?"#ef4444":"#94a3b8",cursor:j?"not-allowed":"pointer",transition:"all 0.2s",opacity:c||n?1:0},children:j?e.jsx(ae,{size:18,style:{animation:"spin 1s linear infinite"}}):e.jsx(V,{size:18})})]}),e.jsx("h3",{style:{fontSize:"16px",fontWeight:600,color:"#0f172a",margin:"0 0 4px 0",lineHeight:1.3,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.title||"Unbenanntes Briefing"}),e.jsx("p",{style:{fontSize:"13px",color:"#64748b",margin:"0 0 12px 0"},children:t.template_title}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"12px",borderTop:"1px solid #f1f5f9"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:"#94a3b8",fontSize:"12px"},children:[e.jsx(ye,{size:14}),qe(t.created_at)]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:d,fontSize:"13px",fontWeight:500},children:["Offnen",e.jsx(ue,{size:16})]})]}),n&&e.jsx("div",{style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"8px 12px",fontSize:"12px",color:"#dc2626",fontWeight:500,zIndex:10},onClick:g=>g.stopPropagation(),children:"Nochmal klicken zum Loschen"}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})},Ze=({onOpenBriefing:t,onCreateNew:x,isAuthenticated:f})=>{const{config:d}=ie(),[j,c]=l.useState([]),[i,n]=l.useState(!0),[u,s]=l.useState(null),[h,g]=l.useState(null),p=d?.buttonGradientStart||"#3A7FA7";l.useEffect(()=>{(async()=>{if(!f){n(!1);return}try{n(!0),s(null);const C=await _.request("/smartbriefing/briefings",{method:"GET"});if(C.success&&C.data?.briefings){const m=C.data.briefings.filter(w=>w.status==="completed");c(m)}else throw new Error("Unerwartete API-Antwort")}catch(C){console.error("[SmartBriefing] Error fetching briefings:",C),s(C.message||"Fehler beim Laden der Briefings")}finally{n(!1)}})()},[f]);const b=async k=>{try{if(g(k),(await _.request(`/smartbriefing/briefings/${k}`,{method:"DELETE"})).success)c(m=>m.filter(w=>w.id!==k));else throw new Error("Fehler beim Loschen")}catch(C){console.error("[SmartBriefing] Error deleting briefing:",C),s(C.message||"Fehler beim Loschen des Briefings")}finally{g(null)}};return f?e.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:"#0f172a",margin:"0 0 4px 0"},children:"Meine Briefings"}),e.jsxs("p",{style:{fontSize:"14px",color:"#64748b",margin:0},children:[j.length," gespeicherte Briefings"]})]}),e.jsxs("button",{onClick:x,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${p}, ${p}dd)`,color:"white",fontSize:"14px",fontWeight:600,cursor:"pointer",boxShadow:`0 4px 14px ${p}40`},children:[e.jsx(O,{size:18}),"Neues Briefing"]})]}),i&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"64px 24px"},children:[e.jsx(ae,{size:40,style:{color:p,animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{marginTop:"16px",color:"#64748b"},children:"Briefings werden geladen..."})]}),u&&!i&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px",padding:"24px",display:"flex",alignItems:"flex-start",gap:"12px"},children:[e.jsx(le,{size:24,style:{color:"#ef4444",flexShrink:0}}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px 0",color:"#dc2626",fontSize:"16px"},children:"Fehler beim Laden"}),e.jsx("p",{style:{margin:0,color:"#991b1b",fontSize:"14px"},children:u})]})]}),!i&&!u&&e.jsx(e.Fragment,{children:j.length===0?e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"48px 24px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx(xe,{size:48,style:{color:"#cbd5e1",marginBottom:"16px"}}),e.jsx("h2",{style:{color:"#64748b",margin:"0 0 8px 0",fontSize:"18px"},children:"Noch keine Briefings"}),e.jsx("p",{style:{color:"#94a3b8",margin:"0 0 24px 0",fontSize:"14px"},children:"Erstelle dein erstes Briefing, um loszulegen."}),e.jsxs("button",{onClick:x,style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${p}, ${p}dd)`,color:"white",fontSize:"15px",fontWeight:600,cursor:"pointer",boxShadow:`0 4px 14px ${p}40`},children:[e.jsx(O,{size:18}),"Briefing erstellen"]})]}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:j.map(k=>e.jsx(Ye,{briefing:k,onOpen:t,onDelete:b,primaryAccent:p,isDeleting:h===k.id},k.id))})})]}):e.jsx("div",{style:{padding:"24px",maxWidth:"800px",margin:"0 auto"},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"48px 24px",textAlign:"center",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsx(xe,{size:48,style:{color:"#cbd5e1",marginBottom:"16px"}}),e.jsx("h2",{style:{color:"#64748b",margin:"0 0 8px 0",fontSize:"18px"},children:"Anmeldung erforderlich"}),e.jsx("p",{style:{color:"#94a3b8",margin:"0 0 24px 0",fontSize:"14px"},children:"Melde dich an, um deine gespeicherten Briefings zu sehen."})]})})},Je=[{key:"file-text",icon:F,label:"Dokument"},{key:"briefcase",icon:se,label:"Koffer"},{key:"banknote",icon:re,label:"Geld"},{key:"users",icon:ne,label:"Team"},{key:"user",icon:te,label:"Person"},{key:"target",icon:X,label:"Ziel"},{key:"lightbulb",icon:K,label:"Idee"},{key:"star",icon:Y,label:"Stern"},{key:"shield",icon:q,label:"Schutz"},{key:"compass",icon:N,label:"Kompass"},{key:"rocket",icon:G,label:"Rakete"},{key:"message-circle",icon:ee,label:"Nachricht"},{key:"award",icon:Q,label:"Auszeichnung"},{key:"book",icon:J,label:"Buch"},{key:"clipboard",icon:Z,label:"Checkliste"}],ge=[{value:"text",label:"Einzeiliges Textfeld"},{value:"textarea",label:"Mehrzeiliges Textfeld"},{value:"select",label:"Dropdown-Auswahl"}],U=()=>`var_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Qe=()=>({id:U(),key:"",label:"",type:"text",required:!0,placeholder:"",options:[]}),Xe=()=>({id:U(),value:"",label:""}),et=({variable:t,index:x,total:f,onChange:d,onDelete:j,onMoveUp:c,onMoveDown:i,primaryAccent:n})=>{const[u,s]=l.useState(!0),[h,g]=l.useState(t.label);l.useEffect(()=>{g(t.label)},[t.label]);const p=(o,z)=>{d({...t,[o]:z})},b=()=>{const o=[...t.options||[],Xe()];d({...t,options:o})},k=(o,z,I)=>{const D=t.options.map(W=>W.id===o?{...W,[z]:I}:W);d({...t,options:D})},C=o=>{const z=t.options.filter(I=>I.id!==o);d({...t,options:z})},m=o=>o.toLowerCase().replace(/[äöüß]/g,z=>({ä:"ae",ö:"oe",ü:"ue",ß:"ss"})[z]).replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),w=()=>{if(h!==t.label){const o={label:h};(!t.key||t.key===m(t.label))&&(o.key=m(h)),d({...t,...o})}};return e.jsxs("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0",marginBottom:"12px",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",backgroundColor:"white",borderBottom:u?"1px solid #e2e8f0":"none",cursor:"pointer"},onClick:()=>s(!u),children:[e.jsx(Re,{size:16,style:{color:"#94a3b8",cursor:"grab"}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("span",{style:{fontWeight:600,color:"#0f172a",fontSize:"14px"},children:t.label||`Variable ${x+1}`}),t.key&&e.jsxs("span",{style:{marginLeft:"8px",color:"#64748b",fontSize:"12px"},children:["$","{","$",t.key,"}"]})]}),e.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:500,backgroundColor:`${n}15`,color:n},children:ge.find(o=>o.value===t.type)?.label||t.type}),e.jsxs("div",{style:{display:"flex",gap:"2px"},children:[e.jsx("button",{onClick:o=>{o.stopPropagation(),c()},disabled:x===0,style:{padding:"4px",border:"none",backgroundColor:"transparent",cursor:x===0?"not-allowed":"pointer",opacity:x===0?.3:1},children:e.jsx(he,{size:16,style:{color:"#64748b"}})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),i()},disabled:x===f-1,style:{padding:"4px",border:"none",backgroundColor:"transparent",cursor:x===f-1?"not-allowed":"pointer",opacity:x===f-1?.3:1},children:e.jsx(be,{size:16,style:{color:"#64748b"}})})]}),e.jsx("button",{onClick:o=>{o.stopPropagation(),j()},style:{padding:"6px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444"},title:"Variable löschen",children:e.jsx(V,{size:16})})]}),e.jsx(Te,{children:u&&e.jsx(je.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Feldbezeichnung *"}),e.jsx("input",{type:"text",value:h,onChange:o=>g(o.target.value),onBlur:w,placeholder:"z.B. Unternehmen",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Variablenname *"}),e.jsx("input",{type:"text",value:t.key,onChange:o=>p("key",o.target.value),placeholder:"z.B. unternehmen",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Feldtyp"}),e.jsx("select",{value:t.type,onChange:o=>p("type",o.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",backgroundColor:"white"},children:ge.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 0",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:t.required,onChange:o=>p("required",o.target.checked),style:{width:"16px",height:"16px",accentColor:n}}),e.jsx("span",{style:{fontSize:"14px",color:"#475569"},children:"Pflichtfeld"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Platzhalter-Text (optional)"}),e.jsx("input",{type:"text",value:t.placeholder,onChange:o=>p("placeholder",o.target.value),placeholder:"z.B. BMW AG, Siemens, etc.",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"}})]}),t.type==="select"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"8px"},children:"Auswahloptionen"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(t.options||[]).map((o,z)=>e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx("input",{type:"text",value:o.value,onChange:I=>k(o.id,"value",I.target.value),placeholder:"Wert",style:{flex:1,padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px",fontFamily:"monospace"}}),e.jsx("input",{type:"text",value:o.label,onChange:I=>k(o.id,"label",I.target.value),placeholder:"Anzeigename",style:{flex:2,padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px"}}),e.jsx("button",{onClick:()=>C(o.id),style:{padding:"6px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444"},children:e.jsx(V,{size:14})})]},o.id)),e.jsxs("button",{onClick:b,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",border:"1px dashed #cbd5e1",borderRadius:"6px",backgroundColor:"transparent",color:"#64748b",fontSize:"13px",cursor:"pointer",marginTop:"4px"},children:[e.jsx(O,{size:14}),"Option hinzufügen"]})]})]})]})})})]})},tt=({selectedIcon:t,onSelect:x,primaryAccent:f})=>e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px"},children:Je.map(({key:d,icon:j,label:c})=>{const i=t===d;return e.jsx("button",{onClick:()=>x(d),title:c,style:{width:"60px",height:"60px",borderRadius:"12px",border:`2px solid ${i?f:"#e2e8f0"}`,backgroundColor:i?`${f}15`:"white",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},children:e.jsx(j,{size:28,style:{color:i?f:"#64748b"}})},d)})}),nt=({isOpen:t,onClose:x,onSave:f,editTemplate:d=null,demoCode:j})=>{const{branding:c,config:i}=ie(),n=c?.["--primary-accent"]||i?.buttonGradientStart||"#3A7FA7",[u,s]=l.useState(""),[h,g]=l.useState(""),[p,b]=l.useState("file-text"),[k,C]=l.useState(""),[m,w]=l.useState([]),[o,z]=l.useState(!1),[I,D]=l.useState(null),[W,$]=l.useState("basics");l.useEffect(()=>{d?(s(d.title||""),g(d.description||""),b(d.icon||"file-text"),C(d.system_prompt||""),w((d.variables_schema||[]).map(r=>({...r,id:r.id||U(),options:(r.options||[]).map(S=>({...S,id:S.id||U()}))})))):(s(""),g(""),b("file-text"),C(""),w([])),$("basics"),D(null)},[d,t]);const M=()=>{w([...m,Qe()])},y=(r,S)=>{const R=[...m];R[r]=S,w(R)},a=r=>{w(m.filter((S,R)=>R!==r))},v=r=>{if(r===0)return;const S=[...m];[S[r-1],S[r]]=[S[r],S[r-1]],w(S)},B=r=>{if(r===m.length-1)return;const S=[...m];[S[r],S[r+1]]=[S[r+1],S[r]],w(S)},A=()=>{if(!u.trim())return D("Bitte gib einen Titel ein."),$("basics"),!1;if(!k.trim())return D("Bitte gib einen System-Prompt ein."),$("prompt"),!1;for(const r of m){if(!r.key.trim()||!r.label.trim())return D("Alle Variablen benötigen einen Namen und eine Bezeichnung."),$("variables"),!1;if(r.type==="select"&&(!r.options||r.options.length===0))return D(`Variable "${r.label}" benötigt mindestens eine Auswahloption.`),$("variables"),!1}return!0},P=async()=>{if(D(null),!!A()){z(!0);try{const r=m.map(L=>({key:L.key,label:L.label,type:L.type,required:L.required,placeholder:L.placeholder,...L.type==="select"?{options:L.options.map(T=>({value:T.value,label:T.label}))}:{}})),S={title:u.trim(),description:h.trim(),icon:p,system_prompt:k,variables_schema:r,...j?{demo_code:j}:{}};let R;if(d?R=await _.request(`/smartbriefing/templates/${d.id}`,{method:"PUT",body:JSON.stringify(S)}):R=await _.request("/smartbriefing/templates",{method:"POST",body:JSON.stringify(S)}),R.success)f?.(R.data.template),x();else throw new Error(R.message||"Fehler beim Speichern")}catch(r){console.error("[CreateTemplateDialog] Save error:",r),D(r.message||"Fehler beim Speichern des Templates")}finally{z(!1)}}};return t?e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:"16px"},children:e.jsxs(je.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{backgroundColor:"white",borderRadius:"20px",width:"100%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden"},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:700,color:"#0f172a"},children:d?"Template bearbeiten":"Neues Template erstellen"}),e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"#64748b"},children:"Erstelle ein persönliches Briefing-Template"})]}),e.jsx("button",{onClick:x,style:{padding:"8px",border:"none",backgroundColor:"#f1f5f9",borderRadius:"8px",cursor:"pointer"},children:e.jsx(ve,{size:20,style:{color:"#64748b"}})})]}),e.jsx("div",{style:{display:"flex",borderBottom:"1px solid #e2e8f0",padding:"0 24px"},children:[{key:"basics",label:"Grundlagen"},{key:"variables",label:"Eingabefelder"},{key:"prompt",label:"KI-Anweisung"}].map(r=>e.jsx("button",{onClick:()=>$(r.key),style:{padding:"12px 20px",border:"none",backgroundColor:"transparent",fontSize:"14px",fontWeight:600,cursor:"pointer",color:W===r.key?n:"#64748b",borderBottom:`3px solid ${W===r.key?n:"transparent"}`,marginBottom:"-1px",transition:"all 0.2s"},children:r.label},r.key))}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:"24px"},children:[I&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"12px 16px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(le,{size:18,style:{color:"#ef4444",flexShrink:0}}),e.jsx("span",{style:{color:"#dc2626",fontSize:"14px"},children:I})]}),W==="basics"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"Titel *"}),e.jsx("input",{type:"text",value:u,onChange:r=>s(r.target.value),placeholder:"z.B. Projektpräsentation Vorbereitung",style:{width:"100%",padding:"12px 14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"15px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"Beschreibung"}),e.jsx("textarea",{value:h,onChange:r=>g(r.target.value),placeholder:"Kurze Beschreibung, wofür dieses Template verwendet wird...",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"14px",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"8px"},children:"Symbol"}),e.jsx(tt,{selectedIcon:p,onSelect:b,primaryAccent:n})]})]}),W==="variables"&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(Be,{size:16,style:{color:"#64748b"}}),e.jsx("span",{style:{fontSize:"13px",color:"#64748b"},children:"Definiere die Eingabefelder, die der Nutzer beim Erstellen eines Briefings ausfüllen soll."})]})}),m.map((r,S)=>e.jsx(et,{variable:r,index:S,total:m.length,onChange:R=>y(S,R),onDelete:()=>a(S),onMoveUp:()=>v(S),onMoveDown:()=>B(S),primaryAccent:n},r.id)),e.jsxs("button",{onClick:M,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"14px",borderRadius:"10px",border:"2px dashed #cbd5e1",backgroundColor:"white",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:r=>{r.currentTarget.style.borderColor=n,r.currentTarget.style.color=n},onMouseLeave:r=>{r.currentTarget.style.borderColor="#cbd5e1",r.currentTarget.style.color="#64748b"},children:[e.jsx(O,{size:18}),"Eingabefeld hinzufügen"]}),m.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"32px",color:"#94a3b8",fontSize:"14px"},children:"Noch keine Eingabefelder definiert."})]}),W==="prompt"&&e.jsxs("div",{children:[e.jsx("div",{style:{backgroundColor:"#f0f9ff",borderRadius:"10px",padding:"16px",marginBottom:"16px",border:"1px solid #bae6fd"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px"},children:[e.jsx(K,{size:18,style:{color:"#0284c7",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 6px 0",fontSize:"14px",fontWeight:600,color:"#0369a1"},children:"Tipps für effektive Prompts"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"13px",color:"#0369a1",lineHeight:1.6},children:[e.jsxs("li",{children:["Verwende ",e.jsxs("code",{style:{backgroundColor:"#e0f2fe",padding:"1px 4px",borderRadius:"3px"},children:["$","{variablenname}"]})," um auf Eingabefelder zu verweisen"]}),e.jsx("li",{children:'Beschreibe die Rolle der KI (z.B. "Du bist ein erfahrener Karriere-Coach...")'}),e.jsx("li",{children:"Definiere die Struktur des gewünschten Outputs"}),e.jsx("li",{children:"Gib Beispiele für den Ton und Stil"})]})]})]})}),m.length>0&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("span",{style:{fontSize:"12px",color:"#64748b"},children:"Verfügbare Variablen: "}),m.map(r=>e.jsxs("code",{style:{display:"inline-block",padding:"2px 6px",marginRight:"6px",marginBottom:"4px",backgroundColor:"#f1f5f9",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace",color:"#475569",cursor:"pointer"},onClick:()=>{const S=`\${${r.key}}`;C(R=>R+S)},title:"Klicken zum Einfügen",children:["$","{"+r.key+"}"]},r.id))]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"System-Prompt *"}),e.jsx("textarea",{value:k,onChange:r=>C(r.target.value),placeholder:`Du bist ein erfahrener Experte für...

Erstelle ein strukturiertes Briefing für den Nutzer basierend auf folgenden Informationen:
- Position: \${position}
- Unternehmen: \${unternehmen}

Das Briefing soll folgende Abschnitte enthalten:
1. ...
2. ...

Formatiere jeden Abschnitt mit einem Titel und 5-8 konkreten Bullet Points.`,rows:15,style:{width:"100%",padding:"14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",resize:"vertical",lineHeight:1.5}})]})]})]}),e.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[e.jsx("button",{onClick:x,style:{padding:"12px 24px",borderRadius:"10px",border:"1px solid #e2e8f0",backgroundColor:"white",color:"#475569",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:P,disabled:o,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 24px",borderRadius:"10px",border:"none",background:`linear-gradient(135deg, ${n} 0%, ${n}dd 100%)`,color:"white",fontSize:"14px",fontWeight:600,cursor:o?"not-allowed":"pointer",opacity:o?.7:1},children:o?e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:18,style:{animation:"spin 1s linear infinite"}}),"Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{size:18}),d?"Speichern":"Template erstellen"]})})]}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}):null},E={DASHBOARD:"dashboard",FORM:"form",RESULT:"result",LIST:"list",WORKBOOK:"workbook"},ft=({isAuthenticated:t,requireAuth:x,setPendingAction:f,onNavigateToSimulator:d,onNavigateToHistory:j,demoCode:c})=>{const[i,n]=l.useState(E.DASHBOARD),[u,s]=l.useState(null),[h,g]=l.useState(null),[p,b]=l.useState(null),[k,C]=l.useState(null),[m,w]=l.useState(!1),[o,z]=l.useState(null),[I,D]=l.useState(0);l.useEffect(()=>{k&&t&&(s(k),n(E.FORM),C(null))},[k,t]),l.useEffect(()=>{window.scrollTo(0,0)},[i]);const W=l.useCallback(T=>{s(T),n(E.FORM)},[]),$=l.useCallback(()=>{s(null),g(null),b(null),n(E.DASHBOARD)},[]),M=l.useCallback(T=>{g(T),b(T),n(E.WORKBOOK)},[]),y=l.useCallback(()=>{g(null),b(null),s(null),n(E.DASHBOARD)},[]),a=l.useCallback(()=>{g(null),b(null),n(E.FORM)},[]);l.useCallback(()=>{n(E.LIST)},[]);const v=l.useCallback(T=>{b(T),n(E.WORKBOOK)},[]);l.useCallback(()=>{b(null),n(E.LIST)},[]);const B=l.useCallback(T=>{d&&d(T)},[d]),A=l.useCallback(async T=>{try{if((await _.request(`/smartbriefing/briefings/${T.id}`,{method:"DELETE"})).success)b(null),n(E.DASHBOARD);else throw new Error("Fehler beim Löschen")}catch(H){throw console.error("[SmartBriefing] Error deleting briefing:",H),H}},[]),P=l.useCallback(()=>{z(null),w(!0)},[]),r=l.useCallback(T=>{z(T),w(!0)},[]),S=l.useCallback(()=>{w(!1),z(null)},[]),R=l.useCallback(T=>{D(H=>H+1)},[]),L=()=>{switch(i){case E.FORM:return e.jsx(Ke,{template:u,onBack:$,onBriefingGenerated:M,isAuthenticated:t});case E.RESULT:return e.jsx(Ge,{briefing:h,template:u,onBack:$,onCreateNew:y,onGenerateAnother:a});case E.LIST:return e.jsx(Ze,{onOpenBriefing:v,onCreateNew:y,isAuthenticated:t});case E.WORKBOOK:return e.jsx(Le,{briefing:p,onBack:$,onDelete:A,onStartSimulation:d?B:null});case E.DASHBOARD:default:return e.jsx(Me,{onSelectTemplate:W,onShowList:j,onCreateTemplate:P,onEditTemplate:r,isAuthenticated:t,requireAuth:x,setPendingAction:f,demoCode:c},I)}};return e.jsxs("div",{style:{minHeight:"100%"},children:[L(),e.jsx(nt,{isOpen:m,onClose:S,onSave:R,editTemplate:o,demoCode:c})]})};export{Ze as BriefingList,Ge as BriefingResult,Le as BriefingWorkbook,ft as SmartBriefingApp,Me as SmartBriefingDashboard,Ke as SmartBriefingForm};
