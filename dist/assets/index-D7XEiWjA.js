import{j as e,d as N,m as g,aa as O,ab as G,am as V,y as K,ae as M,f as W,H as $,h as F,l as J,a as Q,g as X}from"./ui-vendor-w3QMwUw1.js";import{a}from"./react-vendor-uDOJF2jQ.js";import{B as T}from"./select-native-a06Ufdzz.js";import{w as b,k as Y,q as U,C as c}from"./FeatureInfoButton-DOlrUowH.js";import"./dialog-Dl3u2MoA.js";import{F as C,u as Z}from"./useScrollToTop-DcDjf9hQ.js";import{a as q,D as ee}from"./DecisionBoardResult-BVBdNYLx.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";import"./input-BGIQpOO6.js";import"./textarea-DNkfWAYb.js";import"./index.js";import"./AudioRecorder-_eG8qG_8.js";import"./button-DCmq61py.js";import"./card-26TC7KQi.js";const se=[{icon:O,color:c.emerald[500],title:"Pro-Argumente",description:"Sammle alle Vorteile mit Gewichtung"},{icon:G,color:c.rose[500],title:"Contra-Argumente",description:"Erfasse Nachteile und Risiken"},{icon:V,color:c.violet[500],title:"KI-Analyse",description:"Objektive Auswertung deiner Argumente"},{icon:K,color:c.amber[500],title:"Coaching-Impulse",description:"Neue Perspektiven für deine Entscheidung"}],te=({onStartNew:f,onContinueSession:w,onNavigateToHistory:D,isAuthenticated:d,requireAuth:y,setPendingAction:o})=>{const[p,j]=a.useState([]),[E,u]=a.useState(!1),r=U(c.teal[500],c.teal[400]);a.useEffect(()=>{d&&x()},[d]);const x=async()=>{u(!0);try{const t=await b.getDecisions();if(t?.data?.decisions){const m=t.data.decisions.sort((v,S)=>new Date(S.created_at)-new Date(v.created_at)).slice(0,5);j(m)}}catch(t){console.error("[DecisionDashboard] Failed to load sessions:",t)}finally{u(!1)}},I=a.useCallback(()=>{if(!d){o&&o({type:"decision_start"}),y&&y(()=>{f()});return}f()},[d,y,o,f]),A=t=>new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}),h=t=>t.status==="completed"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700",children:[e.jsx(Q,{className:"w-3 h-3"}),"Abgeschlossen"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-700",children:[e.jsx(X,{className:"w-3 h-3"}),"Entwurf"]});return e.jsxs(e.Fragment,{children:[e.jsx(Y,{featureId:"decisionboard",showOnMount:!0}),e.jsxs("div",{className:"min-h-full",children:[e.jsx(C,{featureId:"decisionboard",icon:N,title:"Entscheidungs-Board",subtitle:"Strukturierte Entscheidungsfindung",gradient:r,historyLabel:"Meine Entscheidungen",onNavigateToHistory:D,showHistoryButton:d&&p.length>0}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl mx-auto mb-6 flex items-center justify-center",style:{background:r},children:e.jsx(N,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:"Fundierte Entscheidungen treffen"}),e.jsx("p",{className:"text-slate-600 max-w-2xl mx-auto leading-relaxed",children:"Stehst du vor einer wichtigen Entscheidung? Das Entscheidungs-Board hilft dir, Pro- und Contra-Argumente systematisch zu sammeln, zu gewichten und mit KI-Unterstützung die richtige Wahl zu treffen."})]}),e.jsx(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-10",children:se.map((t,m)=>e.jsxs(g.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1+m*.05},className:"bg-white rounded-xl p-4 border border-slate-200 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl mx-auto mb-3 flex items-center justify-center",style:{backgroundColor:`${t.color}15`},children:e.jsx(t.icon,{className:"w-6 h-6",style:{color:t.color}})}),e.jsx("h3",{className:"font-semibold text-slate-800 text-sm mb-1",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500",children:t.description})]},t.title))}),e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-center mb-12",children:[e.jsxs(T,{onClick:I,size:"lg",className:"px-8 py-4 text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all",style:{background:r,color:"white"},children:[e.jsx(M,{className:"w-5 h-5 mr-2"}),"Neue Entscheidung starten",e.jsx(W,{className:"w-5 h-5 ml-2"})]}),!d&&e.jsx("p",{className:"text-sm text-slate-500 mt-3",children:"Anmeldung erforderlich zum Starten"})]}),d&&p.length>0&&e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-slate-400"}),"Letzte Entscheidungen"]}),p.length>=5&&e.jsxs(T,{variant:"ghost",size:"sm",onClick:D,className:"text-slate-600 hover:text-slate-800",children:["Alle anzeigen",e.jsx(F,{className:"w-4 h-4 ml-1"})]})]}),e.jsx("div",{className:"space-y-3",children:p.map((t,m)=>e.jsx(g.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5+m*.05},className:"bg-white rounded-xl p-4 border border-slate-200 hover:border-teal-300 hover:shadow-md transition-all cursor-pointer group",onClick:()=>w(t),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{background:`${c.teal[500]}15`},children:e.jsx(N,{className:"w-5 h-5",style:{color:c.teal[500]}})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:t.topic?t.topic.substring(0,50)+(t.topic.length>50?"...":""):"Entscheidungsanalyse"}),e.jsx("p",{className:"text-sm text-slate-500",children:A(t.created_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[h(t),e.jsx(F,{className:"w-5 h-5 text-slate-400 group-hover:text-teal-500 transition-colors"})]})]})},t.id))})]}),e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"mt-12 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-2xl p-6 border border-teal-100",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-teal-500"}),"So funktioniert's"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Fragestellung eingeben"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Beschreibe deine Entscheidung oder Frage"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"Argumente sammeln"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Füge Pro- und Contra-Punkte mit Gewichtung hinzu"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-800",children:"KI-Analyse erhalten"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Erhalte eine fundierte Empfehlung und neue Perspektiven"})]})]})]})]})]})]})]})},l={DASHBOARD:"dashboard",INPUT:"input",RESULT:"result"},ye=({isAuthenticated:f,requireAuth:w,setPendingAction:D,onNavigateToHistory:d})=>{const[y,o]=a.useState(l.DASHBOARD),[p,j]=a.useState(null),[E,u]=a.useState(null),[r,x]=a.useState(null),[I,A]=a.useState(!1),h=a.useRef(!1),t=U(c.teal[500],c.teal[400]);Z({dependencies:[y]});const m=a.useCallback(()=>{j(null),u(null),x(null),h.current=!1,o(l.INPUT)},[]),v=a.useCallback(async s=>{try{x(s.id),h.current=!0;const n={topic:s.topic||"",context:s.context||"",pros:s.pros||[],cons:s.cons||[],proScore:s.pro_score||0,contraScore:s.contra_score||0};j(n),s.status==="completed"&&s.analysis?(u(s.analysis),o(l.RESULT)):o(l.INPUT)}catch(n){console.error("[DecisionBoard] Failed to load session:",n)}},[]),S=a.useCallback(()=>{o(l.DASHBOARD)},[]),_=a.useCallback(async s=>{if(h.current||!s.topic?.trim())return null;try{const n={topic:s.topic,context:s.context||null,pros:s.pros||[],cons:s.cons||[],pro_score:s.proScore||0,contra_score:s.contraScore||0,status:"draft"},i=await b.createDecision(n);if(i?.id)return h.current=!0,x(i.id),console.log("[DecisionBoard] Draft session saved with ID:",i.id),i.id}catch(n){console.error("[DecisionBoard] Failed to save draft session:",n)}return null},[]),k=a.useCallback(async(s,n)=>{if(s)try{const i={topic:n.topic,context:n.context||null,pros:n.pros||[],cons:n.cons||[],pro_score:n.proScore||0,contra_score:n.contraScore||0,analysis:n.analysis||null,status:n.status||"completed"};await b.updateDecision(s,i),console.log("[DecisionBoard] Session updated:",s)}catch(i){console.error("[DecisionBoard] Failed to update session:",i)}},[]),R=a.useCallback(async s=>{if(s)try{await b.deleteDecision(s),console.log("[DecisionBoard] Session deleted:",s)}catch(n){console.error("[DecisionBoard] Failed to delete session:",n)}},[]),z=a.useCallback(async(s,n)=>{j(s),u(n),o(l.RESULT);try{if(r)await k(r,{...s,analysis:n,status:"completed"});else{const i={topic:s.topic,context:s.context||null,pros:s.pros,cons:s.cons,pro_score:s.proScore,contra_score:s.contraScore,analysis:n,status:"completed"},B=await b.createDecision(i);B?.id&&(x(B.id),h.current=!0,console.log("[DecisionBoard] Decision saved with ID:",B.id))}}catch(i){console.error("[DecisionBoard] Failed to save decision:",i)}},[r,k]),L=a.useCallback(()=>{u(null),o(l.INPUT)},[]),H=a.useCallback(async()=>{r&&await R(r),j(null),u(null),x(null),h.current=!1,o(l.DASHBOARD)},[r,R]),P=()=>{switch(y){case l.DASHBOARD:return e.jsx(te,{onStartNew:m,onContinueSession:v,onNavigateToHistory:d,isAuthenticated:f,requireAuth:w,setPendingAction:D});case l.RESULT:return e.jsxs(e.Fragment,{children:[e.jsx(C,{featureId:"decisionboard",icon:N,title:"Entscheidungs-Board",subtitle:"Deine Analyse",gradient:t,showBackButton:!0,onBack:S}),e.jsx(ee,{decisionData:p,analysisResult:E,onStartNew:m,onEditDecision:L})]});case l.INPUT:default:return e.jsxs(e.Fragment,{children:[e.jsx(C,{featureId:"decisionboard",icon:N,title:"Entscheidungs-Board",subtitle:"Strukturierte Entscheidungsfindung",gradient:t,showBackButton:!0,onBack:S}),e.jsx(q,{initialData:p,onAnalysisComplete:z,onCancel:H,isAuthenticated:f,requireAuth:w,savedDecisionId:r,onSaveDraft:_,onUpdateSession:k,onDecisionIdChange:x})]})}};return e.jsx("div",{className:"min-h-full",children:P()})};export{ye as DecisionBoardApp,q as DecisionBoardInput,ee as DecisionBoardResult};
