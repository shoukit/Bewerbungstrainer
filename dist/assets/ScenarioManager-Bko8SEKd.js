import{j as e,a1 as ie,z as K,X as le,v as ne,M as F,al as re,aQ as ae,L as b,aa as ce,O as oe,F as de,w as he,E as xe}from"./ui-vendor-Mj2_BHwd.js";import{a as n}from"./react-vendor-uDOJF2jQ.js";import{C as k,a as z}from"./card-B7pPIjvq.js";import{B as r}from"./button-aST1fZsy.js";import{I as u}from"./input-8NGOBwP_.js";import{T as w}from"./textarea-Cvie9LXd.js";import{D as E,a as L,b as A,c as B,d as I,e as T}from"./dialog-DNcIzlLr.js";import{F as me,a as R}from"./form-accordion-DzfJ48Yv.js";import{w as N}from"./FeatureInfoButton-CmzxY1Ui.js";import"./index-CXo7hDKg.js";import"./utils-09jiQjc0.js";function Ce({onBack:t}){const[l,i]=n.useState([]),[y,O]=n.useState(!0),[S,P]=n.useState(null),[h,V]=n.useState(""),[$,p]=n.useState(!1),[U,g]=n.useState(!1),[Z,j]=n.useState(!1),[C,G]=n.useState(null),[c,o]=n.useState(!1),[d,v]=n.useState({title:"",description:"",agent_id:"",initial_message:"",difficulty:"medium",status:"draft",coaching_hints:"",interviewer_profile:{name:"",role:"",properties:""}}),[f,_]=n.useState(null);n.useEffect(()=>{x()},[]);const x=async()=>{try{O(!0),P(null);const s=await N.adminGetRoleplayScenarios();if(s.success)i(s.data||[]);else throw new Error("Fehler beim Laden der Szenarien")}catch(s){P(s.message),a("error","Fehler beim Laden der Szenarien")}finally{O(!1)}},a=(s,m)=>{_({type:s,message:m}),setTimeout(()=>_(null),4e3)},M=()=>{v({title:"",description:"",agent_id:"",initial_message:"",difficulty:"medium",status:"draft",coaching_hints:"",interviewer_profile:{name:"",role:"",properties:""}}),p(!0)},q=s=>{G(s),v({title:s.title||"",description:s.description||"",agent_id:s.agent_id||"",initial_message:s.initial_message||"",difficulty:s.difficulty||"medium",status:s.status||"draft",coaching_hints:s.coaching_hints||"",interviewer_profile:{name:s.interviewer_profile?.name||"",role:s.interviewer_profile?.role||"",properties:s.interviewer_profile?.properties||""}}),g(!0)},X=s=>{G(s),j(!0)},J=async()=>{if(!d.title.trim()){a("error","Bitte geben Sie einen Titel ein");return}try{if(o(!0),(await N.adminCreateRoleplayScenario(d)).success)a("success","Szenario erfolgreich erstellt"),p(!1),x();else throw new Error("Fehler beim Erstellen")}catch(s){a("error",s.message)}finally{o(!1)}},W=async()=>{if(!d.title.trim()){a("error","Bitte geben Sie einen Titel ein");return}try{if(o(!0),(await N.adminUpdateRoleplayScenario(C.id,d)).success)a("success","Szenario erfolgreich aktualisiert"),g(!1),x();else throw new Error("Fehler beim Aktualisieren")}catch(s){a("error",s.message)}finally{o(!1)}},Y=async()=>{try{if(o(!0),(await N.adminDeleteRoleplayScenario(C.id)).success)a("success","Szenario erfolgreich gelöscht"),j(!1),x();else throw new Error("Fehler beim Löschen")}catch(s){a("error",s.message)}finally{o(!1)}},H=l.filter(s=>s.title?.toLowerCase().includes(h.toLowerCase())||s.description?.toLowerCase().includes(h.toLowerCase())),D=s=>({easy:"Einfach",medium:"Mittel",hard:"Schwer"})[s]||s,ee=s=>({easy:"bg-green-100 text-green-700",medium:"bg-yellow-100 text-yellow-700",hard:"bg-red-100 text-red-700"})[s]||"bg-gray-100 text-gray-700",se=s=>({publish:"Veröffentlicht",draft:"Entwurf",pending:"Ausstehend"})[s]||s,te=s=>({publish:"bg-green-100 text-green-700",draft:"bg-gray-100 text-gray-700",pending:"bg-yellow-100 text-yellow-700"})[s]||"bg-gray-100 text-gray-700";return e.jsxs("div",{className:"space-y-6",children:[f&&e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center gap-2 px-4 py-3 rounded-lg shadow-lg ${f.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:[f.type==="success"?e.jsx(ie,{className:"w-5 h-5"}):e.jsx(K,{className:"w-5 h-5"}),f.message,e.jsx("button",{onClick:()=>_(null),className:"ml-2 hover:opacity-80",children:e.jsx(le,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(r,{variant:"ghost",onClick:t,className:"p-2",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:e.jsx(F,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-[var(--text-main)]",children:"Live-Simulationen (Roleplays)"}),e.jsxs("p",{className:"text-sm text-[var(--text-secondary)]",children:[l.length," Szenarien"]})]})]})]}),e.jsxs(r,{onClick:M,className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Neues Szenario"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-[var(--text-muted)]"}),e.jsx(u,{placeholder:"Szenarien durchsuchen...",value:h,onChange:s=>V(s.target.value),className:"pl-10"})]}),y&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(b,{className:"w-8 h-8 animate-spin text-[var(--primary-accent)]"})}),S&&!y&&e.jsx(k,{className:"border-red-200 bg-red-50",children:e.jsx(z,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-red-700",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("p",{children:S}),e.jsx(r,{variant:"outline",size:"sm",onClick:x,children:"Erneut versuchen"})]})})}),!y&&!S&&e.jsx("div",{className:"space-y-3",children:H.length===0?e.jsx(k,{children:e.jsx(z,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"w-12 h-12 text-[var(--text-muted)] mx-auto mb-3"}),e.jsx("p",{className:"text-[var(--text-secondary)]",children:h?"Keine Szenarien gefunden":"Noch keine Szenarien vorhanden"}),!h&&e.jsx(r,{onClick:M,className:"mt-4",children:"Erstes Szenario erstellen"})]})})}):H.map(s=>e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(z,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-main)]",children:s.title}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${te(s.status)}`,children:se(s.status)}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${ee(s.difficulty)}`,children:D(s.difficulty)})]}),s.description&&e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-[var(--text-muted)]",children:[s.agent_id&&e.jsxs("span",{children:["Agent: ",s.agent_id.substring(0,12),"..."]}),e.jsxs("span",{children:["ID: ",s.id]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>q(s),className:"text-[var(--text-secondary)] hover:text-[var(--primary-accent)]",children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>X(s),className:"text-[var(--text-secondary)] hover:text-red-600",children:e.jsx(oe,{className:"w-4 h-4"})})]})]})})},s.id))}),e.jsx(E,{open:$,onOpenChange:p,children:e.jsxs(L,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(A,{children:[e.jsx(B,{children:"Neues Szenario erstellen"}),e.jsx(I,{children:"Erstellen Sie ein neues Roleplay-Szenario für Live-Simulationen."})]}),e.jsx(Q,{formData:d,setFormData:v}),e.jsxs(T,{children:[e.jsx(r,{variant:"outline",onClick:()=>p(!1),children:"Abbrechen"}),e.jsxs(r,{onClick:J,disabled:c,children:[c&&e.jsx(b,{className:"w-4 h-4 mr-2 animate-spin"}),"Erstellen"]})]})]})}),e.jsx(E,{open:U,onOpenChange:g,children:e.jsxs(L,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(A,{children:[e.jsx(B,{children:"Szenario bearbeiten"}),e.jsx(I,{children:"Bearbeiten Sie das ausgewählte Roleplay-Szenario."})]}),e.jsx(Q,{formData:d,setFormData:v}),e.jsxs(T,{children:[e.jsx(r,{variant:"outline",onClick:()=>g(!1),children:"Abbrechen"}),e.jsxs(r,{onClick:W,disabled:c,children:[c&&e.jsx(b,{className:"w-4 h-4 mr-2 animate-spin"}),"Speichern"]})]})]})}),e.jsx(E,{open:Z,onOpenChange:j,children:e.jsxs(L,{children:[e.jsxs(A,{children:[e.jsx(B,{children:"Szenario löschen"}),e.jsxs(I,{children:['Sind Sie sicher, dass Sie das Szenario "',C?.title,'" löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.']})]}),e.jsxs(T,{children:[e.jsx(r,{variant:"outline",onClick:()=>j(!1),children:"Abbrechen"}),e.jsxs(r,{variant:"destructive",onClick:Y,disabled:c,children:[c&&e.jsx(b,{className:"w-4 h-4 mr-2 animate-spin"}),"Löschen"]})]})]})})]})}function Q({formData:t,setFormData:l}){return e.jsxs(me,{children:[e.jsx(R,{title:"Grundinformationen",subtitle:"Titel, Beschreibung und Basiseinstellungen",icon:de,accentColor:"blue",defaultExpanded:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Titel ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(u,{value:t.title,onChange:i=>l({...t,title:i.target.value}),placeholder:"z.B. Vorstellungsgespräch IT-Consultant"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Beschreibung"}),e.jsx(w,{value:t.description,onChange:i=>l({...t,description:i.target.value}),placeholder:"Kurze Beschreibung des Szenarios...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs("select",{value:t.status,onChange:i=>l({...t,status:i.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"draft",children:"Entwurf"}),e.jsx("option",{value:"publish",children:"Veröffentlicht"}),e.jsx("option",{value:"pending",children:"Ausstehend"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Schwierigkeit"}),e.jsxs("select",{value:t.difficulty,onChange:i=>l({...t,difficulty:i.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"easy",children:"Einfach"}),e.jsx("option",{value:"medium",children:"Mittel"}),e.jsx("option",{value:"hard",children:"Schwer"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"ElevenLabs Agent ID"}),e.jsx(u,{value:t.agent_id,onChange:i=>l({...t,agent_id:i.target.value}),placeholder:"agent_xxx..."}),e.jsx("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:"Die Agent ID aus Ihrem ElevenLabs Dashboard"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Erste Nachricht"}),e.jsx(w,{value:t.initial_message,onChange:i=>l({...t,initial_message:i.target.value}),placeholder:"Die erste Nachricht des KI-Gesprächspartners...",rows:3}),e.jsxs("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:["Platzhalter: ","{{user_name}}",", ","{{company_name}}",", ","{{position}}"]})]})]})}),e.jsx(R,{title:"Gesprächspartner-Profil",subtitle:"Name, Rolle und Eigenschaften des KI-Interviewers",icon:he,accentColor:"teal",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx(u,{value:t.interviewer_profile.name,onChange:i=>l({...t,interviewer_profile:{...t.interviewer_profile,name:i.target.value}}),placeholder:"z.B. Dr. Maria Schmidt"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Rolle/Position"}),e.jsx(u,{value:t.interviewer_profile.role,onChange:i=>l({...t,interviewer_profile:{...t.interviewer_profile,role:i.target.value}}),placeholder:"z.B. HR-Leiterin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Eigenschaften"}),e.jsx(w,{value:t.interviewer_profile.properties,onChange:i=>l({...t,interviewer_profile:{...t.interviewer_profile,properties:i.target.value}}),placeholder:"Charaktereigenschaften (eine pro Zeile)...",rows:3})]})]})}),e.jsx(R,{title:"Erweiterte Einstellungen",subtitle:"Coaching-Hinweise und zusätzliche Konfiguration",icon:xe,accentColor:"purple",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Coaching-Hinweise"}),e.jsx(w,{value:t.coaching_hints,onChange:i=>l({...t,coaching_hints:i.target.value}),placeholder:"Tipps für den Benutzer während des Gesprächs (eine pro Zeile)...",rows:4}),e.jsx("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:"Diese Hinweise werden im Live-Coaching-Panel angezeigt"})]})})})]})}export{Ce as default};
