import{au as O,l as $e,ae as ze,S as Me,as as De,i as Be,U as Ue,B as Te,j as e,aU as re,aM as je,aL as te,aV as _e,z as Fe,ay as Oe}from"./ui-vendor-Dm6q_mjH.js";import{a as d}from"./react-vendor-uDOJF2jQ.js";import{w as Re,u as Ge,D as V}from"./FeatureInfoButton-DP9rw1S0.js";import{S as Ke,a as He}from"./ScenarioCard-CqLEv9uN.js";import{D as We,a as Ye,b as Ze,c as Je}from"./dialog-17kXcCTd.js";import{u as Qe}from"./useMobile-YxjH166V.js";import{B as Xe,S as _,c as qe}from"./select-native-aziB-GZa.js";const Pe={briefcase:Te,users:Ue,"trending-up":Be,"message-circle":De,shield:Me,heart:ze,target:$e,folder:O},L=O,N=t=>!t||typeof t!="string"?L:Pe[t.toLowerCase()]||L,z=t=>!t||typeof t!="string"?"":t.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/[^a-z0-9]/g,""),ee={career:"karriere",leadership:"fuehrung",sales:"vertrieb",communication:"kommunikation",service:"service",social:"social",karriere:"karriere",fuehrung:"fuehrung",vertrieb:"vertrieb",kommunikation:"kommunikation",meine:"meine",selfpresentation:"karriere",interview:"karriere",pitch:"vertrieb",negotiation:"vertrieb",vorstellungsgespraech:"karriere",gehaltsverhandlung:"vertrieb",fuehrungsgespraech:"fuehrung",praesentation:"kommunikation",selbstvorstellung:"karriere",training:"kommunikation"};let M=null,se=null;const Ve=300*1e3;function es(){const[t,x]=d.useState(M||[]),[c,u]=d.useState(!M),[h,v]=d.useState(null),g=d.useCallback(async()=>{if(M&&se&&Date.now()-se<Ve)return x(M),u(!1),M;try{u(!0),v(null);const n=await Re.getCategories();return M=n,se=Date.now(),x(n),n}catch(n){return console.error("[useCategories] Failed to fetch categories:",n),v(n.message||"Failed to fetch categories"),[]}finally{u(!1)}},[]);d.useEffect(()=>{g()},[g]);const j=d.useCallback(n=>{if(!n||!t.length)return null;const o=z(n),i=ee[o]||o,a=t.find(l=>z(l.slug)===i||z(l.name)===i);return a?{...a,IconComponent:N(a.icon),bgColor:`${a.color}15`}:null},[t]),w=d.useCallback(n=>{if(Array.isArray(n)){for(const a of n){if(typeof a!="string")continue;const l=j(a);if(l)return{key:l.slug,label:l.name,shortLabel:l.shortName||l.name,icon:N(l.icon),IconComponent:N(l.icon),color:l.color,bgColor:l.bgColor}}const i=n.find(a=>typeof a=="string")||"unknown";return{key:String(i),label:String(i),shortLabel:String(i),icon:L,IconComponent:L,color:"#64748b",bgColor:"#f1f5f9"}}if(typeof n!="string")return{key:"unknown",label:"Unbekannt",shortLabel:"Unbekannt",icon:L,IconComponent:L,color:"#64748b",bgColor:"#f1f5f9"};const o=j(n);return o?{key:o.slug,label:o.name,shortLabel:o.shortName||o.name,icon:N(o.icon),IconComponent:N(o.icon),color:o.color,bgColor:o.bgColor}:{key:n||"unknown",label:n||"Unbekannt",shortLabel:n||"Unbekannt",icon:L,IconComponent:L,color:"#64748b",bgColor:"#f1f5f9"}},[j]),y=d.useCallback((n=[])=>{if(!t.length)return[];if(!n.length)return t.map(i=>({key:i.slug,label:i.name,shortLabel:i.shortName||i.name,icon:N(i.icon),IconComponent:N(i.icon),color:i.color,bgColor:`${i.color}15`}));const o=new Map;return n.forEach(i=>{if(i){if(Array.isArray(i))i.forEach(a=>{if(!a||typeof a!="string"||!a.trim())return;const l=j(a);l&&!o.has(l.slug)&&o.set(l.slug,{key:l.slug,label:l.name,shortLabel:l.shortName||l.name,icon:N(l.icon),IconComponent:N(l.icon),color:l.color,bgColor:l.bgColor})});else if(typeof i=="string"&&i.trim()){const a=j(i);a&&!o.has(a.slug)&&o.set(a.slug,{key:a.slug,label:a.name,shortLabel:a.shortName||a.name,icon:N(a.icon),IconComponent:N(a.icon),color:a.color,bgColor:a.bgColor})}}}),Array.from(o.values())},[t,j]),S=d.useCallback((n,o)=>{if(!n||!o)return!1;const i=z(o);if(Array.isArray(n))return n.some(m=>{const I=z(m);return(ee[I]||I)===i});const a=z(n);return(ee[a]||a)===i},[]),E=d.useMemo(()=>{const n=new Map;return t.forEach(o=>{n.set(o.slug,{...o,IconComponent:N(o.icon),bgColor:`${o.color}15`})}),n},[t]);return{categories:t,categoriesMap:E,loading:c,error:h,refetch:g,getCategoryBySlug:j,getCategoryConfig:w,getCategoriesForFilter:y,matchesCategory:S}}const F=({label:t,icon:x,isSelected:c,onClick:u})=>e.jsxs("button",{onClick:u,className:`inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold
      border-2 cursor-pointer transition-all whitespace-nowrap
      ${c?"border-indigo-500 bg-indigo-500 text-white shadow-lg shadow-indigo-500/40":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[x&&e.jsx(x,{className:"w-3.5 h-3.5"}),t]}),ss=({count:t})=>t===0?null:e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-md bg-red-500 text-white text-xs font-semibold flex items-center justify-center",children:t}),rs=({value:t,onChange:x,placeholder:c,className:u=""})=>e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 pointer-events-none z-10"}),e.jsx("input",{type:"text",placeholder:c,value:t,onChange:h=>x(h.target.value),className:"w-full py-3 pr-4 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none transition-all focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 placeholder:text-slate-400",style:{paddingLeft:"44px"}})]}),fe=({value:t,onChange:x,options:c,className:u=""})=>e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(te,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("select",{value:t,onChange:h=>x(h.target.value),className:"w-full py-3 pl-10 pr-10 rounded-lg border border-slate-200 text-base text-slate-900 bg-white cursor-pointer outline-none appearance-none bg-no-repeat",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundPosition:"right 12px center"},children:c.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]}),be=({viewMode:t,onViewModeChange:x,compact:c=!1})=>e.jsxs("div",{className:`flex items-center gap-1 ${c?"p-[3px]":"p-1"} bg-slate-100 rounded-lg`,children:[e.jsx("button",{onClick:()=>x("grid"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${t==="grid"?"bg-white shadow-sm":"bg-transparent"}`,title:"Kachelansicht",children:e.jsx(re,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${t==="grid"?"text-indigo-600":"text-slate-500"}`})}),e.jsx("button",{onClick:()=>x("list"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${t==="list"?"bg-white shadow-sm":"bg-transparent"}`,title:"Listenansicht",children:e.jsx(_e,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${t==="list"?"text-indigo-600":"text-slate-500"}`})})]}),ts=({searchQuery:t,onSearchChange:x,searchPlaceholder:c="Durchsuchen...",showSearch:u=!0,categories:h=[],selectedCategory:v,onCategoryChange:g,showCategories:j=!0,difficultyOptions:w=[],selectedDifficulty:y,onDifficultyChange:S,showDifficulty:E=!1,viewMode:n,onViewModeChange:o,showViewToggle:i=!0,renderCustomFilters:a,customActions:l,children:m})=>{const[I,A]=d.useState(!1),R=Qe(),$=[v?1:0,y&&y!=="all"?1:0,t?.trim()?1:0].reduce((f,G)=>f+G,0);return R?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[u&&e.jsxs("div",{className:"relative flex-1",children:[e.jsx(je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:t,onChange:f=>x(f.target.value),className:"w-full py-2 pr-3 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none",style:{paddingLeft:"40px"}})]}),e.jsxs("button",{onClick:()=>A(!0),className:`relative flex items-center justify-center w-11 h-11 rounded-lg border flex-shrink-0 cursor-pointer
            ${$>0?"border-indigo-500 bg-indigo-50":"border-slate-200 bg-white"}`,children:[e.jsx(te,{className:`w-[18px] h-[18px] ${$>0?"text-indigo-600":"text-slate-500"}`}),e.jsx(ss,{count:$})]}),i&&n&&e.jsx(be,{viewMode:n,onViewModeChange:o,compact:!0})]}),l&&e.jsx("div",{className:"mt-2",children:l}),e.jsx(We,{open:I,onOpenChange:A,children:e.jsxs(Ye,{className:"fixed bottom-0 left-0 right-0 top-auto transform-none max-w-full w-full rounded-t-2xl max-h-[80vh] overflow-auto",children:[e.jsx(Ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Je,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-indigo-600"}),"Filter"]}),$>0&&e.jsx("button",{onClick:()=>{g?.(null),S?.("all"),x?.("")},className:"px-3 py-1 rounded-md border-none bg-slate-100 text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-200 transition-colors",children:"Zurücksetzen"})]})}),e.jsxs("div",{className:"flex flex-col gap-5 py-2",children:[E&&w.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Schwierigkeit"}),e.jsx(fe,{value:y,onChange:S,options:w})]}),j&&h.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Kategorie"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(F,{label:"Alle",icon:re,isSelected:!v,onClick:()=>g(null)}),h.map(f=>e.jsx(F,{label:f.label,icon:f.icon,isSelected:v===f.key,onClick:()=>g(f.key)},f.key))]})]}),a&&e.jsx("div",{children:a()})]}),e.jsx(Xe,{variant:"primary",size:"lg",onClick:()=>A(!1),fullWidth:!0,className:"mt-3",children:"Filter anwenden"})]})}),m]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[u&&e.jsx(rs,{value:t,onChange:x,placeholder:c,className:"flex-1 min-w-[200px]"}),E&&w.length>0&&e.jsx(fe,{value:y,onChange:S,options:w,className:"min-w-[180px]"}),a&&a(),l,i&&n&&e.jsx(be,{viewMode:n,onViewModeChange:o})]}),j&&h.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(F,{label:"Alle",icon:re,isSelected:!v,onClick:()=>g(null)}),h.map(f=>e.jsx(F,{label:f.label,icon:f.icon,isSelected:v===f.key,onClick:()=>g(f.key)},f.key))]}),m]})},ge=({category:t,getCategoryConfig:x})=>{const c=x(t);if(!c)return null;const u=c.IconComponent||c.icon||O;return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:c.bgColor,color:c.color},children:[e.jsx(u,{style:{width:"12px",height:"12px"}}),c.shortLabel]})},ls=({category:t,getCategoryConfig:x})=>Array.isArray(t)?e.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((c,u)=>e.jsx(ge,{category:c,getCategoryConfig:x},u))}):e.jsx(ge,{category:t,getCategoryConfig:x}),us=({title:t,subtitle:x,headerIcon:c,fetchScenarios:u,moduleKey:h,historyButtonLabel:v="Meine Sessions",onNavigateToHistory:g,showHistoryButton:j=!0,onSelectScenario:w,renderCardMeta:y,renderCategoryBadge:S,getIconForScenario:E,cardActionLabel:n="Starten",cardActionIcon:o,getCardCustomActions:i,getCardClassName:a,categoryField:l="category",customCategoryConfig:m,emptyStateIcon:I,emptyStateTitle:A="Keine Szenarien verfügbar",emptyStateMessage:R="Bitte kontaktieren Sie den Administrator.",searchPlaceholder:$="Durchsuchen...",headerActions:f,filterActions:G,renderInfoBox:le,extraContent:we,isAuthenticated:B,requireAuth:K,setPendingAction:H,setPendingScenario:W,demoCode:ne,pendingScenario:Y,clearPendingScenario:Z,loadingMessage:ns="Szenarien werden geladen...",errorRetryLabel:Ne="Erneut versuchen",additionalCategories:U=[]})=>{const[ae,ke]=d.useState([]),[ve,oe]=d.useState(!0),[ie,ce]=d.useState(null),[C,de]=d.useState(null),[J,ye]=d.useState("grid"),[T,Se]=d.useState(""),{branding:Q,filterScenariosBySetupAndPartner:xe}=Ge(),{getCategoryConfig:X,getCategoriesForFilter:me,matchesCategory:D}=es(),Ce=Q?.["--header-gradient"]||V["--header-gradient"],Le=Q?.["--header-text"]||V["--header-text"];Q?.["--primary-accent"]||V["--primary-accent"];const q=d.useCallback(async()=>{try{oe(!0),ce(null);const s=await u();ke(s||[])}catch(s){console.error(`[${t}] Error loading scenarios:`,s),ce(s.message||"Fehler beim Laden")}finally{oe(!1)}},[u,t]);d.useEffect(()=>{q()},[q]);const ue=d.useRef(!1);d.useEffect(()=>{Y&&B&&!ue.current&&(ue.current=!0,Z&&Z(),w(Y))},[Y,B,Z,w]);const k=d.useMemo(()=>xe([...ae],h),[ae,xe,h]),P=d.useMemo(()=>{if(m){const p=new Set;return k.forEach(r=>{const b=r[l];b&&m[b]&&p.add(b)}),Array.from(p)}const s=k.flatMap(p=>{const r=p[l];return Array.isArray(r)?r.filter(b=>b&&typeof b=="string"&&b.trim()):r&&typeof r=="string"&&r.trim()?[r]:[]});return[...new Set(s)]},[k,l,m]),pe=d.useMemo(()=>{let s=[];return m?s=P.filter(r=>k.some(b=>b[l]===r)).map(r=>({key:r,label:m[r]?.label||r,shortLabel:m[r]?.label||r,color:m[r]?.color,bgColor:m[r]?.bgColor,icon:m[r]?.icon,IconComponent:m[r]?.icon})):(s=me(P),s=s.filter(r=>!r||!r.label||!r.label.trim()?!1:k.some(b=>D(b[l],r.key)))),[...U.filter(r=>!r||!r.key?!1:r.filterFn?k.some(r.filterFn):k.some(b=>b[l]===r.key||D(b[l],r.key))),...s]},[P,m,me,k,l,D,U]),he=d.useMemo(()=>{let s=[...k];if(C){const p=U.find(r=>r.key===C);p?.filterFn?s=s.filter(p.filterFn):m?s=s.filter(r=>r[l]===C):s=s.filter(r=>D(r[l],C))}if(T.trim()){const p=T.toLowerCase();s=s.filter(r=>r.title?.toLowerCase().includes(p)||r.description?.toLowerCase().includes(p))}return s},[k,C,T,l,m,D,U]),Ee=d.useCallback(s=>{if(!B&&!ne){W?W(s):H&&H({type:"SELECT_SCENARIO",scenario:s}),K&&K(()=>{w(s)},{type:"SELECT_SCENARIO",scenario:s});return}w(s)},[B,ne,W,H,K,w]),Ie=d.useCallback(s=>{const p=s[l];if(!p)return null;if(S)return S(s,X);if(m&&m[p]){const r=m[p];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:r.bgColor,color:r.color},children:[r.icon&&e.jsx(r.icon,{style:{width:"12px",height:"12px"}}),r.label]})}return e.jsx(ls,{category:p,getCategoryConfig:X})},[l,S,m,X]);return ve?e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(_,{className:"w-12 h-12 rounded-xl"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(_,{className:"h-7 w-48"}),e.jsx(_,{className:"h-4 w-64"})]})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[1,2,3,4,5].map(s=>e.jsx(_,{className:"h-10 w-24 rounded-full flex-shrink-0"},s))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(s=>e.jsx(qe,{},s))})]}):ie?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-[60px_20px] gap-4",children:[e.jsx(Fe,{className:"w-12 h-12 text-red-500"}),e.jsx("p",{className:"text-red-500 text-base text-center",children:ie}),e.jsx("button",{onClick:q,className:"px-6 py-3 rounded-xl border-none bg-primary text-white text-sm font-semibold cursor-pointer hover:opacity-90 transition-opacity",children:Ne})]}):e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:Ce},children:c&&e.jsx(c,{style:{width:"24px",height:"24px",color:Le}})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[28px] font-bold text-slate-900 m-0",children:t}),e.jsx("p",{className:"text-sm text-slate-600 m-0",children:x})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[f,j&&g&&e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-5 py-3 rounded-xl border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-all",children:[e.jsx(Oe,{size:18}),v]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(ts,{searchQuery:T,onSearchChange:Se,searchPlaceholder:$,categories:pe.map(s=>({key:s.key,label:s.label,shortLabel:s.shortLabel||s.label,color:s.color,bgColor:s.bgColor,icon:s.IconComponent||s.icon})),selectedCategory:C,onCategoryChange:de,showCategories:pe.length>0,showDifficulty:!1,viewMode:J,onViewModeChange:ye,customActions:G})})]}),he.length>0?e.jsx(Ke,{minCardWidth:"340px",viewMode:J,children:he.map(s=>{const p=E?E(s):null,r=y?y(s):[],b=i?i(s):null,Ae=a?a(s):"";return e.jsx(He,{title:s.title,description:s.description,icon:p,categoryBadge:Ie(s),meta:r,action:o?{label:n,icon:o}:{label:n},onClick:()=>Ee(s),viewMode:J,customActions:b,className:Ae},s.id)})}):e.jsxs("div",{className:"text-center p-12 px-6 bg-white rounded-2xl border border-slate-200",children:[e.jsx("div",{className:"flex justify-center mb-4",children:I?e.jsx(I,{className:"w-12 h-12 text-slate-300"}):e.jsx(O,{className:"w-12 h-12 text-slate-300"})}),e.jsx("h3",{className:"text-slate-500 m-0 mb-2 font-medium",children:A}),e.jsx("p",{className:"text-slate-400 m-0 text-sm",children:C?"In der ausgewählten Kategorie sind keine Szenarien verfügbar.":R}),C&&k.length>0&&e.jsx("button",{onClick:()=>de(null),className:"mt-4 px-5 py-2.5 rounded-[20px] border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-colors",children:"Alle Szenarien anzeigen"})]}),le&&le(),we]})};export{us as S};
