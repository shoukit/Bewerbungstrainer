import{j as e,O as _,F as A,h as ue,y as M,ae as O,au as ke,q as Se,av as we,ad as ve,R as G,C as H,c as q,a0 as Z,aw as J,ax as Y,a8 as Q,T as X,as as ee,w as te,U as se,aj as re,B as ne,v as me,x as fe,e as ge,z as ae,a as be,Q as ye,n as ce,ay as de,Y as pe,t as Ce,az as xe,l as oe,m as je,X as ze,aA as Be,aB as Ne,aC as Ie,A as De}from"./ui-vendor-B9DEMv6g.js";import{a}from"./react-vendor-uDOJF2jQ.js";import{w as $,h as Ee,F as Te,u as Re}from"./FeatureInfoButton-DsfjgKw4.js";import{S as We}from"./ScenarioDashboard-Db_QZFbt.js";import{B as V,C as K}from"./Button-BHvYxNT_.js";import"./select-native-BMh_kGEB.js";import"./dialog-Dg1K-ctH.js";import{F as Ae}from"./fullscreen-loader-CGHRnDJu.js";import{D as Le}from"./DynamicFormField-BNIpbzt6.js";import{a as Oe,B as $e}from"./BriefingWorkbook-CWOSsrO3.js";import{u as Fe}from"./useBranding-CjHnMPMs.js";import{u as _e}from"./useMobile-YxjH166V.js";import"./ScenarioCard-OpqbSsPm.js";import"./utils-BEHD0UYf.js";import"./index-CklPxmEV.js";const Me={"file-text":A,briefcase:ne,banknote:re,users:se,user:te,"message-circle":ee,target:X,award:Q,book:Y,clipboard:J,star:Z,lightbulb:M,shield:q,compass:H,rocket:G,heart:ve,folder:we,"trending-up":Se},Pe=({onSelectTemplate:t,onShowList:u,onCreateTemplate:y,onEditTemplate:c,isAuthenticated:g,requireAuth:p,setPendingAction:n,demoCode:s})=>{const[x,f]=a.useState(null),[m,b]=a.useState(0),o=a.useCallback(async()=>{const l=new URLSearchParams;s&&l.append("demo_code",s);const h=await $.request(`/smartbriefing/templates?${l.toString()}`,{method:"GET"});if(h.success&&h.data?.templates)return h.data.templates;throw new Error("Unerwartete API-Antwort")},[s,m]),d=()=>{if(!g&&!s){p&&(n(()=>y),p());return}y?.()},S=(l,h)=>{l.stopPropagation(),c?.(h)},C=(l,h)=>{l.stopPropagation(),f(h)},k=async()=>{if(x)try{const l=new URLSearchParams;s&&l.append("demo_code",s),(await $.request(`/smartbriefing/templates/${x.id}?${l.toString()}`,{method:"DELETE"})).success&&b(v=>v+1)}catch(l){console.error("[SmartBriefing] Error deleting template:",l)}finally{f(null)}},z=l=>Me[l.icon]||A,i=l=>{const h=l.variables_schema?.length||0;return[{text:`${h} Eingabefeld${h!==1?"er":""}`}]},w=l=>l.is_custom?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:h=>S(h,l),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-slate-100 hover:text-primary",title:"Template bearbeiten",children:e.jsx(ke,{size:16})}),e.jsx("button",{onClick:h=>C(h,l),className:"p-1.5 rounded-md border-none bg-transparent text-slate-500 cursor-pointer flex items-center justify-center transition-all hover:bg-red-50 hover:text-red-500",title:"Template löschen",children:e.jsx(_,{size:16})})]}):null,B=(g||s)&&y?e.jsxs("button",{onClick:d,className:"flex items-center gap-2 py-2.5 px-4 rounded-[10px] border-2 border-dashed border-slate-300 bg-white text-slate-500 text-sm font-medium cursor-pointer transition-all whitespace-nowrap hover:border-primary hover:text-primary",children:[e.jsx(O,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"persönliches Template"}),e.jsx("span",{className:"sm:hidden",children:"Template"})]}):null,E=()=>e.jsx("div",{className:"mt-12 py-5 px-6 bg-primary/5 rounded-xl border border-primary/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(M,{size:20,className:"text-primary flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-1",children:"So funktioniert Smart Briefing"}),e.jsx("p",{className:"text-[13px] text-slate-500 leading-relaxed",children:"Wähle ein Template aus, gib deine spezifischen Informationen ein (z.B. Unternehmen, Position), und erhalte ein maßgeschneidertes Briefing mit Insider-Wissen, Fachbegriffen und cleveren Rückfragen."})]})]})}),T=x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>f(null),children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-[400px] w-full shadow-2xl",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-50 flex items-center justify-center",children:e.jsx(_,{size:24,className:"text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Template löschen?"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Diese Aktion kann nicht rückgängig gemacht werden."})]})]}),e.jsx("div",{className:"bg-slate-50 rounded-lg p-3 mb-5",children:e.jsx("p",{className:"text-sm text-slate-600",children:e.jsx("strong",{children:x.title})})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(V,{variant:"secondary",onClick:()=>f(null),children:"Abbrechen"}),e.jsx(V,{variant:"danger",onClick:k,children:"Löschen"})]})]})});return e.jsxs(e.Fragment,{children:[e.jsx(Ee,{featureId:"smartbriefing",showOnMount:!0}),e.jsx(We,{title:"Smart Briefing",subtitle:"Dein KI-gestützter Vorbereitungs-Assistent",headerIcon:A,headerActions:e.jsx(Te,{featureId:"smartbriefing",size:"sm"}),fetchScenarios:o,moduleKey:"briefings",historyButtonLabel:"Meine Briefings",onNavigateToHistory:u,onSelectScenario:t,renderCardMeta:i,getIconForScenario:z,getCardCustomActions:w,cardActionLabel:"Briefing erstellen",cardActionIcon:ue,categoryField:"category",emptyStateIcon:A,emptyStateTitle:"Keine Templates gefunden",emptyStateMessage:"Es wurden noch keine Briefing-Templates erstellt.",searchPlaceholder:"Briefings durchsuchen...",filterActions:B,renderInfoBox:E,extraContent:T,isAuthenticated:g,requireAuth:p,setPendingAction:n,demoCode:s,loadingMessage:"Templates werden geladen..."},m)]})},Ve=({variable:t,index:u,onChange:y,onDelete:c})=>e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("input",{type:"text",value:t.key||"",onChange:g=>y(u,"key",g.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"_")),placeholder:"variable_name",className:"flex-1 py-2 px-3 rounded-md border border-slate-200 text-sm font-mono bg-slate-50 mr-2 outline-none focus:border-primary focus:ring-2 focus:ring-primary/10"}),e.jsx("button",{type:"button",onClick:()=>c(u),className:"p-2 border-none bg-transparent cursor-pointer text-red-500 flex items-center justify-center hover:bg-red-50 rounded-md transition-colors",children:e.jsx(_,{size:18})})]}),e.jsx("textarea",{value:t.value||"",onChange:g=>y(u,"value",g.target.value),placeholder:"Wert eingeben... (mehrzeilig möglich)",rows:3,className:"w-full py-2.5 px-3 rounded-md border border-slate-200 text-sm resize-y min-h-[80px] box-border outline-none focus:border-primary focus:ring-2 focus:ring-primary/10"})]}),Ke=({template:t,onBack:u,onBriefingGenerated:y,isAuthenticated:c})=>{const[g,p]=a.useState({}),[n,s]=a.useState({}),[x,f]=a.useState(!1),[m,b]=a.useState(null),[o,d]=a.useState([]),[S,C]=a.useState(!1),k=Oe(t?.icon);a.useEffect(()=>{if(t?.variables_schema){const l={};t.variables_schema.forEach(h=>{h.default&&(l[h.key]=h.default)}),p(l)}d([]),C(!1)},[t]);const z=()=>{d([...o,{key:"",value:""}])},i=(l,h,v)=>{const R=[...o];R[l][h]=v,d(R)},w=l=>{d(o.filter((h,v)=>v!==l))},B=(l,h)=>{p(v=>({...v,[l]:h})),n[l]&&s(v=>{const R={...v};return delete R[l],R})},E=()=>{const l={};return t?.variables_schema?.forEach(h=>{h.required&&!g[h.key]&&(l[h.key]="Dieses Feld ist erforderlich")}),l},T=async l=>{l.preventDefault();const h=E();if(Object.keys(h).length>0){s(h);return}f(!0),b(null);try{const v={};o.forEach(L=>{L.key&&L.value&&(v[L.key]=L.value)});const R={template_id:t.id,variables:g};Object.keys(v).length>0&&(R.custom_variables=v);const F=await $.request("/smartbriefing/generate",{method:"POST",body:JSON.stringify(R)});if(F.success&&F.data?.briefing)y(F.data.briefing);else throw new Error("Unerwartete API-Antwort")}catch(v){console.error("[SmartBriefing] Error generating briefing:",v),b(v.message||"Fehler beim Generieren des Briefings")}finally{f(!1)}};return t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 pt-8 max-w-[700px] mx-auto",children:[e.jsxs("button",{onClick:u,disabled:x,className:`flex items-center gap-2 py-2 border-none bg-transparent text-slate-500 text-sm font-medium cursor-pointer mb-6 transition-opacity ${x?"opacity-50 cursor-not-allowed":"hover:text-slate-700"}`,children:[e.jsx(me,{size:18}),e.jsx("span",{className:"leading-relaxed",children:"Zurück zur Übersicht"})]}),e.jsx(K,{className:"p-6 mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(k,{size:28,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[22px] font-bold text-slate-900 mb-1",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500",children:t.description})]})]})}),e.jsxs(K,{className:"p-6",children:[e.jsx("h2",{className:"text-base font-semibold text-slate-900 mb-5 pb-4 border-b border-slate-100",children:"Deine Angaben"}),e.jsxs("form",{onSubmit:T,children:[t.variables_schema?.map(l=>e.jsx(Le,{field:l,value:g[l.key],onChange:B,error:n[l.key]},l.key)),t.allow_custom_variables&&e.jsxs("div",{className:"mt-6 mb-5 pt-5 border-t border-slate-100",children:[e.jsxs("button",{type:"button",onClick:()=>C(!S),className:`flex items-start gap-2 p-0 border-none bg-transparent text-slate-500 text-sm font-medium cursor-pointer text-left ${S?"mb-4":""}`,children:[e.jsxs("span",{className:"flex items-center gap-2 flex-shrink-0",children:[S?e.jsx(fe,{size:18}):e.jsx(ge,{size:18}),e.jsx(O,{size:16})]}),e.jsx("span",{className:"leading-relaxed",children:"Zusätzliche Variablen hinzufügen (optional)"})]}),S&&e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4",children:[e.jsx("p",{className:"text-[13px] text-slate-500 mb-3",children:"Füge eigene Variablen hinzu, die in die Briefing-Generierung einfließen sollen."}),o.length>0&&e.jsx("div",{className:"mb-3",children:o.map((l,h)=>e.jsx(Ve,{variable:l,index:h,onChange:i,onDelete:w},h))}),e.jsxs("button",{type:"button",onClick:z,className:"flex items-center gap-1.5 py-2 px-3 border border-dashed border-slate-300 rounded-lg bg-white text-slate-500 text-[13px] cursor-pointer w-full justify-center hover:border-primary hover:text-primary transition-colors",children:[e.jsx(O,{size:14}),"Variable hinzufügen"]})]})]}),m&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-5 flex items-start gap-3",children:[e.jsx(ae,{size:20,className:"text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:m})]}),e.jsx(V,{type:"submit",disabled:x,size:"lg",fullWidth:!0,icon:e.jsx(be,{size:20}),children:"Briefing generieren"})]})]})]}),e.jsx(Ae,{isLoading:x,message:"Smart Briefing wird erstellt...",subMessage:"Die KI analysiert deine Angaben und erstellt ein maßgeschneidertes Briefing."})]}):null},Ue={"file-text":A,briefcase:ne,banknote:re,users:se,user:te,"message-circle":ee,target:X,award:Q,book:Y,clipboard:J,star:Z,lightbulb:M,shield:q,compass:H,rocket:G},Ge=({content:t,primaryAccent:u})=>{if(!t)return null;const y=g=>{const p=g.split(`
`),n=[];let s=[],x=null;const f=()=>{s.length>0&&(n.push(e.jsx("ul",{style:{margin:"12px 0",paddingLeft:"24px",listStyle:"none"},children:s.map((m,b)=>e.jsxs("li",{style:{marginBottom:"8px",fontSize:"15px",lineHeight:1.6,color:"#374151",position:"relative",paddingLeft:"20px"},children:[e.jsx("span",{style:{position:"absolute",left:0,color:u,fontWeight:"bold"},children:x==="number"?`${b+1}.`:""}),c(m)]},b))},`list-${n.length}`)),s=[],x=null)};return p.forEach((m,b)=>{const o=m.trim();if(!o){f();return}if(o.startsWith("### ")){f(),n.push(e.jsx("h3",{style:{fontSize:"18px",fontWeight:700,color:"#0f172a",margin:"24px 0 12px 0",paddingTop:"16px",borderTop:b>0?"1px solid #f1f5f9":"none",display:"flex",alignItems:"center",gap:"8px"},children:c(o.substring(4))},`h3-${b}`));return}if(o.startsWith("## ")){f(),n.push(e.jsx("h2",{style:{fontSize:"20px",fontWeight:700,color:"#0f172a",margin:"28px 0 14px 0"},children:c(o.substring(3))},`h2-${b}`));return}if(o.startsWith("# ")){f(),n.push(e.jsx("h1",{style:{fontSize:"24px",fontWeight:700,color:"#0f172a",margin:"32px 0 16px 0"},children:c(o.substring(2))},`h1-${b}`));return}if(o.startsWith("- ")||o.startsWith("* ")){x!=="bullet"&&(f(),x="bullet"),s.push(o.substring(2));return}const d=o.match(/^(\d+)\.\s/);if(d){x!=="number"&&(f(),x="number"),s.push(o.substring(d[0].length));return}f(),n.push(e.jsx("p",{style:{margin:"12px 0",fontSize:"15px",lineHeight:1.7,color:"#374151"},children:c(o)},`p-${b}`))}),f(),n},c=g=>{const p=[];let n=g,s=0;for(;n.length>0;){const x=n.match(/\*\*(.+?)\*\*/),f=n.match(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)|_([^_]+)_")),m=n.match(/`([^`]+)`/),b=[{match:x,type:"bold"},{match:f,type:"italic"},{match:m,type:"code"}].filter(d=>d.match);if(b.length===0){p.push(n);break}const o=b.reduce((d,S)=>(d.match?.index??1/0)<(S.match?.index??1/0)?d:S);switch(o.match.index>0&&p.push(n.substring(0,o.match.index)),o.type){case"bold":p.push(e.jsx("strong",{style:{fontWeight:600,color:"#0f172a"},children:o.match[1]},s++));break;case"italic":p.push(e.jsx("em",{style:{fontStyle:"italic"},children:o.match[1]||o.match[2]},s++));break;case"code":p.push(e.jsx("code",{style:{backgroundColor:"#f1f5f9",padding:"2px 6px",borderRadius:"4px",fontSize:"13px",fontFamily:"monospace",color:u},children:o.match[1]},s++));break}n=n.substring(o.match.index+o.match[0].length)}return p};return e.jsx("div",{children:y(t)})},He=({briefing:t,template:u,onBack:y,onCreateNew:c,onGenerateAnother:g})=>{const p=Fe(),n=_e(),[s,x]=a.useState(!1),f=a.useRef(null),m=p.primaryAccent,b=p.headerGradient,o=Ue[u?.icon||t?.template_icon]||A,d=k=>k?new Date(k).toLocaleDateString("de-DE",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",S=async()=>{try{await navigator.clipboard.writeText(t.content_markdown),x(!0),setTimeout(()=>x(!1),2e3)}catch(k){console.error("[SmartBriefing] Failed to copy:",k)}},C=()=>{const k=`${u?.title||t?.template_title}
${"=".repeat(50)}

Erstellt am: ${d(t.created_at)}

${t.content_markdown}`,z=new Blob([k],{type:"text/plain;charset=utf-8"}),i=URL.createObjectURL(z),w=document.createElement("a");w.href=i,w.download=`briefing-${t.id}.txt`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(i)};return t?e.jsxs("div",{style:{minHeight:"100vh",background:p.pageBg},children:[e.jsx("div",{style:{background:b,padding:n?"20px 16px":"24px 32px",position:"sticky",top:0,zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[y&&e.jsxs("button",{onClick:y,style:{display:"flex",alignItems:"center",gap:"6px",background:"rgba(255,255,255,0.15)",border:"none",borderRadius:"8px",padding:"8px 12px",cursor:"pointer",color:"#fff",fontSize:"13px",marginBottom:"16px"},children:[e.jsx(me,{size:16}),"Zurück zur Übersicht"]}),e.jsxs("div",{style:{display:"flex",alignItems:n?"flex-start":"center",gap:n?"16px":"24px",flexDirection:n?"column":"row"},children:[e.jsx("div",{style:{width:n?70:90,height:n?70:90,borderRadius:"50%",background:"rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(o,{size:n?32:40,color:"#fff"})}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.2)",color:"#fff"},children:"Smart Briefing"}),e.jsxs("span",{style:{fontSize:"12px",fontWeight:500,padding:"4px 10px",borderRadius:"20px",background:"rgba(255,255,255,0.9)",color:m,display:"flex",alignItems:"center",gap:"4px"},children:[e.jsx(be,{size:12}),"Fertig!"]})]}),e.jsx("h1",{style:{fontSize:n?"20px":"24px",fontWeight:700,color:"#fff",margin:0,marginBottom:"8px"},children:u?.title||t?.template_title}),e.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"rgba(255,255,255,0.8)"},children:[e.jsx(ye,{size:14}),d(t.created_at)]})})]}),!n&&e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("button",{onClick:S,style:{display:"flex",alignItems:"center",gap:"8px",background:s?"rgba(34,197,94,0.3)":"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[s?e.jsx(ce,{size:16}):e.jsx(de,{size:16}),s?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:C,style:{display:"flex",alignItems:"center",gap:"8px",background:"rgba(255,255,255,0.2)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:"10px",padding:"10px 20px",cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:500},children:[e.jsx(pe,{size:16}),"Speichern"]})]})]})]})}),e.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:n?"16px":"24px 32px"},children:[n&&e.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[e.jsxs("button",{onClick:S,style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"12px",borderRadius:"10px",border:`1px solid ${p.borderColor}`,backgroundColor:s?"#dcfce7":"white",color:s?"#16a34a":p.textSecondary,fontSize:"13px",fontWeight:500,cursor:"pointer"},children:[s?e.jsx(ce,{size:16}):e.jsx(de,{size:16}),s?"Kopiert!":"Kopieren"]}),e.jsxs("button",{onClick:C,style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",padding:"12px",borderRadius:"10px",border:`1px solid ${p.borderColor}`,backgroundColor:"white",color:p.textSecondary,fontSize:"13px",fontWeight:500,cursor:"pointer"},children:[e.jsx(pe,{size:16}),"Speichern"]})]}),e.jsx("div",{ref:f,style:{backgroundColor:"white",borderRadius:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",overflow:"hidden",border:`1px solid ${p.borderColor}`},children:e.jsx("div",{style:{padding:n?"20px":"32px"},children:e.jsx(Ge,{content:t.content_markdown,primaryAccent:m})})}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"24px",flexWrap:"wrap"},children:[e.jsxs("button",{onClick:g,style:{flex:1,minWidth:"200px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:`2px solid ${m}`,backgroundColor:"white",color:m,fontSize:"15px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(Ce,{size:18}),"Mit anderen Angaben neu generieren"]}),e.jsxs("button",{onClick:c,style:{flex:1,minWidth:"200px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"14px 24px",borderRadius:"12px",border:"none",background:`linear-gradient(135deg, ${m}, ${m}dd)`,color:"white",fontSize:"15px",fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:`0 4px 14px ${m}40`},children:[e.jsx(O,{size:18}),"Neues Briefing erstellen"]})]})]})]}):null},qe={"file-text":A,briefcase:ne,banknote:re,users:se,user:te,"message-circle":ee,target:X,award:Q,book:Y,clipboard:J,star:Z,lightbulb:M,shield:q,compass:H,rocket:G},Ze=t=>t?new Date(t).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",Je=({briefing:t,onOpen:u,onDelete:y,isDeleting:c})=>{const[g,p]=a.useState(!1),[n,s]=a.useState(!1),x=qe[t.template_icon]||A,f=m=>{m.stopPropagation(),n?(y(t.id),s(!1)):(s(!0),setTimeout(()=>s(!1),3e3))};return e.jsxs(K,{onClick:()=>u(t),onMouseEnter:()=>p(!0),onMouseLeave:()=>{p(!1),s(!1)},className:`p-5 cursor-pointer transition-all duration-300 relative ${g?"border-primary shadow-lg -translate-y-0.5":"border-slate-200 hover:border-slate-300"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"w-11 h-11 rounded-[10px] bg-primary/10 flex items-center justify-center",children:e.jsx(x,{size:22,className:"text-primary"})}),e.jsx("button",{onClick:f,disabled:c,className:`p-2 rounded-lg border-none cursor-pointer transition-all ${n?"bg-red-50 text-red-500":g?"bg-slate-100 text-slate-400":"bg-transparent text-slate-400"} ${g||n?"opacity-100":"opacity-0"} ${c?"cursor-not-allowed":""}`,children:c?e.jsx(oe,{size:18,className:"animate-spin"}):e.jsx(_,{size:18})})]}),e.jsx("h3",{className:"text-base font-semibold text-slate-900 mb-1 leading-tight truncate",children:t.title||"Unbenanntes Briefing"}),e.jsx("p",{className:"text-[13px] text-slate-500 mb-3",children:t.template_title}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400 text-xs",children:[e.jsx(ye,{size:14}),Ze(t.created_at)]}),e.jsxs("div",{className:"flex items-center gap-1 text-primary text-[13px] font-medium",children:["Öffnen",e.jsx(ue,{size:16})]})]}),n&&e.jsx("div",{className:"absolute top-2 right-2 bg-red-50 border border-red-200 rounded-lg py-2 px-3 text-xs text-red-600 font-medium z-10",onClick:m=>m.stopPropagation(),children:"Nochmal klicken zum Löschen"})]})},Ye=({onOpenBriefing:t,onCreateNew:u,isAuthenticated:y})=>{const[c,g]=a.useState([]),[p,n]=a.useState(!0),[s,x]=a.useState(null),[f,m]=a.useState(null);a.useEffect(()=>{(async()=>{if(!y){n(!1);return}try{n(!0),x(null);const d=await $.request("/smartbriefing/briefings",{method:"GET"});if(d.success&&d.data?.briefings){const S=d.data.briefings.filter(C=>C.status==="completed");g(S)}else throw new Error("Unerwartete API-Antwort")}catch(d){console.error("[SmartBriefing] Error fetching briefings:",d),x(d.message||"Fehler beim Laden der Briefings")}finally{n(!1)}})()},[y]);const b=async o=>{try{if(m(o),(await $.request(`/smartbriefing/briefings/${o}`,{method:"DELETE"})).success)g(S=>S.filter(C=>C.id!==o));else throw new Error("Fehler beim Löschen")}catch(d){console.error("[SmartBriefing] Error deleting briefing:",d),x(d.message||"Fehler beim Löschen des Briefings")}finally{m(null)}};return y?e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Meine Briefings"}),e.jsxs("p",{className:"text-sm text-slate-500",children:[c.length," gespeicherte Briefings"]})]}),e.jsx(V,{onClick:u,icon:e.jsx(O,{size:18}),children:"Neues Briefing"})]}),p&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(oe,{size:40,className:"text-primary animate-spin"}),e.jsx("p",{className:"mt-4 text-slate-500",children:"Briefings werden geladen..."})]}),s&&!p&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 flex items-start gap-3",children:[e.jsx(ae,{size:24,className:"text-red-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base text-red-600 font-medium mb-1",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-sm text-red-700",children:s})]})]}),!p&&!s&&e.jsx(e.Fragment,{children:c.length===0?e.jsxs(K,{className:"py-12 px-6 text-center",children:[e.jsx(xe,{size:48,className:"text-slate-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg text-slate-500 mb-2",children:"Noch keine Briefings"}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"Erstelle dein erstes Briefing, um loszulegen."}),e.jsx(V,{onClick:u,icon:e.jsx(O,{size:18}),children:"Briefing erstellen"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:c.map(o=>e.jsx(Je,{briefing:o,onOpen:t,onDelete:b,isDeleting:f===o.id},o.id))})})]}):e.jsx("div",{className:"p-6 max-w-[800px] mx-auto",children:e.jsxs(K,{className:"py-12 px-6 text-center",children:[e.jsx(xe,{size:48,className:"text-slate-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-lg text-slate-500 mb-2",children:"Anmeldung erforderlich"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Melde dich an, um deine gespeicherten Briefings zu sehen."})]})})},Qe=[{key:"file-text",icon:A,label:"Dokument"},{key:"briefcase",icon:ne,label:"Koffer"},{key:"banknote",icon:re,label:"Geld"},{key:"users",icon:se,label:"Team"},{key:"user",icon:te,label:"Person"},{key:"target",icon:X,label:"Ziel"},{key:"lightbulb",icon:M,label:"Idee"},{key:"star",icon:Z,label:"Stern"},{key:"shield",icon:q,label:"Schutz"},{key:"compass",icon:H,label:"Kompass"},{key:"rocket",icon:G,label:"Rakete"},{key:"message-circle",icon:ee,label:"Nachricht"},{key:"award",icon:Q,label:"Auszeichnung"},{key:"book",icon:Y,label:"Buch"},{key:"clipboard",icon:J,label:"Checkliste"}],he=[{value:"text",label:"Einzeiliges Textfeld"},{value:"textarea",label:"Mehrzeiliges Textfeld"},{value:"select",label:"Dropdown-Auswahl"}],U=()=>`var_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Xe=()=>({id:U(),key:"",label:"",type:"text",required:!0,placeholder:"",options:[]}),et=()=>({id:U(),value:"",label:""}),tt=({variable:t,index:u,total:y,onChange:c,onDelete:g,onMoveUp:p,onMoveDown:n,primaryAccent:s})=>{const[x,f]=a.useState(!0),[m,b]=a.useState(t.label);a.useEffect(()=>{b(t.label)},[t.label]);const o=(i,w)=>{c({...t,[i]:w})},d=()=>{const i=[...t.options||[],et()];c({...t,options:i})},S=(i,w,B)=>{const E=t.options.map(T=>T.id===i?{...T,[w]:B}:T);c({...t,options:E})},C=i=>{const w=t.options.filter(B=>B.id!==i);c({...t,options:w})},k=i=>i.toLowerCase().replace(/[äöüß]/g,w=>({ä:"ae",ö:"oe",ü:"ue",ß:"ss"})[w]).replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,""),z=()=>{if(m!==t.label){const i={label:m};(!t.key||t.key===k(t.label))&&(i.key=k(m)),c({...t,...i})}};return e.jsxs("div",{style:{backgroundColor:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0",marginBottom:"12px",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",backgroundColor:"white",borderBottom:x?"1px solid #e2e8f0":"none",cursor:"pointer"},onClick:()=>f(!x),children:[e.jsx(Ie,{size:16,style:{color:"#94a3b8",cursor:"grab"}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("span",{style:{fontWeight:600,color:"#0f172a",fontSize:"14px"},children:t.label||`Variable ${u+1}`}),t.key&&e.jsxs("span",{style:{marginLeft:"8px",color:"#64748b",fontSize:"12px"},children:["$","{","$",t.key,"}"]})]}),e.jsx("span",{style:{padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:500,backgroundColor:`${s}15`,color:s},children:he.find(i=>i.value===t.type)?.label||t.type}),e.jsxs("div",{style:{display:"flex",gap:"2px"},children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),p()},disabled:u===0,style:{padding:"4px",border:"none",backgroundColor:"transparent",cursor:u===0?"not-allowed":"pointer",opacity:u===0?.3:1},children:e.jsx(fe,{size:16,style:{color:"#64748b"}})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),n()},disabled:u===y-1,style:{padding:"4px",border:"none",backgroundColor:"transparent",cursor:u===y-1?"not-allowed":"pointer",opacity:u===y-1?.3:1},children:e.jsx(ge,{size:16,style:{color:"#64748b"}})})]}),e.jsx("button",{onClick:i=>{i.stopPropagation(),g()},style:{padding:"6px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444"},title:"Variable löschen",children:e.jsx(_,{size:16})})]}),e.jsx(De,{children:x&&e.jsx(je.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Feldbezeichnung *"}),e.jsx("input",{type:"text",value:m,onChange:i=>b(i.target.value),onBlur:z,placeholder:"z.B. Unternehmen",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Variablenname *"}),e.jsx("input",{type:"text",value:t.key,onChange:i=>o("key",i.target.value),placeholder:"z.B. unternehmen",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Feldtyp"}),e.jsx("select",{value:t.type,onChange:i=>o("type",i.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",backgroundColor:"white"},children:he.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 0",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:t.required,onChange:i=>o("required",i.target.checked),style:{width:"16px",height:"16px",accentColor:s}}),e.jsx("span",{style:{fontSize:"14px",color:"#475569"},children:"Pflichtfeld"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"4px"},children:"Platzhalter-Text (optional)"}),e.jsx("input",{type:"text",value:t.placeholder,onChange:i=>o("placeholder",i.target.value),placeholder:"z.B. BMW AG, Siemens, etc.",style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px"}})]}),t.type==="select"&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:600,color:"#475569",marginBottom:"8px"},children:"Auswahloptionen"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(t.options||[]).map((i,w)=>e.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[e.jsx("input",{type:"text",value:i.value,onChange:B=>S(i.id,"value",B.target.value),placeholder:"Wert",style:{flex:1,padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px",fontFamily:"monospace"}}),e.jsx("input",{type:"text",value:i.label,onChange:B=>S(i.id,"label",B.target.value),placeholder:"Anzeigename",style:{flex:2,padding:"8px 10px",borderRadius:"6px",border:"1px solid #e2e8f0",fontSize:"13px"}}),e.jsx("button",{onClick:()=>C(i.id),style:{padding:"6px",border:"none",backgroundColor:"transparent",cursor:"pointer",color:"#ef4444"},children:e.jsx(_,{size:14})})]},i.id)),e.jsxs("button",{onClick:d,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",border:"1px dashed #cbd5e1",borderRadius:"6px",backgroundColor:"transparent",color:"#64748b",fontSize:"13px",cursor:"pointer",marginTop:"4px"},children:[e.jsx(O,{size:14}),"Option hinzufügen"]})]})]})]})})})]})},st=({selectedIcon:t,onSelect:u,primaryAccent:y})=>e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"12px"},children:Qe.map(({key:c,icon:g,label:p})=>{const n=t===c;return e.jsx("button",{onClick:()=>u(c),title:p,style:{width:"60px",height:"60px",borderRadius:"12px",border:`2px solid ${n?y:"#e2e8f0"}`,backgroundColor:n?`${y}15`:"white",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s"},children:e.jsx(g,{size:28,style:{color:n?y:"#64748b"}})},c)})}),rt=({isOpen:t,onClose:u,onSave:y,editTemplate:c=null,demoCode:g})=>{const{branding:p,config:n}=Re(),s=p?.["--primary-accent"]||n?.buttonGradientStart||"#3A7FA7",[x,f]=a.useState(""),[m,b]=a.useState(""),[o,d]=a.useState("file-text"),[S,C]=a.useState(""),[k,z]=a.useState([]),[i,w]=a.useState(!1),[B,E]=a.useState(null),[T,l]=a.useState("basics");a.useEffect(()=>{c?(f(c.title||""),b(c.description||""),d(c.icon||"file-text"),C(c.system_prompt||""),z((c.variables_schema||[]).map(r=>({...r,id:r.id||U(),options:(r.options||[]).map(j=>({...j,id:j.id||U()}))})))):(f(""),b(""),d("file-text"),C(""),z([])),l("basics"),E(null)},[c,t]);const h=()=>{z([...k,Xe()])},v=(r,j)=>{const N=[...k];N[r]=j,z(N)},R=r=>{z(k.filter((j,N)=>N!==r))},F=r=>{if(r===0)return;const j=[...k];[j[r-1],j[r]]=[j[r],j[r-1]],z(j)},L=r=>{if(r===k.length-1)return;const j=[...k];[j[r],j[r+1]]=[j[r+1],j[r]],z(j)},ie=()=>{if(!x.trim())return E("Bitte gib einen Titel ein."),l("basics"),!1;if(!S.trim())return E("Bitte gib einen System-Prompt ein."),l("prompt"),!1;for(const r of k){if(!r.key.trim()||!r.label.trim())return E("Alle Variablen benötigen einen Namen und eine Bezeichnung."),l("variables"),!1;if(r.type==="select"&&(!r.options||r.options.length===0))return E(`Variable "${r.label}" benötigt mindestens eine Auswahloption.`),l("variables"),!1}return!0},le=async()=>{if(E(null),!!ie()){w(!0);try{const r=k.map(W=>({key:W.key,label:W.label,type:W.type,required:W.required,placeholder:W.placeholder,...W.type==="select"?{options:W.options.map(I=>({value:I.value,label:I.label}))}:{}})),j={title:x.trim(),description:m.trim(),icon:o,system_prompt:S,variables_schema:r,...g?{demo_code:g}:{}};let N;if(c?N=await $.request(`/smartbriefing/templates/${c.id}`,{method:"PUT",body:JSON.stringify(j)}):N=await $.request("/smartbriefing/templates",{method:"POST",body:JSON.stringify(j)}),N.success)y?.(N.data.template),u();else throw new Error(N.message||"Fehler beim Speichern")}catch(r){console.error("[CreateTemplateDialog] Save error:",r),E(r.message||"Fehler beim Speichern des Templates")}finally{w(!1)}}};return t?e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:"16px"},children:e.jsxs(je.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{backgroundColor:"white",borderRadius:"20px",width:"100%",maxWidth:"700px",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",overflow:"hidden"},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:700,color:"#0f172a"},children:c?"Template bearbeiten":"Neues Template erstellen"}),e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"#64748b"},children:"Erstelle ein persönliches Briefing-Template"})]}),e.jsx("button",{onClick:u,style:{padding:"8px",border:"none",backgroundColor:"#f1f5f9",borderRadius:"8px",cursor:"pointer"},children:e.jsx(ze,{size:20,style:{color:"#64748b"}})})]}),e.jsx("div",{style:{display:"flex",borderBottom:"1px solid #e2e8f0",padding:"0 24px"},children:[{key:"basics",label:"Grundlagen"},{key:"variables",label:"Eingabefelder"},{key:"prompt",label:"KI-Anweisung"}].map(r=>e.jsx("button",{onClick:()=>l(r.key),style:{padding:"12px 20px",border:"none",backgroundColor:"transparent",fontSize:"14px",fontWeight:600,cursor:"pointer",color:T===r.key?s:"#64748b",borderBottom:`3px solid ${T===r.key?s:"transparent"}`,marginBottom:"-1px",transition:"all 0.2s"},children:r.label},r.key))}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:"24px"},children:[B&&e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"12px 16px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ae,{size:18,style:{color:"#ef4444",flexShrink:0}}),e.jsx("span",{style:{color:"#dc2626",fontSize:"14px"},children:B})]}),T==="basics"&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"Titel *"}),e.jsx("input",{type:"text",value:x,onChange:r=>f(r.target.value),placeholder:"z.B. Projektpräsentation Vorbereitung",style:{width:"100%",padding:"12px 14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"15px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"Beschreibung"}),e.jsx("textarea",{value:m,onChange:r=>b(r.target.value),placeholder:"Kurze Beschreibung, wofür dieses Template verwendet wird...",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"14px",resize:"vertical"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"8px"},children:"Symbol"}),e.jsx(st,{selectedIcon:o,onSelect:d,primaryAccent:s})]})]}),T==="variables"&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[e.jsx(Be,{size:16,style:{color:"#64748b"}}),e.jsx("span",{style:{fontSize:"13px",color:"#64748b"},children:"Definiere die Eingabefelder, die der Nutzer beim Erstellen eines Briefings ausfüllen soll."})]})}),k.map((r,j)=>e.jsx(tt,{variable:r,index:j,total:k.length,onChange:N=>v(j,N),onDelete:()=>R(j),onMoveUp:()=>F(j),onMoveDown:()=>L(j),primaryAccent:s},r.id)),e.jsxs("button",{onClick:h,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",width:"100%",padding:"14px",borderRadius:"10px",border:"2px dashed #cbd5e1",backgroundColor:"white",color:"#64748b",fontSize:"14px",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:r=>{r.currentTarget.style.borderColor=s,r.currentTarget.style.color=s},onMouseLeave:r=>{r.currentTarget.style.borderColor="#cbd5e1",r.currentTarget.style.color="#64748b"},children:[e.jsx(O,{size:18}),"Eingabefeld hinzufügen"]}),k.length===0&&e.jsx("div",{style:{textAlign:"center",padding:"32px",color:"#94a3b8",fontSize:"14px"},children:"Noch keine Eingabefelder definiert."})]}),T==="prompt"&&e.jsxs("div",{children:[e.jsx("div",{style:{backgroundColor:"#f0f9ff",borderRadius:"10px",padding:"16px",marginBottom:"16px",border:"1px solid #bae6fd"},children:e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px"},children:[e.jsx(M,{size:18,style:{color:"#0284c7",flexShrink:0,marginTop:"2px"}}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 6px 0",fontSize:"14px",fontWeight:600,color:"#0369a1"},children:"Tipps für effektive Prompts"}),e.jsxs("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"13px",color:"#0369a1",lineHeight:1.6},children:[e.jsxs("li",{children:["Verwende ",e.jsxs("code",{style:{backgroundColor:"#e0f2fe",padding:"1px 4px",borderRadius:"3px"},children:["$","{variablenname}"]})," um auf Eingabefelder zu verweisen"]}),e.jsx("li",{children:'Beschreibe die Rolle der KI (z.B. "Du bist ein erfahrener Karriere-Coach...")'}),e.jsx("li",{children:"Definiere die Struktur des gewünschten Outputs"}),e.jsx("li",{children:"Gib Beispiele für den Ton und Stil"})]})]})]})}),k.length>0&&e.jsxs("div",{style:{marginBottom:"12px"},children:[e.jsx("span",{style:{fontSize:"12px",color:"#64748b"},children:"Verfügbare Variablen: "}),k.map(r=>e.jsxs("code",{style:{display:"inline-block",padding:"2px 6px",marginRight:"6px",marginBottom:"4px",backgroundColor:"#f1f5f9",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace",color:"#475569",cursor:"pointer"},onClick:()=>{const j=`\${${r.key}}`;C(N=>N+j)},title:"Klicken zum Einfügen",children:["$","{"+r.key+"}"]},r.id))]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:600,color:"#0f172a",marginBottom:"6px"},children:"System-Prompt *"}),e.jsx("textarea",{value:S,onChange:r=>C(r.target.value),placeholder:`Du bist ein erfahrener Experte für...

Erstelle ein strukturiertes Briefing für den Nutzer basierend auf folgenden Informationen:
- Position: \${position}
- Unternehmen: \${unternehmen}

Das Briefing soll folgende Abschnitte enthalten:
1. ...
2. ...

Formatiere jeden Abschnitt mit einem Titel und 5-8 konkreten Bullet Points.`,rows:15,style:{width:"100%",padding:"14px",borderRadius:"10px",border:"1px solid #e2e8f0",fontSize:"14px",fontFamily:"monospace",resize:"vertical",lineHeight:1.5}})]})]})]}),e.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[e.jsx("button",{onClick:u,style:{padding:"12px 24px",borderRadius:"10px",border:"1px solid #e2e8f0",backgroundColor:"white",color:"#475569",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:"Abbrechen"}),e.jsx("button",{onClick:le,disabled:i,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 24px",borderRadius:"10px",border:"none",background:`linear-gradient(135deg, ${s} 0%, ${s}dd 100%)`,color:"white",fontSize:"14px",fontWeight:600,cursor:i?"not-allowed":"pointer",opacity:i?.7:1},children:i?e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:18,style:{animation:"spin 1s linear infinite"}}),"Speichern..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{size:18}),c?"Speichern":"Template erstellen"]})})]}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}):null},D={DASHBOARD:"dashboard",FORM:"form",RESULT:"result",LIST:"list",WORKBOOK:"workbook"},yt=({isAuthenticated:t,requireAuth:u,setPendingAction:y,onNavigateToSimulator:c,onNavigateToHistory:g,demoCode:p})=>{const[n,s]=a.useState(D.DASHBOARD),[x,f]=a.useState(null),[m,b]=a.useState(null),[o,d]=a.useState(null),[S,C]=a.useState(null),[k,z]=a.useState(!1),[i,w]=a.useState(null),[B,E]=a.useState(0);a.useEffect(()=>{S&&t&&(f(S),s(D.FORM),C(null))},[S,t]),a.useEffect(()=>{window.scrollTo(0,0)},[n]);const T=a.useCallback(I=>{f(I),s(D.FORM)},[]),l=a.useCallback(()=>{f(null),b(null),d(null),s(D.DASHBOARD)},[]),h=a.useCallback(I=>{b(I),d(I),s(D.WORKBOOK)},[]),v=a.useCallback(()=>{b(null),d(null),f(null),s(D.DASHBOARD)},[]),R=a.useCallback(()=>{b(null),d(null),s(D.FORM)},[]);a.useCallback(()=>{s(D.LIST)},[]);const F=a.useCallback(I=>{d(I),s(D.WORKBOOK)},[]);a.useCallback(()=>{d(null),s(D.LIST)},[]);const L=a.useCallback(I=>{c&&c(I)},[c]),ie=a.useCallback(async I=>{try{if((await $.request(`/smartbriefing/briefings/${I.id}`,{method:"DELETE"})).success)d(null),s(D.DASHBOARD);else throw new Error("Fehler beim Löschen")}catch(P){throw console.error("[SmartBriefing] Error deleting briefing:",P),P}},[]),le=a.useCallback(()=>{w(null),z(!0)},[]),r=a.useCallback(I=>{w(I),z(!0)},[]),j=a.useCallback(()=>{z(!1),w(null)},[]),N=a.useCallback(I=>{E(P=>P+1)},[]),W=()=>{switch(n){case D.FORM:return e.jsx(Ke,{template:x,onBack:l,onBriefingGenerated:h,isAuthenticated:t});case D.RESULT:return e.jsx(He,{briefing:m,template:x,onBack:l,onCreateNew:v,onGenerateAnother:R});case D.LIST:return e.jsx(Ye,{onOpenBriefing:F,onCreateNew:v,isAuthenticated:t});case D.WORKBOOK:return e.jsx($e,{briefing:o,onBack:l,onDelete:ie,onStartSimulation:c?L:null});case D.DASHBOARD:default:return e.jsx(Pe,{onSelectTemplate:T,onShowList:g,onCreateTemplate:le,onEditTemplate:r,isAuthenticated:t,requireAuth:u,setPendingAction:y,demoCode:p},B)}};return e.jsxs("div",{style:{minHeight:"100%"},children:[W(),e.jsx(rt,{isOpen:k,onClose:j,onSave:N,editTemplate:i,demoCode:p})]})};export{Ye as BriefingList,He as BriefingResult,$e as BriefingWorkbook,yt as SmartBriefingApp,Pe as SmartBriefingDashboard,Ke as SmartBriefingForm};
