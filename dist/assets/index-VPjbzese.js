import{j as s,S as U,aC as P}from"./ui-vendor-BAEfSb-X.js";import{a as o}from"./react-vendor-uDOJF2jQ.js";import{a as z,D as _}from"./DecisionBoardResult-DnLgolFW.js";import{u as A,D as L,w as u,c as T,C as x}from"./designTokens-LSOQEIoP.js";import{F as W,a as N}from"./index.js";import"./card-CRd_k1Xo.js";import"./utils-BEHD0UYf.js";import"./button-C27wFDRr.js";import"./input-B2p07toF.js";import"./textarea-AQGmZicy.js";import"./useBranding-CRmuKfX5.js";import"./AudioRecorder-LFdSK1H4.js";const c={INPUT:"input",RESULT:"result"},ne=({isAuthenticated:f,requireAuth:d,setPendingAction:O,onNavigateToHistory:r})=>{const[S,m]=o.useState(c.INPUT),[g,D]=o.useState(null),[j,p]=o.useState(null),[i,a]=o.useState(null),[G,M]=o.useState(!1),l=o.useRef(!1),{branding:C}=A(),w=C?.["--primary-accent"]||L["--primary-accent"],b=T(x.teal[500],x.teal[400]);o.useEffect(()=>{window.scrollTo(0,0)},[S]),o.useEffect(()=>{!f&&d&&d()},[f,d]);const B=o.useCallback(async e=>{if(l.current||!e.topic?.trim())return null;try{const n={topic:e.topic,context:e.context||null,pros:e.pros||[],cons:e.cons||[],pro_score:e.proScore||0,contra_score:e.contraScore||0,status:"draft"},t=await u.createDecision(n);if(t?.id)return l.current=!0,a(t.id),console.log("[DecisionBoard] Draft session saved with ID:",t.id),t.id}catch(n){console.error("[DecisionBoard] Failed to save draft session:",n)}return null},[]),h=o.useCallback(async(e,n)=>{if(e)try{const t={topic:n.topic,context:n.context||null,pros:n.pros||[],cons:n.cons||[],pro_score:n.proScore||0,contra_score:n.contraScore||0,analysis:n.analysis||null,status:n.status||"completed"};await u.updateDecision(e,t),console.log("[DecisionBoard] Session updated:",e)}catch(t){console.error("[DecisionBoard] Failed to update session:",t)}},[]),I=o.useCallback(async e=>{if(e)try{await u.deleteDecision(e),console.log("[DecisionBoard] Session deleted:",e)}catch(n){console.error("[DecisionBoard] Failed to delete session:",n)}},[]),v=o.useCallback(async(e,n)=>{D(e),p(n),m(c.RESULT);try{if(i)await h(i,{...e,analysis:n,status:"completed"});else{const t={topic:e.topic,context:e.context||null,pros:e.pros,cons:e.cons,pro_score:e.proScore,contra_score:e.contraScore,analysis:n,status:"completed"},y=await u.createDecision(t);y?.id&&(a(y.id),l.current=!0,console.log("[DecisionBoard] Decision saved with ID:",y.id))}}catch(t){console.error("[DecisionBoard] Failed to save decision:",t)}},[i,h]),E=o.useCallback(()=>{D(null),p(null),a(null),l.current=!1,m(c.INPUT)},[]),R=o.useCallback(()=>{p(null),m(c.INPUT)},[]),k=o.useCallback(async()=>{i&&await I(i),D(null),p(null),a(null),l.current=!1,r&&r()},[i,I,r]),F=()=>{switch(S){case c.RESULT:return s.jsx(_,{decisionData:g,analysisResult:j,onStartNew:E,onEditDecision:R});case c.INPUT:default:return s.jsx(z,{initialData:g,onAnalysisComplete:v,onCancel:r?k:null,isAuthenticated:f,requireAuth:d,savedDecisionId:i,onSaveDraft:B,onUpdateSession:h,onDecisionIdChange:a})}};return s.jsxs(s.Fragment,{children:[s.jsx(W,{featureId:"decisionboard",showOnMount:!0}),s.jsxs("div",{style:{minHeight:"100%"},children:[s.jsx("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:s.jsx("div",{style:{marginBottom:"24px"},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"16px"},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:b,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx(U,{style:{width:"24px",height:"24px",color:"white"}})}),s.jsxs("div",{children:[s.jsx("h1",{style:{fontSize:"28px",fontWeight:700,color:x.slate[900],margin:0},children:"Entscheidungs-Board"}),s.jsx("p",{style:{fontSize:"14px",color:x.slate[600],margin:0},children:"Strukturierte Entscheidungsfindung"})]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[s.jsx(N,{featureId:"decisionboard",size:"sm"}),r&&s.jsxs("button",{onClick:r,style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",borderRadius:"12px",border:`2px solid ${w}`,backgroundColor:"white",color:w,fontSize:"14px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},children:[s.jsx(P,{size:18}),"Meine Entscheidungen"]})]})]})})}),F()]})]})};export{ne as DecisionBoardApp,z as DecisionBoardInput,_ as DecisionBoardResult};
