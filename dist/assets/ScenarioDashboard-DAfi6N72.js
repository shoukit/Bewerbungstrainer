import{av as O,T as Ee,ad as Ie,c as Ae,as as $e,q as ze,U as De,B as Me,j as e,aU as ee,aM as be,aL as re,aV as Be,l as Te,z as Ue,az as _e}from"./ui-vendor-B9DEMv6g.js";import{a as m}from"./react-vendor-uDOJF2jQ.js";import{w as Oe,u as Re,D as X}from"./FeatureInfoButton-Df0Ex1oW.js";import{S as Fe,a as Ge}from"./ScenarioCard-BVMLj9FI.js";import{D as Ke,a as He,b as We,c as Ye}from"./dialog-BRm7JlyZ.js";import{u as Ze}from"./useMobile-YxjH166V.js";import{B as qe}from"./Button-BHvYxNT_.js";import"./select-native-BpAm0hLd.js";const Je={briefcase:Me,users:De,"trending-up":ze,"message-circle":$e,shield:Ae,heart:Ie,target:Ee,folder:O},C=O,j=s=>!s||typeof s!="string"?C:Je[s.toLowerCase()]||C,z=s=>!s||typeof s!="string"?"":s.toLowerCase().replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss").replace(/[^a-z0-9]/g,""),P={career:"karriere",leadership:"fuehrung",sales:"vertrieb",communication:"kommunikation",service:"service",social:"social",karriere:"karriere",fuehrung:"fuehrung",vertrieb:"vertrieb",kommunikation:"kommunikation",meine:"meine",selfpresentation:"karriere",interview:"karriere",pitch:"vertrieb",negotiation:"vertrieb",vorstellungsgespraech:"karriere",gehaltsverhandlung:"vertrieb",fuehrungsgespraech:"fuehrung",praesentation:"kommunikation",selbstvorstellung:"karriere",training:"kommunikation"};let D=null,V=null;const Qe=300*1e3;function Xe(){const[s,x]=m.useState(D||[]),[c,p]=m.useState(!D),[d,w]=m.useState(null),b=m.useCallback(async()=>{if(D&&V&&Date.now()-V<Qe)return x(D),p(!1),D;try{p(!0),w(null);const l=await Oe.getCategories();return D=l,V=Date.now(),x(l),l}catch(l){return console.error("[useCategories] Failed to fetch categories:",l),w(l.message||"Failed to fetch categories"),[]}finally{p(!1)}},[]);m.useEffect(()=>{b()},[b]);const f=m.useCallback(l=>{if(!l||!s.length)return null;const o=z(l),i=P[o]||o,t=s.find(r=>z(r.slug)===i||z(r.name)===i);return t?{...t,IconComponent:j(t.icon),bgColor:`${t.color}15`}:null},[s]),g=m.useCallback(l=>{if(Array.isArray(l)){for(const t of l){if(typeof t!="string")continue;const r=f(t);if(r)return{key:r.slug,label:r.name,shortLabel:r.shortName||r.name,icon:j(r.icon),IconComponent:j(r.icon),color:r.color,bgColor:r.bgColor}}const i=l.find(t=>typeof t=="string")||"unknown";return{key:String(i),label:String(i),shortLabel:String(i),icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"}}if(typeof l!="string")return{key:"unknown",label:"Unbekannt",shortLabel:"Unbekannt",icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"};const o=f(l);return o?{key:o.slug,label:o.name,shortLabel:o.shortName||o.name,icon:j(o.icon),IconComponent:j(o.icon),color:o.color,bgColor:o.bgColor}:{key:l||"unknown",label:l||"Unbekannt",shortLabel:l||"Unbekannt",icon:C,IconComponent:C,color:"#64748b",bgColor:"#f1f5f9"}},[f]),N=m.useCallback((l=[])=>{if(!s.length)return[];if(!l.length)return s.map(i=>({key:i.slug,label:i.name,shortLabel:i.shortName||i.name,icon:j(i.icon),IconComponent:j(i.icon),color:i.color,bgColor:`${i.color}15`}));const o=new Map;return l.forEach(i=>{if(i){if(Array.isArray(i))i.forEach(t=>{if(!t||typeof t!="string"||!t.trim())return;const r=f(t);r&&!o.has(r.slug)&&o.set(r.slug,{key:r.slug,label:r.name,shortLabel:r.shortName||r.name,icon:j(r.icon),IconComponent:j(r.icon),color:r.color,bgColor:r.bgColor})});else if(typeof i=="string"&&i.trim()){const t=f(i);t&&!o.has(t.slug)&&o.set(t.slug,{key:t.slug,label:t.name,shortLabel:t.shortName||t.name,icon:j(t.icon),IconComponent:j(t.icon),color:t.color,bgColor:t.bgColor})}}}),Array.from(o.values())},[s,f]),v=m.useCallback((l,o)=>{if(!l||!o)return!1;const i=z(o);if(Array.isArray(l))return l.some(L=>{const I=z(L);return(P[I]||I)===i});const t=z(l);return(P[t]||t)===i},[]),S=m.useMemo(()=>{const l=new Map;return s.forEach(o=>{l.set(o.slug,{...o,IconComponent:j(o.icon),bgColor:`${o.color}15`})}),l},[s]);return{categories:s,categoriesMap:S,loading:c,error:d,refetch:b,getCategoryBySlug:f,getCategoryConfig:g,getCategoriesForFilter:N,matchesCategory:v}}const _=({label:s,icon:x,isSelected:c,onClick:p})=>e.jsxs("button",{onClick:p,className:`inline-flex items-center gap-2 px-3 py-2 rounded-full text-sm font-semibold
      border-2 cursor-pointer transition-all whitespace-nowrap
      ${c?"border-primary bg-primary/10 text-primary":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[x&&e.jsx(x,{className:"w-3.5 h-3.5"}),s]}),Pe=({count:s})=>s===0?null:e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 rounded-md bg-red-500 text-white text-xs font-semibold flex items-center justify-center",children:s}),Ve=({value:s,onChange:x,placeholder:c,className:p=""})=>e.jsxs("div",{className:`relative ${p}`,children:[e.jsx(be,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-[18px] h-[18px] text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:s,onChange:d=>x(d.target.value),className:"w-full py-3 pl-11 pr-4 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none transition-all focus:border-primary focus:ring-2 focus:ring-primary/20"})]}),pe=({value:s,onChange:x,options:c,className:p=""})=>e.jsxs("div",{className:`relative ${p}`,children:[e.jsx(re,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("select",{value:s,onChange:d=>x(d.target.value),className:"w-full py-3 pl-10 pr-10 rounded-lg border border-slate-200 text-base text-slate-900 bg-white cursor-pointer outline-none appearance-none bg-no-repeat",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E")`,backgroundPosition:"right 12px center"},children:c.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))})]}),de=({viewMode:s,onViewModeChange:x,compact:c=!1})=>e.jsxs("div",{className:`flex items-center gap-1 ${c?"p-[3px]":"p-1"} bg-slate-100 rounded-lg`,children:[e.jsx("button",{onClick:()=>x("grid"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${s==="grid"?"bg-white shadow-sm":"bg-transparent"}`,title:"Kachelansicht",children:e.jsx(ee,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${s==="grid"?"text-primary":"text-slate-500"}`})}),e.jsx("button",{onClick:()=>x("list"),className:`${c?"p-1":"p-2"} rounded-md border-none cursor-pointer flex items-center justify-center transition-all
        ${s==="list"?"bg-white shadow-sm":"bg-transparent"}`,title:"Listenansicht",children:e.jsx(Be,{className:`${c?"w-3.5 h-3.5":"w-4 h-4"} ${s==="list"?"text-primary":"text-slate-500"}`})})]}),er=({searchQuery:s,onSearchChange:x,searchPlaceholder:c="Durchsuchen...",showSearch:p=!0,categories:d=[],selectedCategory:w,onCategoryChange:b,showCategories:f=!0,difficultyOptions:g=[],selectedDifficulty:N,onDifficultyChange:v,showDifficulty:S=!1,viewMode:l,onViewModeChange:o,showViewToggle:i=!0,renderCustomFilters:t,customActions:r,children:L})=>{const[I,A]=m.useState(!1),R=Ze(),$=[w?1:0,N&&N!=="all"?1:0,s?.trim()?1:0].reduce((h,M)=>h+M,0);return R?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[p&&e.jsxs("div",{className:"relative flex-1",children:[e.jsx(be,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:c,value:s,onChange:h=>x(h.target.value),className:"w-full py-2 pl-9 pr-3 rounded-lg border border-slate-200 text-base text-slate-900 bg-white outline-none"})]}),e.jsxs("button",{onClick:()=>A(!0),className:`relative flex items-center justify-center w-11 h-11 rounded-lg border flex-shrink-0 cursor-pointer
            ${$>0?"border-primary bg-primary/10":"border-slate-200 bg-white"}`,children:[e.jsx(re,{className:`w-[18px] h-[18px] ${$>0?"text-primary":"text-slate-500"}`}),e.jsx(Pe,{count:$})]}),i&&l&&e.jsx(de,{viewMode:l,onViewModeChange:o,compact:!0})]}),r&&e.jsx("div",{className:"mt-2",children:r}),e.jsx(Ke,{open:I,onOpenChange:A,children:e.jsxs(He,{className:"fixed bottom-0 left-0 right-0 top-auto transform-none max-w-full w-full rounded-t-2xl max-h-[80vh] overflow-auto",children:[e.jsx(We,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ye,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-primary"}),"Filter"]}),$>0&&e.jsx("button",{onClick:()=>{b?.(null),v?.("all"),x?.("")},className:"px-3 py-1 rounded-md border-none bg-slate-100 text-slate-600 text-sm font-medium cursor-pointer hover:bg-slate-200 transition-colors",children:"Zurücksetzen"})]})}),e.jsxs("div",{className:"flex flex-col gap-5 py-2",children:[S&&g.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Schwierigkeit"}),e.jsx(pe,{value:N,onChange:v,options:g})]}),f&&d.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Kategorie"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{label:"Alle",icon:ee,isSelected:!w,onClick:()=>b(null)}),d.map(h=>e.jsx(_,{label:h.label,icon:h.icon,isSelected:w===h.key,onClick:()=>b(h.key)},h.key))]})]}),t&&e.jsx("div",{children:t()})]}),e.jsx(qe,{variant:"primary",size:"lg",onClick:()=>A(!1),fullWidth:!0,className:"mt-3",children:"Filter anwenden"})]})}),L]}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[p&&e.jsx(Ve,{value:s,onChange:x,placeholder:c,className:"flex-1 min-w-[200px]"}),S&&g.length>0&&e.jsx(pe,{value:N,onChange:v,options:g,className:"min-w-[180px]"}),t&&t(),r,i&&l&&e.jsx(de,{viewMode:l,onViewModeChange:o})]}),f&&d.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(_,{label:"Alle",icon:ee,isSelected:!w,onClick:()=>b(null)}),d.map(h=>e.jsx(_,{label:h.label,icon:h.icon,isSelected:w===h.key,onClick:()=>b(h.key)},h.key))]}),L]})},he=({category:s,getCategoryConfig:x})=>{const c=x(s);if(!c)return null;const p=c.IconComponent||c.icon||O;return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:c.bgColor,color:c.color},children:[e.jsx(p,{style:{width:"12px",height:"12px"}}),c.shortLabel]})},rr=({category:s,getCategoryConfig:x})=>Array.isArray(s)?e.jsx("div",{className:"flex flex-wrap gap-1",children:s.map((c,p)=>e.jsx(he,{category:c,getCategoryConfig:x},p))}):e.jsx(he,{category:s,getCategoryConfig:x}),mr=({title:s,subtitle:x,headerIcon:c,fetchScenarios:p,moduleKey:d,historyButtonLabel:w="Meine Sessions",onNavigateToHistory:b,showHistoryButton:f=!0,onSelectScenario:g,renderCardMeta:N,renderCategoryBadge:v,getIconForScenario:S,cardActionLabel:l="Starten",cardActionIcon:o,getCardCustomActions:i,categoryField:t="category",customCategoryConfig:r,emptyStateIcon:L,emptyStateTitle:I="Keine Szenarien verfügbar",emptyStateMessage:A="Bitte kontaktieren Sie den Administrator.",searchPlaceholder:R="Durchsuchen...",headerActions:$,filterActions:h,renderInfoBox:M,extraContent:fe,isAuthenticated:B,requireAuth:F,setPendingAction:G,setPendingScenario:K,demoCode:te,pendingScenario:H,clearPendingScenario:W,loadingMessage:ge="Szenarien werden geladen...",errorRetryLabel:je="Erneut versuchen"})=>{const[se,we]=m.useState([]),[Ne,ne]=m.useState(!0),[le,ae]=m.useState(null),[E,oe]=m.useState(null),[Y,ve]=m.useState("grid"),[T,ke]=m.useState(""),{branding:Z,filterScenariosBySetupAndPartner:ie}=Re(),{getCategoryConfig:q,getCategoriesForFilter:ce,matchesCategory:U}=Xe(),ye=Z?.["--header-gradient"]||X["--header-gradient"],Ce=Z?.["--header-text"]||X["--header-text"];Z?.["--primary-accent"]||X["--primary-accent"];const J=m.useCallback(async()=>{try{ne(!0),ae(null);const n=await p();we(n||[])}catch(n){console.error(`[${s}] Error loading scenarios:`,n),ae(n.message||"Fehler beim Laden")}finally{ne(!1)}},[p,s]);m.useEffect(()=>{J()},[J]);const me=m.useRef(!1);m.useEffect(()=>{H&&B&&!me.current&&(me.current=!0,W&&W(),g(H))},[H,B,W,g]);const k=m.useMemo(()=>ie([...se],d),[se,ie,d]),Q=m.useMemo(()=>{if(r){const a=new Set;return k.forEach(u=>{const y=u[t];y&&r[y]&&a.add(y)}),Array.from(a)}const n=k.flatMap(a=>{const u=a[t];return Array.isArray(u)?u.filter(y=>y&&typeof y=="string"&&y.trim()):u&&typeof u=="string"&&u.trim()?[u]:[]});return[...new Set(n)]},[k,t,r]),xe=m.useMemo(()=>r?Q.filter(a=>k.some(u=>u[t]===a)).map(a=>({key:a,label:r[a]?.label||a,shortLabel:r[a]?.label||a,color:r[a]?.color,bgColor:r[a]?.bgColor,icon:r[a]?.icon,IconComponent:r[a]?.icon})):ce(Q).filter(a=>!a||!a.label||!a.label.trim()?!1:k.some(u=>U(u[t],a.key))),[Q,r,ce,k,t,U]),ue=m.useMemo(()=>{let n=[...k];if(E&&(r?n=n.filter(a=>a[t]===E):n=n.filter(a=>U(a[t],E))),T.trim()){const a=T.toLowerCase();n=n.filter(u=>u.title?.toLowerCase().includes(a)||u.description?.toLowerCase().includes(a))}return n},[k,E,T,t,r,U]),Se=m.useCallback(n=>{if(!B&&!te){K?K(n):G&&G({type:"SELECT_SCENARIO",scenario:n}),F&&F(()=>{g(n)},{type:"SELECT_SCENARIO",scenario:n});return}g(n)},[B,te,K,G,F,g]),Le=m.useCallback(n=>{const a=n[t];if(!a)return null;if(v)return v(n,q);if(r&&r[a]){const u=r[a];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-2xl text-[11px] font-semibold",style:{backgroundColor:u.bgColor,color:u.color},children:[u.icon&&e.jsx(u.icon,{style:{width:"12px",height:"12px"}}),u.label]})}return e.jsx(rr,{category:a,getCategoryConfig:q})},[t,v,r,q]);return Ne?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-[60px_20px] gap-4",children:[e.jsx(Te,{className:"w-12 h-12 text-primary animate-spin"}),e.jsx("p",{className:"text-slate-600 text-base",children:ge})]}):le?e.jsxs("div",{className:"min-h-[60vh] flex flex-col items-center justify-center p-[60px_20px] gap-4",children:[e.jsx(Ue,{className:"w-12 h-12 text-red-500"}),e.jsx("p",{className:"text-red-500 text-base text-center",children:le}),e.jsx("button",{onClick:J,className:"px-6 py-3 rounded-xl border-none bg-primary text-white text-sm font-semibold cursor-pointer hover:opacity-90 transition-opacity",children:je})]}):e.jsxs("div",{className:"p-6 max-w-[1200px] mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{background:ye},children:c&&e.jsx(c,{style:{width:"24px",height:"24px",color:Ce}})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-[28px] font-bold text-slate-900 m-0",children:s}),e.jsx("p",{className:"text-sm text-slate-600 m-0",children:x})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[$,f&&b&&e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-5 py-3 rounded-xl border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-all",children:[e.jsx(_e,{size:18}),w]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(er,{searchQuery:T,onSearchChange:ke,searchPlaceholder:R,categories:xe.map(n=>({key:n.key,label:n.label,shortLabel:n.shortLabel||n.label,color:n.color,bgColor:n.bgColor,icon:n.IconComponent||n.icon})),selectedCategory:E,onCategoryChange:oe,showCategories:xe.length>0,showDifficulty:!1,viewMode:Y,onViewModeChange:ve,customActions:h})})]}),ue.length>0?e.jsx(Fe,{minCardWidth:"340px",viewMode:Y,children:ue.map(n=>{const a=S?S(n):null,u=N?N(n):[],y=i?i(n):null;return e.jsx(Ge,{title:n.title,description:n.description,icon:a,categoryBadge:Le(n),meta:u,action:o?{label:l,icon:o}:{label:l},onClick:()=>Se(n),viewMode:Y,customActions:y},n.id)})}):e.jsxs("div",{className:"text-center p-12 px-6 bg-white rounded-2xl border border-slate-200",children:[e.jsx("div",{className:"flex justify-center mb-4",children:L?e.jsx(L,{className:"w-12 h-12 text-slate-300"}):e.jsx(O,{className:"w-12 h-12 text-slate-300"})}),e.jsx("h3",{className:"text-slate-500 m-0 mb-2 font-medium",children:I}),e.jsx("p",{className:"text-slate-400 m-0 text-sm",children:E?"In der ausgewählten Kategorie sind keine Szenarien verfügbar.":A}),E&&k.length>0&&e.jsx("button",{onClick:()=>oe(null),className:"mt-4 px-5 py-2.5 rounded-[20px] border-2 border-primary bg-white text-primary text-sm font-semibold cursor-pointer hover:bg-primary/5 transition-colors",children:"Alle Szenarien anzeigen"})]}),M&&M(),fe]})};export{mr as S};
