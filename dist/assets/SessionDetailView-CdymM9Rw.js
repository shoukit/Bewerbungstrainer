import{j as e,L as _,z as b}from"./ui-vendor-BE38435C.js";import{a as t}from"./react-vendor-uDOJF2jQ.js";import{B as x}from"./button-BQYJJBdr.js";import{e as S,d as N,b as k,h as g}from"./index.js";import{R as v}from"./RoleplaySessionReport-COpH9kq-.js";import"./FeatureInfoButton-DyznMx23.js";import"./useBranding-Kz0Veku8.js";function F({session:i,onBack:r,onRepeatSession:c}){const[n,f]=t.useState(i),[o,j]=t.useState(null),[p,l]=t.useState(!0),[d,m]=t.useState(null),h=t.useMemo(()=>S(n?.feedback_json),[n?.feedback_json]),y=t.useMemo(()=>N(n?.audio_analysis_json),[n?.audio_analysis_json]);t.useEffect(()=>{u()},[i?.id]);const u=async()=>{try{l(!0),m(null);const s=await k(i.id);if(f(a=>({...s,feedback_json:s.feedback_json||a?.feedback_json,audio_analysis_json:s.audio_analysis_json||a?.audio_analysis_json,transcript:s.transcript||a?.transcript,conversation_id:s.conversation_id||a?.conversation_id})),s.scenario_id)try{const a=await g(s.scenario_id);j(a)}catch(a){console.warn("Could not load scenario:",a)}}catch(s){console.error("Failed to load session:",s),m(s.message||"Fehler beim Laden der Session")}finally{l(!1)}};return p?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_,{className:"w-12 h-12 text-indigo-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Gesprächsanalyse wird geladen..."})]})}):d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-6",children:[e.jsx(b,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Fehler beim Laden"}),e.jsx("p",{className:"text-slate-600 mb-4",children:d}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(x,{variant:"outline",onClick:r,children:"Zurück"}),e.jsx(x,{onClick:u,children:"Erneut versuchen"})]})]})}):e.jsx(v,{session:n,scenario:o,feedback:h,audioAnalysis:y,onBack:r,onRepeat:o&&c?()=>c(n,o,"roleplay"):void 0})}export{F as default};
